import*as _n from"https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js";import{OrbitControls as YD}from"https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/controls/OrbitControls.js";import{TextGeometry as QD}from"https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/geometries/TextGeometry.js";import{FontLoader as ZD}from"https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/loaders/FontLoader.js";function JD(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in n)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(n,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();function Ai(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function eR(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),t}var Ep={exports:{}},Zl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B1;function tR(){if(B1)return Zl;B1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:n,type:r,key:l,ref:a!==void 0?a:null,props:i}}return Zl.Fragment=e,Zl.jsx=t,Zl.jsxs=t,Zl}var M1;function nR(){return M1||(M1=1,Ep.exports=tR()),Ep.exports}var q=nR();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rR=1e-7,aR=1e-4;class sR{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Lv{refCount(e){return Rn("refCount")}incRef(e){return Rn("incRef")}timerAvailable(){return!0}time(e){return Rn("time")}read(e){return Rn("read")}readSync(e){return Rn("readSync")}readToGPU(e,t){return Rn("readToGPU")}numDataIds(){return Rn("numDataIds")}disposeData(e,t){return Rn("disposeData")}write(e,t,r){return Rn("write")}move(e,t,r,a,i){return Rn("move")}createTensorFromGPUData(e,t,r){return Rn("createTensorFromGPUData")}memory(){return Rn("memory")}floatPrecision(){return Rn("floatPrecision")}epsilon(){return this.floatPrecision()===32?rR:aR}dispose(){return Rn("dispose")}}function Rn(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sd(n,e,t){return Math.max(n,Math.min(e,t))}function Jm(n){return n%2===0?n:n+1}function Jl(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function iR(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function A(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Kn(n,e,t=""){A(pt(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Ho(n){A(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function pe(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function oR(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==null&&e[t]!==null&&n[t]!==e[t])return!1;return!0}function pt(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Bo(n){return n%1===0}function rm(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function ko(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function U1(n,e=a=>0,t,r){return new Promise((a,i)=>{let l=0;const u=()=>{if(n()){a();return}l++;const c=e(l);if(t!=null&&l>=t){i();return}r!=null?r(u,c):setTimeout(u,c)};u()})}function lR(n,e){let t=1,r=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const a=n.slice();return a[r]=e/t,a}function Ft(n,e){const t=e.length;return n=n==null?e.map((r,a)=>a):[].concat(n),A(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),A(n.every(r=>Bo(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function _s(n,e){const t=[],r=[],a=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||a?null:Ft(e,n).sort();let l=0;for(let u=0;u<n.length;++u){if(i!=null){if(i[l]===u&&n[u]!==1)throw new Error(`Can't squeeze axis ${u} since its dim '${n[u]}' is not 1`);(i[l]==null||i[l]>u)&&n[u]===1&&(t.push(n[u]),r.push(u)),i[l]<=u&&l++}n[u]!==1&&(t.push(n[u]),r.push(u))}return{newShape:t,keptDims:r}}function Ts(n,e){return kt(n,e)}function kt(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function uR(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function cR(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function dR(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function wd(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function fR(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function jd(n){return typeof n=="string"||n instanceof String}function hR(n){return typeof n=="boolean"}function pR(n){return typeof n=="number"}function Eu(n){return Array.isArray(n)?Eu(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":pR(n)?"float32":jd(n)?"string":hR(n)?"bool":"float32"}function am(n){return!!(n&&n.constructor&&n.call&&n.apply)}function sm(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Vt(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function Bv(n,e,t,r=!1){const a=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let l=0;l<i;l++)a[l]=t[n+l]}else{const i=e[0],l=e.slice(1),u=l.reduce((c,f)=>c*f)*(r?2:1);for(let c=0;c<i;c++)a[c]=Bv(n+c*u,l,t,r)}return a}function im(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((a,i)=>a*i)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return Bv(0,n,e,t)}function Mv(n,e){const t=Ns(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function Ns(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function Yn(n){n.forEach(e=>{A(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function om(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let a=0;a<n.length-1;++a)r+=t[a]*n[a];return r}function eg(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(n/t[a]),n-=r[a]*t[a];return r[r.length-1]=n,r}function Ci(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1="tfjsflags";class mR{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=gR,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const a=this.urlFlags[e];Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${a}.`),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Ci(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);P1 in e&&e[P1].split(",").forEach(r=>{const[a,i]=r.split(":");this.urlFlags[a]=xR(a,i)})}}function gR(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(yR(e,r[0],r[1]),r.join("="))),e}function yR(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function xR(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function Z(){return Uv}let Uv=null;function bR(n){Uv=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let $p;function Pv(){if($p==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");$p=n}return $p}function vR(){const n=Pv();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function tg(n,e){const t=vR();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const zv="Abs",Vv="Acos",Gv="Acosh",ng="Add",Hv="AddN",Wv="All",jv="Any",qv="ArgMax",Xv="ArgMin",Kv="Asin",Yv="Asinh",Qv="Atan",Zv="Atanh",Jv="Atan2",eC="AvgPool",CR="AvgPoolGrad",tC="AvgPool3D",SR="AvgPool3DGrad",nC="BatchMatMul",rC="BatchToSpaceND",aC="Bincount",sC="BitwiseAnd",iC="BroadcastArgs",rg="Cast",oC="Ceil",lC="ClipByValue",uC="Complex",cC="ComplexAbs",dC="Concat",fC="Conv2D",hC="Conv2DBackpropFilter",pC="Conv2DBackpropInput",mC="Conv3D",wR="Conv3DBackpropFilterV2",gC="Conv3DBackpropInputV2",yC="Cos",xC="Cosh",bC="Cumprod",vC="Cumsum",CC="CropAndResize",SC="DenseBincount",wC="DepthToSpace",TC="DepthwiseConv2dNative",NC="DepthwiseConv2dNativeBackpropFilter",EC="DepthwiseConv2dNativeBackpropInput",$C="Diag",DC="Dilation2D",RC="RealDiv",_C="Einsum",OC="Elu",TR="EluGrad",kC="Erf",FC="Equal",AC="Exp",IC="ExpandDims",LC="Expm1",BC="FFT",MC="Fill",UC="FlipLeftRight",PC="Floor",zC="FloorDiv",VC="FusedBatchNorm",GC="GatherV2",HC="GatherNd",WC="Greater",jC="GreaterEqual",ag="Identity",qC="IFFT",XC="Imag",KC="IsFinite",YC="IsInf",QC="IsNan",ZC="LeakyRelu",JC="Less",eS="LessEqual",tS="LinSpace",nS="Log",rS="Log1p",aS="LogicalAnd",sS="LogicalNot",iS="LogicalOr",oS="LRN",NR="LRNGrad",lS="Max",uS="Maximum",cS="MaxPool",ER="MaxPoolGrad",dS="MaxPool3D",$R="MaxPool3DGrad",fS="MaxPoolWithArgmax",hS="Mean",pS="Min",mS="Minimum",gS="MirrorPad",yS="Mod",xS="Multinomial",bS="Multiply",vS="Neg",CS="NotEqual",SS="NonMaxSuppressionV3",wS="NonMaxSuppressionV4",TS="NonMaxSuppressionV5",NS="OnesLike",ES="OneHot",$S="Pack",DS="PadV2",RS="Pow",_S="Prelu",OS="Prod",kS="RaggedGather",FS="RaggedRange",AS="RaggedTensorToTensor",IS="Range",LS="Real",BS="Reciprocal",MS="Relu",US="Reshape",PS="ResizeNearestNeighbor",DR="ResizeNearestNeighborGrad",zS="ResizeBilinear",RR="ResizeBilinearGrad",VS="Relu6",GS="Reverse",HS="Round",WS="Rsqrt",jS="ScatterNd",qS="TensorScatterUpdate",XS="SearchSorted",KS="Select",YS="Selu",QS="Slice",ZS="Sin",JS="Sinh",ew="Sign",tw="Sigmoid",nw="Softplus",rw="Sqrt",aw="Sum",sw="SpaceToBatchND",iw="SplitV",ow="Softmax",lw="SparseFillEmptyRows",uw="SparseReshape",cw="SparseSegmentMean",dw="SparseSegmentSum",fw="SparseToDense",hw="SquaredDifference",_R="Square",pw="StaticRegexReplace",mw="StridedSlice",gw="StringNGrams",yw="StringSplit",xw="StringToHashBucketFast",bw="Sub",vw="Tan",Cw="Tanh",sg="Tile",Sw="TopK",ww="Transform",od="Transpose",Tw="Unique",Nw="Unpack",Ew="UnsortedSegmentSum",$w="ZerosLike",Dw="Step",lm="FromPixels",Rw="RotateWithOffset",um="_FusedMatMul",cm="FusedConv2D",dm="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gr(...n){Z().getBool("IS_TEST")||Z().getBool("PROD")||console.warn(...n)}function OR(...n){Z().getBool("IS_TEST")||Z().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Td=tg("kernelRegistry",()=>new Map),kR=tg("gradRegistry",()=>new Map);function fm(n,e){const t=_w(n,e);return Td.get(t)}function z1(n){return kR.get(n)}function V1(n){const e=Td.entries(),t=[];for(;;){const{done:r,value:a}=e.next();if(r)break;const[i,l]=a,[u]=i.split("_");u===n&&t.push(l)}return t}function FR(n){const{kernelName:e,backendName:t}=n,r=_w(e,t);Td.has(r)&&Gr(`The kernel '${e}' for backend '${t}' is already registered`),Td.set(r,n)}function _w(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ow(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var Dp,G1;function AR(){if(G1)return Dp;G1=1,Dp=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(U,k,ee){this.low=U|0,this.high=k|0,this.unsigned=!!ee}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(U){return(U&&U.__isLong__)===!0}e.isLong=t;var r={},a={};function i(U,k){var ee,he,fe;return k?(U>>>=0,(fe=0<=U&&U<256)&&(he=a[U],he)?he:(ee=u(U,(U|0)<0?-1:0,!0),fe&&(a[U]=ee),ee)):(U|=0,(fe=-128<=U&&U<128)&&(he=r[U],he)?he:(ee=u(U,U<0?-1:0,!1),fe&&(r[U]=ee),ee))}e.fromInt=i;function l(U,k){if(isNaN(U))return k?$:T;if(k){if(U<0)return $;if(U>=v)return j}else{if(U<=-9223372036854776e3)return K;if(U+1>=w)return V}return U<0?l(-U,k).neg():u(U%x|0,U/x|0,k)}e.fromNumber=l;function u(U,k,ee){return new e(U,k,ee)}e.fromBits=u;var c=Math.pow;function f(U,k,ee){if(U.length===0)throw Error("empty string");if(U==="NaN"||U==="Infinity"||U==="+Infinity"||U==="-Infinity")return T;if(typeof k=="number"?(ee=k,k=!1):k=!!k,ee=ee||10,ee<2||36<ee)throw RangeError("radix");var he;if((he=U.indexOf("-"))>0)throw Error("interior hyphen");if(he===0)return f(U.substring(1),k,ee).neg();for(var fe=l(c(ee,8)),me=T,ae=0;ae<U.length;ae+=8){var de=Math.min(8,U.length-ae),le=parseInt(U.substring(ae,ae+de),ee);if(de<8){var Q=l(c(ee,de));me=me.mul(Q).add(l(le))}else me=me.mul(fe),me=me.add(l(le))}return me.unsigned=k,me}e.fromString=f;function p(U,k){return typeof U=="number"?l(U,k):typeof U=="string"?f(U,k):u(U.low,U.high,typeof k=="boolean"?k:U.unsigned)}e.fromValue=p;var m=65536,g=1<<24,x=m*m,v=x*x,w=v/2,S=i(g),T=i(0);e.ZERO=T;var $=i(0,!0);e.UZERO=$;var D=i(1);e.ONE=D;var R=i(1,!0);e.UONE=R;var I=i(-1);e.NEG_ONE=I;var V=u(-1,2147483647,!1);e.MAX_VALUE=V;var j=u(-1,-1,!0);e.MAX_UNSIGNED_VALUE=j;var K=u(0,-2147483648,!1);e.MIN_VALUE=K;var B=e.prototype;return B.toInt=function(){return this.unsigned?this.low>>>0:this.low},B.toNumber=function(){return this.unsigned?(this.high>>>0)*x+(this.low>>>0):this.high*x+(this.low>>>0)},B.toString=function(k){if(k=k||10,k<2||36<k)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(K)){var ee=l(k),he=this.div(ee),fe=he.mul(ee).sub(this);return he.toString(k)+fe.toInt().toString(k)}else return"-"+this.neg().toString(k);for(var me=l(c(k,6),this.unsigned),ae=this,de="";;){var le=ae.div(me),Q=ae.sub(le.mul(me)).toInt()>>>0,F=Q.toString(k);if(ae=le,ae.isZero())return F+de;for(;F.length<6;)F="0"+F;de=""+F+de}},B.getHighBits=function(){return this.high},B.getHighBitsUnsigned=function(){return this.high>>>0},B.getLowBits=function(){return this.low},B.getLowBitsUnsigned=function(){return this.low>>>0},B.getNumBitsAbs=function(){if(this.isNegative())return this.eq(K)?64:this.neg().getNumBitsAbs();for(var k=this.high!=0?this.high:this.low,ee=31;ee>0&&(k&1<<ee)==0;ee--);return this.high!=0?ee+33:ee+1},B.isZero=function(){return this.high===0&&this.low===0},B.eqz=B.isZero,B.isNegative=function(){return!this.unsigned&&this.high<0},B.isPositive=function(){return this.unsigned||this.high>=0},B.isOdd=function(){return(this.low&1)===1},B.isEven=function(){return(this.low&1)===0},B.equals=function(k){return t(k)||(k=p(k)),this.unsigned!==k.unsigned&&this.high>>>31===1&&k.high>>>31===1?!1:this.high===k.high&&this.low===k.low},B.eq=B.equals,B.notEquals=function(k){return!this.eq(k)},B.neq=B.notEquals,B.ne=B.notEquals,B.lessThan=function(k){return this.comp(k)<0},B.lt=B.lessThan,B.lessThanOrEqual=function(k){return this.comp(k)<=0},B.lte=B.lessThanOrEqual,B.le=B.lessThanOrEqual,B.greaterThan=function(k){return this.comp(k)>0},B.gt=B.greaterThan,B.greaterThanOrEqual=function(k){return this.comp(k)>=0},B.gte=B.greaterThanOrEqual,B.ge=B.greaterThanOrEqual,B.compare=function(k){if(t(k)||(k=p(k)),this.eq(k))return 0;var ee=this.isNegative(),he=k.isNegative();return ee&&!he?-1:!ee&&he?1:this.unsigned?k.high>>>0>this.high>>>0||k.high===this.high&&k.low>>>0>this.low>>>0?-1:1:this.sub(k).isNegative()?-1:1},B.comp=B.compare,B.negate=function(){return!this.unsigned&&this.eq(K)?K:this.not().add(D)},B.neg=B.negate,B.add=function(k){t(k)||(k=p(k));var ee=this.high>>>16,he=this.high&65535,fe=this.low>>>16,me=this.low&65535,ae=k.high>>>16,de=k.high&65535,le=k.low>>>16,Q=k.low&65535,F=0,P=0,G=0,te=0;return te+=me+Q,G+=te>>>16,te&=65535,G+=fe+le,P+=G>>>16,G&=65535,P+=he+de,F+=P>>>16,P&=65535,F+=ee+ae,F&=65535,u(G<<16|te,F<<16|P,this.unsigned)},B.subtract=function(k){return t(k)||(k=p(k)),this.add(k.neg())},B.sub=B.subtract,B.multiply=function(k){if(this.isZero())return T;if(t(k)||(k=p(k)),n){var ee=n.mul(this.low,this.high,k.low,k.high);return u(ee,n.get_high(),this.unsigned)}if(k.isZero())return T;if(this.eq(K))return k.isOdd()?K:T;if(k.eq(K))return this.isOdd()?K:T;if(this.isNegative())return k.isNegative()?this.neg().mul(k.neg()):this.neg().mul(k).neg();if(k.isNegative())return this.mul(k.neg()).neg();if(this.lt(S)&&k.lt(S))return l(this.toNumber()*k.toNumber(),this.unsigned);var he=this.high>>>16,fe=this.high&65535,me=this.low>>>16,ae=this.low&65535,de=k.high>>>16,le=k.high&65535,Q=k.low>>>16,F=k.low&65535,P=0,G=0,te=0,re=0;return re+=ae*F,te+=re>>>16,re&=65535,te+=me*F,G+=te>>>16,te&=65535,te+=ae*Q,G+=te>>>16,te&=65535,G+=fe*F,P+=G>>>16,G&=65535,G+=me*Q,P+=G>>>16,G&=65535,G+=ae*le,P+=G>>>16,G&=65535,P+=he*F+fe*Q+me*le+ae*de,P&=65535,u(te<<16|re,P<<16|G,this.unsigned)},B.mul=B.multiply,B.divide=function(k){if(t(k)||(k=p(k)),k.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&k.low===-1&&k.high===-1)return this;var ee=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,k.low,k.high);return u(ee,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?$:T;var he,fe,me;if(this.unsigned){if(k.unsigned||(k=k.toUnsigned()),k.gt(this))return $;if(k.gt(this.shru(1)))return R;me=$}else{if(this.eq(K)){if(k.eq(D)||k.eq(I))return K;if(k.eq(K))return D;var ae=this.shr(1);return he=ae.div(k).shl(1),he.eq(T)?k.isNegative()?D:I:(fe=this.sub(k.mul(he)),me=he.add(fe.div(k)),me)}else if(k.eq(K))return this.unsigned?$:T;if(this.isNegative())return k.isNegative()?this.neg().div(k.neg()):this.neg().div(k).neg();if(k.isNegative())return this.div(k.neg()).neg();me=T}for(fe=this;fe.gte(k);){he=Math.max(1,Math.floor(fe.toNumber()/k.toNumber()));for(var de=Math.ceil(Math.log(he)/Math.LN2),le=de<=48?1:c(2,de-48),Q=l(he),F=Q.mul(k);F.isNegative()||F.gt(fe);)he-=le,Q=l(he,this.unsigned),F=Q.mul(k);Q.isZero()&&(Q=D),me=me.add(Q),fe=fe.sub(F)}return me},B.div=B.divide,B.modulo=function(k){if(t(k)||(k=p(k)),n){var ee=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,k.low,k.high);return u(ee,n.get_high(),this.unsigned)}return this.sub(this.div(k).mul(k))},B.mod=B.modulo,B.rem=B.modulo,B.not=function(){return u(~this.low,~this.high,this.unsigned)},B.and=function(k){return t(k)||(k=p(k)),u(this.low&k.low,this.high&k.high,this.unsigned)},B.or=function(k){return t(k)||(k=p(k)),u(this.low|k.low,this.high|k.high,this.unsigned)},B.xor=function(k){return t(k)||(k=p(k)),u(this.low^k.low,this.high^k.high,this.unsigned)},B.shiftLeft=function(k){return t(k)&&(k=k.toInt()),(k&=63)===0?this:k<32?u(this.low<<k,this.high<<k|this.low>>>32-k,this.unsigned):u(0,this.low<<k-32,this.unsigned)},B.shl=B.shiftLeft,B.shiftRight=function(k){return t(k)&&(k=k.toInt()),(k&=63)===0?this:k<32?u(this.low>>>k|this.high<<32-k,this.high>>k,this.unsigned):u(this.high>>k-32,this.high>=0?0:-1,this.unsigned)},B.shr=B.shiftRight,B.shiftRightUnsigned=function(k){if(t(k)&&(k=k.toInt()),k&=63,k===0)return this;var ee=this.high;if(k<32){var he=this.low;return u(he>>>k|ee<<32-k,ee>>>k,this.unsigned)}else return k===32?u(ee,0,this.unsigned):u(ee>>>k-32,0,this.unsigned)},B.shru=B.shiftRightUnsigned,B.shr_u=B.shiftRightUnsigned,B.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},B.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},B.toBytes=function(k){return k?this.toBytesLE():this.toBytesBE()},B.toBytesLE=function(){var k=this.high,ee=this.low;return[ee&255,ee>>>8&255,ee>>>16&255,ee>>>24,k&255,k>>>8&255,k>>>16&255,k>>>24]},B.toBytesBE=function(){var k=this.high,ee=this.low;return[k>>>24,k>>>16&255,k>>>8&255,k&255,ee>>>24,ee>>>16&255,ee>>>8&255,ee&255]},e.fromBytes=function(k,ee,he){return he?e.fromBytesLE(k,ee):e.fromBytesBE(k,ee)},e.fromBytesLE=function(k,ee){return new e(k[0]|k[1]<<8|k[2]<<16|k[3]<<24,k[4]|k[5]<<8|k[6]<<16|k[7]<<24,ee)},e.fromBytesBE=function(k,ee){return new e(k[4]<<24|k[5]<<16|k[6]<<8|k[7],k[0]<<24|k[1]<<16|k[2]<<8|k[3],ee)},Dp}var kw=AR();const Fw=Ai(kw),IR=JD({__proto__:null,default:Fw},[kw]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ci=Fw||IR;function qd(n){return ci.fromString(n,!0,16)}const Aw=qd("c3a5c85c97cb3127"),oi=qd("b492b66fbe98f273"),en=qd("9ae16a3b2f90404f");function hm(n){return n.xor(n.shru(47))}function Iw(n,e,t){const r=n.slice(e,e+t);return ci.fromBytes(Array.from(r),!0,!0)}function it(n,e){return Iw(n,e,8)}function H1(n,e){return Iw(n,e,4)}function Ot(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Cs(n,e,t=qd("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let a=e.xor(r).mul(t);return a=a.xor(a.shru(47)),a=a.mul(t),a}function LR(n,e,t,r,a,i){a=a.add(n),i=Ot(i.add(a).add(r),21);const l=a;return a=a.add(e),a=a.add(t),i=i.add(Ot(a,44)),[a.add(r),i.add(l)]}function Xc(n,e,t,r){return LR(it(n,e),it(n,e+8),it(n,e+16),it(n,e+24),t,r)}function BR(n,e=n.length){if(e>=8){const t=en.add(e*2),r=it(n,0).add(en),a=it(n,e-8),i=Ot(a,37).mul(t).add(r),l=Ot(r,25).add(a).mul(t);return Cs(i,l,t)}if(e>=4){const t=en.add(e*2),r=H1(n,0);return Cs(r.shl(3).add(e),H1(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],a=n[e-1],i=t+(r<<8),l=e+(a<<2);return hm(en.mul(i).xor(Aw.mul(l))).mul(en)}return en}function MR(n,e=n.length){const t=en.add(e*2),r=it(n,0).mul(oi),a=it(n,8),i=it(n,e-8).mul(t),l=it(n,e-16).mul(en);return Cs(Ot(r.add(a),43).add(Ot(i,30)).add(l),r.add(Ot(a.add(en),18)).add(i),t)}function UR(n,e=n.length){const t=en.add(e*2),r=it(n,0).mul(en),a=it(n,8),i=it(n,e-8).mul(t),l=it(n,e-16).mul(en),u=Ot(r.add(a),43).add(Ot(i,30)).add(l),c=Cs(u,r.add(Ot(a.add(en),18)).add(i),t),f=it(n,16).mul(t),p=it(n,24),m=u.add(it(n,e-32)).mul(t),g=c.add(it(n,e-24)).mul(t);return Cs(Ot(f.add(p),43).add(Ot(m,30)).add(g),f.add(Ot(p.add(r),18)).add(m),t)}function PR(n,e=n.length){const t=ci.fromNumber(81,!0);if(e<=32)return e<=16?BR(n,e):MR(n,e);if(e<=64)return UR(n,e);let r=t,a=t.mul(oi).add(113),i=hm(a.mul(en).add(113)).mul(en),l=[ci.UZERO,ci.UZERO],u=[ci.UZERO,ci.UZERO];r=r.mul(en).add(it(n,0));let c=0;const f=(e-1>>6)*64,p=f+(e-1&63)-63;do r=Ot(r.add(a).add(l[0]).add(it(n,c+8)),37).mul(oi),a=Ot(a.add(l[1]).add(it(n,c+48)),42).mul(oi),r=r.xor(u[1]),a=a.add(l[0]).add(it(n,c+40)),i=Ot(i.add(u[0]),33).mul(oi),l=Xc(n,c,l[1].mul(oi),r.add(u[0])),u=Xc(n,c+32,i.add(u[1]),a.add(it(n,c+16))),[i,r]=[r,i],c+=64;while(c!==f);const m=oi.add(i.and(255).shl(1));return c=p,u[0]=u[0].add(e-1&63),l[0]=l[0].add(u[0]),u[0]=u[0].add(l[0]),r=Ot(r.add(a).add(l[0]).add(it(n,c+8)),37).mul(m),a=Ot(a.add(l[1]).add(it(n,c+48)),42).mul(m),r=r.xor(u[1].mul(9)),a=a.add(l[0].mul(9).add(it(n,c+40))),i=Ot(i.add(u[0]),33).mul(m),l=Xc(n,c,l[1].mul(m),r.add(u[0])),u=Xc(n,c+32,i.add(u[1]),a.add(it(n,c+16))),[i,r]=[r,i],Cs(Cs(l[0],u[0],m).add(hm(a).mul(Aw)).add(i),Cs(l[1],u[1],m).add(r),m)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wo(n,e){return e==="string"?xi(n):Xd([n],e)}function zR(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Xd(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Si(n)),Z().getBool("DEBUG")&&uR(n,e),zR(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Pr(){return Z().platform.now()}function VR(n,e){return Z().platform.fetch(n,e)}function xi(n,e="utf-8"){return e=e||"utf-8",Z().platform.encode(n,e)}function Mo(n,e="utf-8"){return e=e||"utf-8",Z().platform.decode(n,e)}function br(n){return Z().platform.isTypedArray!=null?Z().platform.isTypedArray(n):Ow(n)}function Si(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Ci(n)||n==null||br(n)&&t)e.push(n);else if(Array.isArray(n)||br(n))for(let r=0;r<n.length;++r)Si(n[r],e,t);else{let r=-1;for(const a of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(a)&&(r=Math.max(r,Number(a)));for(let a=0;a<=r;a++)Si(n[a],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GR{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new WR)}profileKernel(e,t,r){let a;const i=()=>{a=r()};let l;const u=Pr();if(this.backendTimer.timerAvailable())l=this.backendTimer.time(i);else{i();for(const f of a)f.dataSync();l=Promise.resolve({kernelMs:Pr()-u})}if(Z().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let f=0;f<a.length;f++){const p=a[f];p.data().then(m=>{HR(m,p.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:l.then(f=>f.kernelMs),extraInfo:l.then(f=>f.getExtraProfileInfo!=null?f.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:a,inputs:i,extraInfo:l}=e;r.forEach(u=>{Promise.all([u.data(),a,l]).then(c=>{this.logger.logKernelProfile(t,u,c[0],c[1],i,c[2])})})}}function HR(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const a=n[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${t}'`),!0}return!1}class WR{logKernelProfile(e,t,r,a,i,l){const u=typeof a=="number"?ko(`${a}ms`,9):a.error,c=ko(e,25),f=t.rank,p=t.size,m=ko(t.shape.toString(),14);let g="";for(const x in i){const v=i[x];if(v!=null){const w=v.shape||t.shape,S=w.length;g+=`${x}: ${S}D ${S>0?w:""} `}}console.log(`%c${c}	%c${u}	%c${f}D ${m}	%c${p}	%c${g}	%c${l}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jR(n,e,t){const r={},a={};for(let c=0;c<e.length;c++)r[e[c].id]=!0;for(let c=0;c<n.length;c++){const f=n[c],p=f.inputs;for(const m in p){const g=p[m];let x=!1;for(let v=0;v<e.length;v++)if(r[g.id]){f.outputs.forEach(w=>r[w.id]=!0),x=!0,a[f.id]=!0;break}if(x)break}}const i={};i[t.id]=!0;const l={};for(let c=n.length-1;c>=0;c--){const f=n[c],p=f.inputs;for(let m=0;m<f.outputs.length;m++)if(i[f.outputs[m].id]){for(const g in p)i[p[g].id]=!0,l[f.id]=!0;break}}const u=[];for(let c=0;c<n.length;c++){const f=n[c];if(a[f.id]&&l[f.id]){const p={};for(const g in f.inputs){const x=f.inputs[g];r[x.id]&&(p[g]=x)}const m=Object.assign({},f);m.inputs=p,m.outputs=f.outputs,u.push(m)}}return u}function qR(n,e,t,r){for(let a=e.length-1;a>=0;a--){const i=e[a],l=[];if(i.outputs.forEach(c=>{const f=n[c.id];f!=null?l.push(f):l.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const u=i.gradient(l);for(const c in i.inputs){if(!(c in u))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(u)}.`);const f=t(()=>u[c]());if(f.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${f.dtype}'`);const p=i.inputs[c];if(!pt(f.shape,p.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${c}' has shape '${f.shape}', which does not match the shape of the input '${p.shape}'`);if(n[p.id]==null)n[p.id]=f;else{const m=n[p.id];n[p.id]=r(m,f),m.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1=20,eu=3,Rp=7;function XR(n,e,t,r){const a=Vt(e),i=KR(n,e,t,a),l=e.length,u=ld(n,e,t,a,i),c=["Tensor"];return r&&(c.push(`  dtype: ${t}`),c.push(`  rank: ${l}`),c.push(`  shape: [${e}]`),c.push("  values:")),c.push(u.map(f=>"    "+f).join(`
`)),c.join(`
`)}function KR(n,e,t,r){const a=pe(e),i=r[r.length-1],l=new Array(i).fill(0),u=e.length,c=t==="complex64"?iu(n):n;if(u>1)for(let f=0;f<a/i;f++){const p=f*i;for(let m=0;m<i;m++)l[m]=Math.max(l[m],su(c[p+m],0,t).length)}return l}function su(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(Rp))} + ${parseFloat(n[1].toFixed(Rp))}j`:jd(n)?r=`'${n}'`:t==="bool"?r=Lw(n):r=parseFloat(n.toFixed(Rp)).toString(),ko(r,e)}function Lw(n){return n===0?"false":"true"}function ld(n,e,t,r,a,i=!0){const l=t==="complex64"?2:1,u=e[0],c=e.length;if(c===0){if(t==="complex64"){const w=iu(n);return[su(w[0],0,t)]}return t==="bool"?[Lw(n[0])]:[n[0].toString()]}if(c===1){if(u>W1){const S=eu*l;let T=Array.from(n.slice(0,S)),$=Array.from(n.slice((u-eu)*l,u*l));return t==="complex64"&&(T=iu(T),$=iu($)),["["+T.map((D,R)=>su(D,a[R],t)).join(", ")+", ..., "+$.map((D,R)=>su(D,a[u-eu+R],t)).join(", ")+"]"]}return["["+(t==="complex64"?iu(n):Array.from(n)).map((S,T)=>su(S,a[T],t)).join(", ")+"]"]}const f=e.slice(1),p=r.slice(1),m=r[0]*l,g=[];if(u>W1){for(let w=0;w<eu;w++){const S=w*m,T=S+m;g.push(...ld(n.slice(S,T),f,t,p,a,!1))}g.push("...");for(let w=u-eu;w<u;w++){const S=w*m,T=S+m;g.push(...ld(n.slice(S,T),f,t,p,a,w===u-1))}}else for(let w=0;w<u;w++){const S=w*m,T=S+m;g.push(...ld(n.slice(S,T),f,t,p,a,w===u-1))}const x=c===2?",":"";g[0]="["+(u>0?g[0]+x:"");for(let w=1;w<g.length-1;w++)g[w]=" "+g[w]+x;let v=`,
`;for(let w=2;w<c;w++)v+=`
`;return g[g.length-1]=" "+g[g.length-1]+"]"+(i?"":v),g}function iu(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uo{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=pe(e),r!=null){const a=r.length;A(a===this.size,()=>`Length of values '${a}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||kt(t,this.size),this.strides=Vt(e)}set(e,...t){t.length===0&&(t=[0]),A(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const a of e){if(a<0||a>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=this.strides[a]*e[a];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return zr().makeTensor(this.values,this.shape,this.dtype)}}let zr=null,Do=null;function YR(n){zr=n}function QR(n){Do=n}class Ut{constructor(e,t,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=pe(e),this.strides=Vt(e),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Do.buffer(this.shape,this.dtype,e)}bufferSync(){return Do.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return im(this.shape,e,this.dtype==="complex64")}arraySync(){return im(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=zr().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>Mo(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),zr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=zr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Mo(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await zr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),zr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Do.print(this,e)}clone(){return this.throwIfDisposed(),Do.clone(this)}toString(e=!1){const t=this.dataSync();return XR(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Do.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),zr().makeVariable(this,e,t,r)}}Object.defineProperty(Ut,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Bw(){return tg("Tensor",()=>Ut)}Bw();class Nd extends Ut{constructor(e,t,r,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!pt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);zr().disposeTensor(this),this.dataId=e.dataId,zr().incRef(this,null)}dispose(){zr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Nd,Symbol.hasInstance,{value:n=>n instanceof Ut&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var j1;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(j1||(j1={}));var pm;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(pm||(pm={}));var mm;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(mm||(mm={}));var gm;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(gm||(gm={}));var ym;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(ym||(ym={}));const ZR={float32:gm,int32:pm,bool:mm,complex64:ym};function pa(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return ZR[n][e]}function ig(n){return pa(n,"int32")}function Mw(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function Uw(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(n,e){if(n.dtype===e.dtype)return[n,e];const t=pa(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function JR(n,e){A(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function Pw(n){const e=[];return zw(n,e,new Set),e}function zw(n,e,t){if(n==null)return;if(n instanceof Ut){e.push(n);return}if(!e_(n))return;const r=n;for(const a in r){const i=r[a];t.has(i)||(t.add(i),zw(i,e,t))}}function e_(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _p(n){return n.kernelName!=null}class q1{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Po{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new q1}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(Gr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new GR(this.backendInstance),!0}setupRegisteredKernels(){V1(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){V1(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof Lv)&&typeof r.then=="function"){const a=++this.pendingBackendInitId,i=r.then(l=>a<this.pendingBackendInitId?!1:(this.registry[e]=l,this.pendingBackendInit=null,!0)).catch(l=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,Gr(`Initialization of backend ${e} failed`),Gr(l.stack||l.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Gr(`Initialization of backend ${e} failed`),Gr(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:a,asyncInit:i}=this.initializeBackend(r);if(i||a)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),a=r.backend,i=this.readSync(t),l=a.refCount(t);a.disposeData(t,!0),r.backend=e,e.move(t,i,r.shape,r.dtype,l),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let a;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(a),()=>(a=t(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,t,r){e();try{const a=r();return t(),a}catch(a){throw t(),a}}nextTensorId(){return Po.nextTensorId++}nextVariableId(){return Po.nextVariableId++}clone(e){const t=z.runKernel(ag,{x:e}),r={x:e},a=l=>({x:()=>{const u="float32",c={x:l},f={dtype:u};return z.runKernel(rg,c,f)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[t],a,i,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(fm(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const a=this.backend.numDataIds();let i=0;r.forEach(c=>{i+=c.dtype==="complex64"?3:1});const l=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],u=a-t-i-l;if(u>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${u} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const a=this.isTapeOn(),i=this.state.numBytes,l=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let u;this.backendName==null&&this.backend;let c;const f=_p(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(_p(e)){const{kernelName:v,inputs:w,attrs:S}=e;this.backendName==null&&this.backend;const T=fm(v,this.backendName);A(T!=null,()=>`Cannot find registered kernel '${v}' for backend '${this.backendName}'`),u=()=>{const $=this.backend.numDataIds();c=T.kernelFunc({inputs:w,attrs:S,backend:this.backend});const D=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(v,$,D);const R=D.map(I=>I.rank!=null?I:this.makeTensorFromTensorInfo(I));if(a){const I=this.getTensorsForGradient(v,w,R);r=this.saveTensorsForBackwardMode(I)}return R}}else{const{forwardFunc:v}=e,w=S=>{a&&(r=S.map(T=>this.keep(this.clone(T))))};u=()=>{const S=this.backend.numDataIds();c=this.tidy(()=>v(this.backend,w));const T=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,S,T),T}}const{inputs:p,attrs:m}=e,g=_p(e)?null:e.backwardsFunc;let x;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=u():(x=this.profiler.profileKernel(f,p,()=>u()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(x),t=x.outputs)}),a&&this.addTapeNode(f,p,t,g,r,m),this.state.profiling&&this.state.activeProfile.kernels.push({name:f,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(p).map(v=>p[v]!=null?p[v].shape:null),outputShapes:t.map(v=>v.shape),kernelTimeMs:x.timeMs,extraInfo:x.extraInfo}),Array.isArray(c)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const a=z1(e);if(a!=null){const i=a.inputsToSave||[],l=a.outputsToSave||[];let u;a.saveAllInputs?(A(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),u=Object.keys(t).map(f=>t[f])):u=i.map(f=>t[f]);const c=r.filter((f,p)=>l[p]);return u.concat(c)}return[]}makeTensor(e,t,r,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;let i=e;r==="string"&&jd(e[0])&&(i=e.map(c=>xi(c)));const l=a.write(i,t,r),u=new Ut(t,r,l,this.nextTensorId());if(this.trackTensor(u,a),r==="string"){const c=this.state.tensorInfo.get(l),f=fR(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return u}makeTensorFromDataId(e,t,r,a){r=r||"float32";const i={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(i,a)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:a,dtype:i}=e,l=new Ut(a,i,r,this.nextTensorId());return this.trackTensor(l,t),l}makeVariable(e,t=!0,r,a){r=r||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const i=new Nd(e,t,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*wd(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Nd||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*wd(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,a,i,l){const u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:i},c=z1(e);c!=null&&(a=c.gradFunc),a!=null&&(u.gradient=f=>(f=f.map((p,m)=>{if(p==null){const g=r[m],x=Ns(g.size,g.dtype);return this.makeTensor(x,g.shape,g.dtype)}return p}),a(f.length>1?f:f[0],i,l))),this.state.activeTape.push(u)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=Pw(e),r=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const l=this.state.activeScope.track[i];!l.kept&&!r.has(l.id)&&l.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===a.id&&this.track(i)})}gradients(e,t,r,a=!1){if(A(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));A(i instanceof Ut,()=>"The result y returned by f() must be a tensor.");const l=jR(this.state.activeTape,t,i);if(!a&&l.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const u={};u[i.id]=r??t_(i.shape),qR(u,l,f=>this.tidy(f),n_);const c=t.map(f=>u[f.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(f=>{for(const p of f.saved)p.dispose()}),this.state.activeTape=null),{value:i,grads:c}})}customGrad(e){return A(am(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{A(t.every(u=>u instanceof Ut),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const a={};t.forEach((u,c)=>{a[c]=u});const i=(u,c)=>(r=e(...t,c),A(r.value instanceof Ut,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),A(am(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),l=(u,c)=>{const f=r.gradFunc(u,c),p=Array.isArray(f)?f:[f];A(p.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),A(p.every(g=>g instanceof Ut),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const m={};return p.forEach((g,x)=>{m[x]=()=>g}),m};return this.runKernelFunc({forwardFunc:i,backwardsFunc:l,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Pr(),r=await this.backend.time(e);return r.wallMs=Pr()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new q1;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Po.nextTensorId=0;Po.nextVariableId=0;function t_(n){const e=Mv(pe(n),"float32");return z.makeTensor(e,n,"float32")}function Vw(){const n=Pv();if(n._tfengine==null){const e=new mR(n);n._tfengine=new Po(e)}return bR(n._tfengine.ENV),YR(()=>n._tfengine),n._tfengine}const z=Vw();function n_(n,e){const t={a:n,b:e};return z.runKernel(ng,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_(){return typeof navigator<"u"&&navigator!=null}function Gw(n){if(n||r_()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Hw(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cn=Z();Cn.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Cn.registerFlag("IS_BROWSER",()=>Hw());Cn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Cn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Cn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Cn.registerFlag("PROD",()=>!1);Cn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Cn.getBool("DEBUG"));Cn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Cn.registerFlag("IS_TEST",()=>!1);Cn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Cn.getBool("DEBUG"));Cn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Cn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Cn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(n,e){let t=n;if(br(n))return e==="string"?[]:[n.length];if(Mw(n)){const a=n.channels||"RGBA";return[n.height,n.width*a.length]}else if(Uw(n))return[n.buffer.size/(e==null?4:wd(e))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||br(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Z().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Ww(n,r,[]),r}function Ww(n,e,t){if(t=t||[],!Array.isArray(n)&&!br(n)){A(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}A(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),A(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let a=0;a<n.length;++a)Ww(n[a],r,t.concat(a))}function X1(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function _(n,e,t,r="numeric"){if(n instanceof Bw())return X1(r,n.dtype,e,t),n;let a=Eu(n);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),X1(r,a,e,t),n==null||!br(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const c=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${c}'`)}const i=Os(n,a);!br(n)&&!Array.isArray(n)&&(n=[n]);const u=a!=="string"?Xd(n,a):Si(n,[],!0);return z.makeTensor(u,i,a)}function Ed(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,l)=>_(i,`${e}[${l}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jw="__op";function M(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+jw;const a=(...i)=>{z.startScope(t);try{const l=r(...i);return Ci(l)&&console.error("Cannot return a Promise inside of tidy."),z.endScope(l),l}catch(l){throw z.endScope(null),l}};return Object.defineProperty(a,"name",{value:t,configurable:!0}),a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(n,e){const t=_(n,"real","complex"),r=_(e,"imag","complex");Kn(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const a={real:t,imag:r};return z.runKernel(uC,a)}const Es=M({complex_:a_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(n,e,t,r){if(r==null)r=Eu(n);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Uw(n)||Mw(n)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return z.backend.createTensorFromGPUData(n,e||t,r)}if(!br(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Yn(e);const a=pe(e),i=pe(t);A(a===i,()=>`Based on the provided shape, [${e}], the tensor should have ${a} values but has ${i}`);for(let l=0;l<t.length;++l){const u=t[l],c=l===t.length-1?u!==pe(e.slice(l)):!0;A(t[l]===e[l]||!c,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!br(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?Xd(n,r):Si(n,[],!0),z.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fa(n,e,t){const r=Os(n,t);return ks(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wi={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class jr{static join(e){return new jr(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>br(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let r=0;r<e.length;r++){const a=e[r];r!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+a.byteLength;this.shards.push({buffer:a,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const a=t-e,i=new ArrayBuffer(a),l=new Uint8Array(i);let u=0;for(let c=r;c<this.shards.length;c++){const f=this.shards[c],m=e+u-f.start,g=u,v=Math.min(t,f.end)-f.start,w=new Uint8Array(f.buffer,m,v-m);if(l.set(w,g),u+=w.length,t<f.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(a){return e<a.start?-1:e>=a.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=s_(this.shards,t);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function s_(n,e){let t=0,r=n.length;for(;t<=r;){const a=Math.floor((r-t)/2)+t,i=e(n[a]);if(i===0)return a;i<0?r=a:t=a+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(){return z}function Me(n,e){return z.tidy(n,e)}function vn(n){Pw(n).forEach(t=>t.dispose())}function ca(n){return z.keep(n)}function og(){return z.backendName}function i_(n,e,t=1){return z.registerBackend(n,e,t)}function o_(){return z.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $s=4;async function l_(n,e){const t=[],r=[],a=Array.isArray(n)?n.map(l=>l.name):Object.keys(n);for(let l=0;l<a.length;++l){const u=a[l],c=Array.isArray(n)?n[l].tensor:n[u];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${u}': ${c.dtype}`);const f={name:u,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){const p=new Promise(async m=>{const g=await c.bytes(),x=g.reduce((S,T)=>S+T.length,0)+$s*g.length,v=new Uint8Array(x);let w=0;for(let S=0;S<g.length;S++){const T=g[S],$=new Uint8Array(new Uint32Array([T.length]).buffer);v.set($,w),w+=$s,v.set(T,w),w+=T.length}m(v)});r.push(p)}else r.push(c.data());e!=null&&(f.group=e),t.push(f)}const i=await Promise.all(r);return{data:d_(i),specs:t}}function qw(n,e){const t=new jr(n),r={};let a=0;for(const i of e){const l=u_(i,(u,c)=>t.slice(a+u,a+c));r[i.name]=Xw(i,t.slice(a,a+l)),a+=l}return r}function u_(n,e){const t=pe(n.shape);let r;if("quantization"in n){const a=n.quantization;r=wi[a.dtype]}else if(n.dtype==="string"){let a=0;for(let i=0;i<t;i++)a+=$s+new Uint32Array(e(a,a+$s))[0];return a}else r=wi[n.dtype];return t*r}async function c_(n,e){const t=pe(n.shape);let r;if("quantization"in n){const a=n.quantization;r=wi[a.dtype]}else if(n.dtype==="string"){let a=0;for(let i=0;i<t;i++)a+=$s+new Uint32Array(await e(a,a+$s))[0];return a}else r=wi[n.dtype];return t*r}function Xw(n,e){const t=n.name,r=n.dtype,a=n.shape,i=pe(a);let l,u=0;if("quantization"in n){const c=n.quantization;if(c.dtype==="uint8"||c.dtype==="uint16"){if(!("min"in c&&"scale"in c))throw new Error(`Weight ${n.name} with quantization ${c.dtype} doesn't have corresponding metadata min and scale.`)}else if(c.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${n.name} is quantized with ${c.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${c.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const f=wi[c.dtype],p=c.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(c.dtype==="uint8"||c.dtype==="uint16"){l=new Float32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];l[m]=g*c.scale+c.min}}else if(c.dtype==="float16")l=x_()(p);else throw new Error(`Unsupported quantization type ${c.dtype} for weight type float32.`);else if(r==="int32"){if(c.dtype!=="uint8"&&c.dtype!=="uint16")throw new Error(`Unsupported quantization type ${c.dtype} for weight type int32.`);l=new Int32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];l[m]=Math.round(g*c.scale+c.min)}}else throw new Error(`Unsupported dtype in weight '${t}': ${r}`);u+=i*f}else if(r==="string"){const c=pe(n.shape);l=[];for(let f=0;f<c;f++){const p=new Uint32Array(e.slice(u,u+$s))[0];u+=$s;const m=new Uint8Array(e.slice(u,u+p));l.push(m),u+=p}}else{const c=wi[r];if(r==="float32")l=new Float32Array(e);else if(r==="int32")l=new Int32Array(e);else if(r==="bool")l=new Uint8Array(e);else if(r==="complex64"){l=new Float32Array(e);const f=new Float32Array(l.length/2),p=new Float32Array(l.length/2);for(let v=0;v<f.length;v++)f[v]=l[v*2],p[v]=l[v*2+1];const m=fa(f,a,"float32"),g=fa(p,a,"float32"),x=Es(m,g);return m.dispose(),g.dispose(),x}else throw new Error(`Unsupported dtype in weight '${t}': ${r}`);u+=i*c}return fa(l,a,r)}async function K1(n,e,t){let r=new Uint8Array(e);for(;r.byteLength<t;){const{done:a,value:i}=await n.read();if(a&&i==null){const u=t-r.byteLength;throw new Error(`Reader is done but ${u} bytes are still expected`)}const l=new Uint8Array(r.length+i.byteLength);l.set(r,0),l.set(new Uint8Array(i),r.length),r=l}return r.buffer}async function Kw(n,e){const t={},r=n.getReader();let a=new ArrayBuffer(0);for(const i of e){const l=await c_(i,async(f,p)=>(a=await K1(r,a,p),a.slice(f,p)));a=await K1(r,a,l);const u=a.slice(0,l);a=a.slice(l);const c=Xw(i,u);if(t[i.name]=c,og()==="webgpu"){const f=o_();"uploadToGPU"in f&&pe(c.shape)>=Z().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&f.uploadToGPU(c.dataId)}}return t}function d_(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let a=0;return t.forEach(i=>{r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}const lg=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Y1(n){return lg?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function f_(n){if(lg)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,a=e.length;r<a;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function h_(n){if(lg){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function p_(n){return jr.join(n)}function Q1(n){const e="/";for(n=n.trim();n.endsWith(e);)n=n.slice(0,n.length-1);const t=n.split(e);return t[t.length-1]}function Yw(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function Qw(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(r.initializerSignature=n.initializerSignature),r}async function ug(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),Qw(n,t,r)}function $u(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:Y1(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:Y1(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new jr(n.weightData).byteLength}}function xm(n){const e=[];for(const t of n)e.push(...t.weights);return e}function m_(){const n=t=>{let r=t<<13,a=0;for(;(r&8388608)===0;)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function g_(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function y_(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function x_(){const n=m_(),e=g_(),t=y_();return r=>{const a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let l=0;l<r.length;l++){const u=r[l],c=n[t[u>>10]+(u&1023)]+e[u>>10];i[l]=c}return new Float32Array(a)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ft{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ft.instance==null&&(ft.instance=new ft),ft.instance}static registerSaveRouter(e){ft.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ft.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ft.getHandlers(e,"save")}static getLoadHandlers(e,t){return ft.getHandlers(e,"load",t)}static getHandlers(e,t,r){const a=[];return(t==="load"?ft.getInstance().loadRouters:ft.getInstance().saveRouters).forEach(l=>{const u=l(e,r);u!==null&&a.push(u)}),a}}const b_=n=>ft.registerSaveRouter(n),v_=n=>ft.registerLoadRouter(n),C_=n=>ft.getSaveHandlers(n),S_=(n,e)=>ft.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bm="tensorflowjs",vm=1,mi="models_store",bs="model_info_store";function Zw(){if(!Z().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Cm(n){const e=n.result;e.createObjectStore(mi,{keyPath:"modelPath"}),e.createObjectStore(bs,{keyPath:"modelPath"})}class Ti{constructor(e){if(this.indexedDB=Zw(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,a)=>{const i=this.indexedDB.open(bm,vm);i.onupgradeneeded=()=>Cm(i),i.onsuccess=()=>{const l=i.result;if(t==null){const u=l.transaction(mi,"readonly"),f=u.objectStore(mi).get(this.modelPath);f.onsuccess=()=>{if(f.result==null)return l.close(),a(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(f.result.modelArtifacts)},f.onerror=p=>(l.close(),a(f.error)),u.oncomplete=()=>l.close()}else{t.weightData=jr.join(t.weightData);const u=$u(t),c=l.transaction(bs,"readwrite");let f=c.objectStore(bs),p;try{p=f.put({modelPath:this.modelPath,modelArtifactsInfo:u})}catch(g){return a(g)}let m;p.onsuccess=()=>{m=l.transaction(mi,"readwrite");const g=m.objectStore(mi);let x;try{x=g.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:u})}catch(v){return a(v)}x.onsuccess=()=>r({modelArtifactsInfo:u}),x.onerror=v=>{f=c.objectStore(bs);const w=f.delete(this.modelPath);w.onsuccess=()=>(l.close(),a(x.error)),w.onerror=S=>(l.close(),a(x.error))}},p.onerror=g=>(l.close(),a(p.error)),c.oncomplete=()=>{m==null?l.close():m.oncomplete=()=>l.close()}}},i.onerror=l=>a(i.error)})}}Ti.URL_SCHEME="indexeddb://";const Jw=n=>Z().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ti.URL_SCHEME)?w_(n.slice(Ti.URL_SCHEME.length)):null;ft.registerSaveRouter(Jw);ft.registerLoadRouter(Jw);function w_(n){return new Ti(n)}function T_(n){return n.startsWith(Ti.URL_SCHEME)?n.slice(Ti.URL_SCHEME.length):n}class N_{constructor(){this.indexedDB=Zw()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(bm,vm);r.onupgradeneeded=()=>Cm(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(bs,"readonly"),u=i.objectStore(bs).getAll();u.onsuccess=()=>{const c={};for(const f of u.result)c[f.modelPath]=f.modelArtifactsInfo;e(c)},u.onerror=c=>(a.close(),t(u.error)),i.oncomplete=()=>a.close()},r.onerror=a=>t(r.error)})}async removeModel(e){return e=T_(e),new Promise((t,r)=>{const a=this.indexedDB.open(bm,vm);a.onupgradeneeded=()=>Cm(a),a.onsuccess=()=>{const i=a.result,l=i.transaction(bs,"readwrite"),u=l.objectStore(bs),c=u.get(e);let f;c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const p=u.delete(e),m=()=>{f=i.transaction(mi,"readwrite");const x=f.objectStore(mi).delete(e);x.onsuccess=()=>t(c.result.modelArtifactsInfo),x.onerror=v=>r(c.error)};p.onsuccess=m,p.onerror=g=>(m(),i.close(),r(c.error))}},c.onerror=p=>(i.close(),r(c.error)),l.oncomplete=()=>{f==null?i.close():f.oncomplete=()=>i.close()}},a.onerror=i=>r(a.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ba="/",Ro="tensorflowjs_models",eT="info",E_="model_topology",$_="weight_specs",D_="weight_data",R_="model_metadata";function tT(n){return{info:[Ro,n,eT].join(Ba),topology:[Ro,n,E_].join(Ba),weightSpecs:[Ro,n,$_].join(Ba),weightData:[Ro,n,D_].join(Ba),modelMetadata:[Ro,n,R_].join(Ba)}}function nT(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function __(n){const e=n.split(Ba);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Ba)}function O_(n){return n.startsWith(Ni.URL_SCHEME)?n.slice(Ni.URL_SCHEME.length):n}class Ni{constructor(e){if(!Z().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=tT(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=$u(e),i=jr.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,f_(i));const l={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(l)),{modelArtifactsInfo:a}}catch{throw nT(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=a;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const u=JSON.parse(i);t.format=u.format,t.generatedBy=u.generatedBy,t.convertedBy=u.convertedBy,u.signature!=null&&(t.signature=u.signature),u.userDefinedMetadata!=null&&(t.userDefinedMetadata=u.userDefinedMetadata),u.modelInitializer!=null&&(t.modelInitializer=u.modelInitializer),u.initializerSignature!=null&&(t.initializerSignature=u.initializerSignature),u.trainingConfig!=null&&(t.trainingConfig=u.trainingConfig)}const l=this.LS.getItem(this.keys.weightData);if(l==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=h_(l),t}}Ni.URL_SCHEME="localstorage://";const rT=n=>Z().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ni.URL_SCHEME)?k_(n.slice(Ni.URL_SCHEME.length)):null;ft.registerSaveRouter(rT);ft.registerLoadRouter(rT);function k_(n){return new Ni(n)}class F_{constructor(){A(Z().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),A(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Ro+Ba,r=Ba+eT;for(let a=0;a<this.LS.length;++a){const i=this.LS.key(a);if(i.startsWith(t)&&i.endsWith(r)){const l=__(i);e[l]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=O_(e);const t=tT(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return nT(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fo="://";class Jt{constructor(){this.managers={}}static getInstance(){return Jt.instance==null&&(Jt.instance=new Jt),Jt.instance}static registerManager(e,t){A(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Fo)&&(e=e.slice(0,e.indexOf(Fo))),A(e.length>0,()=>"scheme must not be an empty string.");const r=Jt.getInstance();A(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=Jt.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Jt.getInstance().managers)}}function ud(n){if(n.indexOf(Fo)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Jt.getSchemes().join(",")}`);return{scheme:n.split(Fo)[0],path:n.split(Fo)[1]}}async function aT(n,e,t=!1){A(n!==e,()=>`Old path and new path are the same: '${n}'`);const r=ft.getLoadHandlers(n);A(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),A(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const a=r[0],i=ft.getSaveHandlers(e);A(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),A(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const l=i[0],u=ud(n).scheme,c=ud(n).path,f=u===ud(n).scheme,p=await a.load();t&&f&&await Jt.getManager(u).removeModel(c);const m=await l.save(p);return t&&!f&&await Jt.getManager(u).removeModel(c),m.modelArtifactsInfo}async function A_(){const n=Jt.getSchemes(),e={};for(const t of n){const r=await Jt.getManager(t).listModels();for(const a in r){const i=t+Fo+a;e[i]=r[a]}}return e}async function I_(n){const e=ud(n);return Jt.getManager(e.scheme).removeModel(e.path)}async function L_(n,e){return aT(n,e,!1)}async function B_(n,e){return aT(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M_{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Z().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const a=this.functionRefs[r.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return Ow(e)}}if(Z().get("IS_BROWSER")){Z().setPlatform("browser",new M_);try{Jt.registerManager(Ni.URL_SCHEME,new F_)}catch{}try{Jt.registerManager(Ti.URL_SCHEME,new N_)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_={importFetch:()=>require("node-fetch")};let Op;class P_{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Z().global.fetch!=null?Z().global.fetch(e,t):(Op==null&&(Op=U_.importFetch()),Op(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Z().get("IS_NODE")&&!Z().get("IS_BROWSER")&&Z().setPlatform("node",new P_);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(n,e="float32",t){return e=e||"float32",Yn(n),new Uo(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_(n,e){const t=_(n,"x","cast");if(!cR(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},a={dtype:e};return z.runKernel(rg,r,a)}const Tt=M({cast_:z_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_(n){const t={x:_(n,"x","clone","string_or_numeric")};return z.runKernel(ag,t)}const Ss=M({clone_:V_});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sT(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Vw();const G_={buffer:mt,cast:Tt,clone:Ss,print:sT};QR(G_);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_(n,e){let t=_(n,"a","add"),r=_(e,"b","add");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(ng,a)}const Re=M({add_:H_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_(n,e){let t=_(n,"a","floorDiv"),r=_(e,"b","floorDiv");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(zC,a)}const iT=M({floorDiv_:W_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_(n,e){let t=_(n,"a","div"),r=_(e,"b","div");if([t,r]=xt(t,r),t.dtype==="int32"&&r.dtype==="int32")return iT(t,r);const a={a:t,b:r},i={};return z.runKernel(RC,a,i)}const Qe=M({div_:j_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q_(n,e){let t=_(n,"a","mul"),r=_(e,"b","mul");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(bS,a)}const ve=M({mul_:q_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_(n){const e=_(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return z.runKernel(cC,t)}else{const t={x:e};return z.runKernel(zv,t)}}const jn=M({abs_:X_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_(n){const t={x:_(n,"x","acos")};return z.runKernel(Vv,t)}const Y_=M({acos_:K_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_(n){const t={x:_(n,"x","acosh")};return z.runKernel(Gv,t)}const Z_=M({acosh_:Q_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(n){A(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),A(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((a,i)=>_(a,`tensors${i}`,"addN")),t=e[0];e.forEach(a=>{if(a.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!pt(a.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return z.runKernel(Hv,r)}const eO=M({addN_:J_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(n,e=null,t=!1){const a={x:_(n,"x","all","bool")},i={axis:e,keepDims:t};return z.runKernel(Wv,a,i)}const nO=M({all_:tO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(n,e=null,t=!1){const a={x:_(n,"x","any","bool")},i={axis:e,keepDims:t};return z.runKernel(jv,a,i)}const aO=M({any_:rO});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sO(n,e=0){const r={x:_(n,"x","argMax")},a={axis:e};return z.runKernel(qv,r,a)}const iO=M({argMax_:sO});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oO(n,e=0){const r={x:_(n,"x","argMin")},a={axis:e};return z.runKernel(Xv,r,a)}const lO=M({argMin_:oO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uO(n){const t={x:_(n,"x","asin")};return z.runKernel(Kv,t)}const cO=M({asin_:uO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dO(n){const t={x:_(n,"x","asinh")};return z.runKernel(Yv,t)}const fO=M({asinh_:dO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hO(n){const t={x:_(n,"x","atan")};return z.runKernel(Qv,t)}const pO=M({atan_:hO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mO(n,e){let t=_(n,"a","atan2"),r=_(e,"b","atan2");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(Jv,a)}const gO=M({atan2_:mO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yO(n){const t={x:_(n,"x","atanh")};return z.runKernel(Zv,t)}const xO=M({atanh_:yO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oT(n,e,t,r,a="NHWC",i){const l=n[3],u=[...e,l],c=jo(a);return Qn(n,u,t,i,r,null,null,c)}function Ii(n,e,t,r,a,i,l="channelsLast"){const[u,c]=fu(e);let f;if(l==="channelsLast")f=[u,c,n[3],n[3]];else if(l==="channelsFirst")f=[u,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${l}`);return Qn(n,f,t,r,a,i,!1,l)}function Du(n,e,t,r,a,i,l="NDHWC"){const[u,c,f]=Sm(e);let p,m;if(l==="NDHWC")m="channelsLast",p=[u,c,f,n[4],n[4]];else if(l==="NCDHW")m="channelsFirst",p=[u,c,f,n[1],n[1]];else throw new Error(`Unknown dataFormat ${l}`);return Ru(n,p,t,r,a,!1,m,i)}function Qn(n,e,t,r,a,i,l=!1,u="channelsLast"){let[c,f,p,m]=[-1,-1,-1,-1];if(u==="channelsLast")[c,f,p,m]=n;else if(u==="channelsFirst")[c,m,f,p]=n;else throw new Error(`Unknown dataFormat ${u}`);const[g,x,,v]=e,[w,S]=fu(t),[T,$]=fu(r),D=Ao(g,T),R=Ao(x,$),{padInfo:I,outHeight:V,outWidth:j}=CO(a,f,p,w,S,D,R,i,u),K=l?v*m:v;let B;return u==="channelsFirst"?B=[c,K,V,j]:u==="channelsLast"&&(B=[c,V,j,K]),{batchSize:c,dataFormat:u,inHeight:f,inWidth:p,inChannels:m,outHeight:V,outWidth:j,outChannels:K,padInfo:I,strideHeight:w,strideWidth:S,filterHeight:g,filterWidth:x,effectiveFilterHeight:D,effectiveFilterWidth:R,dilationHeight:T,dilationWidth:$,inShape:n,outShape:B,filterShape:e}}function Ru(n,e,t,r,a,i=!1,l="channelsLast",u){let[c,f,p,m,g]=[-1,-1,-1,-1,-1];if(l==="channelsLast")[c,f,p,m,g]=n;else if(l==="channelsFirst")[c,g,f,p,m]=n;else throw new Error(`Unknown dataFormat ${l}`);const[x,v,w,,S]=e,[T,$,D]=Sm(t),[R,I,V]=Sm(r),j=Ao(x,R),K=Ao(v,I),B=Ao(w,V),{padInfo:U,outDepth:k,outHeight:ee,outWidth:he}=SO(a,f,p,m,T,$,D,j,K,B,u),fe=i?S*g:S;let me;return l==="channelsFirst"?me=[c,fe,k,ee,he]:l==="channelsLast"&&(me=[c,k,ee,he,fe]),{batchSize:c,dataFormat:l,inDepth:f,inHeight:p,inWidth:m,inChannels:g,outDepth:k,outHeight:ee,outWidth:he,outChannels:fe,padInfo:U,strideDepth:T,strideHeight:$,strideWidth:D,filterDepth:x,filterHeight:v,filterWidth:w,effectiveFilterDepth:j,effectiveFilterHeight:K,effectiveFilterWidth:B,dilationDepth:R,dilationHeight:I,dilationWidth:V,inShape:n,outShape:me,filterShape:e}}function bO(n,e,t,r,a){r==null&&(r=cg(n,e,t));const i=n[0],l=n[1],u=hu((i-e+2*r)/t+1,a),c=hu((l-e+2*r)/t+1,a);return[u,c]}function vO(n,e,t,r,a,i){a==null&&(a=cg(n,e[0],r[0]));const l=[0,0,0,t];for(let u=0;u<3;u++)n[u]+2*a>=e[u]&&(l[u]=hu((n[u]-e[u]+2*a)/r[u]+1,i));return l}function cg(n,e,t,r=1){const a=Ao(e,r);return Math.floor((n[0]*(t-1)-t+a)/2)}function fu(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function Sm(n){return typeof n=="number"?[n,n,n]:n}function Ao(n,e){return e<=1?n:n+(n-1)*(e-1)}function CO(n,e,t,r,a,i,l,u,c){let f,p,m;if(typeof n=="number"){f={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const x=bO([e,t],i,r,n,u);p=x[0],m=x[1]}else if(n==="same"){p=Math.ceil(e/r),m=Math.ceil(t/a);const g=Math.max(0,(p-1)*r+i-e),x=Math.max(0,(m-1)*a+l-t),v=Math.floor(g/2),w=g-v,S=Math.floor(x/2),T=x-S;f={top:v,bottom:w,left:S,right:T,type:"SAME"}}else if(n==="valid")f={top:0,bottom:0,left:0,right:0,type:"VALID"},p=Math.ceil((e-i+1)/r),m=Math.ceil((t-l+1)/a);else if(typeof n=="object"){const g=c==="channelsLast"?n[1][0]:n[2][0],x=c==="channelsLast"?n[1][1]:n[2][1],v=c==="channelsLast"?n[2][0]:n[3][0],w=c==="channelsLast"?n[2][1]:n[3][1];f={top:g,bottom:x,left:v,right:w,type:g===0&&x===0&&v===0&&w===0?"VALID":"EXPLICIT"},p=hu((e-i+g+x)/r+1,u),m=hu((t-l+v+w)/a+1,u)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outHeight:p,outWidth:m}}function SO(n,e,t,r,a,i,l,u,c,f,p){let m,g,x,v;if(n==="valid"&&(n=0),typeof n=="number"){m={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const S=vO([e,t,r,1],[u,c,f],1,[a,i,l],n,p);g=S[0],x=S[1],v=S[2]}else if(n==="same"){g=Math.ceil(e/a),x=Math.ceil(t/i),v=Math.ceil(r/l);const w=(g-1)*a+u-e,S=(x-1)*i+c-t,T=(v-1)*l+f-r,$=Math.floor(w/2),D=w-$,R=Math.floor(S/2),I=S-R,V=Math.floor(T/2),j=T-V;m={top:R,bottom:I,left:V,right:j,front:$,back:D,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:m,outDepth:g,outHeight:x,outWidth:v}}function hu(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function pu(n){const[e,t,r]=fu(n);return e===1&&t===1&&r===1}function Ln(n,e){return pu(n)||pu(e)}function Ei(n){return fu(n).every(e=>e>0)}function jo(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function vr(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")A(Bo(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(a=>{A(Bo(a),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${a}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wO(n,e){const r={x:_(n,"x","reshape","string_or_numeric")},a={shape:e};return z.runKernel(US,r,a)}const oe=M({reshape_:wO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TO(n,e,t,r,a){const i=_(n,"x","avgPool","float32"),l=1;A(Ln(t,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${l}'`);let u=i,c=!1;i.rank===3&&(c=!0,u=oe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),A(u.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${u.rank}.`),vr("avgPool",r,a);const f={x:u},p={filterSize:e,strides:t,pad:r,dimRoundingMode:a};let m=z.runKernel(eC,f,p);return m=Tt(m,i.dtype),c?oe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const lT=M({avgPool_:TO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NO(n,e,t,r,a,i="NDHWC"){const l=_(n,"x","avgPool3d","float32");let u=l,c=!1;l.rank===4&&(c=!0,u=oe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),A(u.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${u.rank}.`),A(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),A(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),vr("avgPool3d",r,a);const f={x:u},p={filterSize:e,strides:t,pad:r,dimRoundingMode:a,dataFormat:i};let m=z.runKernel(tC,f,p);return m=Tt(m,u.dtype),c?oe(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const EO=M({avgPool3d_:NO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(n,e=0){A(n.length>=1,()=>"Pass at least one tensor to concat");const t=Ed(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return Ss(t[0]);const r=t,a={axis:e};return z.runKernel(dC,r,a)}const nn=M({concat_:$O});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DO(n,e,t=!1,r=!1){let a=_(n,"a","matMul"),i=_(e,"b","matMul");[a,i]=xt(a,i);const l={a,b:i},u={transposeA:t,transposeB:r};return z.runKernel(nC,l,u)}const et=M({matMul_:DO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(n){const t={x:_(n,"x","sigmoid","float32")};return z.runKernel(tw,t)}const bi=M({sigmoid_:RO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _O(n,e,t){const r=_(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:e,size:t};return z.runKernel(QS,a,i)}const je=M({slice_:_O});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OO(n){const t={x:_(n,"x","tanh","float32")};return z.runKernel(Cw,t)}const wm=M({tanh_:OO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kO(n,e,t,r,a,i){const l=_(n,"forgetBias","basicLSTMCell"),u=_(e,"lstmKernel","basicLSTMCell"),c=_(t,"lstmBias","basicLSTMCell"),f=_(r,"data","basicLSTMCell"),p=_(a,"c","basicLSTMCell"),m=_(i,"h","basicLSTMCell"),g=nn([f,m],1),x=et(g,u),v=Re(x,c),w=v.shape[0],S=v.shape[1]/4,T=[w,S],$=je(v,[0,0],T),D=je(v,[0,S],T),R=je(v,[0,S*2],T),I=je(v,[0,S*3],T),V=Re(ve(bi($),wm(D)),ve(p,bi(Re(l,R)))),j=ve(wm(V),bi(I));return[V,j]}const FO=M({basicLSTMCell_:kO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AO(n,e,t){const r=_(n,"x","batchToSpaceND"),a=e.reduce((u,c)=>u*c);A(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),A(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),A(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const i={x:r},l={blockShape:e,crops:t};return z.runKernel(rC,i,l)}const uT=M({batchToSpaceND_:AO});function IO(n){let e;return n.rank===0||n.rank===1?e=oe(n,[1,1,1,n.size]):n.rank===2?e=oe(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=oe(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(n,e,t,r,a,i){i==null&&(i=.001);const l=_(n,"x","batchNorm"),u=_(e,"mean","batchNorm"),c=_(t,"variance","batchNorm");let f;a!=null&&(f=_(a,"scale","batchNorm"));let p;r!=null&&(p=_(r,"offset","batchNorm")),A(u.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(p==null||u.rank===p.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(f==null||u.rank===f.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const g={x:IO(l),scale:f,offset:p,mean:u,variance:c},x={varianceEpsilon:i},v=z.runKernel(VC,g,x);return oe(v,l.shape)}const Kd=M({batchNorm_:LO});function BO(n,e,t,r,a,i){const l=_(n,"x","batchNorm"),u=_(e,"mean","batchNorm"),c=_(t,"variance","batchNorm");let f;a!=null&&(f=_(a,"scale","batchNorm"));let p;return r!=null&&(p=_(r,"offset","batchNorm")),A(l.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${l.rank}.`),A(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${u.rank}.`),A(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),f!=null&&A(f.rank===2||f.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${f.rank}.`),p!=null&&A(p.rank===2||p.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${p.rank}.`),Kd(l,u,c,p,f,i)}const MO=M({batchNorm2d_:BO});function UO(n,e,t,r,a,i){const l=_(n,"x","batchNorm"),u=_(e,"mean","batchNorm"),c=_(t,"variance","batchNorm");let f;a!=null&&(f=_(a,"scale","batchNorm"));let p;return r!=null&&(p=_(r,"offset","batchNorm")),A(l.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${l.rank}.`),A(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${u.rank}.`),A(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),f!=null&&A(f.rank===3||f.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${f.rank}.`),p!=null&&A(p.rank===3||p.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${p.rank}.`),Kd(l,u,c,p,f,i)}const PO=M({batchNorm3d_:UO});function zO(n,e,t,r,a,i){const l=_(n,"x","batchNorm"),u=_(e,"mean","batchNorm"),c=_(t,"variance","batchNorm");let f;a!=null&&(f=_(a,"scale","batchNorm"));let p;return r!=null&&(p=_(r,"offset","batchNorm")),A(l.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${l.rank}.`),A(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${u.rank}.`),A(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),f!=null&&A(f.rank===4||f.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${f.rank}.`),p!=null&&A(p.rank===4||p.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${p.rank}.`),Kd(l,u,c,p,f,i)}const VO=M({batchNorm4d_:zO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GO(n,e,t){const r=_(n,"x","bincount"),a=_(e,"weights","bincount");A(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),A(t>=0,()=>`size must be non-negative, but got ${t}.`),A(a.size===r.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},l={size:t};return z.runKernel(aC,i,l)}const cT=M({bincount_:GO});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HO(n,e){const t=_(n,"x","bitwiseAnd"),r=_(e,"y","bitwiseAnd");if(!pt(t.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${t.shape}, y: ${r.shape}`);if(t.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${t.dtype} and type of y: ${r.dtype}`);const a={a:t,b:r};return z.runKernel(sC,a)}const WO=M({bitwiseAnd_:HO});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jO(n,e){const t=_(n,"s0","broadcastArgs","int32"),r=_(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const a={s0:t,s1:r};return z.runKernel(iC,a)}const qO=M({broadcastArgs_:jO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XO(n,e){let t=_(n,"broadcastTo","x");const r=t.shape;if(Yn(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const f=t.shape.slice();for(;f.length<e.length;)f.unshift(1);t=oe(t,f)}const a=t.shape,i=Array.from(e);for(let f=e.length-1;f>=0;f--)if(a[f]===e[f])i[f]=1;else if(t.shape[f]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((f,p)=>f>1?p:-1).filter(f=>f>=0).length===0)return Ss(t);const u={x:t},c={reps:i};return z.runKernel(sg,u,c)}const cu=M({broadcastTo_:XO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KO(n){const t={x:_(n,"x","ceil","float32")};return z.runKernel(oC,t)}const YO=M({ceil_:KO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _u(n,e,t){Yn(n),t=t||Eu(e);const r={shape:n,value:e,dtype:t};return z.runKernel(MC,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QO(n,e,t){const r=_(n,"x","clipByValue");if(A(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return _u(r.shape,e,r.dtype);const a={x:r},i={clipValueMin:e,clipValueMax:t};return z.runKernel(lC,a,i)}const ZO=M({clipByValue_:QO});function JO(n){return nn(n,0)}const ek=M({concat1d_:JO});function tk(n,e){return nn(n,e)}const dT=M({concat2d_:tk});function nk(n,e){return nn(n,e)}const rk=M({concat3d_:nk});function ak(n,e){return nn(n,e)}const sk=M({concat4d_:ak});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ik(n,e,t,r,a="NHWC",i=[1,1],l){const u=_(n,"x","conv2d","float32"),c=_(e,"filter","conv2d","float32");let f=u,p=!1;u.rank===3&&(p=!0,f=oe(u,[1,u.shape[0],u.shape[1],u.shape[2]])),A(f.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${f.rank}.`),A(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),vr("conv2d",r,l);const m=a==="NHWC"?f.shape[3]:f.shape[1];A(m===c.shape[2],()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${c.shape[2]}.`),A(Ln(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),A(Ei(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),A(Ei(t),()=>"Error in conv2D: Strides should be larger than 0.");const g={x:f,filter:c},x={strides:t,pad:r,dataFormat:a,dilations:i,dimRoundingMode:l},v=z.runKernel(fC,g,x);return p?oe(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const Yd=M({conv2d_:ik});function ok(n,e,t,r,a="NWC",i=1,l){const u=_(n,"x","conv1d"),c=_(e,"filter","conv1d");let f=u,p=!1;u.rank===2&&(p=!0,f=oe(u,[1,u.shape[0],u.shape[1]])),A(f.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${f.rank}.`),A(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),vr("conv1d",r,l),A(f.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${f.shape[2]}) must match input depth for filter ${c.shape[1]}.`),A(Ln(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),A(Ei(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),A(Ei(t),()=>"Error in conv1D: Stride should be larger than 0."),A(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const m=oe(c,[1,c.shape[0],c.shape[1],c.shape[2]]),g=oe(f,[f.shape[0],1,f.shape[1],f.shape[2]]),S=Yd(g,m,[1,t],r,"NHWC",[1,i],l);return p?oe(S,[S.shape[2],S.shape[3]]):oe(S,[S.shape[0],S.shape[2],S.shape[3]])}const lk=M({conv1d_:ok});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uk(n,e,t,r,a,i="NHWC",l){A(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let u=n,c=e,f=!1;e.rank===3&&(f=!0,c=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]]),u=[1,n[0],n[1],n[2]]),A(u.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${u.length}.`),A(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),A(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const p=i==="NHWC"?u[3]:u[1],m=i==="NHWC"?c.shape[3]:c.shape[1];A(p===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${p}) must match input depth for filter ${t.shape[2]}.`),A(m===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${m}) must match output depth for filter ${t.shape[3]}.`),vr("conv2dDerInput",a,l);const g={dy:c,filter:t},x={strides:r,pad:a,dataFormat:i,dimRoundingMode:l,inputShape:u},v=z.runKernel(pC,g,x);return f?oe(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const fT=M({conv2DBackpropInput_:uk});function ck(n,e,t,r,a,i){const l=_(n,"x","conv2dTranspose"),u=_(e,"filter","conv2dTranspose");return fT(t,l,u,r,a,"NHWC",i)}const dk=M({conv2dTranspose_:ck});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fk(n,e,t,r,a="NDHWC",i=[1,1,1]){const l=_(n,"x","conv3d"),u=_(e,"filter","conv3d");let c=l,f=!1;l.rank===4&&(f=!0,c=oe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),A(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),A(u.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${u.rank}.`),A(c.shape[4]===u.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${u.shape[3]}.`),A(Ln(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),A(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),A(Ei(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),A(Ei(t),()=>"Error in conv3D: Strides should be larger than 0.");const p={x:c,filter:u},m={strides:t,pad:r,dataFormat:a,dilations:i},g=z.runKernel(mC,p,m);return f?oe(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const hk=M({conv3d_:fk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(n,e,t,r,a){A(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,l=e,u=!1;e.rank===4&&(u=!0,l=oe(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const c=i[4],f=l.shape[4];A(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),A(l.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${l.rank}`),A(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),A(c===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${t.shape[3]}.`),A(f===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[4]}.`);const p={dy:l,filter:t},m={pad:a,strides:r,inputShape:i},g=z.runKernel(gC,p,m);return u?oe(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const mk=M({conv3DBackpropInput_:pk});function gk(n,e,t,r,a){const i=_(n,"x","conv3dTranspose"),l=_(e,"filter","conv3dTranspose");return mk(t,i,l,r,a)}const yk=M({conv3dTranspose_:gk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xk(n){const t={x:_(n,"x","cos","float32")};return z.runKernel(yC,t)}const bk=M({cos_:xk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vk(n){const t={x:_(n,"x","cosh","float32")};return z.runKernel(xC,t)}const Ck=M({cosh_:vk});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sk(n,e=0,t=!1,r=!1){const i={x:_(n,"x","cumprod")},l={axis:e,exclusive:t,reverse:r};return z.runKernel(bC,i,l)}const wk=M({cumprod_:Sk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tk(n,e=0,t=!1,r=!1){const i={x:_(n,"x","cumsum")},l={axis:e,exclusive:t,reverse:r};return z.runKernel(vC,i,l)}const Nk=M({cumsum_:Tk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ek(n,e,t,r=!1){const a=_(n,"x","denseBincount"),i=_(e,"weights","denseBincount");A(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),A(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),A(t>=0,()=>`size must be non-negative, but got ${t}.`),A(i.size===a.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${i.shape}.`);const l={x:a,weights:i},u={size:t,binaryOutput:r};return z.runKernel(SC,l,u)}const $k=M({denseBincount_:Ek});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dk(n,e,t="NHWC"){const r=_(n,"x","depthToSpace","float32"),a=t==="NHWC"?r.shape[1]:r.shape[2],i=t==="NHWC"?r.shape[2]:r.shape[3],l=t==="NHWC"?r.shape[3]:r.shape[1];A(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),A(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e}  for depthToSpace with input shape
    ${r.shape}`),A(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),A(l%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${l} for depthToSpace with input shape ${r.shape}`);const u={x:r},c={blockSize:e,dataFormat:t};return z.runKernel(wC,u,c)}const Rk=M({depthToSpace_:Dk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _k(n,e,t,r,a="NHWC",i=[1,1],l){const u=_(n,"x","depthwiseConv2d","float32"),c=_(e,"filter","depthwiseConv2d","float32");let f=u,p=!1;u.rank===3&&(p=!0,f=oe(u,[1,u.shape[0],u.shape[1],u.shape[2]])),A(f.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),A(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const m=a==="NHWC"?f.shape[3]:f.shape[1];A(m===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${m}) must match the inChannels dimension in filter ${c.shape[2]}.`),vr("depthwiseConv2d",r,l);const g={x:f,filter:c},x={strides:t,pad:r,dataFormat:a,dilations:i,dimRoundingMode:l},v=z.runKernel(TC,g,x);return p?oe(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const dg=M({depthwiseConv2d_:_k});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ok(n){const t={x:_(n,"x","diag")};return z.runKernel($C,t)}const kk=M({diag_:Ok});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fk(n,e,t,r,a=[1,1],i="NHWC"){const l=_(n,"x","dilation2d"),u=_(e,"filter","dilation2d");A(l.rank===3||l.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${l.rank}.`),A(u.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${u.rank}.`),A(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let c=l,f=!1;l.rank===3&&(c=oe(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=!0),A(c.shape[3]===u.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${u.shape[2]}`);const p={x:c,filter:u},m={strides:t,pad:r,dilations:a},g=z.runKernel(DC,p,m);return f?oe(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Ak=M({dilation2d_:Fk});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $d(n,e){const t=n.length,r=[];for(let a=0;a<t;a++){const i=t-1-a,l=n[i]||1;(e[e.length-1-a]||1)>1&&l===1&&r.unshift(i)}return r}function hT(n,e){const t=[];for(let r=0;r<e.length;r++){const a=n[n.length-r-1],i=e.length-r-1,l=e[i];(a==null||a===1&&l>1)&&t.unshift(i)}return t}function We(n,e){const t=Math.max(n.length,e.length),r=new Array(t);for(let a=0;a<t;a++){let i=n[n.length-a-1];i==null&&(i=1);let l=e[e.length-a-1];if(l==null&&(l=1),i===1)r[t-a-1]=l;else if(l===1)r[t-a-1]=i;else if(i!==l){const u=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(u)}else r[t-a-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ik(n,e){let t=_(n,"a","equal","string_or_numeric"),r=_(e,"b","equal","string_or_numeric");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(FC,a)}const pT=M({equal_:Ik});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lk(n,e,t){const r=_(e,"a","where"),a=_(t,"b","where"),i=_(n,"condition","where","bool"),l=We(We(i.shape,r.shape),a.shape),u=cu(i,l),c=cu(r,l),f=cu(a,l),p={condition:u,t:c,e:f};return z.runKernel(KS,p)}const ws=M({where_:Lk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bk(n){const t={x:_(n,"x","zerosLike")};return z.runKernel($w,t)}const Xn=M({zerosLike_:Bk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mk(n,e){let t=_(n,"a","div"),r=_(e,"b","div");[t,r]=xt(t,r);const a=Qe(t,r),i=Xn(a),l=pT(r,i);return ws(l,i,a)}const Uk=M({divNoNan_:Mk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pk(n,e){const t=_(n,"t1","dot"),r=_(e,"t2","dot");A((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const a=t.rank===1?t.size:t.shape[1],i=r.rank===1?r.size:r.shape[0];if(A(a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),t.rank===1&&r.rank===1){const l=oe(t,[1,-1]),u=oe(r,[-1,1]),c=et(l,u);return oe(c,[])}else if(t.rank===1&&r.rank===2){const l=oe(t,[1,-1]),u=oe(r,[r.shape[0],r.shape[1]]),c=et(l,u);return oe(c,[c.size])}else if(t.rank===2&&r.rank===1){const l=oe(r,[-1,1]),u=et(t,l);return oe(u,[u.size])}else{const l=oe(r,[r.shape[0],r.shape[1]]);return et(t,l)}}const zk=M({dot_:Pk});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vk(n,...e){const t=e.map((a,i)=>_(a,`tensors${i}`,"einsum")),r={equation:n};return z.runKernel(_C,t,r)}const _o=M({einsum_:Vk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gk(n){const t={x:_(n,"x","elu","float32")};return z.runKernel(OC,t)}const mT=M({elu_:Gk});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hk(n,e){const t=_(n,"x","ensureShape","string_or_numeric");if(!oR(t.shape,e))throw new Error(`EnsureShape: Shape of tensor ${t.shape} is not compatible with expected shape ${e}`);return n}const Wk=M({ensureShape_:Hk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jk(n){let e=_(n,"x","erf");A(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Tt(e,"float32"));const t={x:e};return z.runKernel(kC,t)}const qk=M({erf_:jk});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fg(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function gT(n,e,t){const r=n.length+e.length,a=[];let i=0,l=0;for(let u=0;u<r;u++)t.indexOf(u)===-1?a.push(n[i++]):a.push(e[l++]);return a}function ma(n,e){const t=[],r=n.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);const a=e.map(i=>n[i]);return[t,a]}function Zn(n,e){const t=e.map(r=>1);return gT(n,t,e)}function qr(n,e,t){A(fg(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Cr(n,e){if(fg(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function hg(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Sr(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xk(n,e=null,t=!1){const a={x:_(n,"x","max")},i={reductionIndices:e,keepDims:t};return z.runKernel(lS,a,i)}const Io=M({max_:Xk});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kk(n,e=null,t=!1){const a={x:_(n,"x","min")},i={axis:e,keepDims:t};return z.runKernel(pS,a,i)}const Tm=M({min_:Kk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yk(n,e){let t=_(n,"base","pow"),r=_(e,"exp","pow");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(RS,a)}const mu=M({pow_:Yk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ze(n,e){if((br(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&br(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ks(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qk(n){const t={x:_(n,"x","sqrt","float32")};return z.runKernel(rw,t)}const Ma=M({sqrt_:Qk});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zk(n){const e=_(n,"x","square"),t={};return z.runKernel("Square",{x:e},t)}const Hr=M({square_:Zk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jk(n,e=null,t=!1){let r=_(n,"x","sum");r.dtype==="bool"&&(r=Tt(r,"int32"));const a={x:r},i={axis:e,keepDims:t};return z.runKernel(aw,a,i)}const ut=M({sum_:Jk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eF(n,e="euclidean",t=null,r=!1){n=_(n,"x","norm");const a=yT(n,e,t);let i=a.shape;if(r){const l=Ft(t,n.shape);i=Zn(a.shape,l)}return oe(a,i)}function yT(n,e,t=null){if(n.rank===0)return jn(n);if(n.rank!==1&&t===null)return yT(oe(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return ut(jn(n),t);if(e===1/0)return Io(jn(n),t);if(e===-1/0)return Tm(jn(n),t);if(e==="euclidean"||e===2)return Ma(ut(mu(jn(n),ze(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Io(ut(jn(n),t[0]),t[1]-1);if(e===1/0)return Io(ut(jn(n),t[1]),t[0]);if(e===-1/0)return Tm(ut(jn(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Ma(ut(Hr(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const Qd=M({norm_:eF});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tF(n,e=null,t=!1){return Qd(n,"euclidean",e,t)}const nF=M({euclideanNorm_:tF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rF(n){const t={x:_(n,"x","exp")};return z.runKernel(AC,t)}const $i=M({exp_:rF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aF(n,e=0){const t=_(n,"x","expandDims","string_or_numeric");A(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},a={dim:e};return z.runKernel(IC,r,a)}const Aa=M({expandDims_:aF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sF(n){const t={x:_(n,"x","expm1")};return z.runKernel(LC,t)}const iF=M({expm1_:sF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oF(n,e){const t=_(n,"x","tile","string_or_numeric");A(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},a={reps:e};return z.runKernel(sg,r,a)}const du=M({tile_:oF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lF(n,e,t,r="float32"){e==null&&(e=n);const a=mt([n,e],r),i=n<=e?n:e;for(let u=0;u<i;++u)a.set(1,u,u);const l=oe(a.toTensor(),[n,e]);if(t==null)return l;if(t.length===1)return du(Aa(l,0),[t[0],1,1]);if(t.length===2)return du(Aa(Aa(l,0),0),[t[0],t[1],1,1]);if(t.length===3)return du(Aa(Aa(Aa(l,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const xT=M({eye_:lF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uF(n){const t={x:_(n,"x","floor","float32")};return z.runKernel(PC,t)}const bT=M({floor_:uF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cF(n,e,t=0,r=0){const a=_(n,"x","gather"),i=_(e,"indices","gather","int32"),l={x:a,indices:i},u={axis:t,batchDims:r};return z.runKernel(GC,l,u)}const vT=M({gather_:cF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dF(n,e){let t=_(n,"a","greater","string_or_numeric"),r=_(e,"b","greater","string_or_numeric");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(WC,a)}const Zd=M({greater_:dF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fF(n,e){let t=_(n,"a","greaterEqual","string_or_numeric"),r=_(e,"b","greaterEqual","string_or_numeric");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(jC,a)}const CT=M({greaterEqual_:fF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hF(n){const t={input:_(n,"input","imag")};return z.runKernel(XC,t)}const Jd=M({imag_:hF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pF(n){const t={x:_(n,"x","isFinite")};return z.runKernel(KC,t)}const mF=M({isFinite_:pF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gF(n){const t={x:_(n,"x","isInf")};return z.runKernel(YC,t)}const yF=M({isInf_:gF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xF(n){const t={x:_(n,"x","isNaN")};return z.runKernel(QC,t)}const bF=M({isNaN_:xF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vF(n,e=.2){const r={x:_(n,"x","leakyRelu")},a={alpha:e};return z.runKernel(ZC,r,a)}const ST=M({leakyRelu_:vF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CF(n,e){let t=_(n,"a","less","string_or_numeric"),r=_(e,"b","less","string_or_numeric");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(JC,a)}const Nm=M({less_:CF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SF(n,e){let t=_(n,"a","lessEqual","string_or_numeric"),r=_(e,"b","lessEqual","string_or_numeric");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(eS,a)}const pg=M({lessEqual_:SF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wF(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const r={start:n,stop:e,num:t};return z.runKernel(tS,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TF(n,e=5,t=1,r=1,a=.5){const i=_(n,"x","localResponseNormalization");A(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),A(Bo(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let l=i,u=!1;i.rank===3&&(u=!0,l=oe(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const c={x:l},f={depthRadius:e,bias:t,alpha:r,beta:a},p=z.runKernel(oS,c,f);return u?oe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const NF=M({localResponseNormalization_:TF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EF(n){const t={x:_(n,"x","log","float32")};return z.runKernel(nS,t)}const gu=M({log_:EF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $F(n){const t={x:_(n,"x","log1p")};return z.runKernel(rS,t)}const wT=M({log1p_:$F});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DF(n,e){A(am(n),()=>"The f passed in variableGrads(f) must be a function"),A(e==null||Array.isArray(e)&&e.every(f=>f instanceof Nd),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const f in z.registeredVariables)e.push(z.registeredVariables[f])}const r=t?e.filter(f=>!f.trainable):null,a=e.length;e=e.filter(f=>f.trainable),A(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const i=!0,{value:l,grads:u}=z.gradients(n,e,null,i);A(u.some(f=>f!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),A(l.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${l.rank} tensor`);const c={};return e.forEach((f,p)=>{u[p]!=null&&(c[f.name]=u[p])}),r!=null&&r.forEach(f=>c[f.name]=null),{value:l,grads:c}}function Ua(n){return z.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RF(n){const t={x:_(n,"x","neg")};return z.runKernel(vS,t)}const ha=M({neg_:RF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _F(n){const t={x:_(n,"x","softplus")};return z.runKernel(nw,t)}const TT=M({softplus_:_F});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OF(n){const e=_(n,"x","logSigmoid");return Ua(r=>({value:ha(TT(ha(r))),gradFunc:l=>ve(l,bi(ha(r)))}))(e)}const kF=M({logSigmoid_:OF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FF(n,e){let t=_(n,"a","sub"),r=_(e,"b","sub");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(bw,a)}const Ie=M({sub_:FF});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AF(n,e=-1){const t=_(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Ua((a,i)=>{const u=Io(a,e,!0),c=Ie(a,u),f=Ie(Tt(c,"float32"),gu(ut($i(c),e,!0)));return i([f]),{value:f,gradFunc:(m,g)=>{const[x]=g,v=!0,w=$i(x);return Ie(m,ve(ut(m,e,v),w))}}})(t)}const IF=M({logSoftmax_:AF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LF(n,e=null,t=!1){const r=_(n,"x","logSumExp"),a=Ft(e,r.shape),i=Io(r,a,!0),l=Ie(r,i),u=$i(l),c=ut(u,a),f=gu(c),p=Re(oe(i,f.shape),f);if(t){const m=Zn(p.shape,a);return oe(p,m)}return p}const NT=M({logSumExp_:LF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BF(n,e){const t=_(n,"a","logicalAnd","bool"),r=_(e,"b","logicalAnd","bool");We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(aS,a)}const Dd=M({logicalAnd_:BF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(n){const t={x:_(n,"x","logicalNot","bool")};return z.runKernel(sS,t)}const ET=M({logicalNot_:MF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UF(n,e){const t=_(n,"a","logicalOr","bool"),r=_(e,"b","logicalOr","bool");We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(iS,a)}const $T=M({logicalOr_:UF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PF(n,e){const t=_(n,"a","logicalXor","bool"),r=_(e,"b","logicalXor","bool");return We(t.shape,r.shape),Dd($T(n,e),ET(Dd(n,e)))}const zF=M({logicalXor_:PF});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kc=2147483648;function VF(n,e,t="left"){const r=_(n,"sortedSequence","searchSorted"),a=_(e,"values","searchSorted"),i=r.shape[r.shape.length-1],l=a.shape[a.shape.length-1],u=oe(r,[-1,i]),c=oe(a,[-1,l]);if(u.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(u.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(pe(c.shape)>=Kc)throw new Error(`values tensor size must less than ${Kc}`);if(u.shape[1]>=Kc)throw new Error(`trailing dim_size must less than ${Kc} for int32 output type, was ${u.shape[1]}`);const f={sortedSequence:u,values:c},p={side:t};return z.runKernel(XS,f,p)}const mg=M({searchSorted_:VF});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GF(n,e){return mg(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(n,e,t,r,a){const i=_(n,"x","maxPool"),l=1;let u=i,c=!1;i.rank===3&&(c=!0,u=oe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),A(u.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${u.rank}.`),A(Ln(t,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${l}'`),vr("maxPool",r,a);const f={x:u},p={filterSize:e,strides:t,pad:r,dimRoundingMode:a},m=z.runKernel(cS,f,p);return c?oe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const DT=M({maxPool_:HF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WF(n,e=[1,1,1],t,r,a,i="NDHWC"){const l=_(n,"x","maxPool3d");let u=l,c=!1;l.rank===4&&(c=!0,u=oe(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),A(u.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${u.rank}.`),A(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),vr("maxPool3d",r,a);const f={x:u},p={filterSize:e,strides:t,pad:r,dimRoundingMode:a,dataFormat:i},m=z.runKernel(dS,f,p);return c?oe(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const jF=M({maxPool3d_:WF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qF(n,e,t,r,a=!1){const l={x:_(n,"x","maxPoolWithArgmax")},u={filterSize:e,strides:t,pad:r,includeBatchInIndex:a},c=z.runKernel(fS,l,u);return{result:c[0],indexes:c[1]}}const XF=M({maxPoolWithArgmax_:qF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KF(n,e){let t=_(n,"a","maximum"),r=_(e,"b","maximum");[t,r]=xt(t,r),t.dtype==="bool"&&(t=Tt(t,"int32"),r=Tt(r,"int32")),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(uS,a)}const RT=M({maximum_:KF});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YF(n,e=null,t=!1){const a={x:_(n,"x","mean")},i={axis:e,keepDims:t};return z.runKernel(hS,a,i)}const Rd=M({mean_:YF});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Di(n,e="float32"){if(Yn(n),e==="complex64"){const r=Di(n,"float32"),a=Di(n,"float32");return Es(r,a)}const t=Ns(pe(n),e);return z.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gi(n,e="float32"){if(Yn(n),e==="complex64"){const r=gi(n,"float32"),a=Di(n,"float32");return Es(r,a)}const t=Mv(pe(n),e);return z.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QF(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let r=_(n,"x","meshgrid",n instanceof Ut?n.dtype:"float32");if(e===void 0)return[r];let a=_(e,"y","meshgrid",e instanceof Ut?e.dtype:"float32");const i=pe(r.shape),l=pe(a.shape);return t==="xy"?(r=oe(r,[1,-1]),a=oe(a,[-1,1]),[et(gi([l,1],r.dtype),r),et(a,gi([1,i],a.dtype))]):(r=oe(r,[-1,1]),a=oe(a,[1,-1]),[et(r,gi([1,l],r.dtype)),et(gi([i,1],a.dtype),a)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZF(n,e){let t=_(n,"a","minimum"),r=_(e,"b","minimum");[t,r]=xt(t,r),t.dtype==="bool"&&(t=Tt(t,"int32"),r=Tt(r,"int32")),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(mS,a)}const _d=M({minimum_:ZF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JF(n,e,t){A(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=_(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");A(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const a=t==="reflect"?1:0;for(let u=0;u<r.rank;u++)A(e[u].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),A(e[u][0]>=0&&e[u][0]<=r.shape[u]-a&&e[u][1]>=0&&e[u][1]<=r.shape[u]-a,()=>`Padding in dimension ${u} cannot be greater than or equal to ${r.shape[u]-a} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:t},l={x:r};return z.runKernel(gS,l,i)}const eA=M({mirrorPad_:JF});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tA(n,e){let t=_(n,"a","mod"),r=_(e,"b","mod");[t,r]=xt(t,r);const a={a:t,b:r};return z.runKernel(yS,a)}const nA=M({mod_:tA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rA(n,e=null,t=!1){n=_(n,"x","moments");const r=Ft(e,n.shape),a=Rd(n,r,t);let i=a.shape;t||(i=Zn(a.shape,r));const l=Hr(Ie(Tt(n,"float32"),oe(a,i))),u=Rd(l,r,t);return{mean:a,variance:u}}const aA=M({moments_:rA});function sA(n,e,t,r){const a=_(e,"data","multiRNNCell"),i=Ed(t,"c","multiRNNCell"),l=Ed(r,"h","multiRNNCell");let u=a;const c=[];for(let m=0;m<n.length;m++){const g=n[m](u,i[m],l[m]);c.push(g[0]),c.push(g[1]),u=g[1]}const f=[],p=[];for(let m=0;m<c.length;m+=2)f.push(c[m]),p.push(c[m+1]);return[f,p]}const iA=M({multiRNNCell_:sA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oA(n,e,t,r=!1){const a=_(n,"logits","multinomial"),i=a.size,l=a.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(l>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${l}`);t=t||Math.random();const c={logits:l===1?oe(a,[1,-1]):a},f={numSamples:e,seed:t,normalized:r},p=z.runKernel(xS,c,f);return l===1?oe(p,[p.size]):p}const lA=M({multinomial_:oA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uA(n,e){let t=_(n,"a","notEqual","string_or_numeric"),r=_(e,"b","notEqual","string_or_numeric");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r};return z.runKernel(CS,a)}const _T=M({notEqual_:uA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cA(n,e,t=1,r=0,a="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const l={indices:_(n,"indices","oneHot","int32")},u={dtype:a,depth:e,onValue:t,offValue:r};return z.runKernel(ES,l,u)}const dA=M({oneHot_:cA});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fA(n){const t={x:_(n,"x","onesLike")};return z.runKernel(NS,t)}const hA=M({onesLike_:fA});function pA(n,e){const t=_(n,"v1","outerProduct"),r=_(e,"v2","outerProduct");A(t.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${r.rank}.`);const a=oe(t,[-1,1]),i=oe(r,[1,-1]);return et(a,i)}const mA=M({outerProduct_:pA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(n,e,t=0){const r=_(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:t},i={x:r};return z.runKernel(DS,i,a)}const Ou=M({pad_:gA});function yA(n,e,t=0){return A(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Ou(n,[e],t)}const xA=M({pad1d_:yA});function bA(n,e,t=0){return A(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ou(n,e,t)}const vA=M({pad2d_:bA});function CA(n,e,t=0){return A(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ou(n,e,t)}const SA=M({pad3d_:CA});function wA(n,e,t=0){return A(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ou(n,e,t)}const TA=M({pad4d_:wA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NA(n,e,t){const r=_(n,"x","spaceToBatchND");A(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),A(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),A(r.shape.reduce((l,u,c)=>c>0&&c<=e.length?l&&(u+t[c-1][0]+t[c-1][1])%e[c-1]===0:l,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:r},i={blockShape:e,paddings:t};return z.runKernel(sw,a,i)}const OT=M({spaceToBatchND_:NA});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EA(n,e,t,r,a,i,l){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");const u=_(n,"x","maxPool");let c=u,f=!1;u.rank===3&&(f=!0,c=oe(u,[1,u.shape[0],u.shape[1],u.shape[2]])),A(Ln(i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);const p=Ii(c.shape,e,i,a,r),m=[p.dilationHeight,p.dilationWidth];let g;r==="same"?g=DA([p.filterHeight,p.filterWidth],m):g=[[0,0],[0,0]];const x=m[0]===1&&m[1]===1,[v,w]=$A([p.inHeight,p.inWidth],m,g),S=x?r:"valid",T=x?c:OT(c,m,v),D=(t==="avg"?()=>lT(T,e,i,S,l):()=>DT(T,e,i,S,l))(),R=x?D:uT(D,m,w);return f?oe(R,[R.shape[1],R.shape[2],R.shape[3]]):R}function $A(n,e,t){const r=t.map(p=>p[0]),a=t.map(p=>p[1]),i=n.concat(r,a),l=e.map((p,m)=>(p-i[m]%p)%p),u=a.map((p,m)=>p+l[m]),c=e.map((p,m)=>[r[m],u[m]]),f=e.map((p,m)=>[0,l[m]]);return[c,f]}function DA(n,e){const r=n.map((l,u)=>l+(l-1)*(e[u]-1)).map(l=>l-1),a=r.map(l=>Math.floor(l/2)),i=r.map((l,u)=>l-a[u]);return r.map((l,u)=>[a[u],i[u]])}const RA=M({pool_:EA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _A(n,e){const t=_(n,"x","prelu"),r=_(e,"alpha","prelu"),a={x:t,alpha:r};return z.runKernel(_S,a)}const kT=M({prelu_:_A});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OA(n,e=null,t=!1){let r=_(n,"x","prod");r.dtype==="bool"&&(r=Tt(r,"int32"));const a={x:r},i={axis:e,keepDims:t};return z.runKernel(OS,a,i)}const kA=M({prod_:OA});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FA(n,e,t,r){const a=n.map((p,m)=>_(p,`tensors${m}`,"raggedGather","int32")),i=_(e,"paramsDenseValues","raggedGather"),l=_(t,"indices","raggedGather","int32"),u={paramsNestedSplits:a,paramsDenseValues:i,indices:l},c={outputRaggedRank:r},f=z.runKernel(kS,u,c);return{outputNestedSplits:f.slice(0,f.length-1),outputDenseValues:f[f.length-1]}}const AA=M({raggedGather_:FA});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IA(n,e,t){const r=_(n,"starts","raggedRange"),a=_(e,"limits","raggedRange",r.dtype),i=_(t,"deltas","raggedRange",r.dtype),l={starts:r,limits:a,deltas:i},u=z.runKernel(FS,l);return{rtNestedSplits:u[0],rtDenseValues:u[1]}}const LA=M({raggedRange_:IA});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BA(n,e,t,r,a){const i=_(n,"shape","raggedTensorToTensor","int32"),l=_(e,"values","raggedTensorToTensor"),u=_(t,"defaultValue","raggedTensorToTensor",l.dtype),c=r.map((m,g)=>_(m,`tensors${g}`,"raggedTensorToTensor","int32")),f={shape:i,values:l,defaultValue:u,rowPartitionTensors:c},p={rowPartitionTypes:a};return z.runKernel(AS,f,p)}const MA=M({raggedTensorToTensor_:BA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UA(n,e,t){Yn(n);const r=pe(n);let a=null;if(t==null||t==="float32")a=new Float32Array(r);else if(t==="int32")a=new Int32Array(r);else if(t==="bool")a=new Uint8Array(r);else throw new Error(`Unknown data type ${t}`);for(let i=0;i<r;i++)a[i]=e();return z.makeTensor(a,n,t)}const PA=M({rand_:UA});var cd={exports:{}},zA=cd.exports,Z1;function VA(){return Z1||(Z1=1,function(n){(function(e,t,r){function a(c){var f=this,p=u();f.next=function(){var m=2091639*f.s0+f.c*23283064365386963e-26;return f.s0=f.s1,f.s1=f.s2,f.s2=m-(f.c=m|0)},f.c=1,f.s0=p(" "),f.s1=p(" "),f.s2=p(" "),f.s0-=p(c),f.s0<0&&(f.s0+=1),f.s1-=p(c),f.s1<0&&(f.s1+=1),f.s2-=p(c),f.s2<0&&(f.s2+=1),p=null}function i(c,f){return f.c=c.c,f.s0=c.s0,f.s1=c.s1,f.s2=c.s2,f}function l(c,f){var p=new a(c),m=f&&f.state,g=p.next;return g.int32=function(){return p.next()*4294967296|0},g.double=function(){return g()+(g()*2097152|0)*11102230246251565e-32},g.quick=g,m&&(typeof m=="object"&&i(m,p),g.state=function(){return i(p,{})}),g}function u(){var c=4022871197,f=function(p){p=String(p);for(var m=0;m<p.length;m++){c+=p.charCodeAt(m);var g=.02519603282416938*c;c=g>>>0,g-=c,g*=c,c=g>>>0,g-=c,c+=g*4294967296}return(c>>>0)*23283064365386963e-26};return f}t&&t.exports?t.exports=l:this.alea=l})(zA,n)}(cd)),cd.exports}var dd={exports:{}},GA=dd.exports,J1;function HA(){return J1||(J1=1,function(n){(function(e,t,r){function a(u){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var m=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^m^m>>>8},u===(u|0)?c.x=u:f+=u;for(var p=0;p<f.length+64;p++)c.x^=f.charCodeAt(p)|0,c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c}function l(u,c){var f=new a(u),p=c&&c.state,m=function(){return(f.next()>>>0)/4294967296};return m.double=function(){do var g=f.next()>>>11,x=(f.next()>>>0)/4294967296,v=(g+x)/(1<<21);while(v===0);return v},m.int32=f.next,m.quick=m,p&&(typeof p=="object"&&i(p,f),m.state=function(){return i(f,{})}),m}t&&t.exports?t.exports=l:this.xor128=l})(GA,n)}(dd)),dd.exports}var fd={exports:{}},WA=fd.exports,eb;function jA(){return eb||(eb=1,function(n){(function(e,t,r){function a(u){var c=this,f="";c.next=function(){var m=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(m^m<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,u===(u|0)?c.x=u:f+=u;for(var p=0;p<f.length+64;p++)c.x^=f.charCodeAt(p)|0,p==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(u,c){return c.x=u.x,c.y=u.y,c.z=u.z,c.w=u.w,c.v=u.v,c.d=u.d,c}function l(u,c){var f=new a(u),p=c&&c.state,m=function(){return(f.next()>>>0)/4294967296};return m.double=function(){do var g=f.next()>>>11,x=(f.next()>>>0)/4294967296,v=(g+x)/(1<<21);while(v===0);return v},m.int32=f.next,m.quick=m,p&&(typeof p=="object"&&i(p,f),m.state=function(){return i(f,{})}),m}t&&t.exports?t.exports=l:this.xorwow=l})(WA,n)}(fd)),fd.exports}var hd={exports:{}},qA=hd.exports,tb;function XA(){return tb||(tb=1,function(n){(function(e,t,r){function a(u){var c=this;c.next=function(){var p=c.x,m=c.i,g,x;return g=p[m],g^=g>>>7,x=g^g<<24,g=p[m+1&7],x^=g^g>>>10,g=p[m+3&7],x^=g^g>>>3,g=p[m+4&7],x^=g^g<<7,g=p[m+7&7],g=g^g<<13,x^=g^g<<9,p[m]=x,c.i=m+1&7,x};function f(p,m){var g,x=[];if(m===(m|0))x[0]=m;else for(m=""+m,g=0;g<m.length;++g)x[g&7]=x[g&7]<<15^m.charCodeAt(g)+x[g+1&7]<<13;for(;x.length<8;)x.push(0);for(g=0;g<8&&x[g]===0;++g);for(g==8?x[7]=-1:x[g],p.x=x,p.i=0,g=256;g>0;--g)p.next()}f(c,u)}function i(u,c){return c.x=u.x.slice(),c.i=u.i,c}function l(u,c){u==null&&(u=+new Date);var f=new a(u),p=c&&c.state,m=function(){return(f.next()>>>0)/4294967296};return m.double=function(){do var g=f.next()>>>11,x=(f.next()>>>0)/4294967296,v=(g+x)/(1<<21);while(v===0);return v},m.int32=f.next,m.quick=m,p&&(p.x&&i(p,f),m.state=function(){return i(f,{})}),m}t&&t.exports?t.exports=l:this.xorshift7=l})(qA,n)}(hd)),hd.exports}var pd={exports:{}},KA=pd.exports,nb;function YA(){return nb||(nb=1,function(n){(function(e,t,r){function a(u){var c=this;c.next=function(){var p=c.w,m=c.X,g=c.i,x,v;return c.w=p=p+1640531527|0,v=m[g+34&127],x=m[g=g+1&127],v^=v<<13,x^=x<<17,v^=v>>>15,x^=x>>>12,v=m[g]=v^x,c.i=g,v+(p^p>>>16)|0};function f(p,m){var g,x,v,w,S,T=[],$=128;for(m===(m|0)?(x=m,m=null):(m=m+"\0",x=0,$=Math.max($,m.length)),v=0,w=-32;w<$;++w)m&&(x^=m.charCodeAt((w+32)%m.length)),w===0&&(S=x),x^=x<<10,x^=x>>>15,x^=x<<4,x^=x>>>13,w>=0&&(S=S+1640531527|0,g=T[w&127]^=x+S,v=g==0?v+1:0);for(v>=128&&(T[(m&&m.length||0)&127]=-1),v=127,w=4*128;w>0;--w)x=T[v+34&127],g=T[v=v+1&127],x^=x<<13,g^=g<<17,x^=x>>>15,g^=g>>>12,T[v]=x^g;p.w=S,p.X=T,p.i=v}f(c,u)}function i(u,c){return c.i=u.i,c.w=u.w,c.X=u.X.slice(),c}function l(u,c){u==null&&(u=+new Date);var f=new a(u),p=c&&c.state,m=function(){return(f.next()>>>0)/4294967296};return m.double=function(){do var g=f.next()>>>11,x=(f.next()>>>0)/4294967296,v=(g+x)/(1<<21);while(v===0);return v},m.int32=f.next,m.quick=m,p&&(p.X&&i(p,f),m.state=function(){return i(f,{})}),m}t&&t.exports?t.exports=l:this.xor4096=l})(KA,n)}(pd)),pd.exports}var md={exports:{}},QA=md.exports,rb;function ZA(){return rb||(rb=1,function(n){(function(e,t,r){function a(u){var c=this,f="";c.next=function(){var m=c.b,g=c.c,x=c.d,v=c.a;return m=m<<25^m>>>7^g,g=g-x|0,x=x<<24^x>>>8^v,v=v-m|0,c.b=m=m<<20^m>>>12^g,c.c=g=g-x|0,c.d=x<<16^g>>>16^v,c.a=v-m|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,u===Math.floor(u)?(c.a=u/4294967296|0,c.b=u|0):f+=u;for(var p=0;p<f.length+20;p++)c.b^=f.charCodeAt(p)|0,c.next()}function i(u,c){return c.a=u.a,c.b=u.b,c.c=u.c,c.d=u.d,c}function l(u,c){var f=new a(u),p=c&&c.state,m=function(){return(f.next()>>>0)/4294967296};return m.double=function(){do var g=f.next()>>>11,x=(f.next()>>>0)/4294967296,v=(g+x)/(1<<21);while(v===0);return v},m.int32=f.next,m.quick=m,p&&(typeof p=="object"&&i(p,f),m.state=function(){return i(f,{})}),m}t&&t.exports?t.exports=l:this.tychei=l})(QA,n)}(md)),md.exports}var gd={exports:{}};const JA={},eI=Object.freeze(Object.defineProperty({__proto__:null,default:JA},Symbol.toStringTag,{value:"Module"})),tI=eR(eI);var nI=gd.exports,ab;function rI(){return ab||(ab=1,function(n){(function(e,t,r){var a=256,i=6,l=52,u="random",c=r.pow(a,i),f=r.pow(2,l),p=f*2,m=a-1,g;function x(R,I,V){var j=[];I=I==!0?{entropy:!0}:I||{};var K=T(S(I.entropy?[R,D(t)]:R??$(),3),j),B=new v(j),U=function(){for(var k=B.g(i),ee=c,he=0;k<f;)k=(k+he)*a,ee*=a,he=B.g(1);for(;k>=p;)k/=2,ee/=2,he>>>=1;return(k+he)/ee};return U.int32=function(){return B.g(4)|0},U.quick=function(){return B.g(4)/4294967296},U.double=U,T(D(B.S),t),(I.pass||V||function(k,ee,he,fe){return fe&&(fe.S&&w(fe,B),k.state=function(){return w(B,{})}),he?(r[u]=k,ee):k})(U,K,"global"in I?I.global:this==r,I.state)}function v(R){var I,V=R.length,j=this,K=0,B=j.i=j.j=0,U=j.S=[];for(V||(R=[V++]);K<a;)U[K]=K++;for(K=0;K<a;K++)U[K]=U[B=m&B+R[K%V]+(I=U[K])],U[B]=I;(j.g=function(k){for(var ee,he=0,fe=j.i,me=j.j,ae=j.S;k--;)ee=ae[fe=m&fe+1],he=he*a+ae[m&(ae[fe]=ae[me=m&me+ee])+(ae[me]=ee)];return j.i=fe,j.j=me,he})(a)}function w(R,I){return I.i=R.i,I.j=R.j,I.S=R.S.slice(),I}function S(R,I){var V=[],j=typeof R,K;if(I&&j=="object")for(K in R)try{V.push(S(R[K],I-1))}catch{}return V.length?V:j=="string"?R:R+"\0"}function T(R,I){for(var V=R+"",j,K=0;K<V.length;)I[m&K]=m&(j^=I[m&K]*19)+V.charCodeAt(K++);return D(I)}function $(){try{var R;return g&&(R=g.randomBytes)?R=R(a):(R=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(R)),D(R)}catch{var I=e.navigator,V=I&&I.plugins;return[+new Date,e,V,e.screen,D(t)]}}function D(R){return String.fromCharCode.apply(0,R)}if(T(r.random(),t),n.exports){n.exports=x;try{g=tI}catch{}}else r["seed"+u]=x})(typeof self<"u"?self:nI,[],Math)}(gd)),gd.exports}var kp,sb;function aI(){if(sb)return kp;sb=1;var n=VA(),e=HA(),t=jA(),r=XA(),a=YA(),i=ZA(),l=rI();return l.alea=n,l.xor128=e,l.xorwow=t,l.xorshift7=r,l.xor4096=a,l.tychei=i,kp=l,kp}var gg=aI();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yg{constructor(e,t,r,a,i){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const l=i||Math.random();this.random=gg.alea(l.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,t,r=!1;for(;!r;){let a,i,l;do a=2*this.random()-1,i=2*this.random()-1,l=a*a+i*i;while(l>=1||l===0);const u=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*a*u,t=this.mean+this.stdDev*i*u,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class sI{constructor(e,t,r,a){this.alpha=e,this.beta=1/t,this.dtype=r;const i=a||Math.random();this.randu=gg.alea(i.toString()),this.randn=new yg(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,a,i,l;for(;;){do a=this.randn.nextValue(),l=1+this.c*a;while(l<=0);if(l*=l*l,e=a*a,t=1-.331*e*e,r=.5*e+this.d*(1-l+Math.log(l)),i=this.randu(),i<t||Math.log(i)<r)break}return l=1/this.beta*this.d*l,this.alpha<1&&(l*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(l)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class iI{constructor(e=0,t=1,r,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=gg.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(n,e,t=1,r="float32",a){if(Yn(n),t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new sI(e,t,r,a),l=mt(n,r);for(let u=0;u<l.values.length;u++)l.values[u]=i.nextValue();return l.toTensor()}const lI=M({randomGamma_:oI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uI(n,e=0,t=1,r,a){if(Yn(n),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new yg(e,t,r,!1,a),l=mt(n,r);for(let u=0;u<l.values.length;u++)l.values[u]=i.nextValue();return l.toTensor()}const FT=M({randomNormal_:uI});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cI(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return FT(n,0,1,e,t)}const dI=M({randomStandardNormal_:cI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fI(n,e=0,t=1,r="float32",a){Yn(n);const i=mt(n,r),l=new iI(e,t,null,a);for(let u=0;u<i.values.length;u++)i.values[u]=l.nextValue();return i.toTensor()}const xg=M({randomUniform_:fI});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hI(n,e,t,r){return xg(n,e,t,"int32",r)}const pI=M({randomUniformInt_:hI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yu(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const a={start:n,stop:e,step:t,dtype:r};return z.runKernel(IS,{},a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mI(n){const t={input:_(n,"input","real")};return z.runKernel(LS,t)}const xu=M({real_:mI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gI(n){const t={x:_(n,"x","reciprocal")};return z.runKernel(BS,t)}const yI=M({reciprocal_:gI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xI(n){const t={x:_(n,"x","relu")};return z.runKernel(MS,t)}const ef=M({relu_:xI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bI(n){const t={x:_(n,"x","relu6")};return z.runKernel(VS,t)}const AT=M({relu6_:bI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vI(n,e){const r={x:_(n,"x","reverse")},a={dims:e};return z.runKernel(GS,r,a)}const Ri=M({reverse_:vI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CI(n){const e=_(n,"x","reverse");return A(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Ri(e,0)}const SI=M({reverse1d_:CI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wI(n,e){const t=_(n,"x","reverse");return A(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Ri(t,e)}const TI=M({reverse2d_:wI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NI(n,e){const t=_(n,"x","reverse");return A(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Ri(t,e)}const EI=M({reverse3d_:NI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $I(n,e){const t=_(n,"x","reverse");return A(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Ri(t,e)}const DI=M({reverse4d_:$I});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RI(n){const t={x:_(n,"x","round")};return z.runKernel(HS,t)}const IT=M({round_:RI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _I(n){const t={x:_(n,"x","rsqrt","float32")};return z.runKernel(WS,t)}const OI=M({rsqrt_:_I});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kI(n){const t={x:_(n,"x","selu")};return z.runKernel(YS,t)}const FI=M({selu_:kI});function AI(n,e,t,r,a,i=[1,1],l="NHWC"){const u=_(n,"x","separableConv2d"),c=_(e,"depthwiseFilter","separableConv2d"),f=_(t,"pointwiseFilter","separableConv2d");let p=u,m=!1;if(u.rank===3&&(m=!0,p=oe(u,[1,u.shape[0],u.shape[1],u.shape[2]])),l==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(p.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${p.rank}.`),A(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),A(f.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),A(f.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${f.shape[0]}.`),A(f.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${f.shape[1]}.`);const g=c.shape[2],x=c.shape[3];A(f.shape[2]===g*x,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${g*x}, but got ${f.shape[2]}.`);const v=dg(p,c,r,a,l,i),S=Yd(v,f,1,"valid",l);return m?oe(S,[S.shape[1],S.shape[2],S.shape[3]]):S}const II=M({separableConv2d_:AI});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function LI(n,e){const t=_(n,"x","setdiff1d"),r=_(e,"y","setdiff1d");A(t.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${r.dtype}).`),A(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),A(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const a=await t.data(),i=await r.data(),l=new Set(i);let u=0;for(let p=0;p<a.length;p++)l.has(a[p])||u++;const c=new Uo([u],t.dtype),f=new Uo([u],"int32");for(let p=0,m=0;p<a.length;p++)l.has(a[p])||(c.values[m]=a[p],f.values[m]=p,m++);return[c.toTensor(),f.toTensor()]}const BI=LI;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MI(n){const t={x:_(n,"x","sign")};return z.runKernel(ew,t)}const UI=M({sign_:MI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PI(n){const t={x:_(n,"x","sin","float32")};return z.runKernel(ZS,t)}const zI=M({sin_:PI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VI(n){const t={x:_(n,"x","sinh")};return z.runKernel(JS,t)}const GI=M({sinh_:VI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HI(n,e,t){const r=_(n,"x","slice1d");return A(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),je(r,[e],[t])}const WI=M({slice1d_:HI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jI(n,e,t){const r=_(n,"x","slice2d");return A(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),je(r,e,t)}const qI=M({slice2d_:jI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XI(n,e,t){const r=_(n,"x","slice3d");return A(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),je(r,e,t)}const KI=M({slice3d_:XI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YI(n,e,t){const r=_(n,"x","slice4d");return A(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),je(r,e,t)}const QI=M({slice4d_:YI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZI(n,e=-1){const t=_(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},a={dim:e};return z.runKernel(ow,r,a)}const JI=M({softmax_:ZI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(n){A(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return z.runKernel(BC,e)}const bg=M({fft_:e3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3(n){A(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return z.runKernel(qC,e)}const Od=M({ifft_:t3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n3(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const a=oe(n,[t,e]);r=Od(a)}else{const a=[t,2*(e-1)],i=oe(xu(n),[t,e]),l=oe(Jd(n),[t,e]),u=Ri(je(i,[0,1],[t,e-2]),1),c=ve(Ri(je(l,[0,1],[t,e-2]),1),ze(-1)),f=nn([i,u],1),p=nn([l,c],1),m=oe(Es(f,p),[a[0],a[1]]);r=Od(m)}if(r=xu(r),n.rank===3&&n.shape[0]!==0){const a=r,i=n.shape[0];r=oe(r,[i,r.shape[0]/i,r.shape[1]]),a.dispose()}return r}const LT=M({irfft_:n3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3(n,e,t=0){const a={x:_(n,"x","split")},i={numOrSizeSplits:e,axis:t};return z.runKernel(iw,a,i)}const bu=M({split_:r3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3(n,e){A(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let a;if(e!=null&&e<t){const v=n.shape.map(S=>0),w=n.shape.map(S=>S);w[n.shape.length-1]=e,a=je(n,v,w),t=e}else if(e!=null&&e>t){const v=n.shape.map(w=>w);v[n.shape.length-1]=e-t,a=nn([n,Di(v)],n.shape.length-1),t=e}else a=n;const i=Xn(a),l=oe(Es(a,i),[r,t]),u=bg(l),c=Math.floor(t/2)+1,f=xu(u),p=Jd(u),m=bu(f,[c,t-c],f.shape.length-1),g=bu(p,[c,t-c],p.shape.length-1),x=a.shape.slice();return x[a.shape.length-1]=c,oe(Es(m[0],g[0]),x)}const vg=M({rfft_:a3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3(n,e){let t=_(n,"a","squaredDifference"),r=_(e,"b","squaredDifference");[t,r]=xt(t,r),We(t.shape,r.shape);const a={a:t,b:r},i={};return z.runKernel(hw,a,i)}const BT=M({squaredDifference_:s3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3(n,e){const t=_(n,"x","squeeze","string_or_numeric");return oe(t,_s(t.shape,e).newShape)}const vu=M({squeeze_:i3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o3(n,e=0){const t=Ed(n,"tensors","stack","string_or_numeric");A(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&A(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,a={axis:e};return z.runKernel($S,r,a)}const Pa=M({stack_:o3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3(n,e=0){const r={x:_(n,"x","step")},a={alpha:e};return z.runKernel(Dw,r,a)}const MT=M({step_:l3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3(n,e,t,r,a=0,i=0,l=0,u=0,c=0){const p={x:_(n,"x","stridedSlice","string_or_numeric")},m={begin:e,end:t,strides:r,beginMask:a,endMask:i,ellipsisMask:l,newAxisMask:u,shrinkAxisMask:c};return z.runKernel(mw,p,m)}const c3=M({stridedSlice_:u3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3(n){const t={x:_(n,"x","tan","float32")};return z.runKernel(vw,t)}const f3=M({tan_:d3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function An(n,e){Ho(n);const t=Os(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ks(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(n,e,t){if(Ho(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Os(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ks(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UT(n,e,t){if(Ho(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Os(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ks(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3(n,e,t){if(Ho(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Os(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ks(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3(n,e,t){if(Ho(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Os(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ks(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3(n,e,t){if(Ho(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Os(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,ks(n,e,r,t)}function PT(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${a}.`;if(t.rank<a)throw new Error(i+` update.rank < ${a}. `);if(n.length<r+(t.rank-a))throw new Error(i+` Output shape length < ${r+(t.rank-a)}`);if(t.rank!==a+n.length-r)throw new Error(i+` update.rank != ${a+n.length-r}`);for(let l=0;l<a;++l)if(t.shape[l]!==e.shape[l])throw new Error(i+` updates.shape[${l}] (${t.shape[l]}) != indices.shape[${l}] (${e.shape[l]}).`);for(let l=0;l<t.rank-a;++l)if(t.shape[l+a]!==n[l+r])throw new Error(i+` updates.shape[${l+a}] (${t.shape[l+a]}) != shape[${l+a}] (${n[l+a]})`)}function Cg(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}PT(t,e,n)}function tf(n,e,t){const r=e.shape.length,a=r>1?e.shape[r-1]:1,i=t.length;let l=1;for(let m=a;m<i;++m)l*=t[m];const u=a<1?1:a,c=pe(e.shape)/u,f=[...Vt(t.slice(0,a)),1],p=pe(t);return{sliceRank:a,numUpdates:c,sliceSize:l,strides:f,outputSize:p}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3(n,e,t){const r=_(n,"tensor","tensorScatterupdate"),a=_(e,"indices","tensorScatterupdate","int32"),i=_(t,"updates","tensorScatterupdate");if(Cg(i,a,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);const l={tensor:r,indices:a,updates:i},u={};return z.runKernel(qS,l,u)}const y3=M({tensorScatterUpdate_:g3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x3(n,e=1,t=!0){const r=_(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${e}`);const i={x:r},l={k:e,sorted:t},[u,c]=z.runKernel(Sw,i,l);return{values:u,indices:c}}const b3=M({topk_:x3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3(n,e=0,t=1,r,a){if(Yn(n),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new yg(e,t,r,!0,a),l=mt(n,r);for(let u=0;u<l.values.length;u++)l.values[u]=i.nextValue();return l.toTensor()}const C3=M({truncatedNormal_:v3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3(n,e=0){const t=_(n,"x","unique","string_or_numeric");A(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},a={axis:e},[i,l]=z.runKernel(Tw,r,a);return{values:i,indices:l}}const w3=M({unique_:S3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3(n,e,t){const r=_(n,"x","unsortedSegmentSum"),a=_(e,"segmentIds","unsortedSegmentSum","int32");A(Bo(t),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:a},l={numSegments:t};return z.runKernel(Ew,i,l)}const N3=M({unsortedSegmentSum_:T3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3(n,e=0){const t=_(n,"x","unstack","string_or_numeric");A(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},a={axis:e};return z.runKernel(Nw,r,a)}const Li=M({unstack_:E3});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3(n,e){return mg(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3(n,e=!0,t,r){return z.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zT(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const r=mt(n,"int32"),a=mt([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const l=r.indexToLoc(t[i]),u=i*n.length;a.values.set(l,u)}return a.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function R3(n){const e=_(n,"condition","whereAsync","bool"),t=await e.data(),r=zT(e.shape,t);return n!==e&&e.dispose(),r}const VT=R3;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _3(n,e,t){const r=_(n,"tensor","boolMask"),a=_(e,"mask","boolMask","bool"),i=t??0,l=a.rank,u=r.shape;A(l>0,()=>"mask cannot be scalar"),Kn(u.slice(i,i+l),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let w=i;w<i+l;w++)c*=u[w];const f=u.slice(0,i).concat([c],u.slice(i+l)),p=oe(r,f),m=oe(a,[-1]),g=await VT(m),x=vu(g,[1]),v=vT(p,x,i);return n!==r&&r.dispose(),e!==a&&a.dispose(),x.dispose(),p.dispose(),m.dispose(),g.dispose(),v}const O3=_3;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3(n,e,t){const r=_(n,"x","transpose");if(e==null&&(e=r.shape.map((l,u)=>u).reverse()),A(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(l=>{A(l>=0&&l<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const a={x:r},i={perm:e};return r.dtype==="complex64"?Me(()=>{let l=xu(r),u=Jd(r);return l=z.runKernel(od,{x:l},i),u=z.runKernel(od,{x:u},i),t&&(u=ha(u)),Es(l,u)}):z.runKernel(od,a,i)}const Em=M({transpose_:k3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3(n,e,t,r,a=!0){const i=_(n,"v","movingAverage"),l=_(e,"x","movingAverage"),u=_(t,"decay","movingAverage");JR(i,l),A(pt(i.shape,l.shape),()=>"Shape mismatch in v and x");const c=ze(1),f=Ie(c,u);let p=ve(Ie(l,i),f);if(a){A(r!=null,()=>"When using zeroDebias: true, step is required.");const m=_(r,"step","movingAverage");p=Qe(p,Ie(c,mu(u,m)))}return Re(i,p)}const A3=M({movingAverage_:F3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3(n,e,t){Yn(t);const r=_(n,"indices","scatterND","int32"),a=_(e,"updates","scatterND");Cg(a,r,t);const i={indices:r,updates:a},l={shape:t};return z.runKernel(jS,i,l)}const L3=M({scatterND_:I3});function B3(n,e,t,r){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const a=n.rank>0?n.shape[0]:1,i=n.rank>1?n.shape[1]:1;if(t.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${i}.`);const l=e.size;if(!(e.rank===0||e.rank===1&&l===a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3(n,e,t,r=0){Yn(t);const a=_(n,"sparseIndices","sparseToDense","int32"),i=_(e,"sparseValues","sparseToDense","string_or_numeric"),l=_(r,"defaultValue","sparseToDense",i.dtype);B3(a,i,t,l);const u={sparseIndices:a,sparseValues:i,defaultValue:l},c={outputShape:t};return z.runKernel(fw,u,c)}const U3=M({sparseToDense_:M3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3(n,e){const t=_(e,"indices","gatherND","int32"),a={params:_(n,"x","gatherND","string_or_numeric"),indices:t};return z.runKernel(HC,a)}const z3=M({gatherND_:P3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V3(n,e){if(e==null)return n.shape.slice();if(pt(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(n,e,t,r){const a=_(n,"x","dropout");if(A(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),A(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Ut?a.clone():a;const i=V3(a,t),l=1-e,u=Qe(bT(Re(xg(i,0,1,"float32",r),l)),l);return ve(a,u)}const H3=M({dropout_:G3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function Sg(n,e,t){const r=1-n%2,a=new Float32Array(n);for(let i=0;i<n;++i){const l=2*Math.PI*i/(n+r-1);a[i]=e-t*Math.cos(l)}return An(a,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function W3(n,e,t=1){const r=_(n,"predictions","inTopK"),a=_(e,"targets","inTopK");A(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),A(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),Kn(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];A(t>0&&t<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${t}`);const l=await r.data(),u=await a.data(),[c,f]=[l.length/i,i],p=Ts("bool",c);for(let m=0;m<c;m++){const g=m*f,x=l.subarray(g,g+f),v=[];for(let w=0;w<x.length;w++)v.push({value:x[w],index:w});v.sort((w,S)=>S.value-w.value),p[m]=0;for(let w=0;w<t;w++)if(v[w].index===u[m]){p[m]=1;break}}return n!==r&&r.dispose(),e!==a&&a.dispose(),fa(p,a.shape,"bool")}const j3=W3;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3(n,e,t,r,a,i="NHWC",l){let u=n;n.rank===3&&(u=oe(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=e;c.rank===3&&(c=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]])),A(u.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${u.shape}.`),A(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),A(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const f=i==="NHWC"?u.shape[3]:u.shape[1],p=i==="NHWC"?c.shape[3]:c.shape[1];A(f===t[2],()=>`Error in conv2dDerFilter: depth of input ${f}) must match input depth in filter (${t[2]}.`),A(p===t[3],()=>`Error in conv2dDerFilter: depth of dy (${p}) must match output depth for filter (${t[3]}).`),vr("conv2dDerFilter",a,l);const m={x:u,dy:c},g={strides:r,pad:a,dataFormat:i,dimRoundingMode:l,filterShape:t};return z.runKernel(hC,m,g)}const X3=M({conv2DBackpropFilter_:q3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return ve(n,MT(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function rf(n,e){let t=e;const r=hT(n.shape,e.shape);return r.length>0&&(t=ut(t,r)),oe(t,n.shape)}function af(n,e,t,r){if(e==="linear")return n;if(e==="relu")return ef(n);if(e==="elu")return mT(n);if(e==="relu6")return AT(n);if(e==="prelu")return kT(n,t);if(e==="leakyrelu")return ST(n,r);if(e==="sigmoid")return bi(n);throw new Error(`Unknown fused activation ${e}.`)}const sf=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3({x:n,filter:e,strides:t,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:l,bias:u,activation:c="linear",preluActivationWeights:f,leakyreluAlpha:p}){if(c=c||"linear",sf(z.state.gradientDepth,c)===!1){A(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let V=Yd(n,e,t,r,a,i,l);return u!=null&&(V=Re(V,u)),af(V,c,f,p)}const m=_(n,"x","conv2d","float32"),g=_(e,"filter","conv2d","float32");let x=m,v=!1;m.rank===3&&(v=!0,x=oe(m,[1,m.shape[0],m.shape[1],m.shape[2]])),A(x.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${x.rank}.`),A(g.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${g.rank}.`),vr("fused conv2d",r,l);const w=a==="NHWC"?x.shape[3]:x.shape[1];A(g.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${g.shape[2]}.`),A(Ln(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const S=Qn(x.shape,g.shape,t,i,r,l);let T;u!=null&&(T=_(u,"bias","fused conv2d"),[T]=xt(T,m),a==="NHWC"?We(S.outShape,T.shape):(A(T.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${T.shape.length}.`),A(T.shape.length===0||T.shape[0]===S.outChannels||T.shape[0]===1,()=>`Error in fused conv2d: bias shape (${T.shape}) is not compatible with the number of output channels (${S.outChannels})`)));let $;if(f!=null){const V=f.shape;if(A(V.length<=1||V.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${V.length}.`),V.length===1)A(V[0]===1||V[0]===S.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the number of output channels (${S.outChannels}).`);else if(V.length===3)try{We(V,S.outShape)}catch{const K=`Error in fused conv2d: PReLU activation weights (${V}) is not compatible with the output shape of the conv2d (${S.outShape}).`;throw Error(K)}$=_(f,"prelu weights","fused conv2d")}const D=(V,j)=>{A(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[K,B,U,k]=j,ee=nf(V,U,c);A(pu(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const he=fT(B.shape,ee,K,t,r),fe=X3(B,ee,K.shape,t,r),me=[he,fe];if(k!=null){const ae=rf(k,ee);me.push(ae)}return me},R={x,filter:g,bias:T,preluActivationWeights:$},I={strides:t,pad:r,dataFormat:a,dilations:i,dimRoundingMode:l,activation:c,leakyreluAlpha:p};return u==null?Ua((j,K,B)=>{let U=z.runKernel(cm,R,I);return B([K,j,U]),v&&(U=oe(U,[U.shape[1],U.shape[2],U.shape[3]])),{value:U,gradFunc:D}})(x,g):Ua((j,K,B,U)=>{let k=z.runKernel(cm,R,I);return U([K,j,k,B]),v&&(k=oe(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:D}})(x,g,T)}const Y3=M({fusedConv2d_:K3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q3(n,e,t,r,a,i=[1,1],l){let u=n;n.rank===3&&(u=oe(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=e;c.rank===3&&(c=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const f={x:u,dy:c},p={strides:r,pad:a,dimRoundingMode:l,dilations:i,filterShape:t};return z.runKernel(NC,f,p)}const Z3=M({depthwiseConv2dNativeBackpropFilter_:Q3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3(n,e,t,r,a,i=[1,1],l){let u=e,c=!1;e.rank===3&&(c=!0,u=oe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const f={dy:u,filter:t},p={strides:r,pad:a,dimRoundingMode:l,dilations:i,inputShape:n},m=z.runKernel(EC,f,p);return c?oe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const eL=M({depthwiseConv2dNativeBackpropInput_:J3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tL({x:n,filter:e,strides:t,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:l,bias:u,activation:c="linear",preluActivationWeights:f,leakyreluAlpha:p}){if(sf(z.state.gradientDepth,c)===!1){let I=dg(n,e,t,r,a,i,l);return u!=null&&(I=Re(I,u)),af(I,c,f,p)}const m=_(n,"x","depthwiseConv2d","float32"),g=_(e,"filter","depthwiseConv2d","float32");let x=m,v=!1;m.rank===3&&(v=!0,x=oe(m,[1,m.shape[0],m.shape[1],m.shape[2]])),A(x.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${x.rank}.`),A(g.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${g.rank}.`),A(x.shape[3]===g.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${x.shape[3]}) must match the inChannels dimension in filter ${g.shape[2]}.`),i==null&&(i=[1,1]),A(Ln(t,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),vr("fused depthwiseConv2d",r,l);const w=Qn(x.shape,g.shape,t,i,r,l,!0);let S;u!=null&&(S=_(u,"bias","fused conv2d"),[S]=xt(S,m),We(w.outShape,S.shape));let T;f!=null&&(T=_(f,"prelu weights","fused depthwiseConv2d"));const $=(I,V)=>{A(pu(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[j,K,B,U]=V,k=nf(I,B,c),ee=eL(K.shape,k,j,t,r,i,l),he=Z3(K,k,j.shape,t,r,i,l);if(U!=null){const fe=rf(S,k);return[ee,he,fe]}return[ee,he]},D={x,filter:g,bias:S,preluActivationWeights:T},R={strides:t,pad:r,dataFormat:a,dilations:i,dimRoundingMode:l,activation:c,leakyreluAlpha:p};return u==null?Ua((V,j,K)=>{let B=z.runKernel(dm,D,R);return K([j,V,B]),v&&(B=oe(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:$}})(x,g):Ua((V,j,K,B)=>{let U=z.runKernel(dm,D,R);return B([j,V,U,K]),v&&(U=oe(U,[U.shape[1],U.shape[2],U.shape[3]])),{value:U,gradFunc:$}})(x,g,S)}const nL=M({fusedDepthwiseConv2d_:tL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:l,leakyreluAlpha:u=.2}){if(sf(z.state.gradientDepth,i)===!1){let k=et(n,e,t,r);return a!=null&&(k=Re(k,a)),af(k,i,l,u)}let c=_(n,"a","fused matMul"),f=_(e,"b","fused matMul");[c,f]=xt(c,f);const p=t?c.shape[c.rank-2]:c.shape[c.rank-1],m=r?f.shape[f.rank-1]:f.shape[f.rank-2],g=t?c.shape[c.rank-1]:c.shape[c.rank-2],x=r?f.shape[f.rank-2]:f.shape[f.rank-1],v=c.shape.slice(0,-2),w=f.shape.slice(0,-2),S=pe(v),T=pe(w);A(p===m,()=>`Error in fused matMul: inner shapes (${p}) and (${m}) of Tensors with shapes ${c.shape} and ${f.shape} and transposeA=${t} and transposeB=${r} must match.`);const D=We(c.shape.slice(0,-2),f.shape.slice(0,-2)).concat([g,x]),R=t?oe(c,[S,p,g]):oe(c,[S,g,p]),I=r?oe(f,[T,x,m]):oe(f,[T,m,x]);let V;a!=null&&(V=_(a,"bias","fused matMul"),[V]=xt(V,c),We(D,V.shape));let j;l!=null&&(j=_(l,"prelu weights","fused matMul"));const K=(k,ee)=>{const[he,fe,me,ae]=ee,de=nf(oe(k,me.shape),me,i);let le,Q;if(!t&&!r?(le=et(de,fe,!1,!0),Q=et(he,de,!0,!1)):!t&&r?(le=et(de,fe,!1,!1),Q=et(de,he,!0,!1)):t&&!r?(le=et(fe,de,!1,!0),Q=et(he,de,!1,!1)):(le=et(fe,de,!0,!0),Q=et(de,he,!0,!0)),a!=null){const F=rf(ae,de);return[le,Q,F]}else return[le,Q]},B={a:R,b:I,bias:V,preluActivationWeights:j},U={transposeA:t,transposeB:r,activation:i,leakyreluAlpha:u};return a==null?Ua((ee,he,fe)=>{const me=z.runKernel(um,B,U);return fe([ee,he,me]),{value:oe(me,D),gradFunc:K}})(R,I):Ua((ee,he,fe,me)=>{const ae=z.runKernel(um,B,U);return me([ee,he,ae,fe]),{value:oe(ae,D),gradFunc:K}})(R,I,V)}const aL=M({fusedMatMul_:rL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sL=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Y3,depthwiseConv2d:nL,matMul:aL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iL(n){return Sg(n,.54,.46)}const oL=M({hammingWindow_:iL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lL(n){return Sg(n,.5,.5)}const HT=M({hannWindow_:lL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uL(n,e,t,r=!1,a=0){let i=0;const l=[];for(;i+e<=n.size;)l.push(je(n,i,e)),i+=t;if(r)for(;i<n.size;){const u=i+e-n.size,c=nn([je(n,i,e-u),_u([u],a)]);l.push(c),i+=t}return l.length===0?Lo([],[0,e]):oe(nn(l),[l.length,e])}const WT=M({frame_:uL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(n,e,t,r,a=HT){r==null&&(r=GT(e));const i=WT(n,e,t),l=ve(i,a(e));return vg(l,r)}const dL=M({stft_:cL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fL(n,e,t,r,a="bilinear",i=0){const l=_(n,"image","cropAndResize"),u=_(e,"boxes","cropAndResize","float32"),c=_(t,"boxInd","cropAndResize","int32"),f=u.shape[0];A(l.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${l.rank}.`),A(u.rank===2&&u.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${f},4] but had shape ${u.shape}.`),A(c.rank===1&&c.shape[0]===f,()=>`Error in cropAndResize: boxInd must be have size [${f}] but had shape ${u.shape}.`),A(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),A(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),A(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);const p={image:l,boxes:u,boxInd:c},m={method:a,extrapolationValue:i,cropSize:r};return z.runKernel(CC,p,m)}const hL=M({cropAndResize_:fL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(n){const e=_(n,"image","flipLeftRight","float32");A(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return z.runKernel(UC,t,{})}const mL=M({flipLeftRight_:pL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(n){const e=_(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];A(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),A(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const a=new Array(e.rank);return a.fill(1,0,t),a[t]=3,du(e,a)}const yL=M({grayscaleToRGB_:gL});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xL(n){const e=_(n,"image","RGBToGrayscale"),t=e.rank-1,r=e.shape[t];A(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),A(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const a=e.dtype,i=Tt(e,"float32"),l=An([.2989,.587,.114]);let u;switch(e.rank){case 2:u=_o("ij,j->i",i,l);break;case 3:u=_o("ijk,k->ij",i,l);break;case 4:u=_o("ijkl,l->ijk",i,l);break;case 5:u=_o("ijklm,m->ijkl",i,l);break;case 6:u=_o("ijklmn,n->ijklm",i,l);break;default:throw new Error("Not a valid tensor rank.")}return u=Aa(u,-1),Tt(u,a)}const bL=M({rgbToGrayscale_:xL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vL(n,e,t=0,r=.5){const a=_(n,"image","rotateWithOffset","float32");A(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const i={image:a},l={radians:e,fillValue:t,center:r};return z.runKernel(Rw,i,l)}const CL=M({rotateWithOffset_:vL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qo(n,e,t,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);const l=n.shape[0];return t=Math.min(t,l),A(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),A(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),A(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),A(e.rank===1,()=>"scores must be a 1D tensor"),A(e.shape[0]===l,()=>`scores has incompatible shape with boxes. Expected ${l}, but was ${e.shape[0]}`),A(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(n,e,t,r=.5,a=Number.NEGATIVE_INFINITY){const i=_(n,"boxes","nonMaxSuppression","float32"),l=_(e,"scores","nonMaxSuppression","float32"),u=qo(i,l,t,r,a);t=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold;const c={maxOutputSize:t,iouThreshold:r,scoreThreshold:a};return z.runKernel(SS,{boxes:i,scores:l},c)}const wL=M({nonMaxSuppression_:SL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TL(n,e,t){const r=NL(n,e,t),a=r<0?-(r+1):r;n.splice(a,0,e)}function NL(n,e,t){return $L(n,e,t||EL)}function EL(n,e){return n>e?1:n<e?-1:0}function $L(n,e,t){let r=0,a=n.length,i=0,l=!1;for(;r<a;){i=r+(a-r>>>1);const u=t(e,n[i]);u>0?r=i+1:(a=i,l=!u)}return l?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jT(n,e,t,r,a){return wg(n,e,t,r,a,0)}function qT(n,e,t,r,a,i){return wg(n,e,t,r,a,0,!1,i,!0)}function XT(n,e,t,r,a,i){return wg(n,e,t,r,a,i,!0)}function wg(n,e,t,r,a,i,l=!1,u=!1,c=!1){const f=[];for(let S=0;S<e.length;S++)e[S]>a&&f.push({score:e[S],boxIndex:S,suppressBeginIndex:0});f.sort(ib);const p=i>0?-.5/i:0,m=[],g=[];for(;m.length<t&&f.length>0;){const S=f.pop(),{score:T,boxIndex:$,suppressBeginIndex:D}=S;if(T<a)break;let R=!1;for(let I=m.length-1;I>=D;--I){const V=DL(n,$,m[I]);if(V>=r){R=!0;break}if(S.score=S.score*RL(r,p,V),S.score<=a)break}S.suppressBeginIndex=m.length,R||(S.score===T?(m.push($),g.push(S.score)):S.score>a&&TL(f,S,ib))}const x=m.length,v=t-x;u&&v>0&&(m.push(...new Array(v).fill(0)),g.push(...new Array(v).fill(0)));const w={selectedIndices:m};return l&&(w.selectedScores=g),c&&(w.validOutputs=x),w}function DL(n,e,t){const r=n.subarray(e*4,e*4+4),a=n.subarray(t*4,t*4+4),i=Math.min(r[0],r[2]),l=Math.min(r[1],r[3]),u=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),f=Math.min(a[0],a[2]),p=Math.min(a[1],a[3]),m=Math.max(a[0],a[2]),g=Math.max(a[1],a[3]),x=(u-i)*(c-l),v=(m-f)*(g-p);if(x<=0||v<=0)return 0;const w=Math.max(i,f),S=Math.max(l,p),T=Math.min(u,m),$=Math.min(c,g),D=Math.max(T-w,0)*Math.max($-S,0);return D/(x+v-D)}function RL(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function ib(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _L(n,e,t,r=.5,a=Number.NEGATIVE_INFINITY){const i=_(n,"boxes","nonMaxSuppressionAsync"),l=_(e,"scores","nonMaxSuppressionAsync"),u=qo(i,l,t,r,a);t=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold;const c=await Promise.all([i.data(),l.data()]),f=c[0],p=c[1],{selectedIndices:m}=jT(f,p,t,r,a);return i!==n&&i.dispose(),l!==e&&l.dispose(),An(m,"int32")}const OL=_L;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kL(n,e,t,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const l=_(n,"boxes","nonMaxSuppression"),u=_(e,"scores","nonMaxSuppression"),c=qo(l,u,t,r,a,i);t=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma;const f={boxes:l,scores:u},p={maxOutputSize:t,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},m=z.runKernel(TS,f,p);return{selectedIndices:m[0],selectedScores:m[1]}}const FL=M({nonMaxSuppressionWithScore_:kL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function AL(n,e,t,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const l=_(n,"boxes","nonMaxSuppressionAsync"),u=_(e,"scores","nonMaxSuppressionAsync"),c=qo(l,u,t,r,a,i);t=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma;const f=await Promise.all([l.data(),u.data()]),p=f[0],m=f[1],{selectedIndices:g,selectedScores:x}=XT(p,m,t,r,a,i);return l!==n&&l.dispose(),u!==e&&u.dispose(),{selectedIndices:An(g,"int32"),selectedScores:An(x)}}const IL=AL;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(n,e,t,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const l=_(n,"boxes","nonMaxSuppression"),u=_(e,"scores","nonMaxSuppression"),c=qo(l,u,t,r,a,null),f=c.maxOutputSize,p=c.iouThreshold,m=c.scoreThreshold,g={boxes:l,scores:u},x={maxOutputSize:f,iouThreshold:p,scoreThreshold:m,padToMaxOutputSize:i},v=z.runKernel(wS,g,x);return{selectedIndices:v[0],validOutputs:v[1]}}const BL=M({nonMaxSuppressionPadded_:LL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ML(n,e,t,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const l=_(n,"boxes","nonMaxSuppressionAsync"),u=_(e,"scores","nonMaxSuppressionAsync"),c=qo(l,u,t,r,a,null),f=c.maxOutputSize,p=c.iouThreshold,m=c.scoreThreshold,[g,x]=await Promise.all([l.data(),u.data()]),{selectedIndices:v,validOutputs:w}=qT(g,x,f,p,m,i);return l!==n&&l.dispose(),u!==e&&u.dispose(),{selectedIndices:An(v,"int32"),validOutputs:ze(w,"int32")}}const UL=ML;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(n,e,t=!1,r=!1){const a=_(n,"images","resizeBilinear");A(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),A(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),A(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,l=!1;a.rank===3&&(l=!0,i=oe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const u={images:i},c={alignCorners:t,halfPixelCenters:r,size:e},f=z.runKernel(zS,u,c);return l?oe(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const zL=M({resizeBilinear_:PL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(n,e,t=!1,r=!1){const a=_(n,"images","resizeNearestNeighbor");A(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),A(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),A(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),A(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,l=!1;a.rank===3&&(l=!0,i=oe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const u={images:i},c={alignCorners:t,halfPixelCenters:r,size:e},f=z.runKernel(PS,u,c);return l?oe(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const GL=M({resizeNearestNeighbor_:VL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(n,e="binary",t=!1,r=.5){const a=_(n,"image","threshold"),i=.2989,l=.587,u=.114,c=a.shape[0]*a.shape[1];let f=ve(An([r]),255),p,m,g,x;if(A(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),A(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),A(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),A(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),a.shape[2]===3){[p,m,g]=bu(a,[1,1,1],-1);const S=ve(p,i),T=ve(m,l),$=ve(g,u);x=Re(Re(S,T),$)}else x=n;if(e==="otsu"){const S=cT(Tt(IT(x),"int32"),fa([]),256);f=WL(S,c)}const v=t?pg(x,f):Zd(x,f);return Tt(ve(v,255),"int32")}function WL(n,e){let t=An([-1]),r=An([0]),a=An([0]),i,l,u,c,f,p;for(let m=0;m<n.size-1;m++){i=je(n,0,m+1),l=je(n,m+1),f=Qe(ut(i),e),p=Qe(ut(l),e);const g=ut(ve(i,yu(0,i.size)));u=Qe(g,ut(i));const x=_u(l.shape,i.size),v=Re(yu(0,l.size),x),w=ve(l,v);c=Qe(ut(w),ut(l));const S=Ie(u,c),T=Ie(u,c),$=ve(f,p);a=ve(ve($,S),T);const D=Zd(a,r);r=ws(D,a,r),t=ws(D,An([m]),t)}return t}const jL=M({threshold_:HL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(n,e,t="nearest",r="constant",a=0,i){const l=_(n,"image","transform","float32"),u=_(e,"transforms","transform","float32");A(l.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${l.rank}.`),A(u.rank===2&&(u.shape[0]===l.shape[0]||u.shape[0]===1)&&u.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),A(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const c={image:l,transforms:u},f={interpolation:t,fillMode:r,fillValue:a,outputShape:i};return z.runKernel(ww,c,f)}const XL=M({transform_:qL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(n,e,t){const r=_(n,"a","bandPart");A(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const a=r.shape,[i,l]=r.shape.slice(-2);let u,c;typeof e=="number"?(A(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),A(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),u=_(e<0?i:e,"numLower","bandPart")):(A(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),u=ws(Nm(e,0),i,_d(e,i))),typeof t=="number"?(A(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),A(t<=l,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${l}).`),c=_(t<0?l:t,"numUpper","bandPart")):(A(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),c=ws(Nm(t,0),l,_d(t,l)));const f=oe(yu(0,i,1,"int32"),[-1,1]),p=yu(0,l,1,"int32"),m=Ie(f,p),g=Dd(pg(m,u),CT(m,ha(c))),x=Di([i,l],r.dtype);return oe(Pa(Li(oe(r,[-1,i,l])).map(v=>ws(g,v,x))),a)}const YL=M({bandPart_:KL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(n){let e;if(Array.isArray(n)){e=!1,A(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=n[0].shape[0];for(let i=1;i<n.length;++i)A(n[i].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${a})`)}else e=!0,n=bu(n,n.shape[0],0).map(a=>vu(a,[0]));A(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let a=0;a<n.length;++a)t.push(z.tidy(()=>{let i=r[a];if(a>0)for(let l=0;l<a;++l){const u=ve(ut(ve(t[l],i)),t[l]);i=Ie(i,u)}return Qe(i,Qd(i,"euclidean"))}));return e?Pa(t,0):t}const ZL=M({gramSchmidt_:QL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JL(n,e=!1){if(A(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return ob(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((c,f)=>c*f),r=Li(oe(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),a=[],i=[];r.forEach(c=>{const[f,p]=ob(c,e);a.push(f),i.push(p)});const l=oe(Pa(a,0),n.shape),u=oe(Pa(i,0),n.shape);return[l,u]}}function ob(n,e=!1){return z.tidy(()=>{A(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let a=xT(t),i=Ss(n);const l=Lo([[1]],[1,1]);let u=Ss(l);const c=t>=r?r:t;for(let f=0;f<c;++f){const p=i,m=u,g=a;[u,i,a]=z.tidy(()=>{const x=je(i,[f,f],[t-f,1]),v=Qd(x),w=je(i,[f,f],[1,1]),S=ws(Zd(w,0),Lo([[-1]]),Lo([[1]])),T=Ie(w,ve(S,v)),$=Qe(x,T);$.shape[0]===1?u=Ss(l):u=nn([l,je($,[1,0],[$.shape[0]-1,$.shape[1]])],0);const D=ha(Qe(et(S,T),v)),R=je(i,[f,0],[t-f,r]),I=ve(D,u),V=Em(u);if(f===0)i=Ie(R,et(I,et(V,R)));else{const B=Ie(R,et(I,et(V,R)));i=nn([je(i,[0,0],[f,r]),B],0)}const j=Em(I),K=je(a,[0,f],[t,a.shape[1]-f]);if(f===0)a=Ie(K,et(et(K,u),j));else{const B=Ie(K,et(et(K,u),j));a=nn([je(a,[0,0],[t,f]),B],1)}return[u,i,a]}),vn([p,m,g])}return!e&&t>r&&(a=je(a,[0,0],[t,r]),i=je(i,[0,0],[r,r])),[a,i]})}const e4=M({qr_:JL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xn;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(xn||(xn={}));function t4(n,e,t=xn.SUM_BY_NONZERO_WEIGHTS){const r=_(n,"losses","computeWeightedLoss");let a=null;e!=null&&(a=_(e,"weights","computeWeightedLoss"));const i=a==null?r:ve(r,a);if(t===xn.NONE)return i;if(t===xn.SUM)return ut(i);if(t===xn.MEAN){if(a==null)return Rd(i);{const l=r.size/a.size,u=Qe(ut(i),ut(a));return l>1?Qe(u,ze(l)):u}}if(t===xn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return Qe(ut(i),ze(r.size));{const l=ve(a,gi(r.shape)),u=Tt(ut(_T(l,ze(0))),"float32");return Qe(ut(i),u)}}throw Error(`Unknown reduction: ${t}`)}const Va=M({computeWeightedLoss_:t4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(n,e,t,r=xn.SUM_BY_NONZERO_WEIGHTS){const a=_(n,"labels","absoluteDifference"),i=_(e,"predictions","absoluteDifference");let l=null;t!=null&&(l=_(t,"weights","absoluteDifference")),Kn(a.shape,i.shape,"Error in absoluteDifference: ");const u=jn(Ie(a,i));return Va(u,l,r)}const r4=M({absoluteDifference_:n4});function a4(n,e,t,r,a=xn.SUM_BY_NONZERO_WEIGHTS){const i=_(n,"labels","cosineDistance"),l=_(e,"predictions","cosineDistance");let u=null;r!=null&&(u=_(r,"weights","cosineDistance")),Kn(i.shape,l.shape,"Error in cosineDistance: ");const c=ze(1),f=Ie(c,ut(ve(i,l),t,!0));return Va(f,u,a)}const s4=M({cosineDistance_:a4});function i4(n,e,t,r=xn.SUM_BY_NONZERO_WEIGHTS){let a=_(n,"labels","hingeLoss");const i=_(e,"predictions","hingeLoss");let l=null;t!=null&&(l=_(t,"weights","hingeLoss")),Kn(a.shape,i.shape,"Error in hingeLoss: ");const u=ze(1);a=Ie(ve(ze(2),a),u);const c=ef(Ie(u,ve(a,i)));return Va(c,l,r)}const o4=M({hingeLoss_:i4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(n,e,t,r=1,a=xn.SUM_BY_NONZERO_WEIGHTS){const i=_(n,"labels","huberLoss"),l=_(e,"predictions","huberLoss");let u=null;t!=null&&(u=_(t,"weights","huberLoss")),Kn(i.shape,l.shape,"Error in huberLoss: ");const c=ze(r),f=jn(Ie(l,i)),p=_d(f,c),m=Ie(f,p),g=Re(ve(ze(.5),Hr(p)),ve(c,m));return Va(g,u,a)}const u4=M({huberLoss_:l4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(n,e,t,r=1e-7,a=xn.SUM_BY_NONZERO_WEIGHTS){const i=_(n,"labels","logLoss"),l=_(e,"predictions","logLoss");let u=null;t!=null&&(u=_(t,"weights","logLoss")),Kn(i.shape,l.shape,"Error in logLoss: ");const c=ze(1),f=ze(r),p=ha(ve(i,gu(Re(l,f)))),m=ve(Ie(c,i),gu(Re(Ie(c,l),f))),g=Ie(p,m);return Va(g,u,a)}const d4=M({logLoss_:c4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4(n,e,t,r=xn.SUM_BY_NONZERO_WEIGHTS){const a=_(n,"labels","meanSquaredError"),i=_(e,"predictions","meanSquaredError");let l=null;t!=null&&(l=_(t,"weights","meanSquaredError")),Kn(a.shape,i.shape,"Error in meanSquaredError: ");const u=BT(a,i);return Va(u,l,r)}const h4=M({meanSquaredError_:f4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4(n,e){const t=_(n,"labels","sigmoidCrossEntropyWithLogits"),r=_(e,"logits","sigmoidCrossEntropyWithLogits");Kn(t.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=ef(r),i=ve(r,t),l=wT($i(ha(jn(r))));return Re(Ie(a,i),l)}function m4(n,e,t,r=0,a=xn.SUM_BY_NONZERO_WEIGHTS){let i=_(n,"multiClassLabels","sigmoidCrossEntropy");const l=_(e,"logits","sigmoidCrossEntropy");let u=null;if(t!=null&&(u=_(t,"weights","sigmoidCrossEntropy")),Kn(i.shape,l.shape,"Error in sigmoidCrossEntropy: "),r>0){const f=ze(r),p=ze(1),m=ze(.5);i=Re(ve(i,Ie(p,f)),ve(m,f))}const c=p4(i,l);return Va(c,u,a)}const g4=M({sigmoidCrossEntropy_:m4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Ua((a,i,l)=>{const c=NT(i,[t],!0),f=Ie(Tt(i,"float32"),c);l([a,f]);const p=ha(ve(f,a));return{value:ut(p,[t]),gradFunc:(x,v)=>{const[w,S]=v,T=Zn(x.shape,[t]);return[ve(oe(x,T),Ie(Tt(w,"float32"),$i(S))),ve(oe(x,T),Ie($i(S),Tt(w,"float32")))]}}})(n,e)}function x4(n,e,t,r=0,a=xn.SUM_BY_NONZERO_WEIGHTS){let i=_(n,"onehotLabels","softmaxCrossEntropy");const l=_(e,"logits","softmaxCrossEntropy");let u=null;if(t!=null&&(u=_(t,"weights","softmaxCrossEntropy")),Kn(i.shape,l.shape,"Error in softmaxCrossEntropy: "),r>0){const f=ze(r),p=ze(1),m=ze(i.shape[1]);i=Re(ve(i,Ie(p,f)),Qe(f,m))}const c=y4(i,l);return Va(c,u,a)}const b4=M({softmaxCrossEntropy_:x4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(n,e,t,r){const a=_(n,"indices","sparseFillEmptyRows","int32"),i=_(e,"values","sparseFillEmptyRows"),l=_(t,"denseShape","sparseFillEmptyRows","int32"),u=_(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(l.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${l.shape}`);if(u.rank!==0)throw new Error(`Default value should be a scalar but received shape ${u.shape}`);const c={indices:a,values:i,denseShape:l,defaultValue:u},f=z.runKernel(lw,c);return{outputIndices:f[0],outputValues:f[1],emptyRowIndicator:f[2],reverseIndexMap:f[3]}}const C4=M({sparseFillEmptyRows_:v4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4(n,e,t){const r=_(n,"inputIndices","sparseReshape","int32"),a=_(e,"inputShape","sparseReshape","int32"),i=_(t,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const l={inputIndices:r,inputShape:a,newShape:i},u=z.runKernel(uw,l);return{outputIndices:u[0],outputShape:u[1]}}const w4=M({sparseReshape_:S4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4(n,e,t){const r=_(n,"data","sparseSegmentMean"),a=_(e,"indices","sparseSegmentMean","int32"),i=_(t,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const l={data:r,indices:a,segmentIds:i};return z.runKernel(cw,l)}const N4=M({sparseSegmentMean_:T4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(n,e,t){const r=_(n,"data","sparseSegmentSum"),a=_(e,"indices","sparseSegmentSum","int32"),i=_(t,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const l={data:r,indices:a,segmentIds:i};return z.runKernel(dw,l)}const $4=M({sparseSegmentSum_:E4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(n,e,t,r,a,i,l,u){const c=_(n,"data","stringNGrams","string");if(c.dtype!=="string")throw new Error("Data must be of datatype string");if(c.shape.length!==1)throw new Error(`Data must be a vector, saw: ${c.shape}`);const f=_(e,"dataSplits","stringNGrams");if(f.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const p={separator:t,nGramWidths:r,leftPad:a,rightPad:i,padWidth:l,preserveShortSequences:u},m={data:c,dataSplits:f},g=z.runKernel(gw,m,p);return{nGrams:g[0],nGramsSplits:g[1]}}const R4=M({stringNGrams_:D4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(n,e,t=!0){const r=_(n,"input","stringSplit","string"),a=_(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const i={skipEmpty:t},l={input:r,delimiter:a},u=z.runKernel(yw,l,i);return{indices:u[0],values:u[1],shape:u[2]}}const O4=M({stringSplit_:_4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4(n,e){const t=_(n,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:t};return z.runKernel(xw,a,r)}const F4=M({stringToHashBucketFast_:k4});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4(n,e,t,r=!0){const a=_(n,"input","staticRegexReplace","string"),i={pattern:e,rewrite:t,replaceGlobal:r};return z.runKernel(pw,{x:a},i)}const I4=M({staticRegexReplace_:A4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4={fft:bg,ifft:Od,rfft:vg,irfft:LT},B4={hammingWindow:oL,hannWindow:HT,frame:WT,stft:dL},Cu={flipLeftRight:mL,grayscaleToRGB:yL,resizeNearestNeighbor:GL,resizeBilinear:zL,rgbToGrayscale:bL,rotateWithOffset:CL,cropAndResize:hL,nonMaxSuppression:wL,nonMaxSuppressionAsync:OL,nonMaxSuppressionWithScore:FL,nonMaxSuppressionWithScoreAsync:IL,nonMaxSuppressionPadded:BL,nonMaxSuppressionPaddedAsync:UL,threshold:jL,transform:XL},M4={bandPart:YL,gramSchmidt:ZL,qr:e4},U4={absoluteDifference:r4,computeWeightedLoss:Va,cosineDistance:s4,hingeLoss:o4,huberLoss:u4,logLoss:d4,meanSquaredError:h4,sigmoidCrossEntropy:g4,softmaxCrossEntropy:b4},P4={sparseFillEmptyRows:C4,sparseReshape:w4,sparseSegmentMean:N4,sparseSegmentSum:$4},z4={stringNGrams:R4,stringSplit:O4,stringToHashBucketFast:F4,staticRegexReplace:I4};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V4=new Map,G4=new Map;class H4{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class di{constructor(){this.classNameMap={}}static getMap(){return di.instance==null&&(di.instance=new di),di.instance}static register(e){di.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function W4(n,e,t){A(n.className!=null,()=>"Class being registered does not have the static className property defined."),A(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),A(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const r=t,a=e+">"+r;return di.register(n),V4.set(a,n),G4.set(n,a),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bi extends H4{minimize(e,t=!1,r){const{value:a,grads:i}=this.computeGradients(e,r);if(r!=null){const l=r.map(u=>({name:u.name,tensor:i[u.name]}));this.applyGradients(l)}else this.applyGradients(i);return vn(i),t?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return DF(e,t)}dispose(){this.iterations_!=null&&vn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Bi,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j4 extends Bi{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=z.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const i=z.registeredVariables[r],l=!1;this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${r}/accum_grad`,variable:Me(()=>Xn(i).variable(l))}),this.accumulatedUpdates[a]==null&&(this.accumulatedUpdates[a]={originalName:`${r}/accum_var`,variable:Me(()=>Xn(i).variable(l))});const u=Array.isArray(e)?e[a].tensor:e[r];if(u==null)return;const c=this.accumulatedGrads[a].variable,f=this.accumulatedUpdates[a].variable;Me(()=>{const p=Re(ve(c,this.rho),ve(Hr(u),1-this.rho)),m=ve(Qe(Ma(Re(f,this.epsilon)),Ma(Re(c,this.epsilon))),u),g=Re(ve(f,this.rho),ve(Hr(m),1-this.rho));c.assign(p),f.assign(g);const x=Re(ve(m,-this.learningRate),i);i.assign(x)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(vn(this.accumulatedGrads.map(e=>e.variable)),vn(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q4 extends Bi{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const i=z.registeredVariables[r];this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${r}/accumulator`,variable:Me(()=>_u(i.shape,this.initialAccumulatorValue).variable(!1))});const l=Array.isArray(e)?e[a].tensor:e[r];if(l==null)return;const u=this.accumulatedGrads[a].variable;Me(()=>{const c=Re(u,Hr(l));u.assign(c);const f=Re(ve(Qe(l,Ma(Re(c,z.backend.epsilon()))),-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&vn(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X4 extends Bi{static get className(){return"Adam"}constructor(e,t,r,a=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Me(()=>{this.accBeta1=ze(t).variable(),this.accBeta2=ze(r).variable()}),a==null&&(this.epsilon=z.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Me(()=>{const r=Ie(1,this.accBeta1),a=Ie(1,this.accBeta2);t.forEach((i,l)=>{const u=z.registeredVariables[i],c=!1;this.accumulatedFirstMoment[l]==null&&(this.accumulatedFirstMoment[l]={originalName:`${i}/m`,variable:Me(()=>Xn(u).variable(c))}),this.accumulatedSecondMoment[l]==null&&(this.accumulatedSecondMoment[l]={originalName:`${i}/v`,variable:Me(()=>Xn(u).variable(c))});const f=Array.isArray(e)?e[l].tensor:e[i];if(f==null)return;const p=this.accumulatedFirstMoment[l].variable,m=this.accumulatedSecondMoment[l].variable,g=Re(ve(p,this.beta1),ve(f,1-this.beta1)),x=Re(ve(m,this.beta2),ve(Hr(f),1-this.beta2)),v=Qe(g,r),w=Qe(x,a);p.assign(g),m.assign(x);const S=Re(ve(Qe(v,Re(Ma(w),this.epsilon)),-this.learningRate),u);u.assign(S)}),this.accBeta1.assign(ve(this.accBeta1,this.beta1)),this.accBeta2.assign(ve(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&vn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&vn(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),Me(()=>{this.accBeta1.assign(mu(this.beta1,this.iterations_+1)),this.accBeta2.assign(mu(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K4 extends Bi{static get className(){return"Adamax"}constructor(e,t,r,a=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=a,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Me(()=>{this.iteration=ze(0).variable(),this.accBeta1=ze(t).variable()}),a==null&&(this.epsilon=z.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Me(()=>{const r=Ie(1,this.accBeta1),a=Qe(-this.learningRate,Re(ve(this.iteration,this.decay),1));t.forEach((i,l)=>{const u=z.registeredVariables[i],c=!1;this.accumulatedFirstMoment[l]==null&&(this.accumulatedFirstMoment[l]={originalName:`${i}/m`,variable:Xn(u).variable(c)}),this.accumulatedWeightedInfNorm[l]==null&&(this.accumulatedWeightedInfNorm[l]={originalName:`${i}/v`,variable:Xn(u).variable(c)});const f=Array.isArray(e)?e[l].tensor:e[i];if(f==null)return;const p=this.accumulatedFirstMoment[l].variable,m=this.accumulatedWeightedInfNorm[l].variable,g=Re(ve(p,this.beta1),ve(f,1-this.beta1)),x=ve(m,this.beta2),v=jn(f),w=RT(x,v);p.assign(g),m.assign(w);const S=Re(ve(Qe(a,r),Qe(g,Re(w,this.epsilon))),u);u.assign(S)}),this.iteration.assign(Re(this.iteration,1)),this.accBeta1.assign(ve(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&vn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&vn(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KT extends Bi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const i=Array.isArray(e)?e[a].tensor:e[r];if(i==null)return;const l=z.registeredVariables[r];Me(()=>{const u=Re(ve(this.c,i),l);l.assign(u)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=ca(ze(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y4 extends KT{static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=ze(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const i=z.registeredVariables[r];this.accumulations[a]==null&&(this.accumulations[a]={originalName:`${r}/momentum`,variable:Me(()=>Xn(i).variable(!1))});const l=this.accumulations[a].variable,u=Array.isArray(e)?e[a].tensor:e[r];u!=null&&Me(()=>{let c;const f=Re(ve(this.m,l),u);this.useNesterov?c=Re(ve(this.c,Re(u,ve(f,this.m))),i):c=Re(ve(this.c,f),i),l.assign(f),i.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&vn(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q4 extends Bi{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,a=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,a==null&&(this.epsilon=z.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const i=z.registeredVariables[r],l=!1;this.accumulatedMeanSquares[a]==null&&(this.accumulatedMeanSquares[a]={originalName:`${r}/rms`,variable:Me(()=>Xn(i).variable(l))}),this.accumulatedMoments[a]==null&&(this.accumulatedMoments[a]={originalName:`${r}/momentum`,variable:Me(()=>Xn(i).variable(l))}),this.accumulatedMeanGrads[a]==null&&this.centered&&(this.accumulatedMeanGrads[a]={originalName:`${r}/mg`,variable:Me(()=>Xn(i).variable(l))});const u=Array.isArray(e)?e[a].tensor:e[r];if(u==null)return;const c=this.accumulatedMeanSquares[a].variable,f=this.accumulatedMoments[a].variable;Me(()=>{const p=Re(ve(c,this.decay),ve(Hr(u),1-this.decay));if(this.centered){const m=this.accumulatedMeanGrads[a].variable,g=Re(ve(m,this.decay),ve(u,1-this.decay)),x=Qe(ve(u,this.learningRate),Ma(Ie(p,Re(Hr(g),this.epsilon)))),v=Re(ve(f,this.momentum),x);c.assign(p),m.assign(g),f.assign(v);const w=Ie(i,v);i.assign(w)}else{const m=Re(ve(c,this.decay),ve(Hr(u),1-this.decay)),g=Re(ve(f,this.momentum),Qe(ve(u,this.learningRate),Ma(Re(m,this.epsilon))));c.assign(m),f.assign(g);const x=Ie(i,g);i.assign(x)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&vn(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&vn(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&vn(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z4=[j4,q4,X4,K4,Y4,Q4,KT];function J4(){for(const n of Z4)W4(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eB="model",tB=".json",nB=".weights.bin";function lb(n){return new Promise(e=>setTimeout(e)).then(n)}class _i{constructor(e){if(!Z().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(_i.URL_SCHEME)&&(e=e.slice(_i.URL_SCHEME.length)),(e==null||e.length===0)&&(e=eB),this.modelJsonFileName=e+tB,this.weightDataFileName=e+nB}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=jr.join(e.weightData),r=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=Yw(e,a),l=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),u=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(u.download=this.modelJsonFileName,u.href=l,await lb(()=>u.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=r,await lb(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:$u(e)}}}}_i.URL_SCHEME="downloads://";class rB{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const r=new FileReader;r.onload=a=>{const i=JSON.parse(a.target.result),l=i.modelTopology;if(l==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:l});return}const c=ug(i,f=>this.loadWeights(f));e(c)},r.onerror=a=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const t=[],r=[];for(const l of e)t.push(...l.weights),r.push(...l.paths);const a=this.checkManifestAndWeightFiles(e),i=r.map(l=>this.loadWeightsFile(l,a[l]));return Promise.all(i).then(l=>[t,l])}loadWeightsFile(e,t){return new Promise((r,a)=>{const i=new FileReader;i.onload=l=>{const u=l.target.result;r(u)},i.onerror=l=>a(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],r=this.weightsFiles.map(i=>Q1(i.name)),a={};for(const i of e)i.paths.forEach(l=>{const u=Q1(l);if(t.indexOf(u)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${u}'`);if(t.push(u),r.indexOf(u)===-1)throw new Error(`Weight file with basename '${u}' is not provided.`);a[l]=this.weightsFiles[r.indexOf(u)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return a}}const aB=n=>Z().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(_i.URL_SCHEME)?sB(n.slice(_i.URL_SCHEME.length)):null;ft.registerSaveRouter(aB);function sB(n="model"){return new _i(n)}function iB(n){return new rB(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ub(n,e,t,r){l(n),t=t??0,r=r??1,u(t,r);let a=0;const i=c=>(c.then(f=>{const p=t+ ++a/n.length*(r-t);return e(p),f}),c);function l(c){A(c!=null&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")}function u(c,f){A(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),A(f>=0&&f<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${f}`),A(f>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${f}`)}return Promise.all(n.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function YT(n,e){e==null&&(e={});const t=e.fetchFunc==null?Z().platform.fetch:e.fetchFunc,r=n.map(m=>t(m,e.requestInit,{isBinary:!0})),u=(e.onProgress==null?await Promise.all(r):await ub(r,e.onProgress,0,.5)).map(m=>m.arrayBuffer());return e.onProgress==null?await Promise.all(u):await ub(u,e.onProgress,.5,1)}function oB(n,e){var t;const r=e.fetchFunc==null?Z().platform.fetch:e.fetchFunc;let a=0,i;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async l=>{for(var u;a<n.length;){i||(i=(await r(n[a],e.requestInit,{isBinary:!0})).body.getReader());const{done:c,value:f}=await i.read();if(c){a++,i=void 0,(u=e.onProgress)===null||u===void 0||u.call(e,a/n.length);continue}l.enqueue(f);return}l.close()}})}async function lB(n,e="",t,r){return QT(l=>YT(l,{requestInit:r}))(n,e,t)}function QT(n){return async(e,t="",r)=>{const a=e.map(()=>!1),i={},l=r!=null?r.map(()=>!1):[],u=[];if(e.forEach((x,v)=>{let w=0;x.weights.forEach(S=>{const T="quantization"in S?S.quantization.dtype:S.dtype,$=wi[T]*pe(S.shape),D=()=>{a[v]=!0,i[v]==null&&(i[v]=[]),i[v].push({manifestEntry:S,groupOffset:w,sizeBytes:$})};r!=null?r.forEach((R,I)=>{R===S.name&&(D(),l[I]=!0)}):D(),u.push(S.name),w+=$})}),!l.every(x=>x)){const x=r.filter((v,w)=>!l[w]);throw new Error(`Could not find weights in manifest with names: ${x.join(", ")}. 
Manifest JSON has weights with names: ${u.join(", ")}.`)}const c=a.reduce((x,v,w)=>(v&&x.push(w),x),[]),f=[];c.forEach(x=>{e[x].paths.forEach(v=>{const w=t+(t.endsWith("/")?"":"/")+v;f.push(w)})});const p=await n(f),m={};let g=0;return c.forEach(x=>{const v=e[x].paths.length,w=new jr(p.slice(g,g+v));i[x].forEach(T=>{const $=w.slice(T.groupOffset,T.groupOffset+T.sizeBytes),D=qw($,[T.manifestEntry]);for(const R in D)m[R]=D[R]}),g+=v}),m}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uB="application/octet-stream",cB="application/json";class Tg{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(A(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Z().platform.fetch,A(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&A(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=Yw(e,r);if(t.body.append("model.json",new Blob([JSON.stringify(a)],{type:cB}),"model.json"),e.weightData!=null){const l=jr.join(e.weightData);t.body.append("model.weights.bin",new Blob([l],{type:uB}),"model.weights.bin")}const i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:$u(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let l=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?l+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":l+=" Please make sure the server is serving valid JSON for this request.",new Error(l)}const r=t.modelTopology,a=t.weightsManifest;if(r==null&&a==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return ug(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),r=xm(e.weightsManifest),a=()=>oB(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:a})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,a]=dB(t),i=this.weightPathPrefix||r,l=[],u=[];for(const c of e)for(const f of c.paths)this.weightUrlConverter!=null?u.push(this.weightUrlConverter(f)):l.push(i+f+a);return this.weightUrlConverter&&l.push(...await Promise.all(u)),l}async loadWeights(e){const t=await this.getWeightUrls(e),r=xm(e),a=await YT(t,this.loadOptions);return[r,a]}}Tg.URL_SCHEME_REGEX=/^https?:\/\//;function dB(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),a=t>e?n.substring(t):"";return[r+"/",a]}function $m(n){return n.match(Tg.URL_SCHEME_REGEX)!=null}const ZT=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>$m(r)):t=$m(n),t)return Ng(n,e)}return null};ft.registerSaveRouter(ZT);ft.registerLoadRouter(ZT);function Ng(n,e){return new Tg(n,e)}function fB(n,e){return Ng(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fp{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class JT{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class hB{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function pB(n,e,t,r){const a=arguments;return new hB(e2(...a))}function e2(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Fp(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Fp({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Fp({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))}function mB(n){return new JT(n)}function gB(n){return new JT(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t2=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:jr,browserFiles:iB,browserHTTPRequest:fB,concatenateArrayBuffers:p_,copyModel:L_,decodeWeights:qw,decodeWeightsStream:Kw,encodeWeights:l_,fromMemory:pB,fromMemorySync:e2,getLoadHandlers:S_,getModelArtifactsForJSON:ug,getModelArtifactsForJSONSync:Qw,getModelArtifactsInfoForJSON:$u,getSaveHandlers:C_,getWeightSpecs:xm,http:Ng,isHTTPScheme:$m,listModels:A_,loadWeights:lB,moveModel:B_,registerLoadRouter:v_,registerSaveRouter:b_,removeModel:I_,weightsLoaderFactory:QT,withSaveHandler:mB,withSaveHandlerSync:gB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let si;function yB(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,r=!1,a=!1,i=!1,l=!1,u=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)i=!0;else if(n.getContext!=null)l=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)u=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(fm(lm,z.backendName)!=null){const v={pixels:n},w={numChannels:e};return z.runKernel(lm,v,w)}const[f,p]=a?[n.videoWidth,n.videoHeight]:[n.width,n.height];let m;if(l)m=n.getContext("2d").getImageData(0,0,f,p).data;else if(r||t)m=n.data;else if(i||a||u){if(si==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")si=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else si=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});si.canvas.width=f,si.canvas.height=p,si.drawImage(n,0,0,f,p),m=si.getImageData(0,0,f,p).data}let g;if(e===4)g=new Int32Array(m);else{const v=f*p;g=new Int32Array(v*e);for(let w=0;w<v;w++)for(let S=0;S<e;++S)g[w*e+S]=m[w*4+S]}return UT(g,[p,f,e],"int32")}const xB=M({fromPixels_:yB});function n2(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(pe(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const a=e.shape,i=a[a.length-1];let l=1;for(let m=0;m<a.length-1;++m)l*=a[m];const u=n.shape,c=a.slice();c.pop();let f=1;for(let m=i;m<t;++m)f*=u[m],c.push(u[m]);const p=[...Vt(n.shape).map(m=>m/f),1].slice(0,i);return[c,l,f,p]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dm=-2,bB=-1;function r2(n,e,t){const r=n.shape.length;A(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),A(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let a=0;a<r;++a)A(e[a]+t[a]<=n.shape[a],()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${e[a]+t[a]}) would overflow input.shape[${a}] (${n.shape[a]})`)}function vB(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function a2(n,e,t){const r=[];for(let a=0;a<n.length;a++)r[a]=Math.ceil((e[a]-n[a])/t[a]);return r}function s2(n,e,t,r){const a=[...n];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<t;i++)i===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function i2(n,e,t){return t<=n?t:t-(e-1)}function o2(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function CB(n,e,t,r,a,i,l,u,c){const f=n.length;let p=new Array(f),m=new Array(f),g=new Array(f);if(e.length&&t>0){const x=e[0],v=t+1;p=l2(l,x,v,r,n),m=u2(u,x,v,a,n),g=s2(i,x,v,n)}else for(let x=0;x<f;x++)p[x]=d2(l,r,i,n,x,c),m[x]=f2(u,a,i,n,x,c),g[x]=c2(i,x,c);return{begin:p,end:m,strides:g}}function l2(n,e,t,r,a){const i=[...a],l=o2(t,e);for(let u=0;u<i.length;u++)if(l.indexOf(u)>-1)i[u]=0;else{const c=i2(e,t,u);let f=r[c];n&1<<c&&(f=0),i[u]=f}return i}function u2(n,e,t,r,a){const i=[...a],l=o2(t,e);for(let u=0;u<i.length;u++)if(l.indexOf(u)>-1)i[u]=Number.MAX_SAFE_INTEGER;else{const c=i2(e,t,u);let f=r[c];n&1<<c&&(f=Number.MAX_SAFE_INTEGER),i[u]=f}for(let u=0;u<i.length;u++){const c=a[u];i[u]<0&&(i[u]+=c),i[u]=Sd(0,i[u],a[u])}return i}function c2(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function d2(n,e,t,r,a,i){let l=e[a];const u=t[a]||1;(n&1<<a||i&1<<a||l==null)&&(u>0?l=Number.MIN_SAFE_INTEGER:l=Number.MAX_SAFE_INTEGER);const c=r[a];return l<0&&(l+=c),l=Sd(0,l,c-1),l}function f2(n,e,t,r,a,i){let l=e[a];const u=t[a]||1;(n&1<<a||i&1<<a||l==null)&&(u>0?l=Number.MAX_SAFE_INTEGER:l=Number.MIN_SAFE_INTEGER);const c=r[a];return l<0&&(l+=c),u>0?l=Sd(0,l,c):l=Sd(-1,l,c-1),l}function Eg(n,e,t){let r=t.length;for(let a=0;a<t.length;a++)if(t[a]>1){r=a;break}for(let a=r+1;a<t.length;a++)if(e[a]>0||t[a]!==n[a])return!1;return!0}function $g(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function h2(n,e,t){let r;const a=n.shape.length;typeof e=="number"?r=[e,...new Array(a-1).fill(0)]:e.length<a?r=e.concat(new Array(a-e.length).fill(0)):r=e.slice(),r.forEach(l=>{A(l!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(a).fill(-1):typeof t=="number"?i=[t,...new Array(a-1).fill(-1)]:t.length<a?i=t.concat(new Array(a-t.length).fill(-1)):i=t,i=i.map((l,u)=>l>=0?l:(A(l===-1,()=>`Negative size values should be exactly -1 but got ${l} for the slice() size at index ${u}.`),n.shape[u]-r[u])),[r,i]}function p2(n,e,t,r,a,i,l,u,c){let f;if(r==null?(f=new Array(e.length),f.fill(1)):f=r,l!=null&&(l&l-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let p=!1;const m={dims:f.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:f.slice(),beginMask:a,endMask:i,ellipsisMask:l,newAxisMask:u,shrinkAxisMask:c};for(let D=0;D<m.dims;D++)p&&(1<<D&u)!==0&&m.numAddAxisAfterEllipsis++,1<<D&l&&(p=!0);p||(m.ellipsisMask|=1<<m.dims,m.dims++);const g={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};SB(m,g);let x=!0,v=!0,w=!0;const S=[],T=[];for(let D=0;D<n.length;++D){if(g.strides[D]===0)throw Error(`strides[${D}] must be non-zero`);const R=!!(g.shrinkAxisMask&1<<D),I=n[D];if(I===-1){S.push(R?1:-1);continue}const V=[g.beginMask&1<<D,g.endMask&1<<D],j=[g.strides[D]>0?0:-1,g.strides[D]>0?I:I-1];if(R&&g.strides[D]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&g.strides[D]===1;const K=!!(g.beginMask&1<<D&&g.endMask&1<<D);if(g.beginValid&&g.endValid){if(R){const ee=g.begin[D]<0?I+g.begin[D]:g.begin[D];if(g.begin[D]=ee,g.end[D]=g.begin[D]+1,ee<0||ee>=I)throw Error(`slice index ${g.begin[D]} of dimension ${D} out of bounds.`)}else g.begin[D]=cb(g.begin[D],0,g.strides[D],I,V,j),g.end[D]=cb(g.end[D],1,g.strides[D],I,V,j);const k=g.strides[D]===1&&g.begin[D]===0&&g.end[D]===I;x=x&&k,v=v&&(D===0&&g.strides[D]===1||k)}else x=x&&g.strides[D]===1&&K,v=v&&(D===0&&g.strides[D]===1||K);let B,U=!1;if(g.beginValid&&g.endValid?(B=g.end[D]-g.begin[D],U=!0):R?(B=1,U=!0):K&&I>=0&&(g.strides[D]<0?B=-I:B=I,U=!0),U){let k;B===0||B<0!=g.strides[D]<0?k=0:k=Math.trunc(B/g.strides[D])+(B%g.strides[D]!==0?1:0),S.push(k)}else S.push(-1)}for(let D=0;D<g.finalShapeGatherIndices.length;++D){const R=g.finalShapeGatherIndices[D];R>=0?T.push(S[R]):R===Dm&&T.push(1)}return{finalShapeSparse:T.filter((D,R)=>g.finalShapeGatherIndices[R]!==Dm),finalShape:T,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:g.begin,end:g.end,strides:g.strides}}function SB(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const a=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<a;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(Dm),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(bB),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function cb(n,e,t,r,a,i){if(a[e])return t>0?i[e]:i[e+1&1];{const l=n<0?r+n:n;return l<i[0]?i[0]:l>i[1]?i[1]:l}}const wB=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:r2,computeFlatOffset:$g,computeOutShape:a2,getNormalizedAxes:CB,isSliceContinous:Eg,maskToAxes:vB,parseSliceParams:h2,sliceInfo:p2,startForAxis:d2,startIndicesWithElidedDims:l2,stopForAxis:f2,stopIndicesWithElidedDims:u2,stridesForAxis:c2,stridesWithElidedDims:s2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TB=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function NB(){return new Promise(n=>TB(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2(n,e){const t=n[0].length;n.forEach((a,i)=>{A(a.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),A(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((a,i)=>{for(let l=0;l<t;l++)A(l===e||a[l]===r[l],()=>`Error in concat${t}D: Shape of tensors[${i}] (${a}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function Oi(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Vr;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Vr||(Vr={}));function g2(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let a=1;a<t.length;++a){const i=t[a],l=r[r.length-t.length+a],u=r[l];if(i>=0)if(u>=0){if(u!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+n}] = ${i} but shape[${a+n}] = ${u}`)}else r[l]=i}return r}function y2(n){const e={FIRST_DIM_SIZE:Vr.FIRST_DIM_SIZE,VALUE_ROWIDS:Vr.VALUE_ROWIDS,ROW_LENGTHS:Vr.ROW_LENGTHS,ROW_SPLITS:Vr.ROW_SPLITS,ROW_LIMITS:Vr.ROW_LIMITS,ROW_STARTS:Vr.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function x2(n){return n.length===0?0:n[0]===Vr.FIRST_DIM_SIZE?n.length-1:n.length}function b2(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(t,r-1);++a){const i=n[a],l=e[a+1];if(i>=0&&l>=0&&i!==1&&i!==l)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-n.length}] = ${i} but ragged tensor input.flatValues.shape[${a-n.length}] = ${l}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dg=30;function of(n){return n<=Dg?n:sm(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2(n,e,t){const r=t*(typeof n=="number"?n:n[0]),a=e*(typeof n=="number"?n:n[1]);return[r,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rg(n,e,t,r=!0){let a=[];if(r)a=a.concat(e.slice(0)),a.push(n[0]/t),a=a.concat(n.slice(1));else{a=a.concat(n[0]);const i=e.length;for(let l=0;l<i;++l)a=a.concat([n[l+1]/e[l],e[l]]);a=a.concat(n.slice(i+1))}return a}function _g(n,e,t=!0){const r=[];if(t){r.push(e);for(let a=e+1;a<n;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{const a=[],i=[];for(let l=1;l<n;++l)l>=e*2+1||l%2===1?i.push(l):a.push(l);r.push(...a),r.push(0),r.push(...i)}return r}function Og(n,e,t,r=!0){const a=[];r?a.push(n[0]/t):a.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?r?a.push(e[i-1]*n[i]):a.push(n[i]/e[i-1]):a.push(n[i]);return a}function C2(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function S2(n,e,t){const r=n.slice(0,1);for(let a=0;a<t;++a)r.push(n[a+1]-e[a][0]-e[a][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2=1.7580993408473768,T2=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N2=.3275911,E2=.254829592,$2=-.284496736,D2=1.421413741,R2=-1.453152027,_2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rm(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function EB(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function $B(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let a=0;a<n.length;a+=4)t[Math.floor(a/4)]=n[a],r[Math.floor(a/4)]=n[a+1];return{real:t,imag:r}}function DB(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let a=2;a<n.length;a+=4)t[Math.floor(a/4)]=n[a],r[Math.floor(a/4)]=n[a+1];return{real:t,imag:r}}function RB(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function _B(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function OB(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let a=0;a<Math.ceil(n/2);a++){const i=(e?2:-2)*Math.PI*(a/n);t[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:t,imag:r}}function kB(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ap="->",FB=/->/g,db=",",fb="...";function O2(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(FB,"").length)/Ap.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${Ap}").`);const[r,a]=n.split(Ap);A(r.indexOf(fb)===-1,()=>`The ellipsis notation ("${fb}") is not supported yet.`);const i=r.split(db),l=i.length;if(e!==l)throw new Error(`Expected ${l} input tensors, received ${e}`);if(l>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const u=[];for(let g=0;g<a.length;++g){const x=a[g];if(!i.some(v=>v.indexOf(x)!==-1))throw new Error(`Output subscripts contain the label ${x} not present in the input subscripts.`);u.indexOf(x)===-1&&u.push(x)}for(let g=0;g<r.length;++g){const x=r[g];u.indexOf(x)===-1&&x!==db&&u.push(x)}const c=new Array(i.length);for(let g=0;g<l;++g){if(new Set(i[g].split("")).size!==i[g].length)throw new Error(`Found duplicate axes in input component ${i[g]}. Support for duplicate axes in input is not implemented yet.`);c[g]=[];for(let x=0;x<i[g].length;++x)c[g].push(u.indexOf(i[g][x]))}const f=u.length,p=a.length,m=[];for(let g=p;g<f;++g)m.push(g);return{allDims:u,summedDims:m,idDims:c}}function k2(n,e){let t=new Array(n);t.fill(-1);for(let a=0;a<e.length;++a)t[e[a]]=a;const r=[];for(let a=0;a<n;++a)t[a]===-1&&r.push(a);return t=t.filter(a=>a!==-1),{permutationIndices:t,expandDims:r}}function F2(n,e,t){const r=new Array(n);for(let a=0;a<t.length;++a){const i=t[a].shape;for(let l=0;l<e[a].length;++l)r[e[a][l]]===void 0?r[e[a][l]]=i[l]:A(r[e[a][l]]===i[l],()=>`Expected dimension ${r[e[a][l]]} at axis ${l} of input shaped ${JSON.stringify(i)}, but got dimension ${i[l]}`)}}function A2(n,e){const t=n,r=[];let a=0;n.length===0&&t.push(-1),a=n.length+1;for(let l=0;l<a;++l)r.push([]);const i=[];for(let l=0;l<t.length;++l){const u=t[l],c=AB(e,u);for(const f of c)i.indexOf(f)===-1&&(r[l].push(f),i.push(f))}return{path:t,steps:r}}function I2(n){return n.every((e,t)=>e===t)}function AB(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function L2(n,e,t=0){let r=[];if(typeof e=="number")A(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const a=e.reduce((l,u)=>(u===-1&&(l+=1),l),0);A(a<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const l=e.reduce((u,c)=>c>0?u+c:u);e[i]=n.shape[t]-l}A(n.shape[t]===e.reduce((l,u)=>l+u),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function M2(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function U2(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function z2(n,e){return`size ${n} must be non-negative, not ${e}`}function V2(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function G2(n,e){const t=pe(n),r=pe(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function H2(n,e){const t=pe(n),r=pe(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _m(){return"segment ids must be >= 0"}function W2(){return"segment ids are not increasing"}function j2(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function q2(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X2(n,e){let t=!1,r;for(n<=Dg?(r=n,t=!0):r=sm(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=sm(n,r+1);return r}function K2(n,e,t){const r=[],a=n.length;for(let i=0;i<a;i++)i!==e?r.push(n[i]):r.push(t);return r}function Y2(n,e,t,r){const a=e.shape.length,i=n.shape.length;if(r!==0&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let m=0;m<r;++m)if(n.shape[m]!==e.shape[m])throw new Error(`x.shape[${m}]: ${n.shape[m]} should be equal to indices.shape[${m}]: ${e.shape[m]}.`);const l=n.shape[t],u=[];let c=1,f=1,p=1;for(let m=0;m<r;++m)u.push(n.shape[m]),c*=n.shape[m];for(let m=r;m<t;m++)u.push(n.shape[m]),f*=n.shape[m];for(let m=r;m<a;m++)u.push(e.shape[m]);for(let m=t+1;m<i;m++)u.push(n.shape[m]),p*=n.shape[m];return{batchSize:c,sliceSize:p,outerSize:f,dimSize:l,outputShape:u}}const IB=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Y2,computeOutShape:K2,segOpComputeOptimalWindowSize:X2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zo(n){try{return n.map(e=>Mo(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Q2(n){return n.map(e=>xi(e))}const LB=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:E2,ERF_A2:$2,ERF_A3:D2,ERF_A4:R2,ERF_A5:_2,ERF_P:N2,PARALLELIZE_THRESHOLD:Dg,get RowPartitionType(){return Vr},SELU_SCALE:T2,SELU_SCALEALPHA:w2,applyActivation:af,assertAndGetBroadcastShape:We,assertAxesAreInnerMostDims:qr,assertParamsConsistent:m2,assignToTypedArray:_B,axesAreInnerMostDims:fg,calculateShapes:tf,checkEinsumDimSizes:F2,checkPadOnDimRoundingMode:vr,combineLocations:gT,combineRaggedTensorToTensorShapes:g2,complexWithEvenIndex:$B,complexWithOddIndex:DB,computeConv2DInfo:Qn,computeConv3DInfo:Ru,computeDefaultPad:cg,computeDilation2DInfo:oT,computeOptimalWindowSize:of,computeOutAndReduceShapes:ma,computeOutShape:Oi,computePool2DInfo:Ii,computePool3DInfo:Du,convertConv2DDataFormat:jo,decodeEinsumEquation:O2,eitherStridesOrDilationsAreOne:Ln,expandShapeToKeepDim:Zn,exponent:kB,exponents:OB,fromStringArrayToUint8:Q2,fromUint8ToStringArray:zo,getAxesPermutation:Cr,getBroadcastDims:$d,getComplexWithIndex:RB,getEinsumComputePath:A2,getEinsumPermutation:k2,getFusedBiasGradient:rf,getFusedDyActivation:nf,getImageCenter:v2,getInnerMostAxes:Sr,getPermuted:_g,getRaggedRank:x2,getReductionAxes:hT,getReshaped:Rg,getReshapedPermuted:Og,getRowPartitionTypesHelper:y2,getSliceBeginCoords:C2,getSliceSize:S2,getSparseFillEmptyRowsIndicesDenseShapeMismatch:B2,getSparseFillEmptyRowsNegativeIndexErrorMessage:M2,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:U2,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:V2,getSparseReshapeInputOutputMismatchErrorMessage:H2,getSparseReshapeInputOutputMultipleErrorMessage:G2,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:P2,getSparseReshapeNegativeOutputDimErrorMessage:z2,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:q2,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:_m,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:W2,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:j2,getUndoAxesPermutation:hg,isIdentityPermutation:I2,log:OR,mergeRealAndImagArrays:Rm,prepareAndValidate:n2,prepareSplitSize:L2,segment_util:IB,shouldFuse:sf,slice_util:wB,splitRealAndImagArrays:EB,stridesOrDilationsArePositive:Ei,tupleValuesAreOne:pu,upcastType:pa,validateDefaultValueShape:b2,validateInput:Cg,validateUpdateShape:PT,warn:Gr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J4();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BB=Z();BB.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var On;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(On||(On={}));var hb;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(hb||(hb={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MB={};function Z2(n){return MB[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N(n,e,t,r,a){const i=e.inputParams[n];if(i&&i.inputIndexStart!==void 0){const u=i.inputIndexStart,c=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?u+1:i.inputIndexEnd,f=u<0?e.inputNames.length+u:u;if(i.type==="tensor")return Pt(e.inputNames[f],t,r,a);if(i.type==="tensors"){const g=e.inputs.slice(u,c);return e.inputNames.slice(u,c).filter((v,w)=>{var S;return((S=g[w])===null||S===void 0?void 0:S.op)!=="NoOp"}).map(v=>Pt(v,t,r,a))}const p=Pt(e.inputNames[f],t,r,a),m=p.dataSync();return i.type==="number"?m[0]:im(p.shape,m)}const l=e.attrParams[n];return l&&l.value}function Pt(n,e,t,r){const[a,i]=kn(n,t);if(r!=null){const u=r.getHashTableHandleByName(a);if(u!=null)return u}const l=t.currentContextIds.find(u=>!!e[kd(a,u)]);return l!==void 0?e[kd(a,l)][i]:void 0}function pb(n,e,t){return e[kd(n,t.currentContextId)]}function Ia(n,e){const[t,r,a]=kn(n,e);return[kd(t,e&&e.currentContextId),r,a]}function kd(n,e){return e?`${n}-${e}`:n}function kn(n,e){if(n==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const i=e.parseNodeNameCache.get(n);if(i!=null)return i}const r=n.split(":");let a;if(r.length===1)a=[n,0,void 0];else{const i=r[0],l=r.length===3?r[1]:void 0,u=Number(r[r.length-1]);a=[i,u,l]}return t&&e.parseNodeNameCache.set(n,a),a}function yd(n,e,t){let r=N("pad",n,e,t);if(r==="explicit"){r=N("explicitPaddings",n,e,t);const a=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)a[i][0]=r[i*2],a[i][1]=r[i*2+1];return a}return r}function La(n){return n.kept?n:Ss(n)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UB=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],PB=Object.freeze(Object.defineProperty({__proto__:null,json:UB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zB=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],VB=Object.freeze(Object.defineProperty({__proto__:null,json:zB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GB=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],HB=Object.freeze(Object.defineProperty({__proto__:null,json:GB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WB=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],jB=Object.freeze(Object.defineProperty({__proto__:null,json:WB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qB=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],XB=Object.freeze(Object.defineProperty({__proto__:null,json:qB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KB=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],YB=Object.freeze(Object.defineProperty({__proto__:null,json:KB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QB=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],ZB=Object.freeze(Object.defineProperty({__proto__:null,json:QB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JB=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],eM=Object.freeze(Object.defineProperty({__proto__:null,json:JB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tM=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],nM=Object.freeze(Object.defineProperty({__proto__:null,json:tM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rM=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],aM=Object.freeze(Object.defineProperty({__proto__:null,json:rM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sM=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],iM=Object.freeze(Object.defineProperty({__proto__:null,json:sM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oM=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],lM=Object.freeze(Object.defineProperty({__proto__:null,json:oM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uM=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],cM=Object.freeze(Object.defineProperty({__proto__:null,json:uM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dM=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],fM=Object.freeze(Object.defineProperty({__proto__:null,json:dM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hM=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],pM=Object.freeze(Object.defineProperty({__proto__:null,json:hM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mM=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],gM=Object.freeze(Object.defineProperty({__proto__:null,json:mM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yM=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],xM=Object.freeze(Object.defineProperty({__proto__:null,json:yM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bM=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],vM=Object.freeze(Object.defineProperty({__proto__:null,json:bM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CM=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],SM=Object.freeze(Object.defineProperty({__proto__:null,json:CM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mb{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[PB,VB,HB,jB,XB,YB,ZB,eM,nM,aM,iM,lM,cM,fM,pM,gM,xM,vM,SM],t=[].concat(...e.map(r=>r.json));this.opMappers=t.reduce((r,a)=>(r[a.tfOpName]=a,r),{})}transformGraph(e,t={}){const r=e.node,a=[],i=[],l=[],u=r.reduce((w,S)=>(w[S.name]=this.mapNode(S),S.op.startsWith("Placeholder")?a.push(w[S.name]):S.op==="Const"?i.push(w[S.name]):(S.input==null||S.input.length===0)&&l.push(w[S.name]),w),{});let c=[];const f=[];let p={},m={};t!=null&&(p=this.mapSignatureEntries(t.inputs),m=this.mapSignatureEntries(t.outputs));const g=Object.keys(u);g.forEach(w=>{const S=u[w];S.inputNames.forEach((T,$)=>{const[D,,R]=Ia(T),I=u[D];if(I.outputs!=null){const V=I.outputs.indexOf(R);if(V!==-1){const j=`${D}:${V}`;S.inputNames[$]=j}}S.inputs.push(I),I.children.push(S)})}),Object.keys(m).length===0?g.forEach(w=>{const S=u[w];S.children.length===0&&f.push(S)}):Object.keys(m).forEach(w=>{const[S]=Ia(w),T=u[S];T!=null&&(T.signatureKey=m[w],f.push(T))}),Object.keys(p).length>0?Object.keys(p).forEach(w=>{const[S]=Ia(w),T=u[S];T&&(T.signatureKey=p[w],c.push(T))}):c=a;let x={};e.library!=null&&e.library.function!=null&&(x=e.library.function.reduce((w,S)=>(w[S.signature.name]=this.mapFunction(S),w),{}));const v={nodes:u,inputs:c,outputs:f,weights:i,placeholders:a,signature:t,functions:x};return l.length>0&&(v.initNodes=l),v}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,r)=>(t[e[r].name]=r,t),{})}mapNode(e){const t=Z2(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(r.inputParams=t.inputs.reduce((a,i)=>(a[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},a),{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce((a,i)=>{const l=i.type;let u;switch(i.type){case"string":u=Om(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Om(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":u=Mm(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Mm(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":u=Fm(e.attr,i.tfName,i.defaultValue||0),u===void 0&&i.tfDeprecatedName&&(u=Fm(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":u=Bm(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Bm(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":u=km(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=km(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":u=Pm(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Pm(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":u=Lm(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Lm(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":u=Um(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Um(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":u=Am(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Am(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":u=Im(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=Im(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":u=gb(e.attr,i.tfName,i.defaultValue),u===void 0&&i.tfDeprecatedName&&(u=gb(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return a[i.name]={value:u,type:l},a},{})),r}mapFunction(e){const t=e.nodeDef,r=[],a=[];let i={};t!=null&&(i=t.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op==="Const"&&a.push(m[g.name]),m),{}));const l=[],u=[];e.signature.inputArg.forEach(m=>{const[g]=Ia(m.name),x={name:g,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:kg(m.type),type:"dtype"}},children:[]};x.signatureKey=m.name,l.push(x),i[g]=x}),Object.keys(i).forEach(m=>{const g=i[m];g.inputNames.forEach((x,v)=>{const[w,,S]=Ia(x),T=i[w];if(T.outputs!=null){const $=T.outputs.indexOf(S);if($!==-1){const D=`${w}:${$}`;g.inputNames[v]=D}}g.inputs.push(T),T.children.push(g)})});const f=e.ret;e.signature.outputArg.forEach(m=>{const[g,x]=Ia(f[m.name]),v=i[g];v!=null&&(v.defaultOutput=x,u.push(v))});const p=this.mapArgsToSignature(e);return{nodes:i,inputs:l,outputs:u,weights:a,placeholders:r,signature:p}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r),t),{}),outputs:e.signature.outputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t),{})}}mapArgToTensorInfo(e,t){let r=e.name;return t!=null&&(r=t[r]),{name:r,dtype:e.type}}}function wM(n){const e=Z().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function J2(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):wM(n);return e?t:t.toLowerCase()}function Om(n,e,t,r=!1){const a=n[e];return a!=null?J2(a.s,r):t}function km(n,e,t){const r=n[e];return r?r.b:t}function Fm(n,e,t){const r=n[e]||{},a=r.i!=null?r.i:r.f!=null?r.f:t;return typeof a=="number"?a:parseInt(a,10)}function kg(n){switch(typeof n=="string"&&(n=On[n]),n){case On.DT_FLOAT:case On.DT_HALF:return"float32";case On.DT_INT32:case On.DT_INT64:case On.DT_INT8:case On.DT_UINT8:return"int32";case On.DT_BOOL:return"bool";case On.DT_DOUBLE:return"float32";case On.DT_STRING:return"string";case On.DT_COMPLEX64:case On.DT_COMPLEX128:return"complex64";default:return null}}function gb(n,e,t){const r=n[e];return r&&r.func?r.func.name:t}function Am(n,e,t){const r=n[e];return r&&r.type?kg(r.type):t}function Im(n,e,t){const r=n[e];return r&&r.list&&r.list.type?r.list.type.map(a=>kg(a)):t}function eN(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Lm(n,e,t){const r=n[e];return r&&r.shape?eN(r.shape):t}function Bm(n,e,t){const r=n[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):t}function Mm(n,e,t,r=!1){const a=n[e];return a&&a.list&&a.list.s?a.list.s.map(i=>J2(i,r)):t}function Um(n,e,t){const r=n[e];return r&&r.list&&r.list.shape?r.list.shape.map(a=>eN(a)):t}function Pm(n,e,t){const r=n[e];return r&&r.list&&r.list.b?r.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TM{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,i)=>(a[i]=this.getAttr(i),a),{}))}getInput(e){return Pt(e,this.tensorMap,this.context)}getAttr(e,t){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Pt(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return Fm(this.node.rawAttrs,e,t);if(r.s!=null)return Om(this.node.rawAttrs,e,t);if(r.b!=null)return km(this.node.rawAttrs,e,t);if(r.shape!=null)return Lm(this.node.rawAttrs,e,t);if(r.type!=null)return Am(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return Bm(this.node.rawAttrs,e,t);if(r.list.s!=null)return Mm(this.node.rawAttrs,e,t);if(r.list.shape!=null)return Um(this.node.rawAttrs,e,t);if(r.list.b!=null)return Pm(this.node.rawAttrs,e,t);if(r.list.type!=null)return Im(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gt=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:jw,abs:jn,acos:Y_,acosh:Z_,add:Re,addN:eO,all:nO,any:aO,argMax:iO,argMin:lO,asin:cO,asinh:fO,atan:pO,atan2:gO,atanh:xO,avgPool:lT,avgPool3d:EO,basicLSTMCell:FO,batchNorm:Kd,batchNorm2d:MO,batchNorm3d:PO,batchNorm4d:VO,batchToSpaceND:uT,bincount:cT,bitwiseAnd:WO,booleanMaskAsync:O3,broadcastArgs:qO,broadcastTo:cu,buffer:mt,cast:Tt,ceil:YO,clipByValue:ZO,clone:Ss,complex:Es,concat:nn,concat1d:ek,concat2d:dT,concat3d:rk,concat4d:sk,conv1d:lk,conv2d:Yd,conv2dTranspose:dk,conv3d:hk,conv3dTranspose:yk,cos:bk,cosh:Ck,cosineWindow:Sg,cumprod:wk,cumsum:Nk,denseBincount:$k,depthToSpace:Rk,depthwiseConv2d:dg,diag:kk,dilation2d:Ak,div:Qe,divNoNan:Uk,dot:zk,dropout:H3,einsum:_o,elu:mT,enclosingPowerOfTwo:GT,ensureShape:Wk,equal:pT,erf:qk,euclideanNorm:nF,exp:$i,expandDims:Aa,expm1:iF,eye:xT,fft:bg,fill:_u,floor:bT,floorDiv:iT,fused:sL,gather:vT,gatherND:z3,greater:Zd,greaterEqual:CT,ifft:Od,imag:Jd,image:Cu,inTopKAsync:j3,irfft:LT,isFinite:mF,isInf:yF,isNaN:bF,leakyRelu:ST,less:Nm,lessEqual:pg,linalg:M4,linspace:wF,localResponseNormalization:NF,log:gu,log1p:wT,logSigmoid:kF,logSoftmax:IF,logSumExp:NT,logicalAnd:Dd,logicalNot:ET,logicalOr:$T,logicalXor:zF,losses:U4,lowerBound:GF,matMul:et,max:Io,maxPool:DT,maxPool3d:jF,maxPoolWithArgmax:XF,maximum:RT,mean:Rd,meshgrid:QF,min:Tm,minimum:_d,mirrorPad:eA,mod:nA,moments:aA,movingAverage:A3,mul:ve,multiRNNCell:iA,multinomial:lA,neg:ha,norm:Qd,notEqual:_T,oneHot:dA,ones:gi,onesLike:hA,op:M,outerProduct:mA,pad:Ou,pad1d:xA,pad2d:vA,pad3d:SA,pad4d:TA,pool:RA,pow:mu,prelu:kT,print:sT,prod:kA,raggedGather:AA,raggedRange:LA,raggedTensorToTensor:MA,rand:PA,randomGamma:lI,randomNormal:FT,randomStandardNormal:dI,randomUniform:xg,randomUniformInt:pI,range:yu,real:xu,reciprocal:yI,relu:ef,relu6:AT,reshape:oe,reverse:Ri,reverse1d:SI,reverse2d:TI,reverse3d:EI,reverse4d:DI,rfft:vg,round:IT,rsqrt:OI,scalar:ze,scatterND:L3,searchSorted:mg,selu:FI,separableConv2d:II,setdiff1dAsync:BI,sigmoid:bi,sign:UI,signal:B4,sin:zI,sinh:GI,slice:je,slice1d:WI,slice2d:qI,slice3d:KI,slice4d:QI,softmax:JI,softplus:TT,spaceToBatchND:OT,sparse:P4,sparseToDense:U3,spectral:L4,split:bu,sqrt:Ma,square:Hr,squaredDifference:BT,squeeze:vu,stack:Pa,step:MT,stridedSlice:c3,string:z4,sub:Ie,sum:ut,tan:f3,tanh:wm,tensor:fa,tensor1d:An,tensor2d:Lo,tensor3d:UT,tensor4d:h3,tensor5d:p3,tensor6d:m3,tensorScatterUpdate:y3,tile:du,topk:b3,transpose:Em,truncatedNormal:C3,unique:w3,unsortedSegmentSum:N3,unstack:Li,upperBound:$3,variable:D3,where:ws,whereAsync:VT,zeros:Di,zerosLike:Xn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NM=(n,e,t,r=Gt)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(N("a",n,e,t),N("b",n,e,t))];case"AddN":return[r.addN(N("tensors",n,e,t))];case"FloorMod":case"Mod":return[r.mod(N("a",n,e,t),N("b",n,e,t))];case"Mul":return[r.mul(N("a",n,e,t),N("b",n,e,t))];case"RealDiv":case"Div":return[r.div(N("a",n,e,t),N("b",n,e,t))];case"DivNoNan":return[r.divNoNan(N("a",n,e,t),N("b",n,e,t))];case"FloorDiv":return[r.floorDiv(N("a",n,e,t),N("b",n,e,t))];case"Sub":return[r.sub(N("a",n,e,t),N("b",n,e,t))];case"Minimum":return[r.minimum(N("a",n,e,t),N("b",n,e,t))];case"Maximum":return[r.maximum(N("a",n,e,t),N("b",n,e,t))];case"Pow":return[r.pow(N("a",n,e,t),N("b",n,e,t))];case"SquaredDifference":return[r.squaredDifference(N("a",n,e,t),N("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EM=(n,e,t,r=Gt)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(N("x",n,e,t))];case"Acos":return[r.acos(N("x",n,e,t))];case"Acosh":return[r.acosh(N("x",n,e,t))];case"Asin":return[r.asin(N("x",n,e,t))];case"Asinh":return[r.asinh(N("x",n,e,t))];case"Atan":return[r.atan(N("x",n,e,t))];case"Atan2":return[r.atan2(N("x",n,e,t),N("y",n,e,t))];case"Atanh":return[r.atanh(N("x",n,e,t))];case"Ceil":return[r.ceil(N("x",n,e,t))];case"Complex":return[r.complex(N("real",n,e,t),N("imag",n,e,t))];case"Cos":return[r.cos(N("x",n,e,t))];case"Cosh":return[r.cosh(N("x",n,e,t))];case"Elu":return[r.elu(N("x",n,e,t))];case"Erf":return[r.erf(N("x",n,e,t))];case"Exp":return[r.exp(N("x",n,e,t))];case"Expm1":return[r.expm1(N("x",n,e,t))];case"Floor":return[r.floor(N("x",n,e,t))];case"Log":return[r.log(N("x",n,e,t))];case"Log1p":return[r.log1p(N("x",n,e,t))];case"Imag":return[r.imag(N("x",n,e,t))];case"Neg":return[r.neg(N("x",n,e,t))];case"Reciprocal":return[r.reciprocal(N("x",n,e,t))];case"Real":return[r.real(N("x",n,e,t))];case"Relu":return[r.relu(N("x",n,e,t))];case"Round":return[r.round(N("x",n,e,t))];case"Selu":return[r.selu(N("x",n,e,t))];case"Sigmoid":return[r.sigmoid(N("x",n,e,t))];case"Sin":return[r.sin(N("x",n,e,t))];case"Sign":return[r.sign(N("x",n,e,t))];case"Sinh":return[r.sinh(N("x",n,e,t))];case"Softplus":return[r.softplus(N("x",n,e,t))];case"Sqrt":return[r.sqrt(N("x",n,e,t))];case"Square":return[r.square(N("x",n,e,t))];case"Tanh":return[r.tanh(N("x",n,e,t))];case"Tan":return[r.tan(N("x",n,e,t))];case"ClipByValue":return[r.clipByValue(N("x",n,e,t),N("clipValueMin",n,e,t),N("clipValueMax",n,e,t))];case"Relu6":return[r.relu6(N("x",n,e,t))];case"Rsqrt":return[r.rsqrt(Pt(n.inputNames[0],e,t))];case"LeakyRelu":return[r.leakyRelu(N("x",n,e,t),N("alpha",n,e,t))];case"Prelu":return[r.prelu(N("x",n,e,t),N("alpha",n,e,t))];case"IsNan":return[r.isNaN(Pt(n.inputNames[0],e,t))];case"IsInf":return[r.isInf(Pt(n.inputNames[0],e,t))];case"IsFinite":return[r.isFinite(Pt(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){A(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let r=0;r<n.length;r++){const a=n[r],i=e[r];A(a<0||i<0||a===i,()=>t+` Shapes ${n} and ${e} must match`)}}}function yb(n){return!(typeof n=="number"||n.some(e=>e<0))}function tu(n,e,t){let r=zm(n,t);const a=!yb(r);if(a&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&e.forEach(i=>{r=zm(i.shape,r)}),!yb(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function zm(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let r=0;r<n.length;++r){const a=n[r],i=e[r];if(a>=0&&i>=0&&a!==i)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[r]=a>=0?a:i}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $M{constructor(e,t,r,a,i,l,u){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=l,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=ze(0),ca(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),yr(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,ca(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((r,a)=>this.write(r,t[a]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return fa([],[0].concat(this.elementShape));const r=this.readMany(e);return yr(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Pa(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return fa([],[0].concat(this.elementShape));const t=[];for(let a=0;a<this.size();a++)t.push(a);const r=this.readMany(t);return yr(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),nn(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Li(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0;const a=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:t.size/r,l=[];Me(()=>{t=oe(t,[1,r,i]);for(let c=0;c<e.length;++c){const p=[0,c===0?0:a[c-1],0],m=[1,e[c],i];l[c]=oe(je(t,p,m),this.elementShape)}return l});const u=[];for(let c=0;c<e.length;c++)u[c]=c;this.writeMany(u,l)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ki{get id(){return this.idTensor.id}constructor(e,t,r,a=-1){this.tensors=e,this.elementShape=t,this.elementDtype=r,e!=null&&e.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);yr(t,i.shape,"TensorList shape mismatch: "),ca(i)}),this.idTensor=ze(0),this.maxNumElements=a,ca(this.idTensor)}copy(){return new ki([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,r=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);yr(e,this.elementShape,"TensorList shape mismatch: ");const a=tu(this.elementShape,this.tensors,e);return Me(()=>{const i=this.tensors.map(l=>oe(l,a));return Pa(i,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=tu(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,yr(a.shape,e,"TensorList shape mismatch: "),oe(a,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(yr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");ca(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new ki([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)t.tensors[r]=this.tensors[r];return t}getItem(e,t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);yr(this.tensors[e].shape,t,"TensorList shape mismatch: ");const a=tu(this.elementShape,this.tensors,t);return oe(this.tensors[e],a)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);yr(this.elementShape,t.shape,"TensorList shape mismatch: "),ca(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,r){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);yr(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=tu(this.elementShape,this.tensors,r);return e.length===0?fa([],[0].concat(a)):Me(()=>{const i=e.map(l=>oe(this.tensors[l],a));return Pa(i,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);yr(this.elementShape,t,"TensorList shape mismatch: ");const r=tu(this.elementShape,this.tensors,t);return this.size()===0?fa([],[0].concat(r)):Me(()=>{const a=this.tensors.map(i=>oe(i,r));return nn(a,0)})}}function DM(n,e,t){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const a=n.shape.slice(1);yr(a,e,"TensorList shape mismatch: ");const i=Li(n);return new ki(i,e,r)}function RM(n,e,t,r){return new ki([],n,e,r)}function _M(n,e,t,r){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const a=Math.max(...e);if(r!=null&&r!==-1&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);const i=new ki([],t,n.dtype,r),l=Li(n,0);return e.forEach((u,c)=>{i.setItem(u,l[c])}),i}function OM(n,e,t){let r=0;const a=e.map(p=>(r+=p,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);const i=n.shape.slice(1),l=zm(i,t),u=r===0?0:n.size/r,c=Me(()=>{const p=[];n=oe(n,[1,r,u]);for(let m=0;m<e.length;++m){const x=[0,m===0?0:a[m-1],0],v=[1,e[m],u];p[m]=oe(je(n,x,v),l)}return n.dispose(),p}),f=new ki([],t,n.dtype,e.length);for(let p=0;p<c.length;p++)f.setItem(p,c[p]);return f}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kM=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const r=N("thenBranch",n,e,t),a=N("elseBranch",n,e,t),i=N("cond",n,e,t),l=N("args",n,e,t);return(await i.data())[0]?t.functionMap[r].executeFunctionAsync(l,t.tensorArrayMap,t.tensorListMap):t.functionMap[a].executeFunctionAsync(l,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const r=N("body",n,e,t),a=N("cond",n,e,t),i=N("args",n,e,t),l=await t.functionMap[a].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap),u=i.map(p=>p.id);let c=await l[0].data();l.forEach(p=>{!p.kept&&u.indexOf(p.id)===-1&&p.dispose()});let f=i;for(;c[0];){const p=f;f=await t.functionMap[r].executeFunctionAsync(f,t.tensorArrayMap,t.tensorListMap);const m=f.map(x=>x.id);p.forEach(x=>{!x.kept&&u.indexOf(x.id)===-1&&m.indexOf(x.id)===-1&&x.dispose()});const g=await t.functionMap[a].executeFunctionAsync(f,t.tensorArrayMap,t.tensorListMap);c=await g[0].data(),g.forEach(x=>{!x.kept&&u.indexOf(x.id)===-1&&m.indexOf(x.id)===-1&&x.dispose()})}return f}case"LoopCond":{const r=N("pred",n,e,t);return[La(r)]}case"Switch":{const r=N("pred",n,e,t);let a=N("data",n,e,t);return a.kept||(a=La(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=n.inputNames.find(a=>Pt(a,e,t)!==void 0);if(r){const a=Pt(r,e,t);return[La(a)]}return}case"Enter":{const r=N("frameName",n,e,t),a=N("tensor",n,e,t);return t.enterFrame(r),[La(a)]}case"Exit":{const r=N("tensor",n,e,t);return t.exitFrame(),[La(r)]}case"NextIteration":{const r=N("tensor",n,e,t);return t.nextIteration(),[La(r)]}case"TensorArrayV3":{const r=N("size",n,e,t),a=N("dtype",n,e,t),i=N("elementShape",n,e,t),l=N("dynamicSize",n,e,t),u=N("clearAfterRead",n,e,t),c=N("identicalElementShapes",n,e,t),f=N("name",n,e,t),p=new $M(f,a,r,i,c,l,u);return t.addTensorArray(p),[p.idTensor,ze(1)]}case"TensorArrayWriteV3":{const r=N("tensorArrayId",n,e,t),a=N("index",n,e,t),i=N("tensor",n,e,t),l=t.getTensorArray(r.id);return l.write(a,i),[l.idTensor]}case"TensorArrayReadV3":{const r=N("tensorArrayId",n,e,t),a=N("index",n,e,t);return[t.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=N("tensorArrayId",n,e,t),a=N("indices",n,e,t),i=N("dtype",n,e,t);return[t.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{const r=N("tensorArrayId",n,e,t),a=N("indices",n,e,t),i=N("tensor",n,e,t),l=t.getTensorArray(r.id);return l.scatter(a,i),[l.idTensor]}case"TensorArrayConcatV3":{const r=N("tensorArrayId",n,e,t),a=t.getTensorArray(r.id),i=N("dtype",n,e,t);return[a.concat(i)]}case"TensorArraySplitV3":{const r=N("tensorArrayId",n,e,t),a=N("tensor",n,e,t),i=N("lengths",n,e,t),l=t.getTensorArray(r.id);return l.split(i,a),[l.idTensor]}case"TensorArraySizeV3":{const r=N("tensorArrayId",n,e,t),a=t.getTensorArray(r.id);return[ze(a.size(),"int32")]}case"TensorArrayCloseV3":{const r=N("tensorArrayId",n,e,t),a=t.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=N("tensorListId",n,e,t),a=N("index",n,e,t),i=N("tensor",n,e,t),l=t.getTensorList(r.id);return l.setItem(a,i),[l.idTensor]}case"TensorListGetItem":{const r=N("tensorListId",n,e,t),a=N("index",n,e,t),i=N("elementShape",n,e,t),l=N("elementDType",n,e,t);return[t.getTensorList(r.id).getItem(a,i,l)]}case"TensorListScatterV2":case"TensorListScatter":{const r=N("indices",n,e,t),a=N("tensor",n,e,t),i=N("elementShape",n,e,t),l=N("numElements",n,e,t),u=_M(a,r,i,l);return t.addTensorList(u),[u.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=N("elementShape",n,e,t),a=N("elementDType",n,e,t);let i;n.op==="TensorListReserve"?i="numElements":i="maxNumElements";const l=N(i,n,e,t),u=n.op==="TensorListReserve"?-1:l,c=RM(r,a,l,u);return t.addTensorList(c),[c.idTensor]}case"TensorListGather":{const r=N("tensorListId",n,e,t),a=N("indices",n,e,t),i=N("elementShape",n,e,t),l=N("elementDType",n,e,t);return[t.getTensorList(r.id).gather(a,l,i)]}case"TensorListStack":{const r=N("tensorListId",n,e,t),a=N("elementShape",n,e,t),i=N("elementDType",n,e,t),l=N("numElements",n,e,t);return[t.getTensorList(r.id).stack(a,i,l)]}case"TensorListFromTensor":{const r=N("tensor",n,e,t),a=N("elementShape",n,e,t),i=N("elementDType",n,e,t),l=DM(r,a,i);return t.addTensorList(l),[l.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=N("tensorListId",n,e,t),a=t.getTensorList(r.id),i=N("dtype",n,e,t),l=N("elementShape",n,e,t);return[a.concat(i,l)]}case"TensorListPushBack":{const r=N("tensorListId",n,e,t),a=N("tensor",n,e,t),i=t.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{const r=N("tensorListId",n,e,t),a=N("elementShape",n,e,t),i=N("elementDType",n,e,t);return[t.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{const r=N("tensor",n,e,t),a=N("elementShape",n,e,t),i=N("lengths",n,e,t),l=OM(r,i,a);return t.addTensorList(l),[l.idTensor]}case"TensorListLength":{const r=N("tensorListId",n,e,t),a=t.getTensorList(r.id);return[ze(a.size(),"int32")]}case"TensorListResize":{const r=N("tensorListId",n,e,t),a=N("size",n,e,t),l=t.getTensorList(r.id).resize(a);return t.addTensorList(l),[l.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xb(n,e,t){const[r,a]=N("fusedOps",n,e,t),i=r==="biasadd",l=!i,u=a==="prelu",c=r==="fusedbatchnorm",f=N("numArgs",n,e,t);if(i){if(u&&f!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&i&&f!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const p=N("strides",n,e,t),m=yd(n,e,t),g=N("dataFormat",n,e,t).toUpperCase(),x=N("dilations",n,e,t);let[v,w]=N("args",n,e,t);l&&(w=v,v=void 0);const S=N("leakyreluAlpha",n,e,t);return{stride:p,pad:m,dataFormat:g,dilations:x,biasArg:v,preluArg:w,activationFunc:a,leakyreluAlpha:S}}const FM=(n,e,t,r=Gt)=>{switch(n.op){case"Conv1D":{const a=N("stride",n,e,t),i=N("pad",n,e,t),l=N("dataFormat",n,e,t).toUpperCase(),u=N("dilation",n,e,t);return[r.conv1d(N("x",n,e,t),N("filter",n,e,t),a,i,l,u)]}case"Conv2D":{const a=N("strides",n,e,t),i=yd(n,e,t),l=N("dataFormat",n,e,t).toUpperCase(),u=N("dilations",n,e,t);return[r.conv2d(N("x",n,e,t),N("filter",n,e,t),[a[1],a[2]],i,l,[u[1],u[2]])]}case"_FusedConv2D":{const{stride:a,pad:i,dataFormat:l,dilations:u,biasArg:c,preluArg:f,activationFunc:p,leakyreluAlpha:m}=xb(n,e,t);return[r.fused.conv2d({x:N("x",n,e,t),filter:N("filter",n,e,t),strides:[a[1],a[2]],pad:i,dataFormat:l,dilations:[u[1],u[2]],bias:c,activation:p,preluActivationWeights:f,leakyreluAlpha:m})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:i,dataFormat:l,dilations:u,biasArg:c,preluArg:f,activationFunc:p,leakyreluAlpha:m}=xb(n,e,t);return[r.fused.depthwiseConv2d({x:N("x",n,e,t),filter:N("filter",n,e,t),strides:[a[1],a[2]],pad:i,dataFormat:l,dilations:[u[1],u[2]],bias:c,activation:p,preluActivationWeights:f,leakyreluAlpha:m})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=N("outputShape",n,e,t),i=N("strides",n,e,t),l=yd(n,e,t);return[r.conv2dTranspose(N("x",n,e,t),N("filter",n,e,t),a,[i[1],i[2]],l)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=N("strides",n,e,t),i=yd(n,e,t),l=N("dilations",n,e,t),u=N("dataFormat",n,e,t).toUpperCase();return[r.depthwiseConv2d(N("input",n,e,t),N("filter",n,e,t),[a[1],a[2]],i,u,[l[1],l[2]])]}case"Conv3D":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("dataFormat",n,e,t).toUpperCase(),u=N("dilations",n,e,t);return[r.conv3d(N("x",n,e,t),N("filter",n,e,t),[a[1],a[2],a[3]],i,l,[u[1],u[2],u[3]])]}case"AvgPool":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("kernelSize",n,e,t);return[r.avgPool(N("x",n,e,t),[l[1],l[2]],[a[1],a[2]],i)]}case"MaxPool":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("kernelSize",n,e,t);return[r.maxPool(N("x",n,e,t),[l[1],l[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("kernelSize",n,e,t),u=N("includeBatchInIndex",n,e,t),{result:c,indexes:f}=r.maxPoolWithArgmax(N("x",n,e,t),[l[1],l[2]],[a[1],a[2]],i,u);return[c,f]}case"AvgPool3D":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("kernelSize",n,e,t);return[r.avgPool3d(N("x",n,e,t),[l[1],l[2],l[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("kernelSize",n,e,t);return[r.maxPool3d(N("x",n,e,t),[l[1],l[2],l[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{const a=N("strides",n,e,t),i=N("pad",n,e,t),l=N("dilations",n,e,t),u=a[1],c=a[2],f=l[1],p=l[2];return[r.dilation2d(N("x",n,e,t),N("filter",n,e,t),[u,c],i,[f,p],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AM=(n,e,t,r=Gt)=>{switch(n.op){case"Fill":{const a=N("shape",n,e,t),i=N("dtype",n,e,t),l=N("value",n,e,t);return[r.fill(a,l,i)]}case"LinSpace":{const a=N("start",n,e,t),i=N("stop",n,e,t),l=N("num",n,e,t);return[r.linspace(a,i,l)]}case"Multinomial":{const a=N("logits",n,e,t),i=N("numSamples",n,e,t),l=N("seed",n,e,t);return[r.multinomial(a,i,l)]}case"OneHot":{const a=N("indices",n,e,t),i=N("depth",n,e,t),l=N("onValue",n,e,t),u=N("offValue",n,e,t),c=N("dtype",n,e,t);return[r.oneHot(a,i,l,u,c)]}case"Ones":return[r.ones(N("shape",n,e,t),N("dtype",n,e,t))];case"OnesLike":return[r.onesLike(N("x",n,e,t))];case"RandomStandardNormal":return[r.randomStandardNormal(N("shape",n,e,t),N("dtype",n,e,t),N("seed",n,e,t))];case"RandomUniform":return[r.randomUniform(N("shape",n,e,t),N("minval",n,e,t),N("maxval",n,e,t),N("dtype",n,e,t))];case"RandomUniformInt":return[r.randomUniformInt(N("shape",n,e,t),N("minval",n,e,t),N("maxval",n,e,t),N("seed",n,e,t))];case"Range":{const a=N("start",n,e,t),i=N("stop",n,e,t),l=N("step",n,e,t);return[r.range(a,i,l,N("dtype",n,e,t))]}case"TruncatedNormal":{const a=N("shape",n,e,t),i=N("mean",n,e,t),l=N("stdDev",n,e,t),u=N("seed",n,e,t);return[r.truncatedNormal(a,i,l,N("dtype",n,e,t),u)]}case"Zeros":return[r.zeros(N("shape",n,e,t),N("dtype",n,e,t))];case"ZerosLike":return[r.zerosLike(N("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ip(n,e,t){const r=N("boxes",n,e,t),a=N("scores",n,e,t),i=N("maxOutputSize",n,e,t),l=N("iouThreshold",n,e,t),u=N("scoreThreshold",n,e,t),c=N("softNmsSigma",n,e,t);return{boxes:r,scores:a,maxOutputSize:i,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}}const IM=async(n,e,t,r,a=Gt)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:l,maxOutputSize:u,iouThreshold:c,scoreThreshold:f,softNmsSigma:p}=Ip(n,e,t),m=await a.image.nonMaxSuppressionWithScoreAsync(i,l,u,c,f,p);return[m.selectedIndices,m.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:l,maxOutputSize:u,iouThreshold:c,scoreThreshold:f}=Ip(n,e,t),p=N("padToMaxOutputSize",n,e,t),m=await a.image.nonMaxSuppressionPaddedAsync(i,l,u,c,f,p);return[m.selectedIndices,m.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:l,maxOutputSize:u,iouThreshold:c,scoreThreshold:f}=Ip(n,e,t);return[await a.image.nonMaxSuppressionAsync(i,l,u,c,f)]}case"Where":{const i=a.cast(N("condition",n,e,t),"bool"),l=[await a.whereAsync(i)];return i.dispose(),l}case"ListDiff":return a.setdiff1dAsync(N("x",n,e,t),N("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LM=(n,e,t,r=Gt)=>{switch(n.op){case"LowerBound":{const a=N("sortedSequence",n,e,t),i=N("values",n,e,t);return[r.lowerBound(a,i)]}case"TopKV2":{const a=N("x",n,e,t),i=N("k",n,e,t),l=N("sorted",n,e,t),u=r.topk(a,i,l);return[u.values,u.indices]}case"UpperBound":{const a=N("sortedSequence",n,e,t),i=N("values",n,e,t);return[r.upperBound(a,i)]}case"Unique":{const a=N("x",n,e,t),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{const a=N("x",n,e,t),i=N("axis",n,e,t),l=r.unique(a,i);return[l.values,l.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BM=(n,e,t,r=Gt)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const a=N("default",n,e,t);return[Pt(n.name,e,t)||a];case"Placeholder":return[Pt(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const p=N("x",n,e,t);return[La(p)]}case"IdentityN":return N("x",n,e,t).map(p=>La(p));case"Snapshot":const i=N("x",n,e,t);return[La(i)];case"Shape":return[r.tensor1d(N("x",n,e,t).shape,"int32")];case"ShapeN":return N("x",n,e,t).map(p=>r.tensor1d(p.shape));case"Size":return[r.scalar(N("x",n,e,t).size,"int32")];case"Rank":return[r.scalar(N("x",n,e,t).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const l=N("x",n,e,t),u=N("data",n,e,t),c=N("message",n,e,t),f=N("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let p=0;p<u.length;p++)console.log(Array.prototype.slice.call(u[p].dataSync()).slice(0,f));return[l];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MM{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=ze(0),this.tensorMap=new Map,ca(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return ze(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),Me(()=>{const a=Li(t),i=r.length,l=a.length;A(i===l,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${l} elements.`);for(let u=0;u<i;u++){const c=r[u],f=a[u];ca(f),this.tensorMap.set(c,f)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return Me(()=>{const a=[];for(let i=0;i<r.length;i++){const l=r[i],u=this.findWithDefault(l,t);a.push(u)}return Pa(a)})}findWithDefault(e,t){const r=this.tensorMap.get(e);return r??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UM=async(n,e,t,r)=>{switch(n.op){case"HashTable":case"HashTableV2":{const a=r.getHashTableHandleByName(n.name);if(a!=null)return[a];{const i=N("keyDType",n,e,t),l=N("valueDType",n,e,t),u=new MM(i,l);return r.addHashTable(n.name,u),[u.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=N("tableHandle",n,e,t,r),i=N("keys",n,e,t),l=N("values",n,e,t);return[await r.getHashTableById(a.id).import(i,l)]}case"LookupTableFind":case"LookupTableFindV2":{const a=N("tableHandle",n,e,t,r),i=N("keys",n,e,t),l=N("defaultValue",n,e,t);return[await r.getHashTableById(a.id).find(i,l)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=N("tableHandle",n,e,t,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PM=(n,e,t,r=Gt)=>{switch(n.op){case"ResizeBilinear":{const a=N("images",n,e,t),i=N("size",n,e,t),l=N("alignCorners",n,e,t),u=N("halfPixelCenters",n,e,t);return[r.image.resizeBilinear(a,[i[0],i[1]],l,u)]}case"ResizeNearestNeighbor":{const a=N("images",n,e,t),i=N("size",n,e,t),l=N("alignCorners",n,e,t),u=N("halfPixelCenters",n,e,t);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],l,u)]}case"CropAndResize":{const a=N("image",n,e,t),i=N("boxes",n,e,t),l=N("boxInd",n,e,t),u=N("cropSize",n,e,t),c=N("method",n,e,t),f=N("extrapolationValue",n,e,t);return[r.image.cropAndResize(a,i,l,u,c,f)]}case"ImageProjectiveTransformV3":{const a=N("images",n,e,t),i=N("transforms",n,e,t),l=N("outputShape",n,e,t),u=N("fillValue",n,e,t),c=N("interpolation",n,e,t),f=N("fillMode",n,e,t);return[r.image.transform(a,i,c.toLowerCase(),f.toLowerCase(),u,l)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zM=(n,e,t,r=Gt)=>{switch(n.op){case"Equal":return[r.equal(N("a",n,e,t),N("b",n,e,t))];case"NotEqual":return[r.notEqual(N("a",n,e,t),N("b",n,e,t))];case"Greater":return[r.greater(N("a",n,e,t),N("b",n,e,t))];case"GreaterEqual":return[r.greaterEqual(N("a",n,e,t),N("b",n,e,t))];case"Less":return[r.less(N("a",n,e,t),N("b",n,e,t))];case"LessEqual":return[r.lessEqual(N("a",n,e,t),N("b",n,e,t))];case"LogicalAnd":return[r.logicalAnd(N("a",n,e,t),N("b",n,e,t))];case"LogicalNot":return[r.logicalNot(N("a",n,e,t))];case"LogicalOr":return[r.logicalOr(N("a",n,e,t),N("b",n,e,t))];case"Select":case"SelectV2":return[r.where(N("condition",n,e,t),N("a",n,e,t),N("b",n,e,t))];case"BitwiseAnd":return[r.bitwiseAnd(N("a",n,e,t),N("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VM=(n,e,t,r=Gt)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(N("a",n,e,t),N("b",n,e,t),N("transposeA",n,e,t),N("transposeB",n,e,t))];case"Einsum":return[r.einsum(N("equation",n,e,t),...N("tensors",n,e,t))];case"Transpose":return[r.transpose(N("x",n,e,t),N("perm",n,e,t))];case"_FusedMatMul":const[a,i]=N("fusedOps",n,e,t),l=a==="biasadd",u=i==="prelu",c=N("numArgs",n,e,t),f=N("leakyreluAlpha",n,e,t);if(l){if(u&&c!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&c!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[p,m]=N("args",n,e,t);return[r.fused.matMul({a:N("a",n,e,t),b:N("b",n,e,t),transposeA:N("transposeA",n,e,t),transposeB:N("transposeB",n,e,t),bias:p,activation:i,preluActivationWeights:m,leakyreluAlpha:f})];case"MatrixBandPart":return[r.linalg.bandPart(N("a",n,e,t),N("numLower",n,e,t),N("numUpper",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GM=(n,e,t,r=Gt)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(N("x",n,e,t),N("axis",n,e,t),N("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(N("x",n,e,t),N("mean",n,e,t),N("variance",n,e,t),N("offset",n,e,t),N("scale",n,e,t),N("epsilon",n,e,t))];case"FusedBatchNormV3":return[r.batchNorm(N("x",n,e,t),N("mean",n,e,t),N("variance",n,e,t),N("offset",n,e,t),N("scale",n,e,t),N("epsilon",n,e,t))];case"LRN":return[r.localResponseNormalization(N("x",n,e,t),N("radius",n,e,t),N("bias",n,e,t),N("alpha",n,e,t),N("beta",n,e,t))];case"Softmax":return[r.softmax(N("x",n,e,t))];case"LogSoftmax":return[r.logSoftmax(N("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HM=(n,e,t,r=Gt)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:i}=r.raggedGather(N("paramsNestedSplits",n,e,t),N("paramsDenseValues",n,e,t),N("indices",n,e,t),N("outputRaggedRank",n,e,t));return a.concat(i)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:i}=r.raggedRange(N("starts",n,e,t),N("limits",n,e,t),N("splits",n,e,t));return[a,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(N("shape",n,e,t),N("values",n,e,t),N("defaultValue",n,e,t),N("rowPartitionTensors",n,e,t),N("rowPartitionTypes",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WM=(n,e,t,r=Gt)=>{switch(n.op){case"Max":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.max(N("x",n,e,t),u,c)]}case"Mean":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.mean(N("x",n,e,t),u,c)]}case"Min":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.min(N("x",n,e,t),u,c)]}case"Sum":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.sum(N("x",n,e,t),u,c)]}case"All":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.all(N("x",n,e,t),u,c)]}case"Any":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.any(N("x",n,e,t),u,c)]}case"ArgMax":{const u=N("axis",n,e,t);return[r.argMax(N("x",n,e,t),u)]}case"ArgMin":{const u=N("axis",n,e,t);return[r.argMin(N("x",n,e,t),u)]}case"Prod":{const u=N("axis",n,e,t),c=N("keepDims",n,e,t);return[r.prod(N("x",n,e,t),u,c)]}case"Cumprod":{const u=N("axis",n,e,t),c=N("exclusive",n,e,t),f=N("reverse",n,e,t);return[r.cumprod(N("x",n,e,t),u,c,f)]}case"Cumsum":{const u=N("axis",n,e,t),c=N("exclusive",n,e,t),f=N("reverse",n,e,t);return[r.cumsum(N("x",n,e,t),u,c,f)]}case"Bincount":const a=N("x",n,e,t),i=N("weights",n,e,t),l=N("size",n,e,t);return[r.bincount(a,i,l)];case"DenseBincount":{const u=N("x",n,e,t),c=N("weights",n,e,t),f=N("size",n,e,t),p=N("binaryOutput",n,e,t);return[r.denseBincount(u,c,f,p)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jM=(n,e,t,r=Gt)=>{switch(n.op){case"ConcatV2":case"Concat":{const a=N("n",n,e,t),i=N("axis",n,e,t);let l=N("tensors",n,e,t);return l=l.slice(0,a),[r.concat(l,i)]}case"Gather":{const a=N("x",n,e,t),i=N("indices",n,e,t);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{const a=N("axis",n,e,t),i=N("batchDims",n,e,t),l=N("x",n,e,t),u=N("indices",n,e,t);return[r.gather(l,r.cast(u,"int32"),a,i)]}case"Reverse":{const a=N("dims",n,e,t),i=[];for(let u=0;u<a.length;u++)a[u]&&i.push(u);const l=N("x",n,e,t);return[r.reverse(l,i)]}case"ReverseV2":{const a=N("axis",n,e,t),i=N("x",n,e,t);return[r.reverse(i,a)]}case"Slice":{const a=N("begin",n,e,t),i=N("size",n,e,t);return[r.slice(N("x",n,e,t),a,i)]}case"StridedSlice":{const a=N("begin",n,e,t),i=N("end",n,e,t),l=N("strides",n,e,t),u=N("beginMask",n,e,t),c=N("endMask",n,e,t),f=N("ellipsisMask",n,e,t),p=N("newAxisMask",n,e,t),m=N("shrinkAxisMask",n,e,t),g=N("x",n,e,t);return[r.stridedSlice(g,a,i,l,u,c,f,p,m)]}case"Pack":return Me(()=>{const a=N("axis",n,e,t),i=N("tensors",n,e,t),l=i[0].shape,u=r.squeeze(i[0]).shape,c=i.map(f=>{const p=pt(f.shape,l);if(!p&&!pt(r.squeeze(f).shape,u))throw new Error("the input tensors shape does not match");return p?f:r.reshape(f,l)});return[r.stack(c,a)]});case"Unpack":{const a=N("axis",n,e,t),i=N("tensor",n,e,t);return r.unstack(i,a)}case"Tile":{const a=N("reps",n,e,t);return[r.tile(N("x",n,e,t),a)]}case"Split":case"SplitV":{const a=N("axis",n,e,t),i=N("numOrSizeSplits",n,e,t),l=N("x",n,e,t);return r.split(l,i,a)}case"ScatterNd":{const a=N("indices",n,e,t),i=N("values",n,e,t),l=N("shape",n,e,t);return[r.scatterND(a,i,l)]}case"GatherNd":{const a=N("x",n,e,t),i=N("indices",n,e,t);return[r.gatherND(a,i)]}case"SparseToDense":{const a=N("sparseIndices",n,e,t),i=N("outputShape",n,e,t),l=N("sparseValues",n,e,t),u=N("defaultValue",n,e,t);return[r.sparseToDense(a,l,i,l.dtype===u.dtype?u:r.cast(u,l.dtype))]}case"TensorScatterUpdate":{const a=N("indices",n,e,t),i=N("values",n,e,t),l=N("tensor",n,e,t);return[r.tensorScatterUpdate(l,a,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qM=(n,e,t,r=Gt)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:i,emptyRowIndicator:l,reverseIndexMap:u}=r.sparse.sparseFillEmptyRows(N("indices",n,e,t),N("values",n,e,t),N("denseShape",n,e,t),N("defaultValue",n,e,t));return[a,i,l,u]}case"SparseReshape":{const{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(N("inputIndices",n,e,t),N("inputShape",n,e,t),N("newShape",n,e,t));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(N("data",n,e,t),N("indices",n,e,t),N("segmentIds",n,e,t))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(N("data",n,e,t),N("indices",n,e,t),N("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XM=(n,e,t,r=Gt)=>{switch(n.op){case"FFT":return[r.fft(N("x",n,e,t))];case"IFFT":return[r.ifft(N("x",n,e,t))];case"RFFT":return[r.rfft(N("x",n,e,t))];case"IRFFT":return[r.irfft(N("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KM=(n,e,t,r=Gt)=>{switch(n.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(N("input",n,e,t),N("pattern",n,e,t),N("rewrite",n,e,t),N("replaceGlobal",n,e,t))];case"StringNGrams":{const{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(N("data",n,e,t),N("dataSplits",n,e,t),N("separator",n,e,t),N("nGramWidths",n,e,t),N("leftPad",n,e,t),N("rightPad",n,e,t),N("padWidth",n,e,t),N("preserveShortSequences",n,e,t));return[a,i]}case"StringSplit":{const{indices:a,values:i,shape:l}=r.string.stringSplit(N("input",n,e,t),N("delimiter",n,e,t),N("skipEmpty",n,e,t));return[a,i,l]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(N("input",n,e,t),N("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YM=(n,e,t,r=Gt)=>{switch(n.op){case"Cast":return[r.cast(N("x",n,e,t),N("dtype",n,e,t))];case"ExpandDims":{const a=N("axis",n,e,t);return[r.expandDims(N("x",n,e,t),a)]}case"Squeeze":{const a=N("axis",n,e,t);return[r.squeeze(N("x",n,e,t),a)]}case"Reshape":return[r.reshape(N("x",n,e,t),N("shape",n,e,t))];case"EnsureShape":return[r.ensureShape(N("x",n,e,t),N("shape",n,e,t))];case"MirrorPad":return[r.mirrorPad(N("x",n,e,t),N("padding",n,e,t),N("mode",n,e,t))];case"PadV2":case"Pad":return[r.pad(N("x",n,e,t),N("padding",n,e,t),N("constantValue",n,e,t))];case"SpaceToBatchND":{const a=N("blockShape",n,e,t),i=N("paddings",n,e,t);return[r.spaceToBatchND(N("x",n,e,t),a,i)]}case"BatchToSpaceND":{const a=N("blockShape",n,e,t),i=N("crops",n,e,t);return[r.batchToSpaceND(N("x",n,e,t),a,i)]}case"DepthToSpace":{const a=N("blockSize",n,e,t),i=N("dataFormat",n,e,t).toUpperCase();return[r.depthToSpace(N("x",n,e,t),a,i)]}case"BroadcastTo":return[r.broadcastTo(N("x",n,e,t),N("shape",n,e,t))];case"BroadcastArgs":return[r.broadcastArgs(N("s0",n,e,t),N("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bb(n,e,t,r,a=Me){const i=((l,u,c)=>{switch(l.category){case"arithmetic":return a(()=>NM(l,u,c));case"basic_math":return a(()=>EM(l,u,c));case"control":return kM(l,u,c);case"convolution":return a(()=>FM(l,u,c));case"creation":return a(()=>AM(l,u,c));case"dynamic":return IM(l,u,c);case"evaluation":return a(()=>LM(l,u,c));case"image":return a(()=>PM(l,u,c));case"graph":return a(()=>BM(l,u,c));case"logical":return a(()=>zM(l,u,c));case"matrices":return a(()=>VM(l,u,c));case"normalization":return a(()=>GM(l,u,c));case"ragged":return a(()=>HM(l,u,c));case"reduction":return a(()=>WM(l,u,c));case"slice_join":return a(()=>jM(l,u,c));case"sparse":return a(()=>qM(l,u,c));case"spectral":return a(()=>XM(l,u,c));case"string":return a(()=>KM(l,u,c));case"transformation":return a(()=>YM(l,u,c));case"hash_table":return UM(l,u,c,r);case"custom":const f=Z2(l.op);if(f&&f.customExecutor)return f.customExecutor(new TM(l,u,c));throw TypeError(`Custom op ${l.op} is not registered.`);default:throw TypeError(`Unknown op '${l.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Ci(i)?i.then(l=>[].concat(l)):[].concat(i)}class vb{constructor(e={},t={},r={},a={},i){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=a,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cb(n,e,t,r){const a=new Set,i=[];let l=null,u=null;const c=new Set,f=new Set(Object.keys(n).map(g=>kn(g)[0]));r=r||[];const p=new Set(r.map(g=>kn(g.name)[0])),m=[...e];for(;m.length>0;){const g=m.pop();if((fi(g)||aU(g)||sU(g))&&l==null&&(l=g,u=l.children.map(x=>x.name).filter(x=>a.has(x))),a.add(g.name),t[g.name]==null&&!f.has(g.name)&&!p.has(g.name)){if(g.inputs.length===0){i.push(g.name);continue}g.inputs.forEach(x=>{c.has(x.name)||(c.add(x.name),m.push(x))})}}return{inputs:n,outputs:e,usedNodes:a,missingInputs:i,dynamicNode:l,syncInputs:u}}function QM(n,e){const{usedNodes:t,inputs:r}=e,a=Object.keys(r).map(S=>kn(S)[0]).map(S=>n.nodes[S]),i=n.initNodes||[],l=S=>t.has(typeof S=="string"?S:S.name);function u(S){return[...new Map(S.map(T=>[T.name,T])).values()]}const c=u([...a,...n.weights,...i]).filter(l),f=u([...c,...Object.values(n.nodes)]).filter(l),p=new Map(f.map(S=>[S.name,S])),m={};for(const S of f){m[S.name]=m[S.name]||0;for(const T of S.children)l(T)||(m[T.name]=Number.POSITIVE_INFINITY),m[T.name]=(m[T.name]||0)+1}const g=Object.entries(m).filter(([,S])=>S===0).map(([S])=>S),x=[...g];for(;g.length>0;){const S=g.pop(),T=p.get(S);for(const $ of T.children.filter(l))--m[$.name]===0&&(x.push($.name),g.push($.name))}const v=x.map(S=>p.get(S)),w=ZM(v,c);return JM(w,c),w}function ZM(n,e){const t=new Map(n.map(l=>[l.name,l])),r=e.map(l=>l.name),a=new Set(r);for(;r.length>0;){const l=r.pop(),u=t.get(l);for(const c of u.children)!t.has(c.name)||a.has(c.name)||(a.add(c.name),r.push(c.name))}return n.filter(l=>a.has(l.name))}class Yc extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function JM(n,e){const t=new Map(n.map((u,c)=>[u.name,c])),r=new Set(e.map(u=>u.name)),a=u=>r.has(typeof u=="string"?u:u.name),i=new Set(n.map(u=>u.name)),l=u=>i.has(typeof u=="string"?u:u.name);for(const u of n){for(const c of u.children.filter(l)){if(!t.has(c.name))throw new Yc(`Child ${c.name} of node ${u.name} is unreachable.`);if(t.get(u.name)>t.get(c.name))throw new Yc(`Node ${u.name} is scheduled to run after its child ${c.name}.`)}if(!a(u))for(const c of u.inputs){if(!t.has(c.name))throw new Yc(`Input ${c.name} of node ${u.name} is unreachable.`);if(t.get(c.name)>t.get(u.name))throw new Yc(`Node ${u.name} is scheduled to run before its input ${c.name}.`)}}}function eU(n){const e=new Map(n.map((u,c)=>[u.name,c])),t=Number.MAX_SAFE_INTEGER,r=n.map((u,c)=>fi(u)?t:c),a=u=>{const c=r[e.get(u.name)];return c??-1},i=n.map((u,c)=>u.children.map(a).reduce((f,p)=>Math.max(f,p),r[c])),l=new Map;for(let u=0;u<n.length;++u){const c=i[u];if(c===t)continue;const f=n[u],p=n[c];l.has(p.name)||l.set(p.name,[]),l.get(p.name).push(f)}return l}const tU=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),nU=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),rU=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function fi(n){return tU.has(n.op)}function aU(n){return nU.has(n.op)}function sU(n){return rU.has(n.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fd{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(r=>e[r].map(a=>a.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Fd(e.functions[r],this)})}getCompilationKey(e,t){const r=e.map(i=>i.name).sort(),a=t.map(i=>i.name).sort();return r.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,t){const r=Cb(e,t,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:i,syncInputs:l}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${l}]`);if(a.length>0){const f=t.map(m=>m.name),p=Object.keys(e);throw new Error(`Cannot compute the outputs [${f}] from the provided inputs [${p}]. Missing the following inputs: [${a}]`)}const u=QM(this.graph,r),c=eU(u);return{orderedNodes:u,nodeLiveUntilMap:c}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return ca(t),t}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,r])=>[t,this.cloneTensorList(r)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const a=r.map(g=>this.graph.nodes[kn(g)[0]]),i=t.map(g=>kn(g)[0]),l=new Set(i);let u=i.map(g=>this.graph.nodes[g]);u.length===0&&(u=this._outputs);const c=this.getCompilationKey(a,u);let f=this.compiledMap.get(c);f==null&&(f=this.compile(e,u),this.compiledMap.set(c,f));try{this.keepIntermediateTensors=Z().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(g){this.keepIntermediateTensors=!1,console.warn(g.message)}const p={},m={};return Me(()=>{const g=new vb(this.weightMap,p,m,this.functionExecutorMap,this.parseNodeNameCache),x=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(T=>{const[$,D]=kn(T,g),R=[];R[D]=e[T],x[$]=R,this.keepIntermediateTensors&&(this.clonedTensorsMap[$]=this.cloneTensorList(R))});const v=this.getFrozenTensorIds(x),{orderedNodes:w,nodeLiveUntilMap:S}=f;for(const T of w){if(x[T.name])continue;const $=bb(T,x,g,this._resourceManager);if(Ci($))throw new Error(`The execution of the op '${T.op}' returned a promise. Please use model.executeAsync() instead.`);x[T.name]=$,this.keepIntermediateTensors&&(this.clonedTensorsMap[T.name]=this.cloneTensorList($)),this.checkTensorForDisposalWithNodeLiveUntilInfo(T,x,g,v,l,S.get(T.name))}return this.parent==null&&g.dispose(v),t.map(T=>Pt(T,x,g))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(a=>a.id)));return new Set(t)}checkTensorForDisposal(e,t,r,a,i,l,u){if(!(fi(t)||l.has(e))){for(const c of r[e])c!=null&&(u[c.id]=(u[c.id]||0)+t.children.length);for(const c of t.inputs){if(fi(c))continue;const f=pb(c.name,r,a);if(f!=null)for(const p of f){if(!p||p.kept||i.has(p.id))continue;const m=u[p.id];m===1?(p.dispose(),delete u[p.id]):m!=null&&u[p.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,r,a,i,l){function u(c){return fi(c)||i.has(c.name)}if(!(fi(e)||l==null))for(const c of l){if(u(c))continue;const f=pb(c.name,t,r);for(const p of f)!p||p.kept||a.has(p.id)||p.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,r=!1,a={},i={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Z().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(g){this.keepIntermediateTensors=!1,console.warn(g.message)}const l=new vb(this.weightMap,a,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const u=await this.executeWithControlFlow(e,l,t,r),c=t.map(g=>Pt(g,u,l)),f=c.map(g=>g.id),p=Object.keys(e).map(g=>e[g].id),m=new Set([...f,...p,...this.weightIds]);return Object.values(u).forEach(g=>{g.forEach(x=>{x&&!x.isDisposed&&!m.has(x.id)&&x.dispose()})}),this.parent==null&&l.dispose(m),c}async executeFunctionAsync(e,t,r){const a=e.reduce((i,l,u)=>(i[this.inputs[u].name]=l,i),{});return this._executeAsync(a,this.outputNodes,!0,t,r)}async executeWithControlFlow(e,t,r,a){const i=Object.keys(e),l=i.map(R=>this.graph.nodes[kn(R)[0]]),u=r.map(R=>kn(R)[0]),c=new Set(u);let f=u.map(R=>this.graph.nodes[R]);f.length===0&&(f=this._outputs);const{usedNodes:p,missingInputs:m,dynamicNode:g,syncInputs:x}=Cb(e,f,this.weightMap,this._initNodes),v=[...l,...this.graph.weights,...this._initNodes||[]].map(R=>({node:R,contexts:t.currentContext})),w=Object.assign({},this.weightMap);Object.keys(e).forEach(R=>{const[I,V]=kn(R),j=[];j[V]=e[R],w[I]=j});const S={},T=this.getFrozenTensorIds(w),$={};for(;v.length>0;){const R=this.processStack(l,v,t,w,$,T,c,S,p);await Promise.all(R)}g==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const D=f.filter(R=>!fi(R)&&!Pt(R.name,w,t)).map(R=>R.name);if(D.length>0){let R="";throw g!=null&&(R=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${x}]`),new Error(`Cannot compute the outputs [${D}] from the provided inputs [${i}]. Consider providing the following inputs: [${m}]. ${R}`)}return w}processStack(e,t,r,a,i,l,u,c,f){const p=[];for(;t.length>0;){const m=t.pop();r.currentContext=m.contexts;let g="";if(m.node.op==="Enter"&&N("isConstant",m.node,a,r)&&([g]=Ia(m.node.name,r)),a[m.node.name]==null){const x=bb(m.node,a,r,this._resourceManager);g||([g]=Ia(m.node.name,r));const v=r.currentContext;Ci(x)?p.push(x.then(w=>(a[g]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[g]=this.cloneTensorList(w)),r.currentContext=v,this.checkTensorForDisposal(g,m.node,a,r,l,u,c),this.processChildNodes(m.node,t,r,a,i,f),w))):(a[g]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[g]=this.cloneTensorList(x)),this.checkTensorForDisposal(g,m.node,a,r,l,u,c),this.processChildNodes(m.node,t,r,a,i,f))}else this.processChildNodes(m.node,t,r,a,i,f)}return p}processChildNodes(e,t,r,a,i,l){e.children.forEach(u=>{const[c]=Ia(u.name,r);i[c]||!l.has(u.name)||(u.op==="Merge"?u.inputNames.some(f=>!!Pt(f,a,r))&&(i[c]=!0,t.push({contexts:r.currentContext,node:u})):u.inputNames.every(f=>!!Pt(f,a,r))&&(i[c]=!0,t.push({contexts:r.currentContext,node:u})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const r=e[t],[a]=kn(t),i=this.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){const l=i.attrParams.shape.value,u=l.length===r.shape.length&&r.shape.every((c,f)=>l[f]===-1||l[f]===c);A(u,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${l}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&A(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var t,r;const a={};for(const i in e){const l=(r=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||r===void 0?void 0:r[i];l!=null?a[l.name]=e[i]:a[i]=e[i]}return a}checkInputs(e){const t=Object.keys(e).filter(r=>{const[a]=kn(r);return this.graph.nodes[a]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var r,a;const i=(a=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||a===void 0?void 0:a[t];return i!=null?i.name:t},{})}checkOutputs(e){e.forEach(t=>{const[r]=kn(t);if(!this.graph.nodes[r])throw new Error(`The output '${t}' is not found in the graph`)})}}class iU{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oU="?tfjs-format=file",lU="model.json";class uU{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},r=t2){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=r,t==null&&(this.loadOptions={}),this.resourceManager=new iU}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ci(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await Kw(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const r=this.artifacts.modelTopology;let a=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(a=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=a,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new Fd(mb.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=mb.Instance.transformGraph(e.modelInitializer);this.initializer=new Fd(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof Ut?[e]:e,r={};return t.forEach((a,i)=>r[this.structuredOutputKeys[i]]=a),r}return e}predict(e,t){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,t){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var t;if(!(e instanceof Ut)&&!Array.isArray(e)){const i=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(i!=null)for(const l in i){const u=i[l];u.resourceId!=null&&(e[l]=this.resourceIdToCapturedInput[u.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let a=0;return this.inputNodes.reduce((i,l)=>{var u,c,f;const p=(f=(c=(u=this.signature)===null||u===void 0?void 0:u.inputs)===null||c===void 0?void 0:c[l])===null||f===void 0?void 0:f.resourceId;return p!=null?i[l]=this.resourceIdToCapturedInput[p]:i[l]=e[a++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,r=Object.keys(t);for(let a=0;a<r.length;a++){const i=r[a],l=t[i];this.resourceIdToCapturedInput[l.resourceId]=e[a]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,r)=>(t[r]=[e[r]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&vn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function tN(n,e={},t=t2){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=cU(n));const r=new uU(n,e,t);return await r.load(),r}function cU(n){return n.endsWith("/")||(n=n+"/"),`${n}${lU}${oU}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function Ds(n,e,t,r){return new(t||(t=Promise))(function(a,i){function l(f){try{c(r.next(f))}catch(p){i(p)}}function u(f){try{c(r.throw(f))}catch(p){i(p)}}function c(f){var p;f.done?a(f.value):(p=f.value,p instanceof t?p:new t(function(m){m(p)})).then(l,u)}c((r=r.apply(n,[])).next())})}function Rs(n,e){var t,r,a,i,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(c){return function(f){return function(p){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,p[0]&&(l=0)),l;)try{if(t=1,r&&(a=2&p[0]?r.return:p[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,p[1])).done)return a;switch(r=0,a&&(p=[2&p[0],a.value]),p[0]){case 0:case 1:a=p;break;case 4:return l.label++,{value:p[1],done:!1};case 5:l.label++,r=p[1],p=[0];continue;case 7:p=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!((a=a.length>0&&a[a.length-1])||p[0]!==6&&p[0]!==2)){l=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){l.label=p[1];break}if(p[0]===6&&l.label<a[1]){l.label=a[1],a=p;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(p);break}a[2]&&l.ops.pop(),l.trys.pop();continue}p=e.call(n,l)}catch(m){p=[6,m],r=0}finally{t=a=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([c,f])}}}function To(n,e,t){if(t||arguments.length===2)for(var r,a=0,i=e.length;a<i;a++)!r&&a in e||(r||(r=Array.prototype.slice.call(e,0,a)),r[a]=e[a]);return n.concat(r||Array.prototype.slice.call(e))}function Fg(n){return[Math.abs(n.endPoint[0]-n.startPoint[0]),Math.abs(n.endPoint[1]-n.startPoint[1])]}function Ad(n){return[n.startPoint[0]+(n.endPoint[0]-n.startPoint[0])/2,n.startPoint[1]+(n.endPoint[1]-n.startPoint[1])/2]}function Sb(n,e){e===void 0&&(e=1.5);var t=Ad(n),r=Fg(n),a=[e*r[0]/2,e*r[1]/2];return{startPoint:[t[0]-a[0],t[1]-a[1]],endPoint:[t[0]+a[0],t[1]+a[1]],palmLandmarks:n.palmLandmarks}}function wb(n){var e=Ad(n),t=Fg(n),r=Math.max.apply(Math,t)/2;return{startPoint:[e[0]-r,e[1]-r],endPoint:[e[0]+r,e[1]+r],palmLandmarks:n.palmLandmarks}}function Tb(n,e){var t=[n.endPoint[0]-n.startPoint[0],n.endPoint[1]-n.startPoint[1]],r=[t[0]*e[0],t[1]*e[1]];return{startPoint:[n.startPoint[0]+r[0],n.startPoint[1]+r[1]],endPoint:[n.endPoint[0]+r[0],n.endPoint[1]+r[1]],palmLandmarks:n.palmLandmarks}}var dU=function(){function n(e,t,r,a,i,l){this.model=e,this.width=t,this.height=r,this.iouThreshold=i,this.scoreThreshold=l,this.anchors=a.map(function(u){return[u.x_center,u.y_center]}),this.anchorsTensor=Lo(this.anchors),this.inputSizeTensor=An([t,r]),this.doubleInputSizeTensor=An([2*t,2*r])}return n.prototype.normalizeBoxes=function(e){var t=this;return Me(function(){var r=je(e,[0,0],[-1,2]),a=je(e,[0,2],[-1,2]),i=Re(Qe(r,t.inputSizeTensor),t.anchorsTensor),l=Qe(a,t.doubleInputSizeTensor),u=ve(Ie(i,l),t.inputSizeTensor),c=ve(Re(i,l),t.inputSizeTensor);return dT([u,c],1)})},n.prototype.normalizeLandmarks=function(e,t){var r=this;return Me(function(){var a=Re(Qe(oe(e,[-1,7,2]),r.inputSizeTensor),r.anchors[t]);return ve(a,r.inputSizeTensor)})},n.prototype.getBoundingBoxes=function(e){return Ds(this,void 0,void 0,function(){var t,r,a,i,l,u,c,f,p,m,g,x,v,w,S,T=this;return Rs(this,function($){switch($.label){case 0:return t=Me(function(){return ve(Ie(e,.5),2)}),og()==="webgl"?(a=Z().get("WEBGL_PACK_DEPTHWISECONV"),Z().set("WEBGL_PACK_DEPTHWISECONV",!0),r=this.model.predict(t),Z().set("WEBGL_PACK_DEPTHWISECONV",a)):r=this.model.predict(t),i=vu(r),l=Me(function(){return vu(bi(je(i,[0,0],[-1,1])))}),u=je(i,[0,1],[-1,4]),c=this.normalizeBoxes(u),f=console.warn,console.warn=function(){},p=Cu.nonMaxSuppression(c,l,1,this.iouThreshold,this.scoreThreshold),console.warn=f,[4,p.array()];case 1:return m=$.sent(),g=[t,r,p,i,c,u,l],m.length===0?(g.forEach(function(D){return D.dispose()}),[2,null]):(x=m[0],v=je(c,[x,0],[1,-1]),w=je(i,[x,5],[1,14]),S=Me(function(){return oe(T.normalizeLandmarks(w,x),[-1,2])}),g.push(w),g.forEach(function(D){return D.dispose()}),[2,{boxes:v,palmLandmarks:S}])}})})},n.prototype.estimateHandBounds=function(e){return Ds(this,void 0,void 0,function(){var t,r,a,i,l,u,c,f,p=this;return Rs(this,function(m){switch(m.label){case 0:return t=e.shape[1],r=e.shape[2],a=Me(function(){return Qe(Cu.resizeBilinear(e,[p.width,p.height]),255)}),[4,this.getBoundingBoxes(a)];case 1:return(i=m.sent())===null?(a.dispose(),[2,null]):(l=i.boxes.arraySync(),u=l[0].slice(0,2),c=l[0].slice(2,4),f=i.palmLandmarks.arraySync(),a.dispose(),i.boxes.dispose(),i.palmLandmarks.dispose(),[2,(g={startPoint:u,endPoint:c,palmLandmarks:f},x=[r/this.width,t/this.height],{startPoint:[g.startPoint[0]*x[0],g.startPoint[1]*x[1]],endPoint:[g.endPoint[0]*x[0],g.endPoint[1]*x[1]],palmLandmarks:g.palmLandmarks.map(function(v){return[v[0]*x[0],v[1]*x[1]]})})])}var g,x})})},n}(),Lp={thumb:[1,2,3,4],indexFinger:[5,6,7,8],middleFinger:[9,10,11,12],ringFinger:[13,14,15,16],pinky:[17,18,19,20],palmBase:[0]};function fU(n,e){var t,r=Math.PI/2-Math.atan2(-(e[1]-n[1]),e[0]-n[0]);return(t=r)-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}var Nb=function(n,e){return[[1,0,n],[0,1,e],[0,0,1]]};function yi(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function hU(n,e){for(var t=[],r=0;r<n.length;r++)t.push(n[r][e]);return t}function Eb(n,e){for(var t=[],r=n.length,a=0;a<r;a++){t.push([]);for(var i=0;i<r;i++)t[a].push(yi(n[a],hU(e,i)))}return t}function $b(n,e){var t=Math.cos(n),r=Math.sin(n),a=[[t,-r,0],[r,t,0],[0,0,1]],i=Eb(Nb(e[0],e[1]),a);return Eb(i,Nb(-e[0],-e[1]))}function Db(n,e){return[yi(n,e[0]),yi(n,e[1])]}var pU=[0,-.4],mU=[0,-.1],Rb=[0,5,9,13,17,1,2],gU=function(){function n(e,t,r,a,i,l){this.boundingBoxDetector=e,this.meshDetector=t,this.meshWidth=r,this.meshHeight=a,this.maxContinuousChecks=i,this.detectionConfidence=l,this.regionsOfInterest=[],this.runsWithoutHandDetector=0,this.maxHandsNumber=1}return n.prototype.getBoxForPalmLandmarks=function(e,t){var r=e.map(function(a){return Db(To(To([],a,!0),[1],!1),t)});return Sb(wb(Tb(this.calculateLandmarksBoundingBox(r),pU)),3)},n.prototype.getBoxForHandLandmarks=function(e){for(var t=Sb(wb(Tb(this.calculateLandmarksBoundingBox(e),mU)),1.65),r=[],a=0;a<Rb.length;a++)r.push(e[Rb[a]].slice(0,2));return t.palmLandmarks=r,t},n.prototype.transformRawCoords=function(e,t,r,a){var i,l,u,c,f=this,p=Fg(t),m=[p[0]/this.meshWidth,p[1]/this.meshHeight],g=e.map(function($){return[m[0]*($[0]-f.meshWidth/2),m[1]*($[1]-f.meshHeight/2),$[2]]}),x=$b(r,[0,0]),v=g.map(function($){return To(To([],Db($,x),!0),[$[2]],!1)}),w=(l=[[(i=a)[0][0],i[1][0]],[i[0][1],i[1][1]]],u=[i[0][2],i[1][2]],c=[-yi(l[0],u),-yi(l[1],u)],[l[0].concat(c[0]),l[1].concat(c[1]),[0,0,1]]),S=To(To([],Ad(t),!0),[1],!1),T=[yi(S,w[0]),yi(S,w[1])];return v.map(function($){return[$[0]+T[0],$[1]+T[1],$[2]]})},n.prototype.estimateHand=function(e){return Ds(this,void 0,void 0,function(){var t,r,a,i,l,u,c,f,p,m,g,x,v,w,S,T,$,D,R,I;return Rs(this,function(V){switch(V.label){case 0:return(t=this.shouldUpdateRegionsOfInterest())!==!0?[3,2]:[4,this.boundingBoxDetector.estimateHandBounds(e)];case 1:return(r=V.sent())===null?(e.dispose(),this.regionsOfInterest=[],[2,null]):(this.updateRegionsOfInterest(r,!0),this.runsWithoutHandDetector=0,[3,3]);case 2:this.runsWithoutHandDetector++,V.label=3;case 3:return a=this.regionsOfInterest[0],i=fU(a.palmLandmarks[0],a.palmLandmarks[2]),l=Ad(a),u=[l[0]/e.shape[2],l[1]/e.shape[1]],c=Cu.rotateWithOffset(e,i,0,u),f=$b(-i,l),p=t===!0?this.getBoxForPalmLandmarks(a.palmLandmarks,f):a,m=function(j,K,B){var U=K.shape[1],k=K.shape[2],ee=[[j.startPoint[1]/U,j.startPoint[0]/k,j.endPoint[1]/U,j.endPoint[0]/k]];return Cu.cropAndResize(K,ee,[0],B)}(p,c,[this.meshWidth,this.meshHeight]),g=Qe(m,255),m.dispose(),c.dispose(),og()==="webgl"?(v=Z().get("WEBGL_PACK_DEPTHWISECONV"),Z().set("WEBGL_PACK_DEPTHWISECONV",!0),x=this.meshDetector.predict(g),Z().set("WEBGL_PACK_DEPTHWISECONV",v)):x=this.meshDetector.predict(g),w=x[0],S=x[1],g.dispose(),T=w.dataSync()[0],w.dispose(),T<this.detectionConfidence?(S.dispose(),this.regionsOfInterest=[],[2,null]):($=oe(S,[-1,3]),D=$.arraySync(),S.dispose(),$.dispose(),R=this.transformRawCoords(D,p,i,f),I=this.getBoxForHandLandmarks(R),this.updateRegionsOfInterest(I,!1),[2,{landmarks:R,handInViewConfidence:T,boundingBox:{topLeft:I.startPoint,bottomRight:I.endPoint}}])}})})},n.prototype.calculateLandmarksBoundingBox=function(e){var t=e.map(function(a){return a[0]}),r=e.map(function(a){return a[1]});return{startPoint:[Math.min.apply(Math,t),Math.min.apply(Math,r)],endPoint:[Math.max.apply(Math,t),Math.max.apply(Math,r)]}},n.prototype.updateRegionsOfInterest=function(e,t){if(t)this.regionsOfInterest=[e];else{var r=this.regionsOfInterest[0],a=0;if(r!=null&&r.startPoint!=null){var i=e.startPoint,l=i[0],u=i[1],c=e.endPoint,f=c[0],p=c[1],m=r.startPoint,g=m[0],x=m[1],v=r.endPoint,w=v[0],S=v[1],T=Math.max(l,g),$=Math.max(u,x),D=(Math.min(f,w)-T)*(Math.min(p,S)-$);a=D/((f-l)*(p-u)+(w-g)*(S-u)-D)}this.regionsOfInterest[0]=a>.8?r:e}},n.prototype.shouldUpdateRegionsOfInterest=function(){return this.regionsOfInterest.length!==this.maxHandsNumber||this.runsWithoutHandDetector>=this.maxContinuousChecks},n}();function yU(){return Ds(this,void 0,void 0,function(){return Rs(this,function(n){return[2,tN("https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1",{fromTFHub:!0})]})})}function xU(){return Ds(this,void 0,void 0,function(){return Rs(this,function(n){return[2,tN("https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1",{fromTFHub:!0})]})})}function bU(){return Ds(this,void 0,void 0,function(){return Rs(this,function(n){return[2,VR("https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file").then(function(e){return e.json()})]})})}function vU(n){var e={},t=e.maxContinuousChecks,r=t===void 0?1/0:t,a=e.detectionConfidence,i=a===void 0?.8:a,l=e.iouThreshold,u=l===void 0?.3:l,c=e.scoreThreshold,f=c===void 0?.5:c;return Ds(this,void 0,void 0,function(){var p,m,g,x,v,w;return Rs(this,function(S){switch(S.label){case 0:return[4,Promise.all([bU(),yU(),xU()])];case 1:return p=S.sent(),m=p[0],g=p[1],x=p[2],v=new dU(g,256,256,m,u,f),w=new gU(v,x,256,256,r,i),[2,new CU(w)]}})})}var CU=function(){function n(e){this.pipeline=e}return n.getAnnotations=function(){return Lp},n.prototype.estimateHands=function(e,t){return t===void 0&&(t=!1),Ds(this,void 0,void 0,function(){var r,a,i,l,u,c,f,p,m;return Rs(this,function(g){switch(g.label){case 0:return r=function(x){return x instanceof Ut?[x.shape[0],x.shape[1]]:[x.height,x.width]}(e),a=r[1],i=Me(function(){return e instanceof Ut||(e=xB(e)),Aa(Tt(e,"float32"))}),[4,this.pipeline.estimateHand(i)];case 1:if(l=g.sent(),i.dispose(),l===null)return[2,[]];for(u=l,t===!0&&(u=function(x,v){var w=x.handInViewConfidence,S=x.landmarks,T=x.boundingBox;return{handInViewConfidence:w,landmarks:S.map(function($){return[v-1-$[0],$[1],$[2]]}),boundingBox:{topLeft:[v-1-T.topLeft[0],T.topLeft[1]],bottomRight:[v-1-T.bottomRight[0],T.bottomRight[1]]}}}(l,a)),c={},f=0,p=Object.keys(Lp);f<p.length;f++)m=p[f],c[m]=Lp[m].map(function(x){return u.landmarks[x]});return[2,[{handInViewConfidence:u.handInViewConfidence,boundingBox:u.boundingBox,landmarks:u.landmarks,annotations:c}]]}})})},n}();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hi={},Qc={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function SU(n,e){hi[n]=e}function Wr(n,e){if(!(n in hi)||e!=null){const r=TU(n,e);if(r!==null)hi[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=hi[n];return t==null||t.isContextLost()?(delete hi[n],Wr(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),hi[n])}function wU(n){if(!Z().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function TU(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??wU(n);return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete hi[n]},!1),Z().getBool("SOFTWARE_WEBGL_ENABLED")&&(Qc.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Qc)||t.getContext("experimental-webgl",Qc):t.getContext("webgl2",Qc)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Su;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Su||(Su={}));var qn;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(qn||(qn={}));var zt;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(zt||(zt={}));function ku(n,e){return[e,n]}function NU(n,e){return n*e}function Zc(n){const e=pe(n),t=Math.ceil(e/4);return rm(t)}function Xo(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function EU(n,e){const[t,r]=Xo(n,e);return t*r*4}function Ag(n,e){const t=n;let r,a,i,l,u,c,f,p,m,g;return Z().getNumber("WEBGL_VERSION")===2?(r=t.R32F,a=t.R16F,i=t.RGBA16F,l=t.RGBA32F,u=t.RED,f=4,p=1,m=t.HALF_FLOAT,g=t.FLOAT,c=t.RGBA8):(r=n.RGBA,a=n.RGBA,i=n.RGBA,l=t.RGBA,u=n.RGBA,f=4,p=4,m=e!=null?e.HALF_FLOAT_OES:null,g=n.FLOAT,c=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:l,textureFormatFloat:u,downloadTextureFormat:c,downloadUnpackNumChannels:f,defaultNumChannels:p,textureTypeHalfFloat:m,textureTypeFloat:g}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(n,e){const t=e();return Z().getBool("DEBUG")&&$U(n),t}function $U(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+OU(n,e))}const DU=596e-10,RU=65504;function _U(n){return!!(Z().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||DU<Math.abs(n)&&Math.abs(n)<RU)}function OU(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Jc(n,e){return Ga(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function kU(n,e){const t=Ga(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ce(n,()=>n.shaderSource(t,e)),Ce(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function FU(n,e){const t=Ga(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ce(n,()=>n.shaderSource(t,e)),Ce(n,()=>n.compileShader(t)),Z().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw nN(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const AU=/ERROR: [0-9]+:([0-9]+):/g;function nN(n,e){const t=AU.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],a=n.split(`
`),i=a.length.toString().length+2,l=a.map((m,g)=>ko((g+1).toString(),i)+m);let u=0;for(let m=0;m<l.length;m++)u=Math.max(l[m].length,u);const c=l.slice(0,r-1),f=l.slice(r-1,r),p=l.slice(r);console.log(c.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${ko(f[0],u)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join(`
`))}function IU(n){return Ga(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function LU(n,e){if(Ce(n,()=>n.linkProgram(e)),!Z().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Bp(n,e){if(Ce(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function BU(n,e){const t=Ga(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ce(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),Ce(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function MU(n,e){const t=Ga(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ce(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),Ce(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function UU(n){return Ga(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function PU(n,e){const t=Z().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,a=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function zU(n){return Ga(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function _b(n,e,t,r,a,i,l){const u=n.getAttribLocation(e,t);return u===-1?!1:(Ce(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),Ce(n,()=>n.vertexAttribPointer(u,a,n.FLOAT,!1,i,l)),Ce(n,()=>n.enableVertexAttribArray(u)),!0)}function VU(n,e,t){qU(n,t),Ce(n,()=>n.activeTexture(n.TEXTURE0+t)),Ce(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function GU(n,e,t){return Ga(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function HU(n,e,t){return n.getUniformLocation(e,t)}function WU(n,e,t,r){Ce(n,()=>VU(n,e,r)),Ce(n,()=>n.uniform1i(t,r))}function Mp(n,e,t){Ce(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Ce(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function Ob(n,e){Ce(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Ce(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function ed(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+jU(n,e))}function jU(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ga(n,e,t){const r=Ce(n,()=>e());if(r==null)throw new Error(t);return r}function qU(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const a=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${a}.`)}}function Vo(n,e=2){return pe(n.slice(0,n.length-e))}function Go(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function td(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Vo(n),...Go(n)]),e}function XU(n,e=!1){let t=Z().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Z().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Z().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((u,c)=>c>=n.length-2?Jm(n[c]):n[c]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=_s(n).newShape);let a=pe(n),i=null;n.length<=1&&a<=t?i=[1,a]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const l=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||l)if(e){const u=Vo(n);let c=2,f=2;n.length&&([c,f]=Go(n)),a=u*(c/2)*(f/2),i=rm(a).map(p=>p*2)}else i=rm(a);return i}function nd(n){return n%2===0}function Id(n,e){if(n=n.slice(-2),e=e.slice(-2),pt(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],r=e[e.length-1];if(t===r||nd(t)&&nd(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&nd(n[0])&&nd(e[0])}let Up,Pp;function KU(n){if(Up==null){const e=Wr(n);Up=e.getParameter(e.MAX_TEXTURE_SIZE)}return Up}function YU(n){if(Pp==null){const e=Wr(n);Pp=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Pp)}function QU(n){if(n===0)return 0;let e;const t=Wr(n);return xr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:xr(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function xr(n,e){return n.getExtension(e)!=null}function kb(n){try{if(Wr(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function ZU(n){if(n===0)return!1;const e=Wr(n);if(n===1){if(!xr(e,"OES_texture_float"))return!1}else if(!xr(e,"EXT_color_buffer_float"))return!1;return Vm(e)}function JU(n){if(n===0)return!1;const e=Wr(n);if(n===1){if(!xr(e,"OES_texture_float")||!xr(e,"WEBGL_color_buffer_float"))return!1}else{if(xr(e,"EXT_color_buffer_float"))return Vm(e);const r="EXT_color_buffer_half_float";if(xr(e,r)){const a=e.getExtension(r);return eP(e,a)}return!1}return Vm(e)}function Vm(n){const e=Ag(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const l=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),l}function eP(n,e){const t=Ag(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const u=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(l),u}function tP(n){return n!==2?!1:Wr(n).fenceSync!=null}function Fu(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&A(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Te=Z();Te.registerFlag("HAS_WEBGL",()=>Te.getNumber("WEBGL_VERSION")>0);Te.registerFlag("WEBGL_VERSION",()=>kb(2)?2:kb(1)?1:0);Te.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Te.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Te.get("WEBGL_VERSION")===2);Te.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Te.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Te.registerFlag("WEBGL_PACK",()=>Te.getBool("HAS_WEBGL"));Te.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_CLIP",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_REDUCE",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_LAZILY_UNPACK",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_CONV_IM2COL",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>KU(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>YU(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Te.getNumber("WEBGL_VERSION");return n===0?0:QU(n)});Te.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Te.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Gw());Te.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>ZU(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Te.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Te.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Te.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>JU(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_FENCE_API_ENABLED",()=>tP(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Te.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Te.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Te.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Gw()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Te.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Te.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Te.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Te.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Te.registerFlag("WEBGL_EXP_CONV",()=>!1);Te.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Te.getBool("IS_TEST"));Te.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Te.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Te.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Te.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function an(){let n,e,t,r,a,i,l,u,c,f;return Z().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",a="texture",i="outputColor",l="out vec4 outputColor;",u=Z().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",a="texture2D",i="gl_FragColor",l="",u=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:a,output:i,defineOutput:l,defineSpecialNaN:u,defineSpecialInf:c,defineRound:f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mi(n,e,t="index"){const r=Vt(e);return r.map((a,i)=>{const l=`int ${n[i]} = ${t} / ${a}`,u=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${a}`:`index -= ${n[i]} * ${a}`;return`${l}; ${u};`}).join("")}function lf(n,e,t="index"){const r=Vt(e);return r.map((a,i)=>{const l=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,u=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${l}; ${u};`}).join("")}function nP(n,e){const t=n.length,r=n.map(i=>`${e}[${i}]`),a=new Array(t-1);a[t-2]=r[t-1];for(let i=t-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}function rP(n,e,t="index"){const r=n.map((i,l)=>l),a=nP(r,e);return a.map((i,l)=>{const u=`int ${n[l]} = ${t} / ${a[l]}`,c=l===a.length-1?`int ${n[l+1]} = ${t} - ${n[l]} * ${a[l]}`:`index -= ${n[l]} * ${a[l]}`;return`${u}; ${c};`}).join("")}function Ig(n){const e=Vt(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function Lg(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const rN=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:aN}=LB;function aP(n,e,t){const r=[];if(n.forEach(x=>{const v=pe(x.shapeInfo.logicalShape);if(x.shapeInfo.isUniform?r.push(`uniform float ${x.name}${v>1?`[${v}]`:""};`):(r.push(`uniform sampler2D ${x.name};`),r.push(`uniform int offset${x.name};`)),t.enableShapeUniforms){const{uniformShape:w}=Bg(t.packedInputs,x.shapeInfo.logicalShape,x.shapeInfo.texShape);switch(w.length){case 1:r.push(`uniform int ${x.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${x.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${x.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${x.name}Shape;`);break}r.push(`uniform ivec2 ${x.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(x=>{r.push(`uniform ${x.type} ${x.name}${x.arrayIndex?`[${x.arrayIndex}]`:""};`)});const a=r.join(`
`),i=n.map(x=>sP(x,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),l=e.texShape,u=an(),c=lP(u);let f,p,m=dP(u);return e.isPacked?(f=iP(e.logicalShape,l,t.enableShapeUniforms),p=cP(u)):(f=oP(e.logicalShape,l,t.enableShapeUniforms),p=uP(u)),t.packedInputs&&(m+=mP),[m,c,p,a,f,i,t.userCode].join(`
`)}function Ko(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return $P(n,e);case 1:return RP(n,e);case 2:return OP(n,e);case 3:return FP(n,e);case 4:return IP(n,e);case 5:return LP(n);case 6:return BP(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function sN(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return EP(n);case 1:return DP(n,e);case 2:return _P(n,e);case 3:return kP(n,e);default:return AP(n,e)}}function sP(n,e,t=!1,r){let a="";t?a+=sN(n,r):a+=Ko(n,r);const i=n.shapeInfo.logicalShape,l=e.logicalShape;return i.length<=l.length&&(t?a+=MP(n,e):a+=UP(n,e)),a}function iP(n,e,t){switch(n.length){case 0:return iN();case 1:return gP(n,e,t);case 2:return TP(n,e,t);case 3:return xP(n,e,t);default:return vP(n,e,t)}}function oP(n,e,t){switch(n.length){case 0:return iN();case 1:return yP(n,e,t);case 2:return NP(n,e,t);case 3:return bP(n,e,t);case 4:return CP(n,e,t);case 5:return SP(n,e);case 6:return wP(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function lP(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function uP(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function cP(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function dP(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${fP}
    ${hP}
    ${pP}
  `}const fP=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,hP=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,pP=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,mP=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function iN(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function gP(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function yP(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function xP(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(n[2]/2),i=a*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function bP(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${lf(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=Mi(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function vP(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(n[n.length-1]/2),i=a*Math.ceil(n[n.length-2]/2);let l=i,u="",c="b, r, c";for(let f=2;f<n.length-1;f++)l*=n[n.length-f-1],u=`
      int b${f} = index / ${l};
      index -= b${f} * ${l};
    `+u,c=`b${f}, `+c;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${u}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${n.length}(${c});
    }
  `}function CP(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${lf(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Mi(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function SP(n,e){const t=Mi(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function wP(n,e){const t=Mi(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function TP(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(pt(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const a=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function NP(n,e,t){return pt(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Ui(n){return`offset${n}`}function EP(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=an();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function $P(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[a,i]=n.shapeInfo.texShape;if(a===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const l=Ui(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${l});
      return sampleTexture(${t}, uv);
    }
  `;const[u,c]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${u}, ${c}, ${l});
      return sampleTexture(${t}, uv);
    }
  `}function DP(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),a=n.shapeInfo.texShape,i=an();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${l[0]}, ${l[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function RP(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Yo(n)}
      }
    `;const a=n.shapeInfo.texShape,i=a[0],l=a[1];if(l===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const u=Ui(t);return l===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${u}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${u}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${u}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${u}) + 0.5) / ${l}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${u});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${l}, index + ${u});
      return sampleTexture(${t}, uv);
    }
  `}function _P(n,e){const t=n.shapeInfo.logicalShape,r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,l=i[0],u=i[1],c=an();if(i!=null&&pt(t,i))return e?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${c.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${u}.0, ${l}.0);

        return ${c.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `;const f=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],p=Math.ceil(t[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${p}, ${f[0]}, ${f[1]}, row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `}function OP(n,e){const t=n.shapeInfo.logicalShape,r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape;if(i!=null&&pt(t,i)){if(e)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const g=i[0],x=i[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${x}.0, ${g}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:l,keptDims:u}=_s(t),c=l;if(c.length<t.length){const g=Qo(n,c),x=["row","col"];return`
      ${Ko(g,e)}
      float ${a}(int row, int col) {
        return ${a}(${Zo(x,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${Yo(n)}
      }
    `;const f=i[0],p=i[1],m=Ui(r);return p===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${m}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${m}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `:f===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${m}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${m}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${p}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${m};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${m};
    vec2 uv = uvFromFlat(${f}, ${p}, index);
    return sampleTexture(${r}, uv);
  }
`}function kP(n,e){const t=n.shapeInfo.logicalShape,r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const g=t.slice(1),x=[1,2],v=Qo(n,g),w=["b","row","col"];return`
        ${sN(v,e)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${Zo(w,x)});
        }
      `}const u=an();if(e)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `;const c=l[0],f=l[1],p=Math.ceil(t[2]/2),m=p*Math.ceil(t[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${f}, ${m}, ${p}, b, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `}function FP(n,e){const t=n.shapeInfo.logicalShape,r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[1]*t[2],l=t[2],{newShape:u,keptDims:c}=_s(t),f=u;if(f.length<t.length){const w=Qo(n,f),S=["row","col","depth"];return`
        ${Ko(w,e)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${Zo(S,c)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${l}, 1)));
        ${Yo(n)}
      }
    `;const p=n.shapeInfo.texShape,m=p[0],g=p[1],x=n.shapeInfo.flatOffset;if(g===i&&x==null)return e?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${l}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${g}.0, ${m}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(g===l&&x==null)return e?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${g}.0, ${m}.0);
      return sampleTexture(${r}, uv);
    }
  `;const v=Ui(r);return e?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${v};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${l} + depth + ${v};
        vec2 uv = uvFromFlat(${m}, ${g}, index);
        return sampleTexture(${r}, uv);
      }
  `}function AP(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),a=an();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,l=i.length,u=n.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],f=c[0],p=c[1],m=Math.ceil(i[l-1]/2);let g=m*Math.ceil(i[l-2]/2),x="int b, int row, int col",v=`b * ${g} + (row / 2) * ${m} + (col / 2)`;for(let w=2;w<l-1;w++)x=`int b${w}, `+x,g*=i[l-w-1],v=`b${w} * ${g} + `+v;return`
    vec4 ${r}(${x}) {
      int index = ${v};
      int texR = index / ${p};
      int texC = index - texR * ${p};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}, ${f});
      return ${a.texture2D}(${t}, uv);
    }
  `}function IP(n,e){const t=n.shapeInfo.logicalShape,r=n.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[3],l=t[2]*i,u=t[1]*l,{newShape:c,keptDims:f}=_s(t);if(c.length<t.length){const $=Qo(n,c),D=["row","col","depth","depth2"];return`
      ${Ko($,e)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${Zo(D,f)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${u}, ${l}, ${i}, 1)));
        ${Yo(n)}
      }
    `;const p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],x=m[1],v=`int stride2 = ${r}Shape[3];`,w=`int stride1 = ${r}Shape[2] * stride2;`,S=`int stride0 = ${r}Shape[1] * stride1;`;if(x===u&&p==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${v}
        ${w}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${l}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${g}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(x===i&&p==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${g}.0);
        return sampleTexture(${r}, uv);
      }
    `;const T=Ui(r);return e?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${v}
      ${w}
      ${S}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${T});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${l} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${g}, ${x}, index + ${T});
      return sampleTexture(${r}, uv);
    }
  `}function LP(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),a=e[4],i=e[3]*a,l=e[2]*i,u=e[1]*l,{newShape:c,keptDims:f}=_s(e);if(c.length<e.length){const w=Qo(n,c),S=["row","col","depth","depth2","depth3"];return`
      ${Ko(w)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Zo(S,f)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${l}, ${i}, ${a})) +
          depth3;
        ${Yo(n)}
      }
    `;const p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],x=m[1];if(x===u&&p==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${l}, ${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(x===a&&p==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;const v=Ui(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${l} + depth * ${i} +
          depth2 * ${a} + depth3 + ${v};
      vec2 uv = uvFromFlat(${g}, ${x}, index);
      return sampleTexture(${t}, uv);
    }
  `}function BP(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:a,keptDims:i}=_s(e);if(a.length<e.length){const S=Qo(n,a),T=["row","col","depth","depth2","depth3","depth4"];return`
      ${Ko(S)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Zo(T,i)});
      }
    `}const l=e[5],u=e[4]*l,c=e[3]*u,f=e[2]*c,p=e[1]*f;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${p}, ${f}, ${c}, ${u})) +
          dot(
            vec2(depth3, depth4),
            vec2(${l}, 1)));
        ${Yo(n)}
      }
    `;const m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,x=g[0],v=g[1];if(v===p&&m==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${f}, ${c}, ${u}, ${l})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${v}.0, ${x}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(v===l&&m==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${v}.0, ${x}.0);
        return sampleTexture(${t}, uv);
      }
    `;const w=Ui(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${p} + col * ${f} + depth * ${c} +
          depth2 * ${u} + depth3 * ${l} + depth4 + ${w};
      vec2 uv = uvFromFlat(${x}, ${v}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Yo(n){const e=n.name,t=pe(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function MP(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),a="get"+r+"AtOutCoords",i=n.shapeInfo.logicalShape.length,l=e.logicalShape.length,u=aN(n.shapeInfo.logicalShape,e.logicalShape),c=tt(l),f=l-i;let p;const m=["x","y","z","w","u","v"];i===0?p="":l<2&&u.length>=1?p="coords = 0;":p=u.map($=>`coords.${m[$+f]} = 0;`).join(`
`);let g="";l<2&&i>0?g="coords":g=n.shapeInfo.logicalShape.map(($,D)=>`coords.${m[D+f]}`).join(", ");let x="return outputValue;";const w=pe(n.shapeInfo.logicalShape)===1,T=pe(e.logicalShape)===1;if(i===1&&!w&&!T)x=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(w&&!T)l===1?x=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:x=`
        return vec4(outputValue.x);
      `;else if(u.length){const $=i-2,D=i-1;u.indexOf($)>-1&&u.indexOf(D)>-1?x="return vec4(outputValue.x);":u.indexOf($)>-1?x="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(D)>-1&&(x="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${c} coords = getOutputCoords();
      ${p}
      vec4 outputValue = get${r}(${g});
      ${x}
    }
  `}function UP(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),a="get"+r+"AtOutCoords",i=e.texShape,l=n.shapeInfo.texShape,u=n.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!n.shapeInfo.isUniform&&u===c&&n.shapeInfo.flatOffset==null&&pt(l,i))return`
      float ${a}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const f=tt(c),p=aN(n.shapeInfo.logicalShape,e.logicalShape),m=c-u;let g;const x=["x","y","z","w","u","v"];u===0?g="":c<2&&p.length>=1?g="coords = 0;":g=p.map(w=>`coords.${x[w+m]} = 0;`).join(`
`);let v="";return c<2&&u>0?v="coords":v=n.shapeInfo.logicalShape.map((w,S)=>`coords.${x[S+m]}`).join(", "),`
    float ${a}() {
      ${f} coords = getOutputCoords();
      ${g}
      return get${r}(${v});
    }
  `}function tt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function Bg(n,e,t){const{newShape:r,keptDims:a}=_s(e),i=e.length,l=n&&i===3&&e[0]===1,u=l?e.slice(1):r,c=!n&&i>1&&!pt(e,t)&&r.length<i||l;return{useSqueezeShape:c,uniformShape:c?u:e,keptDims:a}}function Qo(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function Zo(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PP(n,e,t,r){const a=t.map((p,m)=>{const g={logicalShape:p.shape,texShape:p.isUniform?null:p.texData.texShape,isUniform:p.isUniform,isPacked:p.isUniform?!1:p.texData.isPacked,flatOffset:null};return p.texData!=null&&p.texData.slice!=null&&p.texData.slice.flatOffset>0&&(g.flatOffset=p.texData.slice.flatOffset),{name:e.variableNames[m],shapeInfo:g}}),i=a.map(p=>p.shapeInfo),l={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=aP(a,l,e),c=FU(n.gl,u),f=n.createProgram(c);return Z().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:u,webGLProgram:f,inShapeInfos:i,outShapeInfo:l,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(f),Object.assign({program:e,fragmentShader:c,source:u,webGLProgram:f,inShapeInfos:i,outShapeInfo:l},oN(n,e,f)))}function oN(n,e,t){const r=[],a=[];let i,l,u,c=null,f=null;f=n.getUniformLocation(t,"NAN",!1),Z().getNumber("WEBGL_VERSION")===1&&(c=n.getUniformLocation(t,"INFINITY",!1));const p=!1;for(const m of e.variableNames){const g={name:m,uniform:n.getUniformLocation(t,m,p),offset:n.getUniformLocation(t,`offset${m}`,p)};e.enableShapeUniforms&&(g.shape=n.getUniformLocation(t,`${m}Shape`,p),g.texShape=n.getUniformLocation(t,`${m}TexShape`,p)),r.push(g)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",p),u=n.getUniformLocation(t,"outShapeStrides",p),l=n.getUniformLocation(t,"outTexShape",p)),e.customUniforms)for(const m of e.customUniforms)a.push(n.getUniformLocation(t,m.name,p));return{variablesLocations:r,customUniformLocations:a,infLoc:c,nanLoc:f,outShapeLocation:i,outShapeStridesLocation:u,outTexShapeLocation:l}}function Fb(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const a=t.logicalShape,i=e[r],l=i.shape;if(!pt(a,l))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${l} must match`);if(t.isUniform&&i.isUniform)return;const u=t.texShape,c=i.isUniform?null:i.texData.texShape;if(!pt(u,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${u} and ${c} must match`)})}function zP(n,e,t,r,a){e.program.enableShapeUniforms||(Fb(e.inShapeInfos,t),Fb([e.outShapeInfo],[r]));const i=r.texData.texture,l=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,l[0],l[1]):n.setOutputMatrixTexture(i.texture,l[0],l[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),Z().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<t.length;++c){const f=t[c],{uniform:p,offset:m,shape:g,texShape:x}=e.variablesLocations[c];if(g){const{uniformShape:v}=Bg(e.program.packedInputs,f.shape,f.texData.texShape);switch(v.length){case 1:n.gl.uniform1iv(g,new Int32Array(v));break;case 2:n.gl.uniform2iv(g,new Int32Array(v));break;case 3:n.gl.uniform3iv(g,new Int32Array(v));break;case 4:n.gl.uniform4iv(g,new Int32Array(v));break}}if(x&&n.gl.uniform2i(x,f.texData.texShape[0],f.texData.texShape[1]),p!=null){if(f.isUniform){if(pe(f.shape)<2)n.gl.uniform1f(p,f.uniformValues[0]);else{let v=f.uniformValues;v instanceof Float32Array||(v=new Float32Array(v)),n.gl.uniform1fv(p,v)}continue}f.texData.slice!=null&&m!=null&&n.gl.uniform1i(m,f.texData.slice.flatOffset),n.setInputMatrixTexture(f.texData.texture.texture,p,c)}}const u=e.outShapeLocation;if(u)switch(r.shape.length){case 1:n.gl.uniform1iv(u,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(u,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(u,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(u,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const c=Vt(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(c));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(c));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(c));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a)for(let c=0;c<e.program.customUniforms.length;++c){const f=e.program.customUniforms[c],p=e.customUniformLocations[c],m=a[c];if(f.type==="float")n.gl.uniform1fv(p,m);else if(f.type==="vec2")n.gl.uniform2fv(p,m);else if(f.type==="vec3")n.gl.uniform3fv(p,m);else if(f.type==="vec4")n.gl.uniform4fv(p,m);else if(f.type==="int")n.gl.uniform1iv(p,m);else if(f.type==="ivec2")n.gl.uniform2iv(p,m);else if(f.type==="ivec3")n.gl.uniform3iv(p,m);else if(f.type==="ivec4")n.gl.uniform4iv(p,m);else throw Error(`uniform type ${f.type} is not supported yet.`)}n.executeProgram()}function VP(n,e,t){let r="";e.concat(t).forEach(l=>{const u=l.texData!=null&&l.texData.slice!=null&&l.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!l.isUniform){const c=l.texData.texShape,{useSqueezeShape:f,uniformShape:p,keptDims:m}=Bg(n.packedInputs,l.shape,c);let g="",x="",v="";if(p.length===1&&n.packedInputs){const I=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];g=`${I[0]>1}_${I[1]>1}`}else if(p.length===2&&!n.packedInputs)x=`${p[0]>1}_${p[1]>1}`;else if(p.length>2&&!n.packedInputs){const I=Vt(p);v=`${I[0]===c[1]}_${I[I.length-1]===c[1]}`}const w=l.shape.length,S=p.length===2&&pt(l.shape,c),T=pe(l.shape)===1,$=$d(l.shape,t.shape),D=!n.packedInputs&&w===t.shape.length&&pt(c,t.texData.texShape),R=n.packedInputs||p.length>2?"":`${c[0]>1}_${c[1]>1}`;r+=`${w}_${D}_${f?m:""}_${p.length}_${T}_${$}_${S}_${g}_${x}_${v}_${R}_${u}`}else{const c=l.isUniform?"uniform":l.texData.texShape;r+=`${l.shape}_${c}_${u}`}});const a=n.userCode;let i=n.constructor.name;return i+="_"+r+"_"+a+`${Z().getNumber("WEBGL_VERSION")}`,i}function Xt(n){return Z().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GP{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Su.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=an();this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?lf(["r","c","d"],e):Mi(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HP{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Su.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=an();this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?lf(["r","c","d"],e):Mi(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WP{constructor(e){this.variableNames=["A"],this.outTexUsage=qn.DOWNLOAD;const t=an();this.outputShape=e,this.userCode=`
      ${rN}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jP{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=qn.DOWNLOAD;const t=an();this.outputShape=e,this.userCode=`
      ${rN}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qP={R:0,G:1,B:2,A:3};class Ab{constructor(e,t=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=an();this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let l="";for(let u=0;u<r.length;u++){const c=r[u];l+=`
          if(offset == ${u}) {
            result = values[${qP[c]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?Lg():Ig(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${a.texture2D}(A, uv);
          ${l}
        }
        ${a.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XP{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=an();this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length);let a="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let l=0;l<=1;l++)for(let u=0;u<=1;u++){const c=l*2+u;a+=`
          localCoords = coords;
          if(localCoords[2] + ${u} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${u};
          if (localCoords[1] + ${l} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${l};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${c}] = values[0];
            } else if (offset == 1) {
              result[${c}] = values[1];
            } else if (offset == 2) {
              result[${c}] = values[2];
            } else {
              result[${c}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?Lg():Ig(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${a}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(n){const e=an(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return kU(n,t)}function YP(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return BU(n,e)}function QP(n){const e=new Uint16Array([0,1,2,2,1,3]);return MU(n,e)}function Au(n,e,t,r,a,i){PU(e,t);const l=UU(n),u=n.TEXTURE_2D;return Ce(n,()=>n.bindTexture(u,l)),Ce(n,()=>n.texParameteri(u,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Ce(n,()=>n.texParameteri(u,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Ce(n,()=>n.texParameteri(u,n.TEXTURE_MIN_FILTER,n.NEAREST)),Ce(n,()=>n.texParameteri(u,n.TEXTURE_MAG_FILTER,n.NEAREST)),Z().getNumber("WEBGL_VERSION")===1?Ce(n,()=>n.texImage2D(u,0,r,e,t,0,a,i,null)):Ce(n,()=>n.texStorage2D(u,1,r,e,t)),Ce(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:l,texShape:[t,e]}}function lN(n){return n.internalFormatFloat}function ZP(n,e,t,r){const[a,i]=ku(e,t);return Au(n,a,i,lN(r),r.textureFormatFloat,n.FLOAT)}function uN(n){return n.internalFormatHalfFloat}function JP(n,e,t,r){const[a,i]=ku(e,t);return Au(n,a,i,uN(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function cN(n){return n.downloadTextureFormat}function ez(n,e,t,r){const[a,i]=ku(e,t);return Au(n,a,i,cN(r),n.RGBA,n.UNSIGNED_BYTE)}function dN(n){return n.internalFormatPackedFloat}function tz(n,e,t,r){const[a,i]=Xo(e,t);return Au(n,a,i,dN(r),n.RGBA,n.FLOAT)}function fN(n){return n.internalFormatPackedHalfFloat}function nz(n,e,t,r){const[a,i]=Xo(e,t);return Au(n,a,i,fN(r),n.RGBA,r.textureTypeHalfFloat)}function rz(n,e,t){return Ce(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),_b(n,e,"clipSpacePos",t,3,20,0)&&_b(n,e,"uv",t,2,20,12)}function az(n,e,t,r,a,i){Ce(n,()=>n.bindTexture(n.TEXTURE_2D,e));let l,u,c;a instanceof Uint8Array?(l=new Uint8Array(t*r*4),u=n.UNSIGNED_BYTE,c=n.RGBA):(l=new Float32Array(t*r*4),u=n.FLOAT,c=i.internalFormatPackedFloat),l.set(a),Z().getNumber("WEBGL_VERSION")===2?Ce(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,u,l)):Ce(n,()=>n.texImage2D(n.TEXTURE_2D,0,c,t,r,0,n.RGBA,u,l)),Ce(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function sz(n,e,t){Ce(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?Z().getNumber("WEBGL_VERSION")===2?Ce(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):Ce(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):Z().getNumber("WEBGL_VERSION")===2?Ce(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):Ce(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),Ce(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function iz(n,e,t,r){const a=n.createBuffer();Ce(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,a));const u=4*4*e*t;return Ce(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,u,n.STREAM_READ)),Ce(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),Ce(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),a}function oz(n,e,t){const r=n,a=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function lz(n,e,t,r){const[a,i]=ku(e,t),l=4,u=new Uint8Array(NU(e*t,l));return Ce(n,()=>n.readPixels(0,0,a,i,r.downloadTextureFormat,n.UNSIGNED_BYTE,u)),new Float32Array(u.buffer)}function uz(n,e,t,r,a,i,l,u){const c=n,f=new Float32Array(EU(i,l));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function cz(n,e,t){const r=new Float32Array(e*t*4);return Ce(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zp{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Z().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,SU(t,e)):this.gl=Wr(t),e=this.gl,Z().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>Ce(i,()=>i.createVertexArray()),this.bindVertexArray=l=>Ce(i,()=>i.bindVertexArray(l)),this.deleteVertexArray=l=>Ce(i,()=>i.deleteVertexArray(l)),this.getVertexArray=()=>Ce(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ce(e,()=>i.createVertexArrayOES()),this.bindVertexArray=l=>Ce(e,()=>i.bindVertexArrayOES(l)),this.deleteVertexArray=l=>Ce(e,()=>i.deleteVertexArrayOES(l)),this.getVertexArray=()=>Ce(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Z().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",l="OES_texture_half_float";if(this.textureFloatExtension=Jc(this.gl,i),xr(this.gl,l))this.textureHalfFloatExtension=Jc(this.gl,l);else if(Z().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),xr(this.gl,a))this.colorBufferHalfFloatExtension=Jc(this.gl,a);else if(Z().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",xr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(xr(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=YP(this.gl),this.indexBuffer=QP(this.gl),this.framebuffer=zU(this.gl),this.textureConfig=Ag(this.gl,this.textureHalfFloatExtension)}get debug(){return Z().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ce(e,()=>e.finish()),Ce(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ce(e,()=>e.deleteFramebuffer(this.framebuffer)),Ce(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ce(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ce(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),ZP(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),JP(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),ez(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),sz(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,a){this.throwIfDisposed(),az(this.gl,e,t,r,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),nz(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),tz(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(Ob(this.gl,this.framebuffer),this.outputTexture=null),Ce(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>lz(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,a,i,l){return uz(this.gl,e,t,r,a,i,l,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return oz(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const a=iz(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(Z().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const l=a.clientWaitSync(i,0,0);return l===a.ALREADY_SIGNALED||l===a.CONDITION_SATISFIED},t=i}else Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>cz(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=KP(t));const r=IU(t);Ce(t,()=>t.attachShader(r,this.vertexShader)),Ce(t,()=>t.attachShader(r,e)),LU(t,r);const a=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Bp(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Ce(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),rz(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ce(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Bp(this.gl,this.program),Ce(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?GU(this.gl,e,t):HU(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ce(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),WU(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[a,i]=Xo(t,r);this.setOutputMatrixTextureDriver(e,a,i)}setOutputMatrixWriteRegion(e,t,r,a){this.setOutputMatrixWriteRegionDriver(r,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Bp(this.gl,this.program),ed(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ce(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ce(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Jc(this.gl,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(a.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await U1(()=>this.disposed||this.isQueryAvailable(e,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),a=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=dz(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Z().platform&&(r=Z().platform.setTimeoutCustom.bind(Z().platform)),U1(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Mp(this.gl,e,this.framebuffer),this.debug&&ed(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Mp(this.gl,this.outputTexture,this.framebuffer),this.debug&&ed(this.gl)):Ob(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const a=this.gl;Mp(a,e,this.framebuffer),this.debug&&ed(a),this.outputTexture=e,Ce(a,()=>a.viewport(0,0,t,r)),Ce(a,()=>a.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,a){this.throwIfDisposed(),Ce(this.gl,()=>this.gl.scissor(e,t,r,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function dz(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fz(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sn(n){return(e,t,r,a,i)=>{const l=We(e,t),u=l.length,c=Vt(l),f=pe(l),p=Ts(i,f),m=e.length,g=t.length,x=Vt(e),v=Vt(t),w=$d(e,l),S=$d(t,l);if(w.length+S.length===0)for(let T=0;T<p.length;++T)p[T]=n(r[T%r.length],a[T%a.length]);else for(let T=0;T<p.length;++T){const $=eg(T,u,c),D=$.slice(-m);w.forEach(j=>D[j]=0);const R=om(D,m,x),I=$.slice(-g);S.forEach(j=>I[j]=0);const V=om(I,g,v);p[T]=n(r[R],a[V])}return[p,l]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(n,e,t,r){if(r==="int32"){const a=Int32Array.from(n);return[e,"int32",a]}if(r==="bool"){const a=Xd([0],t),[i,l]=Sn((u,c)=>u!==c?1:0)(e,[],n,a,"bool");return[l,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pz=Sn((n,e)=>n+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(n,e,t,r,a){const i=pe(r),l=Ns(a,t);for(let u=0;u<n.length;u++){const c=n[u];if(c<0)throw new Error("Input x must be non-negative!");c>=a||(i>0?l[c]+=e[u]:l[c]+=1)}return l}function gz(n,e,t,r=!1){const a=n.shape[0],i=n.shape[1],l=mt([a,t],e.dtype);for(let u=0;u<a;u++)for(let c=0;c<i;c++){const f=n.get(u,c);if(f<0)throw new Error("Input x must be non-negative!");f>=t||(r?l.set(1,u,f):e.size>0?l.set(l.get(u,f)+e.get(u,c),u,f):l.set(l.get(u,f)+1,u,f))}return l}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yz=Sn((n,e)=>n&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(n){return(e,t,r)=>{const a=kt(t,e.length);for(let i=0;i<e.length;++i)a[i]=n(e[i],r);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xz=Ha(n=>Math.ceil(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(n,e,t,r){const a=kt(t,pe(e));if(r&&t!=="string"){let i=0;n.forEach(l=>{const u=pe(l.shape);a.set(l.vals,i),i+=u})}else{let i=0;n.forEach(l=>{const u=t==="string"?zo(l.vals):l.vals;let c=0;for(let f=0;f<l.shape[0];++f){const p=f*e[1]+i;for(let m=0;m<l.shape[1];++m)a[p+m]=u[c++]}i+=l.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vz=Sn((n,e)=>n===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cz=Ha(n=>Math.exp(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sz=Ha(n=>Math.expm1(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wz=Ha(n=>Math.floor(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tz=Sn((n,e)=>Math.floor(n/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(n,e,t,r,a,i,l,u,c){const f=mt([r,i],t);for(let p=0;p<r;p++){const m=[];let g=0;for(let x=0;x<a;x++){const v=n[p*a+x];g+=v*l[x],m.push(v)}if(g<0||g>=c/i)throw new Error(`Invalid indices: ${m} does not index into ${u}`);for(let x=0;x<i;x++)f.values[p*i+x]=e.get(...e.indexToLoc(g*i+x))}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(n,e,t){const r=mt(t,n.dtype);for(let a=0;a<r.size;++a){const l=r.indexToLoc(a).slice(),u=l[0],c=l[2],f=e.locToIndex([u,c]);l[2]=e.values[f];const p=n.locToIndex(l);0<=p&&p<n.values.length&&(r.values[a]=n.values[p])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $z=Sn((n,e)=>n>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dz=Sn((n,e)=>n>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz=Sn((n,e)=>n<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _z=Sn((n,e)=>n<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(n,e,t){const r=(e-n)/(t-1),a=Ns(t,"float32");a[0]=n;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kz=Ha(n=>Math.log(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fz(n,e,t,r){const a=Ts(r,pe(t));for(let i=0;i<a.length;++i){const l=i*e;let u=n[l];for(let c=0;c<e;++c){const f=n[l+c];(Number.isNaN(f)||f>u)&&(u=f)}a[i]=u}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Az=Sn((n,e)=>Math.max(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iz=Sn((n,e)=>Math.min(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hN=Sn((n,e)=>n*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(n,e,t){const r=Wo(-1,t);return hN([],e,r,n,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bz=Sn((n,e)=>n!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(n,e,t,r,a){const i=e.length,l=pe(e),u=Vt(e),c=Vt(a),f=Ts(t,pe(a));for(let p=0;p<l;++p){const m=eg(p,i,u),g=new Array(m.length);for(let v=0;v<g.length;v++)g[v]=m[r[v]];const x=om(g,i,c);f[x]=n[p]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(n,e,t,r){const[a,i]=ma(n,r),l=pa(e,"int32"),u=Ns(pe(a),l),c=pe(i);for(let f=0;f<u.length;++f){const p=f*c;let m=1;for(let g=0;g<c;++g)m*=t[p+g];u[f]=m}return{outVals:u,outShape:a,outDtype:l}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(n,e,t){n.forEach((r,a)=>{if(r<0||r>=t){const i=eg(a,e.length,Vt(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${t})`)}})}function zz(n,e){for(let t=0;t<n.length;++t){const r=n[t],a=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Vz(n,e,t,r){const a=[];let i=0;const l=e.length-1+t.length,u=new Array(l).fill(null).map(()=>[0]);zz(t,r);let c=1;for(let f=0;f<e.length-1;++f){c*=e[f];const p=e[f+1];for(let m=1;m<c+1;++m)u[f].push(m*p)}for(let f=0;f<n.length;++f){let p=n[f],m=n[f]+1;for(let g=0;g<t.length;++g){const x=t[g],v=g+e.length-1;if(v>=0){const w=u[v],S=w[w.length-1]-x[p];for(let T=p;T<m;++T)u[v].push(x[T+1]+S)}p=x[p],m=x[m]}m!==p&&(a.push([p,m]),i+=m-p)}return{outSplits:u,valueSlices:a,numValues:i}}function Gz(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,a=kt("int32",r);e.push(a),n[t].forEach((i,l)=>a[l]=i)}return e}function Ib(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function Hz(n,e,t,r,a,i){const l=Ib(e,2)[1],u=Ib(i,2)[1];let c=0;for(const f of t)for(let p=f[0];p<f[1];++p){for(let m=0;m<r;++m)a[c*u+m]=n[p*l+m];++c}}function Wz(n,e,t,r,a){const i=e.slice();i[0]=a;const l=kt(t,pe(i)),u=n.length,c=u===0?0:u/e[0];return Hz(n,e,r,c,l,i),[l,i]}function jz(n,e,t,r,a,i,l,u){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const c=e[0][0]-1;if(Pz(i,l,c),r.length===0)throw new Error("params.rank must be nonzero");const f=r[0],{outSplits:p,valueSlices:m,numValues:g}=Vz(i,l,n,f),x=Gz(p),v=Wz(t,r,a,m,g);return[x,v[0],v[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lb=2147483647;function qz(n,e,t,r,a,i,l){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(l.length>1)throw new Error("deltas must be a scalar or vector");const u=e.length===0,c=a.length===0,f=l.length===0,p=[];u||p.push(e[0]),c||p.push(a[0]),f||p.push(l[0]);for(let S=1;S<p.length;++S)if(p[S]!==p[S-1])throw new Error("starts, limits, and deltas must have the same shape");const m=p.length===0?1:p[0],g=kt("int32",m+1);g[0]=0;for(let S=0;S<m;++S){const T=u?n[0]:n[S],$=c?r[0]:r[S],D=f?i[0]:i[S];if(D===0)throw new Error("Requires delta != 0");let R;if(D>0&&$<T||D<0&&$>T)R=0;else if(R=Math.ceil(Math.abs(($-T)/D)),R>Lb)throw new Error(`Requires ((limit - start) / delta) <= ${Lb}`);g[S+1]=g[S]+R}const x=g[m],v=kt(t,x);let w=0;for(let S=0;S<m;++S){const T=g[S+1]-g[S];let $=u?n[0]:n[S];const D=f?i[0]:i[S];for(let R=0;R<T;++R)v[w++]=$,$+=D}return[g,v]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gr=Vr;class Ld{constructor(e,t,r,a,i,l,u,c,f,p){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=l,this.defaultValueShape=u,this.rowPartitionValues=c,this.rowPartitionValuesShapes=f,this.rowPartitionTypes=y2(p),this.raggedRank=x2(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===gr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===gr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case gr.VALUE_ROWIDS:return Ld.getMaxWidthValueRowID(t);case gr.ROW_SPLITS:return Ld.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${gr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let a=0;a<t-1;++a){const i=e[a+1]-e[a];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,a=e[0],i=0;for(let l=1;l<t;++l){const u=e[l];u!==a&&(a=u,i=Math.max(l-r,i),r=l)}return Math.max(t-r,i)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Mb(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;b2(r,t);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),l=g2(this.raggedRank,a,t);l[0]<0&&(l[0]=e);for(let u=1;u<=this.raggedRank;++u)l[u]<0&&(l[u]=this.getMaxWidth(u));return l}calculateFirstParentOutputIndex(e,t,r){const a=Math.min(e,r),i=[];let l=0;for(let u=0;u<a;++u,l+=t)i.push(l);for(let u=a;u<e;++u)i.push(-1);return A(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,r,a){const i=e.length,l=[];for(let u=0;u<i-1;++u){const c=e[u+1]-e[u];let f=Math.min(a,c),p=t[u];p===-1&&(f=0);for(let m=0;m<f;++m)l.push(p),p+=r;for(let m=0;m<c-f;++m)l.push(-1)}if(i>0&&l.length!==e[i-1])throw new Error("Invalid row split size.");return l}calculateOutputIndexValueRowID(e,t,r,a){const i=e.length,l=[];if(i===0)return[];let u=0,c=e[0];if(c>=t.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${t.length}`);let f=t[c];l.push(f);for(let p=1;p<i;++p){const m=e[p];if(m===c)f>=0&&(++u,u<a?f+=r:f=-1);else{if(u=0,c=m,m>=t.length)throw new Error(`Got nextValueRowId=${m} which is not less than ${t.length}`);f=t[m]}l.push(f)}if(l.length!==e.length)throw new Error("Invalid row ids.");return l}calculateOutputIndex(e,t,r,a){const i=this.getRowPartitionTensor(e),l=this.getRowPartitionTypeByDimension(e);switch(l){case gr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,r,a);case gr.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,r,a);default:throw new Error(`Unsupported partition type: ${gr[l]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case gr.FIRST_DIM_SIZE:return e[0];case gr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case gr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${gr[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let c=a.length-2;c>=0;--c)a[c]=a[c+1]*r[c+1];const i=Mb(r,!1),l=kt(this.valuesDType,pe(i));if(a[0]*r[0]>0){let c=this.calculateFirstParentOutputIndex(t,a[0],r[0]);for(let f=1;f<=this.raggedRank;++f)c=this.calculateOutputIndex(f-1,c,a[f],r[f]);this.setOutput(this.raggedRank,c,l,i)}return[i,l]}setOutput(e,t,r,a){if(r.length===0)return;const i=this.values,l=r;let u=a.slice();u=u.slice(e+1);const c=pe(u),f=t.length;let p=this.defaultValue;if(p.length!==c&&p.length!==1){const v=this.defaultValueShape;Me(()=>{const w=oe(p,v);p=cu(w,u).dataSync()})}let m=0,g=0,x=0;for(let v=0;v<=f;++v){let w=v<f?t[v]:-1;if(w===x){++x;continue}if(g<x){const S=i.subarray(m*c),T=l.subarray(g*c),$=(x-g)*c;Bb(T,S,$)}if(v>=f){const S=r.length;w=Math.floor(S/c)}if(w>x)if(this.defaultValue.length===1)l.subarray(x*c,w*c).fill(this.defaultValue[0]),x=w;else for(;w>x;){const S=l.slice(x*c);Bb(S,p,c),++x}w<0?(m=v+1,g=x):(m=v,g=x,x=g+1)}}}function Bb(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function Mb(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function Xz(n,e,t,r,a,i,l,u,c,f){return new Ld(n,e,t,r,a,i,l,u,c,f).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(n,e,t,r){const a=n===e,i=n<e&&t<0,l=e<n&&t>1;if(a||i||l)return Ns(0,r);const u=Math.abs(Math.ceil((e-n)/t)),c=Ns(u,r);e<n&&t===1&&(t=-1),c[0]=n;for(let f=1;f<c.length;f++)c[f]=c[f-1]+t;return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yz=Ha(n=>1/Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(n,e,t,r,a,i,l,u,c,f){const p=[r/a,a],m=n.values,g=e.values;if(r===0)return mt(t,e.dtype);const x=c instanceof Uo?c:mt(p,e.dtype);typeof c=="string"||typeof c=="number"?x.values.fill(c):typeof c=="boolean"&&x.values.fill(+c);for(let v=0;v<i;v++){const w=[];let S=0;for(let T=0;T<l;T++){const $=m[v*l+T];w.push($),S+=$*u[T]}if(S<0||S>=r/a)throw new Error(`Invalid indices: ${w} does not index into ${t}`);for(let T=0;T<a;T++)f?x.values[S*a+T]+=g[v*a+T]:x.values[S*a+T]=e.rank===0?g[0]:g[v*a+T]}return x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zz=Ha(n=>1/(1+Math.exp(-n)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(n,e,t,r,a){const i=Eg(r,e,t),l=pe(t),u=Vt(r);if(i){const m=$g(e,u);return a==="string"?n.slice(m,m+l):n.subarray(m,m+l)}const c=a==="string"?zo(n):n,f=mt(r,a,c),p=mt(t,a);for(let m=0;m<p.size;++m){const g=p.indexToLoc(m),x=g.map((v,w)=>v+e[w]);p.set(f.get(...x),...g)}return a==="string"?Q2(p.values):p.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(n,e,t,r,a,i,l){const u=e[0],c=i[0],f=new Array(c),p=new Array(u),m=e[1];if(c===0){if(u!==0)throw new Error(B2(u));const S=kt(t,0),T=kt(a,0);return[S,[0,m],T,f,p]}let g=!0,x=0;const v=new Array(c).fill(0);for(let S=0;S<u;++S){const T=n[S*m];if(T<0)throw new Error(M2(S,T));if(T>=c)throw new Error(U2(S,T,c));++v[T],g=g&&T>=x,x=T}let w=!0;for(let S=0;S<c;++S){const T=v[S]===0;f[S]=T,w=w&&!T,v[S]=Math.max(v[S],1),S>0&&(v[S]+=v[S-1])}if(w&&g){const S=n,T=r;for(let $=0;$<u;++$)p[$]=$;return[S,[u,m],T,f,p]}else{const S=v[c-1],T=kt(t,S*m),$=kt(a,S),D=new Array(c).fill(0);for(let R=0;R<u;++R){const I=n[R*m],V=D[I],j=(I===0?0:v[I-1])+V;D[I]++;for(let K=0;K<m;++K)T[j*m+K]=n[R*m+K];$[j]=r[R],p[R]=j}for(let R=0;R<c;++R)if(D[R]===0){const V=R===0?0:v[R-1];T[V*m+0]=R;for(let j=1;j<m;++j)T[V*m+j]=0;$[V]=l}return[T,[S,m],$,f,p]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(n,e,t,r,a){const i=pe(r),l=e[0],u=a.length,c=[];let f=1,p=-1;for(let S=0;S<u;++S){const T=a[S];if(T===-1){if(p!==-1)throw new Error(P2(p,S));p=S,c.push(1)}else{if(T<0)throw new Error(z2(S,T));f*=T,c.push(T)}}if(p!==-1){if(f<=0)throw new Error(V2());const S=Math.trunc(i/f);if(f*S!==i)throw new Error(G2(r,c));c[p]=S}if(pe(c)!==i)throw new Error(H2(r,c));const g=r.length,x=[];if(g>0){x[g-1]=1;for(let S=g-2;S>=0;--S)x[S]=x[S+1]*r[S+1]}const v=[];if(u>0){v[u-1]=1;for(let S=u-2;S>=0;--S)v[S]=v[S+1]*c[S+1]}const w=kt(t,l*u);for(let S=0;S<l;++S){let T=0;for(let $=0;$<g;++$)T+=n[S*g+$]*x[$];for(let $=0;$<u;++$)w[S*u+$]=Math.trunc(T/v[$]),T%=v[$]}return[w,[l,u],c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(n,e,t,r,a,i=!1,l=0){const u=r.length,c=[e[0],n.length/e[0]],f=c[1],m=u>0?a[u-1]+1:0;if(m<0)throw new Error(_m());const g=e.slice();g[0]=m;const x=g.reduce((D,R)=>D*R,1),v=kt(t,x);if(u===0)return m>0&&v.fill(l),[v,g];if(m<=0)throw new Error(_m());let w=0,S=1,T=0,$=a[w];for(;;){let D=0;if(S<u){if(D=a[S],$===D){++S;continue}if($>=D)throw new Error(W2())}if($<0||$>=m)throw new Error(j2($,m));$>T&&v.fill(l,T*f,$*f);for(let R=w;R<S;++R){const I=r[R];if(I<0||I>=c[0])throw new Error(q2(R,r[R],c[0]));for(let V=0;V<f;V++)v[$*f+V]+=n[I*f+V]}if(i)for(let R=0;R<f;R++)v[$*f+R]/=S-w;if(w=S,++S,T=$+1,$=D,S>u)break}return T<m&&v.fill(l,T*f,m*f),[v,g]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rV=Ha(n=>Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aV=Sn((n,e)=>{const t=n-e;return t*t});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sV=Ha((n,e)=>{const{pattern:t,replaceGlobal:r,rewrite:a}=e;return n.replace(new RegExp(t,r?"g":""),a)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(n,e,t,r){const a=mt(n,e.dtype);for(let i=0;i<a.size;i++){const l=a.indexToLoc(i),u=new Array(l.length);for(let c=0;c<u.length;c++)u[c]=l[c]*t[c]+r[c];a.set(e.get(...u),...l)}return a}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oV{constructor(e,t,r,a,i,l){this.separator=xi(e),this.nGramWidths=t,this.leftPad=xi(r),this.rightPad=xi(a),this.padWidth=i,this.preserveShort=l}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,a,i,l){for(let u=0;u<i;++u){const c=this.getPadWidth(l),f=Math.max(0,c-u),p=Math.max(0,c-(i-(u+1))),m=l-(f+p),g=t+(f>0?0:u-c);let x=0;x+=f*this.leftPad.length;for(let $=0;$<m;++$)x+=e[g+$].length;x+=p*this.rightPad.length;const v=f+p+m-1;x+=v*this.separator.length,r[a+u]=new Uint8Array(x);const w=r[a+u];let S=0;const T=$=>$.forEach(D=>w[S++]=D);for(let $=0;$<f;++$)T(this.leftPad),T(this.separator);for(let $=0;$<m-1;++$)T(e[g+$]),T(this.separator);if(m>0){T(e[g+m-1]);for(let $=0;$<p;++$)T(this.separator),T(this.rightPad)}else{for(let $=0;$<p-1;++$)T(this.rightPad),T(this.separator);T(this.rightPad)}}}compute(e,t){const r=e.length,a=t.length;if(a>0){let c=t[0];if(c!==0)throw new Error(`First split value must be 0, got ${c}`);for(let f=1;f<a;++f){let p=t[f]>=c;if(p=p&&t[f]<=r,!p)throw new Error(`Invalid split value ${t[f]}, must be in [${c}, ${r}]`);c=t[f]}if(c!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${c}`)}const i=a-1,l=kt("int32",a);if(r===0||a===0){const c=new Array(r);for(let f=0;f<=i;++f)l[f]=0;return[c,l]}l[0]=0;for(let c=1;c<=i;++c){const f=t[c]-t[c-1];let p=0;this.nGramWidths.forEach(m=>{p+=this.getNumNGrams(f,m)}),this.preserveShort&&f>0&&p===0&&(p=1),l[c]=l[c-1]+p}const u=new Array(l[i]);for(let c=0;c<i;++c){const f=t[c];let p=l[c];if(this.nGramWidths.forEach(m=>{const g=t[c+1]-t[c],x=this.getNumNGrams(g,m);this.createNGrams(e,f,u,p,x,m),p+=x}),this.preserveShort&&p===l[c]){const m=t[c+1]-t[c];if(m===0)continue;const g=m+2*this.padWidth;this.createNGrams(e,f,u,p,1,g)}}return[u,l]}}function lV(n,e,t,r,a,i,l,u){return new oV(t,r,a,i,l,u).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(n,e,t,r){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)r.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let l=n.indexOf(i);for(;l!==-1;){const u=n.subarray(0,l);(!t||u.length!==0)&&r.push(u),n=n.subarray(l+1),l=n.indexOf(i)}(!t||n.length!==0)&&r.push(n);return}let a=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const l=n.subarray(a,i);(!t||l.length!==0)&&r.push(l),a=i+1}}function cV(n,e,t){const r=n.length,a=[];let i=0,l=0;const u=new Array(r);for(let g=0;g<r;++g){const x=a.length;uV(n[g],e,t,a);const v=a.length-x;u[g]=v,i+=v,l=Math.max(l,v)}const c=kt("int32",i*2),f=new Array(i),p=[r,l];let m=0;for(let g=0;g<r;++g)for(let x=0;x<u[g];++x)c[m*2]=g,c[m*2+1]=x,f[m]=a[m],++m;return[c,f,p]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(n,e){const t=kt("int32",n.length);for(let r=0;r<n.length;++r)t[r]=PR(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fV=Sn((n,e)=>n-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(n,e){const t=new Array(n.rank);for(let a=0;a<t.length;a++)t[a]=n.shape[a]*e[a];const r=mt(t,n.dtype);for(let a=0;a<r.values.length;++a){const i=r.indexToLoc(a),l=new Array(n.rank);for(let c=0;c<l.length;c++)l[c]=i[c]%n.shape[c];const u=n.locToIndex(l);r.values[a]=n.values[u]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ou=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function pN(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const u=r-t+1,c=e-t+1,f=Math.log(u),p=.5*Math.exp(2*f/3),m=.5*Math.sqrt(f*p*(u-p)/u)*Math.sign(c-u/2),g=Math.max(t,Math.floor(e-c*p/u+m)),x=Math.min(r,Math.floor(e+(u-c)*p/u+m));pN(n,e,g,x)}const a=n[e];let i=t,l=r;for(Jl(n,t,e),ou(n[r],a)>0&&Jl(n,t,r);i<l;){for(Jl(n,i,l),i++,l--;ou(n[i],a)<0;)i=i+1;for(;ou(n[l],a)>0;)l=l-1}ou(n[t],a)===0?Jl(n,t,l):(l=l+1,Jl(n,l,r)),l<=e&&(t=l+1),e<=l&&(r=l-1)}}function pV(n,e,t,r,a){const i=e[e.length-1],[l,u]=[n.length/i,i],c=Ts(t,l*r),f=Ts("int32",l*r);for(let m=0;m<l;m++){const g=m*u,x=n.subarray(g,g+u);let v=new Array(x.length);x.forEach(($,D)=>v[D]={value:$,index:D}),r<v.length&&(pN(v,r),v=v.slice(0,r)),a&&v.sort(ou);const w=m*r,S=c.subarray(w,w+r),T=f.subarray(w,w+r);for(let $=0;$<r;$++)S[$]=v[$].value,T[$]=v[$].index}const p=e.slice();return p[p.length-1]=r,[mt(p,t,c),mt(p,"int32",f)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(n,e,t,r){const a=Ft(e,t)[0],i=[1,t[0],1];for(let v=0;v<a;v++)i[0]*=t[v];i[1]=t[a];for(let v=a+1;v<t.length;v++)i[2]*=t[v];const l=new Map,u=new Int32Array(t[a]),c=new Uo(i,r,n),f=[],p=i[0]===1&&i[2]===1;for(let v=0;v<t[a];v++){let w;if(p)w=n[v].toString();else{const T=[];for(let $=0;$<i[0];$++)for(let D=0;D<i[2];D++)T.push(c.get($,v,D));w=T.join(",")}const S=l.get(w);if(S!=null)u[v]=S;else{const T=l.size;l.set(w,T),u[v]=T,f.push(v)}}const m=i.slice();m[1]=l.size;const g=new Uo(m,r);f.forEach((v,w)=>{for(let S=0;S<i[0];S++)for(let T=0;T<i[2];T++)g.set(c.get(S,v,T),S,w,T)});const x=t.slice();return x[a]=m[1],{outputValues:g.values,outputShape:x,indices:u}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gV=Object.freeze(Object.defineProperty({__proto__:null,addImpl:pz,bincountImpl:mz,bincountReduceImpl:gz,bitwiseAndImpl:yz,castImpl:hz,ceilImpl:xz,concatImpl:bz,equalImpl:vz,expImpl:Cz,expm1Impl:Sz,floorDivImpl:Tz,floorImpl:wz,gatherNdImpl:Nz,gatherV2Impl:Ez,greaterEqualImpl:Dz,greaterImpl:$z,lessEqualImpl:_z,lessImpl:Rz,linSpaceImpl:Oz,logImpl:kz,maxImpl:Fz,maximumImpl:Az,minimumImpl:Iz,multiplyImpl:hN,negImpl:Lz,notEqualImpl:Bz,prodImpl:Uz,raggedGatherImpl:jz,raggedRangeImpl:qz,raggedTensorToTensorImpl:Xz,rangeImpl:Kz,rsqrtImpl:Yz,scatterImpl:Qz,sigmoidImpl:Zz,simpleAbsImpl:fz,sliceImpl:Jz,sparseFillEmptyRowsImpl:eV,sparseReshapeImpl:tV,sparseSegmentReductionImpl:nV,sqrtImpl:rV,squaredDifferenceImpl:aV,staticRegexReplaceImpl:sV,stridedSliceImpl:iV,stringNGramsImpl:lV,stringSplitImpl:cV,stringToHashBucketFastImpl:dV,subImpl:fV,tileImpl:hV,topKImpl:pV,transposeImpl:Mz,uniqueImpl:mV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:yV,bincountImpl:mN,bincountReduceImpl:xV,bitwiseAndImpl:bV,castImpl:vV,ceilImpl:CV,concatImpl:SV,equalImpl:wV,expImpl:TV,expm1Impl:NV,floorImpl:EV,gatherNdImpl:$V,gatherV2Impl:DV,greaterImpl:RV,greaterEqualImpl:_V,lessImpl:OV,lessEqualImpl:kV,linSpaceImpl:FV,logImpl:AV,maxImpl:IV,maximumImpl:LV,minimumImpl:BV,multiplyImpl:MV,negImpl:UV,notEqualImpl:PV,prodImpl:zV,raggedGatherImpl:VV,raggedRangeImpl:GV,raggedTensorToTensorImpl:HV,rangeImpl:WV,rsqrtImpl:jV,scatterImpl:qV,sigmoidImpl:XV,simpleAbsImpl:gN,sliceImpl:KV,sparseFillEmptyRowsImpl:YV,sparseReshapeImpl:QV,sparseSegmentReductionImpl:yN,sqrtImpl:ZV,staticRegexReplaceImpl:JV,stridedSliceImpl:eG,stringNGramsImpl:tG,stringSplitImpl:nG,stringToHashBucketFastImpl:rG,subImpl:aG,tileImpl:sG,topKImpl:iG,transposeImpl:Mg,uniqueImpl:oG}=gV;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xN(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function tn(n,e){return e===1?[n]:xN(n,e)}function lG(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uG{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Xt(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=tn("rc",this.rank),r=tt(this.rank),a=this.getOutOfBoundsCondition(t),i=this.getSetup(t),l=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${l}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){let i=`${r===0?"r":"rp1"}, ${a===0?"c":"cp1"}`;for(let l=2;l<this.rank;l++)i=`${e[e.length-1-l]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],a=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${a};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bN{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length);let r="";for(let a=0;a<4;a++){let i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${a>0?"}":""}
      `}this.userCode=`
      ${cG(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?Lg():Ig(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function cG(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?rP(["r","c","d"],"inputShape"):Mi(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dG{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,r){const a=Pb(t,r),i=zb(e,a,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const l=Ub(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=l,this.log();const c=this.freeTextures[i].pop();return this.usedTextures[i].push(c),c}let u;return a===zt.PACKED_2X2_FLOAT32?u=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===zt.PACKED_2X2_FLOAT16?u=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===zt.UNPACKED_FLOAT32?u=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===zt.UNPACKED_FLOAT16?u=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===zt.PACKED_4X1_UNSIGNED_BYTE&&(u=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(u),this.numUsedTextures++,this._numBytesAllocated+=l,this.log(),u}releaseTexture(e,t,r,a){if(this.freeTextures==null)return;const i=Pb(r,a),l=zb(t,i,a);l in this.freeTextures||(this.freeTextures[l]=[]);const u=Ub(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,a),c=Z().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=u):(this.freeTextures[l].push(e),this.numFreeTextures++,this._numBytesFree+=u),this.numUsedTextures--;const f=this.usedTextures[l],p=f&&f.indexOf(e);if(p==null||p<0)throw new Error("Cannot release a texture that was never provided by this texture manager");f[p]=f[f.length-1],f.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function fG(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Ub(n,e,t,r,a){const i=hG(e,r);let l;if(a){const[c,f]=Xo(n[0],n[1]);l=c*f}else{const[c,f]=ku(n[0],n[1]);l=c*f}const u=fG(t,i);return l*u}function hG(n,e){switch(n){case zt.PACKED_2X2_FLOAT32:return dN(e);case zt.PACKED_2X2_FLOAT16:return fN(e);case zt.UNPACKED_FLOAT32:return lN(e);case zt.UNPACKED_FLOAT16:return uN(e);case zt.PACKED_4X1_UNSIGNED_BYTE:return cN(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function pG(n){return Z().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?zt.PACKED_2X2_FLOAT32:zt.UNPACKED_FLOAT32:n?zt.PACKED_2X2_FLOAT16:zt.UNPACKED_FLOAT16}function Pb(n,e){if(n===qn.UPLOAD)return zt.PACKED_2X2_FLOAT32;if(n===qn.RENDER||n==null)return pG(e);if(n===qn.DOWNLOAD||n===qn.PIXELS)return zt.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function zb(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class da{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const wr="if (isnan(x)) return x;",mG="return x;",Vb="return abs(x);",gG="return (x >= 0.0) ? x : (exp(x) - 1.0);",yG=wr+`
  return (x < 0.0) ? 0.0 : x;
`,xG=wr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,gs="return x;",bG="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vG="return x;",CG=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,SG=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wG=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,TG="return 1.0 / (1.0 + exp(-1.0 * x));";class vs{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NG{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length);const t=e.length,r=tn("rc",t),a=tt(t),i=lG(t,r),l=r.slice(-2),u=t<=1?"rc":`vec2(${l.join(",")})`;this.userCode=`
      void main() {
        ${a} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${u}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=zT,$G=1e-7,DG=1e-4,rd={};function RG(n){return n in rd||(rd[n]={}),rd[n]}const _G=Z().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),OG=600;function kG(){return Z().global.screen==null?1024:Z().global.screen.height*Z().global.screen.width*window.devicePixelRatio*OG/1024/1024}class uf extends Lv{nextDataId(){return uf.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Z().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof zp)t=e;else{const r=Wr(Z().getNumber("WEBGL_VERSION"),e);t=new zp(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Wr(Z().getNumber("WEBGL_VERSION"));t=new zp(r),this.binaryCache=RG(Z().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new dG(this.gpgpu),this.numMBBeforeWarning=kG(),this.texData=new sR(this,ms())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,r,a,i,l){const u=this.makeTensorInfo(t,r),c=this.texData.get(u.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[a,i]},c.texShape=[a,i];const f=td(t),p=new Ab(f,!1,l),m=this.runWebGLProgram(p,[u],r,[[a,i]]);return m.shape=t,c.texture=null,this.disposeIntermediateTensorInfo(u),m.dataId}write(e,t,r){if((Z().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Z().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:r,values:e,usage:qn.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,a,i){if(Z().getBool("DEBUG")&&this.checkNumericalProblems(t),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:a,values:t,usage:qn.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:a,complexTensorInfos:i,slice:l,shape:u,isPacked:c}=t;if(l!=null){let g;c?g=new vs(u,gs):g=new da(u,gs);const x=this.runWebGLProgram(g,[{dataId:e,shape:u,dtype:a}],a),v=this.readSync(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(r!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return r;const f=this.activeTimers!=null;let p;f&&(p=Pr());let m;if(a==="complex64"){const g=this.readSync(i.real.dataId),x=this.readSync(i.imag.dataId);m=Rm(g,x)}else m=this.getValuesFromTexture(e);return f&&(this.downloadWaitMs+=Pr()-p),this.convertAndCacheOnCPU(e,m)}async read(e){if(this.pendingRead.has(e)){const v=this.pendingRead.get(e);return new Promise(w=>v.push(w))}const t=this.texData.get(e),{values:r,shape:a,slice:i,dtype:l,complexTensorInfos:u,isPacked:c}=t;if(i!=null){let v;c?v=new vs(a,gs):v=new da(a,gs);const w=this.runWebGLProgram(v,[{dataId:e,shape:a,dtype:l}],l),S=this.read(w.dataId);return this.disposeIntermediateTensorInfo(w),S}if(r!=null)return this.convertAndCacheOnCPU(e);if(Z().getBool("DEBUG")&&!Z().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Z().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let f=null,p;if(l!=="complex64"&&Z().get("WEBGL_BUFFER_SUPPORTED")){p=this.decode(e);const v=this.texData.get(p.dataId);f=this.gpgpu.createBufferFromTexture(v.texture.texture,...Zc(a))}this.pendingRead.set(e,[]),l!=="complex64"&&await this.gpgpu.createAndWaitForFence();let m;if(l==="complex64"){const v=await Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]),w=v[0],S=v[1];m=Rm(w,S)}else if(f==null)m=this.getValuesFromTexture(e);else{const v=pe(a);m=this.gpgpu.downloadFloat32MatrixFromBuffer(f,v)}if(p!=null&&this.disposeIntermediateTensorInfo(p),f!=null){const v=this.gpgpu.gl;Ce(v,()=>v.deleteBuffer(f))}const g=this.convertAndCacheOnCPU(e,m),x=this.pendingRead.get(e);return this.pendingRead.delete(e),x.forEach(v=>v(g)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ms().removeDataId(e,this),this.pendingDeletes--),g}readToGPU(e,t={}){const r=this.texData.get(e),{values:a,shape:i,slice:l,dtype:u,isPacked:c,texture:f}=r;if(u==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(l!=null){let x;c?x=new vs(i,gs):x=new da(i,gs);const v=this.runWebGLProgram(x,[{dataId:e,shape:i,dtype:u}],u),w=this.readToGPU(v,t);return this.disposeIntermediateTensorInfo(v),w}if(f==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const p=this.decode(e,t.customTexShape),m=ms().makeTensorFromTensorInfo(p),g=this.texData.get(p.dataId);return Object.assign({tensorRef:m},g.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(a=>Mo(a));return mt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return mt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!_U(r))throw Z().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:a}=this.texData.get(e),i=pe(t);if(Z().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const g=this.decode(e),x=this.texData.get(g.dataId),v=this.gpgpu.downloadMatrixFromPackedTexture(x.texture.texture,...Zc(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(g),v}const l=Z().getBool("WEBGL_PACK")&&a===!0,u=l?td(t):t,c=l?new jP(u):new WP(u),f=this.runWebGLProgram(c,[{shape:u,dtype:r,dataId:e}],"float32"),p=this.texData.get(f.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(f),m}timerAvailable(){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=Si(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),l=Si(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=t,a&&(this.programTimersStack=null);const u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const c=await Promise.all(i);u.kernelMs=iR(c),u.getExtraProfileInfo=()=>c.map((f,p)=>({name:l[p],ms:f})).map(f=>`${f.name}: ${f.ms}`).join(", ")}else u.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,u})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Pr(),endMs:null}}endTimer(e){return Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Pr(),e)}async getQueryTime(e){if(Z().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:a,usage:i,isPacked:l,slice:u}=this.texData.get(e),c=u&&u.origDataId||e,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),t!=null&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(t,a,i,l)));const p=this.texData.get(e);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=_G){return Z().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&pe(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Gr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return EG(e.shape,t)}packedUnaryOp(e,t,r){const a=new vs(e.shape,t),i=this.compileAndRun(a,[e],r);return ms().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=gN(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(Z().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Vb,e.dtype);const t=new da(e.shape,Vb),r=this.compileAndRun(t,[e]);return ms().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let a;if(t==="string"&&r!=null&&r.length>0&&jd(r[0])){const i=r.map(l=>xi(l));a=this.write(i,e,t)}else a=this.write(r,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,r){return ms().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new NG(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new uG(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const r=[Vo(e.shape),...Go(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Vo(t),...Go(t)],l=new bN(i,r),u=!0,c=[r],f=this.runWebGLProgram(l,[a],e.dtype,c,u);return{dataId:f.dataId,shape:t,dtype:f.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:a,shape:i,dtype:l}=r;if(t!=null){const g=pe(i),x=t[0]*t[1]*4;A(g<=x,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const u=td(i);let c;a?c=new HP(u):c=new GP(u);const f=!0,p=[t??Zc(u)],m=this.runWebGLProgram(c,[{shape:u,dtype:l,dataId:e}],l,p,f,t);return{dtype:l,shape:i,dataId:m.dataId}}runWebGLProgram(e,t,r,a,i=!1,l){const u=this.makeTensorInfo(e.outputShape,r),c=this.texData.get(u.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===Su.DENSE){const T=l??Zc(e.outputShape);c.texShape=T.map($=>$*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),pe(u.shape)===0)return c.values=Ts(u.dtype,0),u;const f=[],p=t.map(T=>{if(T.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let $=this.texData.get(T.dataId);if($.texture==null){if(!e.packedInputs&&pe(T.shape)<=Z().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:T.shape,texData:null,isUniform:!0,uniformValues:$.values};e.packedInputs&&($.isPacked=!0,$.shape=T.shape)}if(this.uploadToGPU(T.dataId),!!$.isPacked!=!!e.packedInputs)T=$.isPacked?this.unpackTensor(T):this.packTensor(T),f.push(T),$=this.texData.get(T.dataId);else if($.isPacked&&!Id($.shape,T.shape)){const D=T,R=T.shape;T.shape=$.shape,T=this.packedReshape(T,R),f.push(T),$=this.texData.get(T.dataId),D.shape=R}return{shape:T.shape,texData:$,isUniform:!1}});this.uploadToGPU(u.dataId);const m={shape:u.shape,texData:c,isUniform:!1},g=VP(e,p,m),x=this.getAndSaveBinary(g,()=>PP(this.gpgpu,e,p,m)),v=this.activeTimers!=null;let w;v&&(w=this.startTimer()),Z().get("ENGINE_COMPILE_ONLY")||zP(this.gpgpu,x,p,m,a),f.forEach(T=>this.disposeIntermediateTensorInfo(T)),v&&(w=this.endTimer(w),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(w)}));const S=Z().getNumber("WEBGL_FLUSH_THRESHOLD");if(S>0){const T=Pr();T-this.lastGlFlushTime>S&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=T)}if(!Z().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&i===!1){const T=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),T}return u}compileAndRun(e,t,r,a,i=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,a,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Z().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Me(()=>{if(!Z().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Z().getBool("DEBUG");Z().set("DEBUG",!1);const t=this.abs(ze(1e-8)).dataSync()[0];if(Z().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?$G:DG}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:a,values:i,texture:l,usage:u,isPacked:c}=t;if(l!=null)return;const f=this.activeTimers!=null;let p;f&&(p=Pr());let m=t.texShape;if(m==null&&(m=XU(r,c),t.texShape=m),i!=null){const g=td(r);let x,v=m[1],w=m[0];const S=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(c||!S)&&([v,w]=Xo(m[0],m[1])),c?x=new XP(g,S):x=new Ab(g,S);const T=S?[w,v]:m,$=this.makeTensorInfo(T,a),D=this.texData.get($.dataId);S?D.usage=qn.PIXELS:D.usage=qn.UPLOAD,D.texShape=T,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture($.dataId),v,w,i);const R=[[w,v]],V=this.runWebGLProgram(x,[$],a,R,!0),j=this.texData.get(V.dataId);t.texShape=j.texShape,t.isPacked=j.isPacked,t.usage=j.usage,Z().get("ENGINE_COMPILE_ONLY")?this.disposeData(V.dataId):(t.texture=j.texture,t.values=null,this.texData.delete(V.dataId)),this.disposeIntermediateTensorInfo($),f&&(this.uploadWaitMs+=Pr()-p)}else{const g=this.acquireTexture(m,u,a,c);t.texture=g}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:a}=r;return t!=null&&(r.values=FG(t,a)),r.values}acquireTexture(e,t,r,a){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*wd(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(a=>{try{this.checkCompletion_(t),a(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await NB(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(nN(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:r,infLoc:a,nanLoc:i,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:c}=oN(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=r,e.infLoc=a,e.nanLoc=i,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=c}}createTensorFromGPUData(e,t,r){e.channels=e.channels||"RGBA";const{texture:a,height:i,width:l,channels:u}=e,c=ms().backend;if(!c.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const f=c.writeTexture(a,t,r,i,l,u);return ms().makeTensorFromDataId(f,t,r,c)}}uf.nextDataId=0;function FG(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Hw()&&i_("webgl",()=>new uf,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ug=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Fi{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=We(t,r),this.enableShapeUniforms=Xt(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pi=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Jo{constructor(e,t,r,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=We(t,r);const i=this.outputShape.length;this.enableShapeUniforms=Xt(i);let l="";if(a)if(i===0||pe(this.outputShape)===1)l=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(l=`
          ${tt(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?l+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:l+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const c=tn("coords",i);this.enableShapeUniforms?l+=`
            bool nextRowOutOfBounds =
              (${c[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${c[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:l+=`
            bool nextRowOutOfBounds =
              (${c[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${c[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${l}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function In(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const AG={kernelName:ag,backendName:"webgl",kernelFunc:In};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(n){const{inputs:e,backend:t}=n,{real:r,imag:a}=e,i=t.makeTensorInfo(r.shape,"complex64"),l=t.texData.get(i.dataId),u=In({inputs:{x:r},backend:t}),c=In({inputs:{x:a},backend:t});return l.complexTensorInfos={real:u,imag:c},i}const IG={kernelName:uC,backendName:"webgl",kernelFunc:Fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vN="return (a < 0.) ? b * a : a;",CN=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function LG(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{alpha:i}=r,l=t.makeTensorInfo([],"float32",Wo(i,"float32")),u=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(CN,a.shape,l.shape):new Fi(vN,a.shape,l.shape),c=t.runWebGLProgram(u,[a,l],"float32");return t.disposeIntermediateTensorInfo(l),c}const BG={kernelName:ZC,backendName:"webgl",kernelFunc:LG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SN="return (a < 0.) ? b * a : a;",wN=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function MG(n){const{inputs:e,backend:t}=n,{x:r,alpha:a}=e,i=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(wN,r.shape,a.shape):new Fi(SN,r.shape,a.shape);return t.runWebGLProgram(i,[r,a],"float32")}const UG={kernelName:_S,backendName:"webgl",kernelFunc:MG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const el="if (isnan(x)) return x;";function Ge({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:a,backend:i})=>{const{x:l}=a,u=i,c=r||l.dtype;if(u.shouldExecuteOnCPU([l])&&t!=null){const m=u.texData.get(l.dataId),g=t(m.values,c);return u.makeTensorInfo(l.shape,c,g)}const f=Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let p;return f?p=new vs(l.shape,e):p=new da(l.shape,n),u.runWebGLProgram(p,[l],c)}}function Ht({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:l,backend:u})=>{const{a:c,b:f}=l,p=u;if(r&&c.dtype==="complex64"){const v=p.texData.get(c.dataId),w=p.texData.get(f.dataId),[S,T]=[[v.complexTensorInfos.real,w.complexTensorInfos.real],[v.complexTensorInfos.imag,w.complexTensorInfos.imag]].map(D=>{const[R,I]=D,V={dataId:R.dataId,dtype:R.dtype,shape:c.shape},j={dataId:I.dataId,dtype:I.dtype,shape:f.shape},K=new Fi(n,c.shape,f.shape);return p.runWebGLProgram(K,[V,j],pa(R.dtype,I.dtype))}),$=Fs({inputs:{real:S,imag:T},backend:p});return p.disposeIntermediateTensorInfo(S),p.disposeIntermediateTensorInfo(T),$}const m=i||pa(c.dtype,f.dtype);if((c.dtype==="string"||f.dtype==="string"||p.shouldExecuteOnCPU([c,f]))&&a!=null){const v=p.texData.get(c.dataId).values,w=p.texData.get(f.dataId).values,S=c.dtype==="string"?zo(v):v,T=c.dtype==="string"?zo(w):w,[$,D]=a(c.shape,f.shape,S,T,m),R=p.makeTensorInfo(D,m),I=p.texData.get(R.dataId);return I.values=$,R}const g=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let x;return g?x=new Jo(e,c.shape,f.shape,t):x=new Fi(n,c.shape,f.shape),p.runWebGLProgram(x,[c,f],m)}}function wu(n,e=!1){if(n==="linear")return e?vG:mG;if(n==="relu")return e?SG:yG;if(n==="elu")return e?CG:gG;if(n==="relu6")return e?wG:xG;if(n==="prelu")return e?wN:SN;if(n==="leakyrelu")return e?CN:vN;if(n==="sigmoid")return e?TG:bG;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TN{constructor(e,t,r,a=!1,i=!1,l=!1,u=null,c=!1,f=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Xt(this.outputShape.length);const p=a?e[1]:e[2],m=Math.ceil(p/2),g=a?"i * 2, rc.y":"rc.y, i * 2",x=i?"rc.z, i * 2":"i * 2, rc.z",v=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],w=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let S="",T="";u&&(c?S=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${u}
        }`:f?S=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${u}
        }`:S=`vec4 activation(vec4 x) {
          ${u}
        }`,T="result = activation(result);");const $=l?"result += getBiasAtOutCoords();":"";l&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),f&&this.variableNames.push("leakyreluAlpha");let D="rc.x",R="rc.x";e[0]<t[0]?D=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(R=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${S}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${m}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${D};
        int batchB = ${R};
        for (int i = 0; i < ${m}; i++) {
          vec4 a = getMatrixA(batchA, ${g});
          vec4 b = getMatrixB(batchB, ${x});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${v[0]} * ${w[0]});
          result += (${v[1]} * ${w[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${$}

        ${T}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gb={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Hb{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=We(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wb="return a * b;";function Pg(n){const{inputs:e,backend:t}=n,{a:r,b:a}=e,i=pa(r.dtype,a.dtype);if(r.dtype==="complex64"){const u=t.texData.get(r.dataId),c=t.texData.get(a.dataId),f=new Hb(Gb.REAL,r.shape,a.shape),p=new Hb(Gb.IMAG,r.shape,a.shape),m=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:r.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:a.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:a.shape}],g=t.runWebGLProgram(f,m,"float32"),x=t.runWebGLProgram(p,m,"float32"),v=Fs({inputs:{real:g,imag:x},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(x),v}if(t.shouldExecuteOnCPU([r,a])){const u=t.texData.get(r.dataId),c=t.texData.get(a.dataId),[f,p]=MV(r.shape,a.shape,u.values,c.values,i),m=t.makeTensorInfo(p,i),g=t.texData.get(m.dataId);return g.values=f,m}let l;return Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?l=new Jo(Wb,r.shape,a.shape):l=new Fi(Wb,r.shape,a.shape),t.runWebGLProgram(l,[r,a],i)}const PG={kernelName:bS,backendName:"webgl",kernelFunc:Pg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zG(n,e,t){const r=[Vo(n.shape),...Go(n.shape)],a={dtype:n.dtype,shape:r,dataId:n.dataId},i=[Vo(e),...Go(e)],l=new bN(i,r),u=!0,c=[r],f=t.runWebGLProgram(l,[a],n.dtype,c,u);return{dataId:f.dataId,shape:e,dtype:f.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function be(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{shape:i}=r,l=t,u=pe(a.shape),c=lR(i,u),f=pe(c);A(u===f,()=>`The new shape (${c}) has ${f} elements and the old shape (${a.shape}) has ${u} elements. The new shape and old shape must have the same number of elements.`);const p=l.texData.get(a.dataId);return p.isPacked&&!Id(a.shape,c)&&!(p.texture!==null&&Id(p.shape,c))?zG(a,c,l):(l.incRef(a.dataId),{dataId:a.dataId,shape:c,dtype:a.dtype})}const VG={kernelName:US,backendName:"webgl",kernelFunc:be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jb{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:i,outSize:l}=e;this.outputShape=[a,l];const u=Math.floor(r/4)*4,c=r%4;let f="sumValue += dot(values, ones);";if(t!=null){const m=1/t;f=`sumValue += dot(values * ${Bo(m)?m.toPrecision(2):m}, ones);`}let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${u};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${f}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${f}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${f}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GG{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:i,outSize:l}=e;this.outputShape=[a,l];let u="0.0",c="";t==="prod"?u="1.0":t==="min"?(u="1.0 / 1e-20",c="min"):t==="max"&&(u="-1.0 / 1e-20",c="max");let f=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?f="sumValue":t==="prod"?f="prodValue":t==="all"?f="allValue":t==="any"&&(f="anyValue");const p=Math.floor(r/4)*4,m=r%4;let g=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${c}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,x="vec4";t==="all"?(u="1.0",g=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,x="bvec4"):t==="any"&&(u="0.0",g=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,x="bvec4");let v="";i%r>0&&(v=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${u};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${v}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${u});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${p}; i += 4) {
          int inIdx = inOffset + i;
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${g}
        }

        int inIdx = inOffset + ${p};
        if (${m===1}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${g}
        } else if (${m===2}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${g}
        } else if (${m===3}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${g}
        }
        setOutput(${f});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=of(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function zi(n,e,t,r){const a=HG(n.shape);let i=n;for(let l=0;l<a.length;l++){const{inSize:u,windowSize:c,outSize:f}=a[l];let p,m;t==="mean"?p=l===0?new jb({windowSize:c,inSize:u,batchSize:n.shape[0],outSize:f},u):new jb({windowSize:c,inSize:u,batchSize:n.shape[0],outSize:f}):p=new GG({windowSize:c,inSize:u,batchSize:n.shape[0],outSize:f},t),m=i,i=r.runWebGLProgram(p,[i],e),m.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(m)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WG{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let l=0;l<r.length;l++)r[l]=e[t[l]];this.outputShape=r,this.rank=r.length;const a=tt(this.rank),i=jG(t);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function jG(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let a=0;a<n.length;a++)r[n[a]]=t[a];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qG{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let p=0;p<r.length;p++)r[p]=e[t[p]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const a=tt(this.rank),i=xN("rc",this.rank),l=new Array(this.rank);for(let p=0;p<t.length;p++)l[t[p]]=i[p];const u=`vec2(${l.slice(-2).join()})`,c=`++${i[this.rank-1]} < ${r[this.rank-1]}`,f=`getChannel(getA(${l.join()}), ${u})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${f};
      if(${c}) {
        result[1] = ${f};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${f};
        if(${c}) {
          result[3] = ${f};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cf(n,e,t){const r=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qG(n.shape,e):new WG(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(n,e,t,r){const a=e,i=n.shape.length,l=Ft(a,n.shape);let u=l;const c=Cr(u,i),f=c!=null;let p=n;f&&(p=cf(n,c,r),u=Sr(u.length,i)),qr("sum",u,i);const[m,g]=ma(p.shape,u);let x=m;t&&(x=Zn(m,l));const v=pe(g),S=pe(n.shape)/v,T=be({inputs:{x:p},attrs:{shape:[S,v]},backend:r}),$=ig(n.dtype),D=zi(T,$,"sum",r),R=be({inputs:{x:D},attrs:{shape:x},backend:r});return r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(D),f&&r.disposeIntermediateTensorInfo(p),R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function df(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,keepDims:l}=r;return XG(a,i,l,t)}const KG={kernelName:aw,backendName:"webgl",kernelFunc:df};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rn(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{perm:i}=r,l=t,u=a.shape.length,c=new Array(u);for(let p=0;p<c.length;p++)c[p]=a.shape[i[p]];let f;if(l.shouldExecuteOnCPU([a])){const m=l.texData.get(a.dataId).values,g=Mg(m,a.shape,a.dtype,i,c);f=l.makeTensorInfo(c,a.dtype);const x=l.texData.get(f.dataId);x.values=g}else f=cf(a,i,l);return f}const YG={kernelName:od,backendName:"webgl",kernelFunc:rn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NN=1e3;function Bd({a:n,b:e,transposeA:t,transposeB:r,backend:a,bias:i=null,preluActivationWeights:l=null,leakyreluAlpha:u=0,activation:c=null}){const f=n.shape.length,p=e.shape.length,m=t?n.shape[f-2]:n.shape[f-1],g=r?e.shape[p-1]:e.shape[p-2],x=t?n.shape[f-1]:n.shape[f-2],v=r?e.shape[p-2]:e.shape[p-1],w=n.shape.slice(0,-2),S=e.shape.slice(0,-2),T=pe(w),$=pe(S),R=We(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([x,v]);A(m===g,()=>`Error in matMul: inner shapes (${m}) and (${g}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const I=t?[T,m,x]:[T,x,m],V=r?[$,v,g]:[$,g,v],j=be({inputs:{x:n},backend:a,attrs:{shape:I}}),K=be({inputs:{x:e},backend:a,attrs:{shape:V}}),B=[j,K],U=Math.max(T,$),k=t?j.shape[1]:j.shape[2],ee=i!=null,he=l!=null,fe=c==="leakyrelu",me=c!=null?wu(c,!0):null,ae=ee||he||fe||me!=null;let de;if((x===1||v===1)&&k>NN&&ae===!1){let Q=j,F=K;t&&(Q=rn({inputs:{x:j},backend:a,attrs:{perm:[0,2,1]}}),B.push(Q)),r&&(F=rn({inputs:{x:K},backend:a,attrs:{perm:[0,2,1]}}),B.push(F));const P=v!==1,G=v===1;let te=Q;P&&(te=be({inputs:{x:Q},backend:a,attrs:{shape:[U,k,1]}}),B.push(te));const re=v===1?2:1;let xe=F;G&&(xe=be({inputs:{x:F},backend:a,attrs:{shape:[U,1,k]}}),B.push(xe));const ye=Pg({inputs:{a:te,b:xe},backend:a});de=df({inputs:{x:ye},backend:a,attrs:{axis:re,keepDims:!0}}),B.push(ye)}else{const Q=pa(n.dtype,e.dtype),F=new TN(I,V,[U,x,v],t,r,ee,me,he,fe),P=[j,K];if(i!=null&&P.push(i),he&&P.push(l),fe){const G=a.makeTensorInfo([],"float32",Wo(u,"float32"));P.push(G),B.push(G)}de=a.runWebGLProgram(F,P,Q)}const le=be({inputs:{x:de},backend:a,attrs:{shape:R}});B.push(de);for(const Q of B)a.disposeIntermediateTensorInfo(Q);return le}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(n){const{inputs:e,backend:t,attrs:r}=n,{a,b:i,bias:l,preluActivationWeights:u}=e,{transposeA:c,transposeB:f,activation:p,leakyreluAlpha:m}=r;return Bd({a,b:i,transposeA:c,transposeB:f,backend:t,bias:l,preluActivationWeights:u,leakyreluAlpha:m,activation:p})}const ZG={kernelName:um,backendName:"webgl",kernelFunc:QG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qb="return abs(x);";function JG(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=t.texData.get(r.dataId),l=gN(i.values);return t.makeTensorInfo(r.shape,r.dtype,l)}let a;return Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new vs(r.shape,qb):a=new da(r.shape,qb),t.runWebGLProgram(a,[r],r.dtype)}const e6={kernelName:zv,backendName:"webgl",kernelFunc:JG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6=wr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,n6=Ge({opSnippet:t6}),r6={kernelName:Vv,backendName:"webgl",kernelFunc:n6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a6=wr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,s6=Ge({opSnippet:a6}),i6={kernelName:Gv,backendName:"webgl",kernelFunc:s6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xb="return a + b;",o6=Ht({opSnippet:Xb,packedOpSnippet:Xb,supportsComplex:!0,cpuKernelImpl:yV}),l6={kernelName:ng,backendName:"webgl",kernelFunc:o6};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u6{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,l)=>`T${l}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const a=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c6{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,l)=>`T${l}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const a=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xd(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return In({inputs:{x:r[0]},backend:t});if(r.length>Z().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(r.length/2),f=xd({inputs:r.slice(0,c),backend:t}),p=xd({inputs:r.slice(c),backend:t});return xd({inputs:[f,p],backend:t})}const a=r.map(c=>c.dtype).reduce((c,f)=>pa(c,f)),i=r.map(c=>c.shape),u=Z().getBool("WEBGL_PACK")?new c6(r[0].shape,i):new u6(r[0].shape,i);return t.runWebGLProgram(u,r,a)}const d6={kernelName:Hv,backendName:"webgl",kernelFunc:xd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,keepDims:l}=r,u=a.shape.length,c=Ft(i,a.shape);let f=c;const p=Cr(f,u);let m=a;p!=null&&(m=rn({inputs:{x:a},backend:t,attrs:{perm:p}}),f=Sr(f.length,u)),qr("all",f,u);const[g,x]=ma(m.shape,f),v=pe(x),w=be({inputs:{x:m},backend:t,attrs:{shape:[-1,v]}}),S=zi(w,w.dtype,"all",t);let T;if(l){const $=Zn(g,c);T=be({inputs:{x:S},backend:t,attrs:{shape:$}})}else T=be({inputs:{x:S},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),p!=null&&t.disposeIntermediateTensorInfo(m),T}const h6={kernelName:Wv,backendName:"webgl",kernelFunc:f6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,keepDims:l}=r,u=a.shape.length,c=Ft(i,a.shape);let f=c;const p=Cr(f,u);let m=a;p!=null&&(m=rn({inputs:{x:a},backend:t,attrs:{perm:p}}),f=Sr(f.length,u)),qr("any",f,u);const[g,x]=ma(m.shape,f),v=pe(x),w=be({inputs:{x:m},backend:t,attrs:{shape:[-1,v]}}),S=zi(w,w.dtype,"any",t);let T;if(l){const $=Zn(g,c);T=be({inputs:{x:S},backend:t,attrs:{shape:$}})}else T=be({inputs:{x:S},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),p!=null&&t.disposeIntermediateTensorInfo(m),T}const m6={kernelName:jv,backendName:"webgl",kernelFunc:p6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g6{constructor(e,t,r){this.variableNames=["A"];const{windowSize:a,batchSize:i,outSize:l}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,l];const u=t==="max"?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${a};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${a}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${u} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y6{constructor(e,t,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,A(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],l=Math.ceil(i/t);this.outputShape=e.slice(0,-1),l>1&&this.outputShape.push(l),a||this.variableNames.push("bestIndicesA");const u=this.outputShape,c=u.length,f=tt(c),p=tn("coords",c);let m,g;if(l===1){g=c+1;const K=tt(g);m=`
        ${K} sourceLocR = ${K}(${p.join()}, 0);
        ++${p[c-1]};
        ${K} sourceLocG = ${K}(${p.join()}, 0);
        ++${p[c-2]};
        ${K} sourceLocA = ${K}(${p.join()}, 0);
        --${p[c-1]};
        ${K} sourceLocB = ${K}(${p.join()}, 0);
        --${p[c-2]};`}else g=c,m=`
        ${f} sourceLocR = coords;
        ++${p[c-1]};
        ${f} sourceLocG = coords;
        ++${p[c-2]};
        ${f} sourceLocA = coords;
        --${p[c-1]};
        ${f} sourceLocB = coords;
        --${p[c-2]};`;const x=["x","y","z","w","u","v"].slice(0,g),v="."+x[g-1],w=x.map(K=>"int "+K),S=tn("sourceLocR",g-1).concat("inIdx.r"),T=tn("sourceLocG",g-1).concat("inIdx.g"),$=tn("sourceLocB",g-1).concat("inIdx.b"),D=tn("sourceLocA",g-1).concat("inIdx.a"),R=r==="max"?"greaterThan":"lessThan",I=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${$.join()}),
                             getBestIndicesAChannel(${D.join()})));`,V=`vec4(
            getAChannel(${S.join()}),
            hasNextCol ? getAChannel(${T.join()}) : 0.,
            hasNextRow ? getAChannel(${$.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${D.join()}) : 0.)`,j=a?"":`
      float getBestIndicesAChannel(${w.join()}) {
        return getChannel(getBestIndicesA(${x.join()}),
                                          vec2(${x.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${w.join()}) {
        return getChannel(getA(${x.join()}),
                               vec2(${x.slice(-2).join()}));
      }
      ${j}
      void main() {
        ${f} coords = getOutputCoords();
        bool hasNextCol = ${p[c-1]} < ${u[c-1]-1};
        bool hasNextRow = ${p[c-2]} < ${u[c-2]-1};
        ${m}
        ivec4 srcIdx = ivec4(sourceLocR${v}, sourceLocG${v},
          sourceLocB${v}, sourceLocA${v}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${V};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${I}
          vec4 candidate = ${V};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${R}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(n,e,t,r=null){let a=e.shape[0],i=e.shape[1];r!=null&&(a=r.shape[0],i=r.shape[1]);const l=of(i),u={windowSize:l,inSize:i,batchSize:a,outSize:Math.ceil(i/l)},c=new g6(u,t,r==null),f=[e];r!=null&&f.push(r);const p=n.runWebGLProgram(c,f,"int32");if(p.shape[1]===1)return p;const m=EN(n,e,t,p);return n.disposeIntermediateTensorInfo(p),m}function $N(n,e,t,r=null){const a=r!=null?r.shape:e.shape,i=a[a.length-1],l=of(i),u=new y6(a,l,t,r==null),c=r==null?[e]:[e,r],f=n.runWebGLProgram(u,c,"int32");if(f.shape.length===e.shape.length){const p=$N(n,e,t,f);return n.disposeIntermediateTensorInfo(f),p}return f}function DN(n,e,t,r){const a=[t];if(qr("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!Z().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],l=n.texData.get(e.dataId),u=l!==null&&l.isPacked;let c=e;u&&(c=n.unpackTensor(e),i.push(c));const[f,p]=ma(c.shape,a),m=pe(p),g=be({inputs:{x:c},backend:n,attrs:{shape:[-1,m]}});i.push(g);const x=EN(n,g,r);i.push(x);const v=be({inputs:{x},backend:n,attrs:{shape:f}});return i.forEach(w=>n.disposeIntermediateTensorInfo(w)),v}return $N(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i}=r;let l=Ft(i,a.shape);const u=Cr(l,a.shape.length);let c=a;const f=[];u!=null&&(c=rn({inputs:{x:a},backend:t,attrs:{perm:u}}),f.push(c),l=Sr(l.length,c.shape.length)),qr("argMax",[l[0]],c.shape.length);const p=DN(t,c,l[0],"max");return f.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const b6={kernelName:qv,backendName:"webgl",kernelFunc:x6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v6(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i}=r;let l=Ft(i,a.shape);const u=Cr(l,a.shape.length);let c=a;const f=[];u!=null&&(c=rn({inputs:{x:a},backend:t,attrs:{perm:u}}),f.push(c),l=Sr(l.length,c.shape.length)),qr("argMin",[l[0]],c.shape.length);const p=DN(t,c,l[0],"min");return f.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const C6={kernelName:Xv,backendName:"webgl",kernelFunc:v6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S6=wr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,w6=Ge({opSnippet:S6}),T6={kernelName:Kv,backendName:"webgl",kernelFunc:w6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N6=wr+"return log(x + sqrt(x * x + 1.0));",E6=Ge({opSnippet:N6}),$6={kernelName:Yv,backendName:"webgl",kernelFunc:E6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D6=wr+`
  return atan(x);
`,R6=Ge({opSnippet:D6}),_6={kernelName:Qv,backendName:"webgl",kernelFunc:R6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O6=Ug+`
  return atan(a, b);
`,k6=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pi+`
  return result;
`,F6=Ht({opSnippet:O6,packedOpSnippet:k6}),A6={kernelName:Jv,backendName:"webgl",kernelFunc:F6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6=wr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,L6=Ge({opSnippet:I6}),B6={kernelName:Zv,backendName:"webgl",kernelFunc:L6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tu{constructor(e,t,r,a=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const l=e.filterWidth,u=e.strideHeight,c=e.strideWidth,f=e.dilationHeight,p=e.dilationWidth,m=e.effectiveFilterHeight,g=e.effectiveFilterWidth,x=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg",S=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,T=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let $="0.0";if(w||($="-1.0 / 1e-20"),r){const K=">=";this.userCode=`
        const ivec2 strides = ivec2(${u}, ${c});
        const ivec2 pads = ivec2(${x}, ${v});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${m};
              wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g};
                wC += ${p}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${K} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${a?i?S:T:`wR * ${g} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const D="max";let R=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(R="avgValue / max(count, 1.0)");const I=Math.floor(l/4)*4,V=l%4,j=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${D}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${u}, ${c});
      const ivec2 pads = ivec2(${x}, ${v});
      const float initializationValue = ${$};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${$});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${m};
            wR += ${f}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${I}; wC += 4) {
            int xC = xCCorner + wC * ${p};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${p}, d),
              getValue(batch, xR, xC + 2 * ${p}, d),
              getValue(batch, xR, xC + 3 * ${p}, d)
            );

            ${j}
          }

          int xC = xCCorner + ${I};
          if (${V===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${j}
          } else if (${V===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${p}, d),
              initializationValue,
              initializationValue
            );

            ${j}
          } else if (${V===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${p}, d),
              getValue(batch, xR, xC + 2 * ${p}, d),
              initializationValue
            );

            ${j}
          }
        }
        setOutput(${R});
      }
    `}}class zg{constructor(e,t,r,a=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const l=e.filterWidth,u=e.strideDepth,c=e.strideHeight,f=e.strideWidth,p=e.dilationDepth,m=e.dilationHeight,g=e.dilationWidth,x=e.effectiveFilterDepth,v=e.effectiveFilterHeight,w=e.effectiveFilterWidth,S=e.padInfo.front,T=e.padInfo.top,$=e.padInfo.left;this.outputShape=e.outShape;const D=t==="avg";let R="0.0";if(D||(R="-1.0 / 1e-20"),r){const U=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${u}, ${c}, ${f});
        const ivec3 pads = ivec3(${S}, ${T}, ${$});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${x};
              wD += ${p}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${v};
                wR += ${m}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${w};
                  wC += ${g}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${U} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${a?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${v} * ${w} +
                      wR * ${w} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const I="max";let V=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(V="avgValue / max(count, 1.0)");const j=Math.floor(l/4)*4,K=l%4,B=`
      if (${D}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${I}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${u}, ${c}, ${f});
      const ivec3 pads = ivec3(${S}, ${T}, ${$});
      const float initializationValue = ${R};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${R});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${x};
            wD += ${p}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${v};
            wR += ${m}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${j}; wC += 4) {
              int xC = xCCorner + wC * ${g};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${g}, ch),
                getValue(batch, xD, xR, xC + 2 * ${g}, ch),
                getValue(batch, xD, xR, xC + 3 * ${g}, ch)
              );

              ${B}
            }

            int xC = xCCorner + ${j};
            if (${K===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${B}
            } else if (${K===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${g}, ch),
                initializationValue,
                initializationValue
              );

              ${B}
            } else if (${K===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${g}, ch),
                getValue(batch, xD, xR, xC + 2 * ${g}, ch),
                initializationValue
              );

              ${B}
            }
          }
        }
        setOutput(${V});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e;Fu(a,"avgPool");const{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,f=1;A(Ln(l,f),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${l} and dilations '${f}'`);const p=Ii(a.shape,i,l,f,u,c);if(p.filterWidth===1&&p.filterHeight===1&&pt(p.inShape,p.outShape))return In({inputs:{x:a},backend:t});const m=new Tu(p,"avg",!1);return t.runWebGLProgram(m,[a],"float32")}const U6={kernelName:eC,backendName:"webgl",kernelFunc:M6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{filterSize:i,strides:l,pad:u,dimRoundingMode:c,dataFormat:f}=r,p=[1,1,1],m=Du(a.shape,i,l,p,u,c,f),g=new zg(m,"avg",!1);return t.runWebGLProgram(g,[a],"float32")}const z6={kernelName:tC,backendName:"webgl",kernelFunc:P6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V6{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=c-1-e.padInfo.top,m=f-1-e.padInfo.left,g=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${p}, ${m});
      const float avgMultiplier = float(${g});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${l}) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${f};
            wC+= ${u}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class G6{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,a=e.filterWidth,i=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,f=e.dilationHeight,p=e.dilationWidth,m=e.effectiveFilterDepth,g=e.effectiveFilterHeight,x=e.effectiveFilterWidth,v=m-1-e.padInfo.front,w=g-1-e.padInfo.top,S=x-1-e.padInfo.left,T=1/(t*r*a);this.userCode=`
      const ivec3 pads = ivec3(${v}, ${w}, ${S});
      const float avgMultiplier = float(${T});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${m};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${g};
              wR += ${f}) {
            float dyR = float(dyRCorner + wR) / ${l}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${x};
                wC += ${p}) {
              float dyC = float(dyCCorner + wC) / ${u}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,input:i}=e,l=i,{filterSize:u,strides:c,pad:f,dimRoundingMode:p}=r,m=[1,1,1],g=Du(l.shape,u,c,m,f,p),x=new G6(g);return t.runWebGLProgram(x,[a],l.dtype)}const W6={kernelName:SR,backendName:"webgl",kernelFunc:H6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,input:i}=e,l=i;Fu([a,i],"avgPoolGrad");const{filterSize:u,strides:c,pad:f}=r,p=Ii(l.shape,u,c,1,f),m=new V6(p);return t.runWebGLProgram(m,[a],l.dtype)}const q6={kernelName:CR,backendName:"webgl",kernelFunc:j6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(n){const{inputs:e,backend:t,attrs:r}=n,{a,b:i}=e,{transposeA:l,transposeB:u}=r;return Bd({a,b:i,transposeA:l,transposeB:u,backend:t})}const K6={kernelName:nC,backendName:"webgl",kernelFunc:X6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y6{constructor(e,t,r,a,i,l){this.outputShape=[],this.variableNames=["x","mean","variance"],We(e,t),We(e,r);let u="0.0";a!=null&&(We(e,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");let c="1.0";i!=null&&(We(e,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${u};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${l}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q6{constructor(e,t,r,a,i,l){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],We(e,t),We(e,r);let u="vec4(0.0)";a!=null&&(We(e,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");let c="vec4(1.0)";i!=null&&(We(e,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${u};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${l}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z6=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:a,variance:i,offset:l,scale:u}=n;A(a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(l==null||a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(u==null||a.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=t;c==null&&(c=.001);const f=[r,a,i];let p=null;l!=null&&(p=l.shape,f.push(l));let m=null;u!=null&&(m=u.shape,f.push(u));const g=Z().getBool("WEBGL_PACK_NORMALIZATION")?new Q6(r.shape,a.shape,i.shape,p,m,c):new Y6(r.shape,a.shape,i.shape,p,m,c);return e.runWebGLProgram(g,f,f[0].dtype)},J6={kernelName:VC,backendName:"webgl",kernelFunc:Z6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eH{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=tt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=tH(this.rank);let a;const i=e.map((l,u)=>`sourceLoc.${Gm[u]} = start[${u}] + coords.${Gm[u]};`);a=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${a}
        setOutput(getSource(${r}));
      }
    `}}const Gm=["x","y","z","w","u","v"];function tH(n){if(n===1)return"sourceLoc";if(n<=6)return Gm.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nH{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=tt(this.rank),r=tn("coords",this.rank),a=tn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${a.slice(-2).join()})`,l=`getChannel(getSource(${a.join()}), ${i})`,u=`
      result.x = ${l};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${a[this.rank-1]};
        result.y = ${l};
        --${a[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${a[this.rank-2]};
        result.z = ${l};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${a[this.rank-1]};
          result.w = ${l};
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((p,m)=>`start[${m}]`).join()});`:e.map((p,m)=>`${a[m]} = ${r[m]} + start[${m}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${f}
        vec4 result = vec4(0.);
        ${u}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rH(n,e,t,r){const a=r.texData.get(n.dataId),i=r.makeTensorInfo(t,n.dtype),l=r.texData.get(i.dataId);Object.assign(l,a),l.refCount=1,l.shape=t,l.dtype=n.dtype;let u=$g(e,Vt(n.shape));a.slice&&(u+=a.slice.flatOffset),l.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};const c=r.dataRefCount.get(l.slice.origDataId)||1;return r.dataRefCount.set(l.slice.origDataId,c+1),i}function tl(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{begin:i,size:l}=r,[u,c]=h2(a,i,l);if(r2(a,u,c),pe(c)===0)return t.makeTensorInfo(c,a.dtype,[]);if(t.shouldExecuteOnCPU([a])||a.dtype==="string"){const m=t.texData.get(a.dataId),g=KV(m.values,u,c,a.shape,a.dtype);return t.makeTensorInfo(c,a.dtype,g)}const{isPacked:f}=t.texData.get(a.dataId),p=Eg(a.shape,u,c);if(f||!p){const m=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nH(c):new eH(c),g=[u];return t.runWebGLProgram(m,[a],a.dtype,g)}return t.uploadToGPU(a.dataId),rH(a,u,c,t)}const aH={kernelName:QS,backendName:"webgl",kernelFunc:tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sH=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{blockShape:i,crops:l}=r;A(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const u=i.reduce(($,D)=>$*D),c=Rg(a.shape,i,u),f=_g(c.length,i.length),p=Og(a.shape,i,u),m=C2(l,i.length),g=S2(p,l,i.length),x=[],v=be({inputs:{x:a},backend:t,attrs:{shape:c}}),w=rn({inputs:{x:v},backend:t,attrs:{perm:f}}),S=be({inputs:{x:w},backend:t,attrs:{shape:p}}),T=tl({inputs:{x:S},backend:t,attrs:{begin:m,size:g}});return x.push(v),x.push(w),x.push(S),x.forEach($=>t.disposeIntermediateTensorInfo($)),T},iH={kernelName:rC,backendName:"webgl",kernelFunc:sH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,weights:i}=e,{size:l}=r,u=t.readSync(a.dataId),c=t.readSync(i.dataId),f=mN(u,c,i.dtype,i.shape,l);return t.makeTensorInfo([l],i.dtype,f)}const lH={kernelName:aC,backendName:"webgl",kernelFunc:oH};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uH=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,cH=`
  return float(int(a.r) & int(b.r));
`;function dH(n){const{inputs:e,backend:t}=n,{a:r,b:a}=e,i=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS"),l=Z().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([r,a])||l===1){const c=t.texData.get(r.dataId).values,f=t.texData.get(a.dataId).values,[p,m]=bV(r.shape,a.shape,c,f,r.dtype),g=t.makeTensorInfo(m,r.dtype),x=t.texData.get(g.dataId);return x.values=p,g}let u;return i?u=new Jo(uH,r.shape,a.shape,!1):u=new Fi(cH,r.shape,a.shape),t.runWebGLProgram(u,[r,a],r.dtype)}const fH={kernelName:sC,backendName:"webgl",kernelFunc:dH};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hH(n){const{inputs:e,backend:t}=n,{s0:r,s1:a}=e,i=t.readSync(r.dataId),l=t.readSync(a.dataId),u=We(Array.from(i),Array.from(l));return t.makeTensorInfo([u.length],"int32",Int32Array.from(u))}const pH={kernelName:iC,backendName:"webgl",kernelFunc:hH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH="return float(a != b);",RN=Ht({opSnippet:mH,cpuKernelImpl:PV,dtype:"bool"}),gH={kernelName:CS,backendName:"webgl",kernelFunc:RN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iu(n){const{inputs:e,backend:t}=n,{input:r}=e,a=t.texData.get(r.dataId);return In({inputs:{x:a.complexTensorInfos.real},backend:t})}const yH={kernelName:LS,backendName:"webgl",kernelFunc:Iu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xH="return float(int(x));";function bH(n,e){const t=new da(n.shape,xH),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hm(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return In({inputs:{x:a},backend:t});const l=Di(a.shape),u=Hm({inputs:{x:a},backend:t,attrs:{dtype:"float32"}}),c=Fs({inputs:{real:u,imag:l},backend:t});return l.dispose(),t.disposeIntermediateTensorInfo(u),c}if(a.dtype==="complex64"){const l=Iu({inputs:{input:a},backend:t}),u=Hm({inputs:{x:l},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(l),u}if(!dR(a.dtype,i)){const l=In({inputs:{x:a},backend:t});return{dataId:l.dataId,shape:l.shape,dtype:i}}if(t.shouldExecuteOnCPU([a])){const l=t.texData.get(a.dataId).values,[u,c,f]=vV(l,a.shape,a.dtype,i);return t.makeTensorInfo(u,c,f)}if(i==="int32")return bH(a,t);if(i==="bool"){const l=t.makeTensorInfo([],"bool",Ts("bool",1)),c=RN({inputs:{a,b:l},backend:t});return t.disposeIntermediateTensorInfo(l),c}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${i}`)}const vH={kernelName:rg,backendName:"webgl",kernelFunc:Hm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kb="return ceil(x);",CH=Ge({opSnippet:Kb,packedOpSnippet:Kb,cpuKernelImpl:CV}),SH={kernelName:oC,backendName:"webgl",kernelFunc:CH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wH{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TH{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NH(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{clipValueMin:i,clipValueMax:l}=r;let u;Z().getBool("WEBGL_PACK_CLIP")?u=new TH(a.shape):u=new wH(a.shape);const c=[[i],[l]];return t.runWebGLProgram(u,[a],a.dtype,c)}const EH={kernelName:lC,backendName:"webgl",kernelFunc:NH};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $H{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yb(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function DH(n){const{inputs:e,backend:t}=n,{x:r}=e,a=t.texData.get(r.dataId),i=new $H(r.shape),l=[Yb(r,a.complexTensorInfos.real),Yb(r,a.complexTensorInfos.imag)];return t.runWebGLProgram(i,l,l[0].dtype)}const RH={kernelName:cC,backendName:"webgl",kernelFunc:DH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _H{constructor(e){this.outputShape=[],this.outputShape=Oi(e,1),this.variableNames=e.map((l,u)=>`T${u}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let l=1;l<t.length;l++)t[l]=t[l-1]+e[l][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let l=1;l<t.length;l++){const u=t[l-1];r.push(`else if (yC < ${t[l]}) setOutput(getT${l}(yR, yC-${u}));`)}const a=t.length,i=t[t.length-1];r.push(`else setOutput(getT${a}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OH{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Oi(e,t);const r=this.outputShape,a=r.length,i=tt(a),l=tn("coords",a),u=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((w,S)=>`T${S}`);const c=new Array(e.length-1);c[0]=e[0][t];for(let w=1;w<c.length;w++)c[w]=c[w-1]+e[w][t];const f=u[t],p=u.slice(-2),m=u.join();let g=`if (${f} < ${c[0]}) {
        return getChannel(
            getT0(${m}), vec2(${p.join()}));
        }`;for(let w=1;w<c.length;w++){const S=c[w-1];g+=`
        if (${f} < ${c[w]}  && ${f} >= ${c[w-1]}) {
          return getChannel(
            getT${w}(${ad(u,f,S)}),
            vec2(${ad(p,f,S)}));
        }`}const x=c.length,v=c[c.length-1];g+=`
        return getChannel(
          getT${x}(${ad(u,f,v)}),
          vec2(${ad(p,f,v)}));`,this.userCode=`
      float getValue(${u.map(w=>"int "+w)}) {
        ${g}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${l}), 0., 0., 0.);

        ${l[a-1]} = ${l[a-1]} + 1;
        if (${l[a-1]} < ${r[a-1]}) {
          result.g = getValue(${l});
        }

        ${l[a-2]} = ${l[a-2]} + 1;
        if (${l[a-2]} < ${r[a-2]}) {
          result.a = getValue(${l});
        }

        ${l[a-1]} = ${l[a-1]} - 1;
        if (${l[a-2]} < ${r[a-2]} &&
            ${l[a-1]} < ${r[a-1]}) {
          result.b = getValue(${l});
        }
        setOutput(result);
      }
    `}}function ad(n,e,t){const r=n.indexOf(e);return n.map((i,l)=>l===r?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ff(n){const{inputs:e,backend:t}=n,{input:r}=e,a=t.texData.get(r.dataId);return In({inputs:{x:a.complexTensorInfos.imag},backend:t})}const kH={kernelName:XC,backendName:"webgl",kernelFunc:ff};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(n,e,t){const r=n[0].dtype;if(r==="complex64"){const x=n.map($=>Iu({inputs:{input:$},backend:t})),v=n.map($=>ff({inputs:{input:$},backend:t})),w=lu(x,e,t),S=lu(v,e,t),T=Fs({inputs:{real:w,imag:S},backend:t});return x.forEach($=>t.disposeIntermediateTensorInfo($)),v.forEach($=>t.disposeIntermediateTensorInfo($)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),T}let a=t.shouldExecuteOnCPU(n);if(r==="string"&&(a=!0),a){const x=n.map(R=>{const V=[-1,pe(R.shape.slice(e))];return be({inputs:{x:R},backend:t,attrs:{shape:V}})}),v=x.map(R=>({vals:t.readSync(R.dataId),shape:R.shape})),w=Oi(x.map(R=>R.shape),1),S=x[0].shape[0]===1,T=SV(v,w,r,S),$=Oi(n.map(R=>R.shape),e),D=t.makeTensorInfo($,r,T);return x.forEach(R=>t.disposeIntermediateTensorInfo(R)),D}const i=n.filter(x=>pe(x.shape)>0),l=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const x=l?new da(n[0].shape,gs):new vs(n[0].shape,gs);return t.runWebGLProgram(x,n,r)}const u=Z().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>u){const x=[];for(let w=0;w<i.length;w+=u){const S=i.slice(w,w+u);x.push(lu(S,e,t))}const v=lu(x,e,t);for(const w of x)t.disposeIntermediateTensorInfo(w);return v}if(l){const x=new OH(i.map(v=>v.shape),e);return t.runWebGLProgram(x,i,r)}const{tensors2D:c,outShape:f}=FH(i,e,t),p=new _H(c.map(x=>x.shape)),m=t.runWebGLProgram(p,c,r);c.forEach(x=>t.disposeIntermediateTensorInfo(x));const g=be({inputs:{x:m},attrs:{shape:f},backend:t});return t.disposeIntermediateTensorInfo(m),g}function FH(n,e,t){const r=Oi(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>be({inputs:{x:i},attrs:{shape:[-1,pe(i.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _N(n){const{inputs:e,backend:t,attrs:r}=n,{axis:a}=r,i=Ft(a,e[0].shape)[0],l=e.map(f=>f.shape);m2(l,i);const u=Oi(e.map(f=>f.shape),i);if(pe(u)===0)return t.makeTensorInfo(u,e[0].dtype,[]);const c=e.filter(f=>pe(f.shape)>0);return c.length===1?In({inputs:{x:c[0]},backend:t}):lu(c,i,t)}const AH={kernelName:dC,backendName:"webgl",kernelFunc:_N};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ON{constructor(e,t=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const l=e.padInfo.top,u=e.padInfo.left,c=e.strideHeight,f=e.strideWidth,p=e.dilationHeight,m=e.dilationWidth,g=e.filterHeight,x=e.filterWidth,v=Math.floor(e.inChannels/4)*4,w=e.inChannels%4,S=e.dataFormat==="channelsLast",T=S?1:2,$=S?2:3,D=S?3:1;let R="",I="";r&&(a?R=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?R=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:R=`
          float activation(float x) {
            ${r}
          }
        `,I="result = activation(result);");const V=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${R}

      const ivec2 strides = ivec2(${c}, ${f});
      const ivec2 pads = ivec2(${l}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${D}];

        ivec2 xRCCorner =
            ivec2(coords[${T}], coords[${$}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${g}; wR++) {
          int xR = xRCorner + wR * ${p};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${x}; wC++) {
            int xC = xCCorner + wC * ${m};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${v}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${S}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${w===1}) {

              if (${S}) {
                dotProd +=
                    getX(batch, xR, xC, ${v}) *
                    getW(wR, wC, ${v}, d2);
              } else {
                dotProd +=
                    getX(batch, ${v}, xR, xC) *
                    getW(wR, wC, ${v}, d2);
              }

            } else if (${w===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${v}, d2),
                getW(wR, wC, ${v} + 1, d2)
              );

              if (${S}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${v}),
                  getX(batch, xR, xC, ${v} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${v}, xR, xC),
                  getX(batch, ${v} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${w===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${v}, d2),
                getW(wR, wC, ${v} + 1, d2),
                getW(wR, wC, ${v} + 2, d2)
              );

              if (${S}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${v}),
                  getX(batch, xR, xC, ${v} + 1),
                  getX(batch, xR, xC, ${v} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${v}, xR, xC),
                  getX(batch, ${v} + 1, xR, xC),
                  getX(batch, ${v} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${V}
        ${I}
        setOutput(result);
      }
    `}}class IH{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,a=e.padInfo.left,i=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,f=e.dilationHeight,p=e.dilationWidth,m=e.filterDepth,g=e.filterHeight,x=e.filterWidth,v=Math.floor(e.inChannels/4)*4,w=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${l}, ${u});
      const ivec3 pads = ivec3(${t}, ${r}, ${a});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${m}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${g}; wR++) {
            int xR = xRCorner + wR * ${f};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${x}; wC++) {
              int xC = xCCorner + wC * ${p};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${v}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${w===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${v}) *
                  getW(wF, wR, wC, ${v}, d2);
              } else if (${w===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${v}),
                  getX(batch, xF, xR, xC, ${v} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${v}, d2),
                  getW(wF, wR, wC, ${v} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${w===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${v}),
                  getX(batch, xF, xR, xC, ${v} + 1),
                  getX(batch, xF, xR, xC, ${v} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${v}, d2),
                  getW(wF, wR, wC, ${v} + 1, d2),
                  getW(wF, wR, wC, ${v} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kN{constructor(e,t=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xt(this.outputShape.length);const l=e.padInfo.left,u=e.strideWidth,c=e.dilationWidth,f=e.filterHeight,p=e.filterWidth,m=p;let g=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let S=0;S<p;S++)g+=`
           vec4 xTexelC${S*2};
           int xTexelC${S*2}Ready;
           vec4 xTexelC${S*2+1};
           int xTexelC${S*2+1}Ready;
           vec4 xC${S};`;g+=`
     for (int r = 0; r < ${f}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let S=0;S<p;S++)g+=`
           xTexelC${S*2} = vec4(0.0);
           xTexelC${S*2}Ready = 0;
           xTexelC${S*2+1} = vec4(0.0);
           xTexelC${S*2+1}Ready = 0;
           xC${S} = vec4(0.0);`;g+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let S=0;S<(m+1)/2;S++){const T=S*2;if(g+=`
           xC = xCCorner + ${T*c};
           `,u===1){if(T<p&&(l%2===1?(g+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }
               `,c===1&&T>0?g+=`
                 xC${T} = vec4(xTexelC${T-2}.zw, xTexelC${T}.xy);
                 `:g+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${T} = vec4(previous.zw, xTexelC${T}.xy);
                   } else {
                     xC${T} = vec4(0.0, 0.0, xTexelC${T}.xy);
                   }
                   `):g+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 xC${T} = xTexelC${T};
                 `,T+1<p)){const $=l%2===0?Jm(c):c;c%2===0&&l%2===1||c%2!==0&&l%2!==1?(g+=`
                   xCOffset = xC + imod(pads[1], 2) + ${$};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                     xTexelC${T+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${T+1}.zw = vec2(0.0);
                     }
                     xTexelC${T+1}Ready = 1;
                   }
                   `,c>1?g+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${T+1} = vec4(previous.zw, xTexelC${T+1}.xy);
                     } else {
                      xC${T+1} = vec4(0.0, 0.0, xTexelC${T+1}.xy);
                     }
                     `:g+=`
                     xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.xy);
                     `):$===1?g+=`
                     xC${T+1} = xTexelC${T};
                     `:g+=`
                     xCOffset = xC + ${$};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                       xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${T+1}.zw = vec2(0.0);
                       }
                       xTexelC${T+1}Ready = 1;
                     }

                     xC${T+1} = xTexelC${T+1};
                     `}}else T<p&&(l%2===1?(g+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${T+1}Ready == 0) {
                   xTexelC${T+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${T+1}.zw = vec2(0.0);
                   }
                   xTexelC${T+1}Ready = 1;
                 }

                 xC${T} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
               `,T+1<p&&(g+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${T+1} = vec4(xTexelC${T+1}.xy, final.xy);
                 `)):(g+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                   xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T+1}.zw = vec2(0.);
                   }
                   xTexelC${T+1}Ready = 1;
                 }

                 xC${T} = vec4(
                   xTexelC${T}.xy, xTexelC${T+1}.xy);
               `,T+1<p&&(g+=`
                   xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
                 `)));T<p&&(g+=`
             wTexel = getW(r, ${T}, d1, d2);
             dotProd += xC${T}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${T}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,T+1<p&&(g+=`
               wTexel = getW(r, ${T+1}, d1, d2);
               dotProd += xC${T+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${T+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}g+=`
     }
   `,g+=`
     }
   `,g+=`
     }
   `;let x="",v="";r&&(a?x=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?x=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:x=`vec4 activation(vec4 x) {
           ${r}
         }`,v="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${x}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${g}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${w}
         ${v}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LH{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Xt(this.outputShape.length);const{dataFormat:r}=t,a=an(),i=r==="channelsLast",l=i?1:2,u=i?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let f="";for(let p=0;p<=1;p++)for(let m=0;m<=1;m++)f+=`
          blockIndex = rc.z + ${m};
          pos = rc.y + ${p};

          ${c}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${l}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${u}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${p*2+m}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${p*2+m}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${f}

        ${a.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function FN({x:n,filter:e,convInfo:t,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:l=0,activation:u=null}){const c=n.shape,f=r.texData.get(n.dataId),p=t.inChannels,m=c[0]*c[1]*c[2],g=t.outChannels,x=t.dataFormat==="channelsLast",v=!1,w=!1;let S;const T=[];if(i!=null){const R=Md(i.shape,x);R!=null&&(i=be({inputs:{x:i},backend:r,attrs:{shape:R}}),T.push(i))}if(a!=null){const R=Md(a.shape,x);R!=null&&(a=be({inputs:{x:a},backend:r,attrs:{shape:R}}),T.push(a))}if(!((m===1||g===1)&&p>NN)&&f.isPacked&&x&&f.texture!=null&&c[2]%2!==0&&pt(f.shape.slice(-3),c.slice(-3))){const R=c[0]*c[1]*(c[2]+1),I={dataId:n.dataId,shape:[1,R,t.inChannels],dtype:n.dtype},V=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,A(Id(f.shape,I.shape),()=>`packed reshape ${f.shape} to ${I.shape} isn't free`);const j=be({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});T.push(j);const K=Bd({a:I,b:j,backend:r,transposeA:v,transposeB:w,bias:a,activation:u,preluActivationWeights:i,leakyreluAlpha:l}),B=r.texData.get(K.dataId);A(B.isPacked,()=>"batchMatMul result is expected to be packed"),f.shape=V,B.shape=t.outShape,S=In({inputs:{x:K},backend:r}),S.shape=t.outShape,T.push(K)}else{const R=t.outHeight*t.outWidth,I=be({inputs:{x:n},backend:r,attrs:{shape:x?[t.batchSize,R,t.inChannels]:[t.batchSize,t.inChannels,R]}}),V=be({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),j=Bd({a:x?I:V,b:x?V:I,transposeA:!x,transposeB:w,backend:r,bias:a,activation:u,preluActivationWeights:i,leakyreluAlpha:l});S=be({inputs:{x:j},backend:r,attrs:{shape:t.outShape}}),T.push(I),T.push(V),T.push(j)}for(const R of T)r.disposeIntermediateTensorInfo(R);return S}function AN({x:n,filter:e,convInfo:t,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:l=0,activation:u=null}){const{filterWidth:c,filterHeight:f,inChannels:p,outWidth:m,outHeight:g,dataFormat:x}=t,v=x==="channelsLast",w=c*f*p,S=g*m,T=[t.batchSize,w,S],$=!0,D=!1,R=[];if(i!=null){const le=Md(i.shape,v);le!=null&&(i=be({inputs:{x:i},backend:r,attrs:{shape:le}}),R.push(i))}if(a!=null){const le=Md(a.shape,v);le!=null&&(a=be({inputs:{x:a},backend:r,attrs:{shape:le}}),R.push(a))}const I=be({inputs:{x:e},backend:r,attrs:{shape:[1,w,pe(e.shape)/w]}});R.push(I);const V=new LH(T,t),j=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],K=r.runWebGLProgram(V,[n],"float32",j),B=be({inputs:{x:K},backend:r,attrs:{shape:T}});R.push(K),R.push(B);const U=a!=null,k=i!=null,ee=u==="leakyrelu",he=u?wu(u,!0):null,fe=new TN(v?B.shape:I.shape,v?I.shape:B.shape,v?[t.batchSize,S,t.outChannels]:[t.batchSize,t.outChannels,S],$,D,U,he,k,ee),me=v?[B,I]:[I,B];if(a&&me.push(a),k&&me.push(i),ee){const le=r.makeTensorInfo([],"float32",Wo(l,"float32"));me.push(le),R.push(le)}const ae=r.runWebGLProgram(fe,me,"float32"),de=be({inputs:{x:ae},backend:r,attrs:{shape:t.outShape}});R.push(ae);for(const le of R)r.disposeIntermediateTensorInfo(le);return de}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,filter:i}=e,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:p}=r,m=jo(c),g=Qn(a.shape,i.shape,l,f,u,p,!1,m);let x;if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))x=FN({x:a,filter:i,convInfo:g,backend:t});else if(g.strideWidth<=2&&m==="channelsLast"&&Z().getBool("WEBGL_EXP_CONV")){const w=new kN(g),S=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]];x=t.runWebGLProgram(w,[a,i],"float32",S)}else if(Z().getBool("WEBGL_CONV_IM2COL"))x=AN({x:a,filter:i,convInfo:g,backend:t});else{const w=new ON(g);x=t.runWebGLProgram(w,[a,i],"float32")}const v=be({inputs:{x},backend:t,attrs:{shape:g.outShape}});return t.disposeIntermediateTensorInfo(x),v}const MH={kernelName:fC,backendName:"webgl",kernelFunc:BH};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UH{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,i=e.padInfo.left,l=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${l?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class PH{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,l=e.dataFormat==="channelsLast",u=t-1-e.padInfo.top,c=r-1-e.padInfo.left,f=l?1:2,p=l?2:3,m=l?3:1;this.userCode=`
      const ivec2 pads = ivec2(${u}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${m}];

        ivec2 dyCorner = ivec2(coords[${f}], coords[${p}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${l}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class zH{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.padInfo.front,l=e.padInfo.top,u=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${l};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${a} - ${u};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class VH{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,a=e.filterWidth,i=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=t-1-e.padInfo.front,f=r-1-e.padInfo.top,p=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${f}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${l}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${a}; wC++) {
              float dyC = float(dyCCorner + wC) / ${u}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${a} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,dy:i}=e,{strides:l,pad:u,dataFormat:c,dimRoundingMode:f,filterShape:p}=r,m=jo(c),g=Qn(a.shape,p,l,1,u,f,!1,m),x=new UH(g);return t.runWebGLProgram(x,[a,i],"float32")}const HH={kernelName:hC,backendName:"webgl",kernelFunc:GH};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WH{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Xt(this.outputShape.length);const t=e.filterHeight,r=e.filterWidth,a=t-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,filter:i}=e,{inputShape:l,strides:u,pad:c,dataFormat:f,dimRoundingMode:p}=r,m=jo(f),g=Qn(l,i.shape,u,1,c,p,!1,m);if(Z().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&m==="channelsLast"){const x=[[g.strideHeight,g.strideWidth]],v=new WH(g);return t.runWebGLProgram(v,[a,i],"float32",x)}else{const x=new PH(g);return t.runWebGLProgram(x,[a,i],"float32")}}const qH={kernelName:pC,backendName:"webgl",kernelFunc:jH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,filter:i}=e,{strides:l,pad:u,dilations:c}=r,f=Ru(a.shape,i.shape,l,c,u),p=new IH(f);return t.runWebGLProgram(p,[a,i],"float32")}const KH={kernelName:mC,backendName:"webgl",kernelFunc:XH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,dy:i}=e,{strides:l,pad:u,filterShape:c}=r,f=Ru(a.shape,c,l,1,u),p=new zH(f);return t.runWebGLProgram(p,[a,i],"float32")}const QH={kernelName:wR,backendName:"webgl",kernelFunc:YH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,filter:i}=e,{pad:l,strides:u,inputShape:c}=r,f=Ru(c,i.shape,u,1,l),p=new VH(f);return t.runWebGLProgram(p,[a,i],"float32")}const JH={kernelName:gC,backendName:"webgl",kernelFunc:ZH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eW=el+`
  return cos(x);
`,tW=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Pi}
  return result;
`,nW=Ge({opSnippet:eW,packedOpSnippet:tW}),rW={kernelName:yC,backendName:"webgl",kernelFunc:nW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aW=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,sW=Ge({opSnippet:aW}),iW={kernelName:xC,backendName:"webgl",kernelFunc:sW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oW{constructor(e,t,r,a,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[l,u,c,f]=e,[p]=t,[m,g]=r;this.outputShape=[p,m,g,f];const x=a==="bilinear"?1:0,[v,w]=[`${u-1}.0`,`${c-1}.0`],[S,T,$]=m>1?[`${(u-1)/(m-1)}`,"(y2-y1) * height_ratio",`y1*${v} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${v}`],[D,R,I]=g>1?[`${(c-1)/(g-1)}`,"(x2-x1) * width_ratio",`x1*${w} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${w}`];this.userCode=`
      const float height_ratio = float(${S});
      const float width_ratio = float(${D});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${l}) {
          return;
        }

        float height_scale = ${T};
        float width_scale = ${R};

        float in_y = ${$};
        if( in_y < 0.0 || in_y > ${v} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${I};
        if( in_x < 0.0 || in_x > ${w} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${x} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lW=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:a,boxes:i,boxInd:l}=e,{cropSize:u,method:c,extrapolationValue:f}=r,p=new oW(a.shape,i.shape,u,c,f);return t.runWebGLProgram(p,[a,i,l],"float32")},uW={kernelName:CC,backendName:"webgl",kernelFunc:lW};var Nu;(function(n){n.Prod="*",n.Sum="+"})(Nu||(Nu={}));class Qb{constructor(e,t,r,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,l=this.op===Nu.Prod?"1.0":"0.0",u=r?l:`getX(${Zb(i,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let f="",p="";r?(f=a?`end != ${c-1}`:"end != 0",p=a?"end + 1":"end - 1"):(f=a?`end + pow2 < ${c}`:"end >= pow2",p=a?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${tt(i)} coords = getOutputCoords();
        int end = ${Jb(i,"coords",this.op)};
        float val = ${u};
        int pow2 = int(pow(2.0, index));
        if (${f}) {
          int idx = ${p};
          ${Jb(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${Zb(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Zb(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function Jb(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(n,e,t,r,a,i){const l=e.shape.length,u=Cr([r],l);let c=e;u!=null&&(c=rn({inputs:{x:e},backend:t,attrs:{perm:u}}));const f=Sr(1,l)[0];if(f!==l-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const p=c.shape[f];let m=In({inputs:{x:c},backend:t});for(let g=0;g<=Math.ceil(Math.log2(p))-1;g++){const x=new Qb(n,c.shape,!1,i),v=[[g]],w=m;m=t.runWebGLProgram(x,[m],m.dtype,v),t.disposeIntermediateTensorInfo(w)}if(a){const g=new Qb(n,c.shape,a,i),x=m;m=t.runWebGLProgram(g,[m],m.dtype),t.disposeIntermediateTensorInfo(x)}if(u!=null){const g=hg(u),x=rn({inputs:{x:m},backend:t,attrs:{perm:g}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(c),x}return m}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,exclusive:l,reverse:u}=r;return IN(Nu.Prod,a,t,i,l,u)}const dW={kernelName:bC,backendName:"webgl",kernelFunc:cW};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,exclusive:l,reverse:u}=r;return IN(Nu.Sum,a,t,i,l,u)}const hW={kernelName:vC,backendName:"webgl",kernelFunc:fW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,weights:i}=e,{size:l,binaryOutput:u}=r;if(a.shape.length===1){const c=t.readSync(a.dataId),f=t.readSync(i.dataId),p=mN(c,f,i.dtype,i.shape,l);return t.makeTensorInfo([l],i.dtype,p)}else if(a.shape.length===2){const c=t.bufferSync(a),f=t.bufferSync(i),p=xV(c,f,l,u);return t.makeTensorInfo(p.shape,i.dtype,p.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const mW={kernelName:SC,backendName:"webgl",kernelFunc:pW};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gW{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{blockSize:i,dataFormat:l}=r,u=a.shape[0],c=l==="NHWC"?a.shape[1]:a.shape[2],f=l==="NHWC"?a.shape[2]:a.shape[3],p=l==="NHWC"?a.shape[3]:a.shape[1],m=c*i,g=f*i,x=p/(i*i),v=l==="NHWC"?[u,m,g,x]:[u,x,m,g],w=new gW(v,i,l);return t.runWebGLProgram(w,[a],a.dtype)}const xW={kernelName:wC,backendName:"webgl",kernelFunc:yW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LN{constructor(e,t=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xt(this.outputShape.length);const l=e.filterHeight,u=e.filterWidth,c=e.outChannels/e.inChannels;let f="",p="";r&&(a?f=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?f=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:f=`
          float activation(float x) {
            ${r}
          }
        `,p="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${c};
        int q = d2 - d1 * ${c};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${l}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${u}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${m}
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BN{constructor(e,t=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xt(this.outputShape.length);const l=e.outChannels/e.inChannels,u=e.padInfo.left,c=e.strideWidth,f=e.dilationWidth,p=e.filterHeight,m=e.filterWidth,g=m;let x=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let T=0;T<m;T++)x+=`
          vec4 xTexelC${T*2};
          int xTexelC${T*2}Ready;
          vec4 xTexelC${T*2+1};
          int xTexelC${T*2+1}Ready;
          vec4 xC${T};`;x+=`
    for (int r = 0; r < ${p}; r++) {
      `;for(let T=0;T<m;T++)x+=`
          xTexelC${T*2} = vec4(0.0);
          xTexelC${T*2}Ready = 0;
          xTexelC${T*2+1} = vec4(0.0);
          xTexelC${T*2+1}Ready = 0;
          xC${T} = vec4(0.0);`;x+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let T=0;T<(g+1)/2;T++){const $=T*2;if(x+=`
          xC = xCCorner + ${$*f};
          `,c===1){if($<m&&(u%2===1?(x+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$}Ready == 0) {
                  xTexelC${$} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${$}.zw = vec2(0.0);
                  }
                  xTexelC${$}Ready = 1;
                }
              `,f===1&&$>0?x+=`
                xC${$} = vec4(xTexelC${$-2}.zw, xTexelC${$}.xy);
                `:x+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${$} = vec4(previous.zw, xTexelC${$}.xy);
                  } else {
                    xC${$} = vec4(0.0, 0.0, xTexelC${$}.xy);
                  }
                  `):x+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${$}Ready == 0) {
                  xTexelC${$} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${$}.zw = vec2(0.0);
                  }
                  xTexelC${$}Ready = 1;
                }

                xC${$} = xTexelC${$};
                `,$+1<m)){const D=u%2===0?Jm(f):f;f%2===0&&u%2===1||f%2!==0&&u%2!==1?(x+=`
                  xCOffset = xC + imod(pads[1], 2) + ${D};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$+1}Ready == 0) {
                    xTexelC${$+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${$+1}.zw = vec2(0.0);
                    }
                    xTexelC${$+1}Ready = 1;
                  }
                  `,f>1?x+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${$+1} = vec4(previous.zw, xTexelC${$+1}.xy);
                    } else {
                     xC${$+1} = vec4(0.0, 0.0, xTexelC${$+1}.xy);
                    }
                    `:x+=`
                    xC${$+1} = vec4(xTexelC${$}.zw, xTexelC${$+1}.xy);
                    `):D===1?x+=`
                    xC${$+1} = xTexelC${$};
                    `:x+=`
                    xCOffset = xC + ${D};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$+1}Ready == 0) {
                      xTexelC${$+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${$+1}.zw = vec2(0.0);
                      }
                      xTexelC${$+1}Ready = 1;
                    }

                    xC${$+1} = xTexelC${$+1};
                    `}}else $<m&&(u%2===1?(x+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$}Ready == 0) {
                  xTexelC${$} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${$}.zw = vec2(0.0);
                  }
                  xTexelC${$}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${$+1}Ready == 0) {
                  xTexelC${$+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${$+1}.zw = vec2(0.0);
                  }
                  xTexelC${$+1}Ready = 1;
                }

                xC${$} = vec4(xTexelC${$}.zw, xTexelC${$+1}.zw);
              `,$+1<m&&(x+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${$+1} = vec4(xTexelC${$+1}.xy, final.xy);
                `)):(x+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${$}Ready == 0) {
                  xTexelC${$} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${$}.zw = vec2(0.0);
                  }
                  xTexelC${$}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$+1}Ready == 0) {
                  xTexelC${$+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${$+1}.zw = vec2(0.);
                  }
                  xTexelC${$+1}Ready = 1;
                }

                xC${$} = vec4(
                  xTexelC${$}.xy, xTexelC${$+1}.xy);
              `,$+1<m&&(x+=`
                  xC${$+1} = vec4(xTexelC${$}.zw, xTexelC${$+1}.zw);
                `)));$<m&&(x+=`
            wTexel = getW(r, ${$}, d1, q);
            dotProd += xC${$} * vec4(wTexel.xz, wTexel.xz);
          `,$+1<m&&(x+=`
              wTexel = getW(r, ${$+1}, d1, q);
              dotProd += xC${$+1} * vec4(wTexel.xz, wTexel.xz);
            `))}x+=`
    }
  `,x+=`
      }
    `;let v="",w="";r&&(a?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:v=`vec4 activation(vec4 x) {
          ${r}
        }`,w="result = activation(result);");const S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${x}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${S}
        ${w}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,filter:i}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:f}=r;let p=c;p==null&&(p=[1,1]),A(Ln(l,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${p}'`);const m=Qn(a.shape,i.shape,l,p,u,f,!0);let g;Z().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1?g=new BN(m):g=new LN(m);const x=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];return t.runWebGLProgram(g,[a,i],"float32",x)}const vW={kernelName:TC,backendName:"webgl",kernelFunc:bW};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CW{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,i=e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${l} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class SW{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,l=t-1-e.padInfo.top,u=r-1-e.padInfo.left,c=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,dy:i}=e,{strides:l,dilations:u,pad:c,dimRoundingMode:f,filterShape:p}=r,m=Qn(a.shape,p,l,u,c,f,!0),g=new CW(m);return t.runWebGLProgram(g,[a,i],"float32")}const TW={kernelName:NC,backendName:"webgl",kernelFunc:wW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,filter:i}=e,{strides:l,dilations:u,pad:c,dimRoundingMode:f,inputShape:p}=r,m=Qn(p,i.shape,l,u,c,f,!0),g=new SW(m);return t.runWebGLProgram(g,[a,i],"float32")}const EW={kernelName:EC,backendName:"webgl",kernelFunc:NW};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $W{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(n){const{inputs:e,backend:t}=n,{x:r}=e,a=[...r.shape,...r.shape],i=pe(r.shape),l=be({inputs:{x:r},backend:t,attrs:{shape:[i]}}),u=new $W(i),c=t.runWebGLProgram(u,[l],l.dtype),f=be({inputs:{x:c},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(c),f}const RW={kernelName:$C,backendName:"webgl",kernelFunc:DW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _W{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:a,strideHeight:i,strideWidth:l,filterHeight:u,filterWidth:c,dilationHeight:f,dilationWidth:p}=e,{top:m,left:g}=a;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${l});
      const ivec2 pads = ivec2(${m}, ${g});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${u}; h++) {
          int hIn = hBeg + h * ${f};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${p};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,filter:i}=e,{strides:l,pad:u,dilations:c}=r,f=oT(a.shape,i.shape,l,u,"NHWC",c);let p;const m=new _W(f);p=t.runWebGLProgram(m,[a,i],"float32");const g=be({inputs:{x:p},backend:t,attrs:{shape:f.outShape}});return t.disposeIntermediateTensorInfo(p),g}const kW={kernelName:DC,backendName:"webgl",kernelFunc:OW};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(n){const{inputs:e,backend:t,attrs:r}=n,{equation:a}=r,i=e,{allDims:l,summedDims:u,idDims:c}=O2(a,i.length);F2(l.length,c,i);const{path:f,steps:p}=A2(u,c),m=p.length;let g=null,x=l.length;const v=[];for(let w=0;w<m;++w){for(const S of p[w]){const{permutationIndices:T,expandDims:$}=k2(x,c[S]);let D;I2(T)?D=i[S]:(D=rn({inputs:{x:i[S]},backend:t,attrs:{perm:T}}),v.push(D));const R=D.shape.slice();for(let I=0;I<$.length;++I)R.splice($[I],0,1);pt(D.shape,R)||(D=be({inputs:{x:D},backend:t,attrs:{shape:R}}),v.push(D)),g===null?g=D:(g=Pg({inputs:{a:D,b:g},backend:t}),v.push(g))}w<m-1&&(f[w]>=0&&(g=df({inputs:{x:g},backend:t,attrs:{axis:f[w]-(l.length-x),keepDims:!1}}),v.push(g)),x--)}for(const w of v)w!==g&&t.disposeIntermediateTensorInfo(w);return g}const AW={kernelName:_C,backendName:"webgl",kernelFunc:FW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW="return (x >= 0.0) ? x : (exp(x) - 1.0);",LW=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,BW=Ge({opSnippet:IW,packedOpSnippet:LW}),MW={kernelName:OC,backendName:"webgl",kernelFunc:BW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UW="return (b >= 0.0) ? a : a * (b + 1.0);",PW=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,zW=n=>{const{inputs:e,backend:t}=n,{dy:r,y:a}=e,i=Z().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Jo(PW,r.shape,a.shape):new Fi(UW,r.shape,a.shape);return t.runWebGLProgram(i,[r,a],r.dtype)},VW={kernelName:TR,backendName:"webgl",kernelFunc:zW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GW=`
  return vec4(equal(a, b));
`,HW="return float(a == b);",WW=Ht({opSnippet:HW,packedOpSnippet:GW,dtype:"bool",cpuKernelImpl:wV}),jW={kernelName:FC,backendName:"webgl",kernelFunc:WW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qW=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${N2};
  float a1 = ${E2};
  float a2 = ${$2};
  float a3 = ${D2};
  float a4 = ${R2};
  float a5 = ${_2};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,XW=Ge({opSnippet:qW}),KW={kernelName:kC,backendName:"webgl",kernelFunc:XW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW=el+`
  return exp(x);
`,QW=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,MN=Ge({opSnippet:YW,packedOpSnippet:QW,cpuKernelImpl:TV,dtype:"float32"}),ZW={kernelName:AC,backendName:"webgl",kernelFunc:MN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wm(n){const{inputs:e,attrs:t,backend:r}=n,{dim:a}=t,{input:i}=e,l=i.shape.length,u=i.shape.slice();let c=a;return a<0&&(A(-(l+1)<=a,()=>`Axis must be in the interval [${-(l+1)}, ${l}]`),c=l+a+1),u.splice(c,0,1),be({inputs:{x:i},backend:r,attrs:{shape:u}})}const JW={kernelName:IC,backendName:"webgl",kernelFunc:Wm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ev="return exp(x) - 1.0;",ej=Ge({opSnippet:ev,packedOpSnippet:ev,cpuKernelImpl:NV}),tj={kernelName:LC,backendName:"webgl",kernelFunc:ej};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tv{constructor(e,t,r){this.variableNames=["real","imag"];const a=t[1];this.outputShape=t;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,l=r?`${a}.0`:"1.0";let u;if(e==="real")u="return real * expR - imag * expI;";else if(e==="imag")u="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${u}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${l};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UN(n,e,t){const r=t.texData.get(n.dataId),a=pe(n.shape),i=n.shape[n.shape.length-1],l=a/i,u=be({inputs:{x:n},backend:t,attrs:{shape:[l,i]}}),c=u.shape,f=new tv("real",c,e),p=new tv("imag",c,e),m=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],g=t.runWebGLProgram(f,m,"float32"),x=t.runWebGLProgram(p,m,"float32"),v=Fs({inputs:{real:g,imag:x},backend:t});t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(x);const w=be({inputs:{x:v},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(v),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nj(n){const{inputs:e,backend:t}=n,{input:r}=e;return UN(r,!1,t)}const rj={kernelName:BC,backendName:"webgl",kernelFunc:nj};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aj{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lu(n){const{backend:e,attrs:t}=n,{shape:r,value:a}=t;let{dtype:i}=t;if(i=i||Eu(a),i==="string"){const l=kt(i,pe(r));return l.fill(a),e.makeTensorInfo(r,i,l)}else{const l=new aj(r,a),u=[[a]];return e.runWebGLProgram(l,[],i,u)}}const sj={kernelName:MC,backendName:"webgl",kernelFunc:Lu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ij{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oj={kernelName:UC,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,a=new ij(t.shape);return r.runWebGLProgram(a,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nv="return floor(x);",lj=Ge({opSnippet:nv,packedOpSnippet:nv,cpuKernelImpl:EV}),uj={kernelName:PC,backendName:"webgl",kernelFunc:lj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cj=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,dj=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,fj=Ht({opSnippet:cj,packedOpSnippet:dj,dtype:"int32"}),hj={kernelName:zC,backendName:"webgl",kernelFunc:fj};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pj{constructor(e){this.variableNames=["A"];const t=an(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mj{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=an(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${a}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gj={kernelName:lm,backendName:"webgl",kernelFunc:yj};let No,Vp=Z().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function yj(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:a}=e;const{numChannels:i}=r,l=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,u=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[c,f]=l?[a.videoWidth,a.videoHeight]:[a.width,a.height],p=[f,c],m=[f,c,i];if(u||l){const w=Z().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(No==null||w!==Vp)&&(Vp=w,No=document.createElement("canvas").getContext("2d",{willReadFrequently:Vp})),No.canvas.width=c,No.canvas.height=f,No.drawImage(a,0,0,c,f),a=No.canvas}const g=t.makeTensorInfo(p,"int32");t.texData.get(g.dataId).usage=qn.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(g.dataId),a);const x=Z().getBool("WEBGL_PACK")?new mj(m):new pj(m),v=t.runWebGLProgram(x,[g],"int32");return t.disposeData(g.dataId),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,filter:i,bias:l,preluActivationWeights:u}=e,{strides:c,pad:f,dataFormat:p,dilations:m,dimRoundingMode:g,activation:x,leakyreluAlpha:v}=r,w=jo(p),S=Qn(a.shape,i.shape,c,m,f,g,!1,w);let T;const $=[],D=l!=null,R=u!=null,I=x==="leakyrelu",V=()=>{const K=[a,i],B=(U,k)=>{if(k==="NCHW"&&U.shape.length===1&&U.shape[0]!==1){const ee=be({inputs:{x:U},backend:t,attrs:{shape:[U.shape[0],1,1]}});return $.push(ee),ee}return U};if(D&&K.push(B(l,p)),R&&K.push(B(u,p)),I){const U=t.makeTensorInfo([],"float32",Wo(v,"float32"));K.push(U),$.push(U)}return K};if(S.filterHeight===1&&S.filterWidth===1&&S.dilationHeight===1&&S.dilationWidth===1&&S.strideHeight===1&&S.strideWidth===1&&(S.padInfo.type==="SAME"||S.padInfo.type==="VALID"))T=FN({x:a,filter:i,convInfo:S,backend:t,bias:l,activation:x,preluActivationWeights:u,leakyreluAlpha:v});else if(S.strideWidth<=2&&w==="channelsLast"&&Z().getBool("WEBGL_EXP_CONV")){const K=x?wu(x,!0):null,B=new kN(S,D,K,R,I),U=[[S.padInfo.top,S.padInfo.left],[S.strideHeight,S.strideWidth],[S.dilationHeight,S.dilationWidth],[S.inHeight,S.inWidth]],k=V();T=t.runWebGLProgram(B,k,"float32",U)}else if(Z().getBool("WEBGL_CONV_IM2COL"))T=AN({x:a,filter:i,convInfo:S,backend:t,bias:l,activation:x,preluActivationWeights:u,leakyreluAlpha:v});else{const K=x?wu(x,!1):null,B=new ON(S,D,K,R,I),U=V();T=t.runWebGLProgram(B,U,"float32")}const j=be({inputs:{x:T},backend:t,attrs:{shape:S.outShape}});return $.push(T),$.forEach(K=>t.disposeIntermediateTensorInfo(K)),j}const bj={kernelName:cm,backendName:"webgl",kernelFunc:xj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vj(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,filter:i,bias:l,preluActivationWeights:u}=e,{strides:c,pad:f,dilations:p,dimRoundingMode:m,activation:g,leakyreluAlpha:x}=r,v=[];let w=p;w==null&&(w=[1,1]),A(Ln(c,w),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${w}'`);const S=Qn(a.shape,i.shape,c,w,f,m,!0),T=Z().getBool("WEBGL_PACK_DEPTHWISECONV")&&S.strideWidth<=2&&S.outChannels/S.inChannels===1,$=g?wu(g,T):null,D=[a,i],R=l!=null,I=u!=null,V=g==="leakyrelu";if(R&&D.push(l),I&&D.push(u),V){const U=t.makeTensorInfo([],"float32",Wo(x,"float32"));D.push(U),v.push(U)}let j;T?j=new BN(S,R,$,I,V):j=new LN(S,R,$,I,V);const K=[[S.padInfo.top,S.padInfo.left],[S.strideHeight,S.strideWidth],[S.dilationHeight,S.dilationWidth],[S.inHeight,S.inWidth]],B=t.runWebGLProgram(j,D,"float32",K);return v.forEach(U=>t.disposeIntermediateTensorInfo(U)),B}const Cj={kernelName:dm,backendName:"webgl",kernelFunc:vj};class Sj{constructor(e,t,r,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;const i=tt(r.length);let l=`
    int index;`;for(let u=0;u<this.sliceDim;u++)l+=`
          index = round(getIndices(coords[0], ${u}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[u]};
          flattenIndex += index * ${this.strides[u]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${l}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wj(n){const{inputs:e,backend:t}=n,{params:r,indices:a}=e,i=a.shape,l=i[i.length-1],u=pe(r.shape),[c,f,p,m]=n2(r,a),g=be({inputs:{x:a},backend:t,attrs:{shape:[f,l]}}),x=be({inputs:{x:r},backend:t,attrs:{shape:[pe(r.shape)/p,p]}});if(t.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const T=t.readSync(a.dataId),$=t.bufferSync(r),D=$V(T,$,r.dtype,f,l,p,m,r.shape,u);return t.makeTensorInfo(c,r.dtype,D.values)}const v=new Sj(l,m,[f,p],r.shape),w=t.runWebGLProgram(v,[x,g],x.dtype),S=be({inputs:{x:w},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),S}const Tj={kernelName:HC,backendName:"webgl",kernelFunc:wj};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nj{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=tt(this.rank),a=Ej(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${a}));
      }
    `}}function Ej(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<n.length;a++)a===2?r.push("index"):r.push(`${t[a]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PN(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,indices:i}=e,{axis:l,batchDims:u}=r,c=Ft(l,a.shape)[0];if(Z().get("DEBUG")){const $=t.readSync(i.dataId),D=a.shape[c];for(let R=0;R<$.length;++R){const I=$[R];A(I<=D-1&&I>=0,()=>`GatherV2: the index value ${I} is not in [0, ${D-1}]`)}}const f=Y2(a,i,c,u),p=pe(i.shape),m=[],g=be({inputs:{x:a},backend:t,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),x=be({inputs:{x:i},backend:t,attrs:{shape:[f.batchSize,p/f.batchSize]}});m.push(g),m.push(x);const v=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize];if(t.shouldExecuteOnCPU([a,i])||a.dtype==="string"){const $=t.bufferSync(x),D=t.bufferSync(g),R=DV(D,$,v);return m.forEach(I=>t.disposeIntermediateTensorInfo(I)),t.makeTensorInfo(f.outputShape,R.dtype,R.values)}const w=new Nj(g.shape,v),S=t.runWebGLProgram(w,[g,x],g.dtype);m.push(S);const T=be({inputs:{x:S},backend:t,attrs:{shape:f.outputShape}});return m.forEach($=>t.disposeIntermediateTensorInfo($)),T}const $j={kernelName:GC,backendName:"webgl",kernelFunc:PN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dj="return float(a > b);",Rj=`
  return vec4(greaterThan(a, b));
`,_j=Ht({opSnippet:Dj,packedOpSnippet:Rj,cpuKernelImpl:RV,dtype:"bool"}),Oj={kernelName:WC,backendName:"webgl",kernelFunc:_j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kj="return float(a >= b);",Fj=`
  return vec4(greaterThanEqual(a, b));
`,Aj=Ht({opSnippet:kj,packedOpSnippet:Fj,dtype:"bool",cpuKernelImpl:_V}),Ij={kernelName:jC,backendName:"webgl",kernelFunc:Aj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lj(n){const{inputs:e,backend:t}=n,{input:r}=e;return UN(r,!0,t)}const Bj={kernelName:qC,backendName:"webgl",kernelFunc:Lj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mj="return float(!isnan(x) && !isinf(x));",Uj=Ge({opSnippet:Mj,dtype:"bool"}),Pj={kernelName:KC,backendName:"webgl",kernelFunc:Uj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zj="return float(isinf(x));",Vj=Ge({opSnippet:zj,dtype:"bool"}),Gj={kernelName:YC,backendName:"webgl",kernelFunc:Vj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hj="return float(isnan(x));",Wj=Ge({opSnippet:Hj,dtype:"bool"}),jj={kernelName:QC,backendName:"webgl",kernelFunc:Wj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qj="return float(a < b);",Xj=`
  return vec4(lessThan(a, b));
`,Kj=Ht({opSnippet:qj,packedOpSnippet:Xj,cpuKernelImpl:OV,dtype:"bool"}),Yj={kernelName:JC,backendName:"webgl",kernelFunc:Kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qj="return float(a <= b);",Zj=`
  return vec4(lessThanEqual(a, b));
`,Jj=Ht({opSnippet:Qj,packedOpSnippet:Zj,cpuKernelImpl:kV,dtype:"bool"}),e7={kernelName:eS,backendName:"webgl",kernelFunc:Jj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(n){const{backend:e,attrs:t}=n,{start:r,stop:a,num:i}=t,l=FV(r,a,i);return e.makeTensorInfo([l.length],"float32",l)}const n7={kernelName:tS,backendName:"webgl",kernelFunc:t7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7=el+`
  return x < 0.0 ? 0./0. : log(x);
`,a7=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,s7=Ge({opSnippet:r7,packedOpSnippet:a7,cpuKernelImpl:AV}),i7={kernelName:nS,backendName:"webgl",kernelFunc:s7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7=el+`
  return log(1.0 + x);
`,l7=Ge({opSnippet:o7}),u7={kernelName:rS,backendName:"webgl",kernelFunc:l7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7="return float(a >= 1.0 && b >= 1.0);",d7=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,f7=Ht({opSnippet:c7,packedOpSnippet:d7,dtype:"bool"}),h7={kernelName:aS,backendName:"webgl",kernelFunc:f7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7="return float(!(x >= 1.0));",m7=Ge({opSnippet:p7}),g7={kernelName:sS,backendName:"webgl",kernelFunc:m7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7="return float(a >= 1.0 || b >= 1.0);",x7=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,b7=Ht({opSnippet:y7,packedOpSnippet:x7,dtype:"bool"}),v7={kernelName:iS,backendName:"webgl",kernelFunc:b7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C7{constructor(e,t,r,a,i){this.variableNames=["x"],this.outputShape=[];const l=t,u=e[3]-1;this.outputShape=e;let c;const f=`float(${r}) + float(${a}) * sum`;i===.5?c=`inversesqrt(${f})`:i===1?c=`1.0/(${f})`:c=`exp(log(${f}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${l}; j <= ${l}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${u}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S7{constructor(e,t,r,a,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const l=t,u=e[3]-1;this.outputShape=e;let c;const f=`float(${r}) + float(${a}) * sum`;i===.5?c=`inversesqrt(${f})`:i===1?c=`1.0/(${f})`:c=`exp(log(${f}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${l};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${l}; j <= ${l}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${u}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{depthRadius:i,bias:l,alpha:u,beta:c}=r,f=Z().getBool("WEBGL_PACK_NORMALIZATION")?new S7(a.shape,i,l,u,c):new C7(a.shape,i,l,u,c);return t.runWebGLProgram(f,[a],a.dtype)},T7={kernelName:oS,backendName:"webgl",kernelFunc:w7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N7{constructor(e,t,r,a,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=a,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${a}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${a})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:a,y:i,dy:l}=e,{depthRadius:u,bias:c,alpha:f,beta:p}=r,m=new N7(a.shape,u,c,f,p);return t.runWebGLProgram(m,[a,i,l],a.dtype)},$7={kernelName:NR,backendName:"webgl",kernelFunc:E7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(n,e,t,r){const a=pe(e),l=pe(n.shape)/a,u=be({inputs:{x:n},attrs:{shape:[l,a]},backend:r}),c=zi(u,n.dtype,"max",r),f=be({inputs:{x:c},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zN(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{reductionIndices:i,keepDims:l}=r,u=a.shape.length,c=Ft(i,a.shape);let f=c;const p=Cr(f,u),m=p!=null,g=t.shouldExecuteOnCPU([a]);let x=a;if(m){if(g){const D=t.texData.get(x.dataId).values,R=new Array(u);for(let j=0;j<R.length;j++)R[j]=a.shape[p[j]];const I=Mg(D,a.shape,a.dtype,p,R);x=t.makeTensorInfo(R,a.dtype);const V=t.texData.get(x.dataId);V.values=I}else x=cf(a,p,t);f=Sr(f.length,u)}qr("max",f,u);const[v,w]=ma(x.shape,f);let S=v;l&&(S=Zn(v,c));let T;if(g){const D=t.texData.get(x.dataId).values,R=IV(D,pe(w),S,a.dtype);T=t.makeTensorInfo(S,a.dtype);const I=t.texData.get(T.dataId);I.values=R}else T=D7(x,w,S,t);return m&&t.disposeIntermediateTensorInfo(x),T}const R7={kernelName:lS,backendName:"webgl",kernelFunc:zN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7=Ug+`
  return max(a, b);
`,O7=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pi+`
  return result;
`,k7=Ht({opSnippet:_7,packedOpSnippet:O7,cpuKernelImpl:LV}),F7={kernelName:uS,backendName:"webgl",kernelFunc:k7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e;Fu(a,"maxPool");const{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,f=1;A(Ln(l,f),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${l} and dilations '${f}'`);const p=Ii(a.shape,i,l,f,u,c);if(p.filterWidth===1&&p.filterHeight===1&&pt(p.inShape,p.outShape))return In({inputs:{x:a},backend:t});const m=new Tu(p,"max",!1);return t.runWebGLProgram(m,[a],a.dtype)}const I7={kernelName:cS,backendName:"webgl",kernelFunc:A7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{filterSize:i,strides:l,pad:u,dataFormat:c,dimRoundingMode:f}=r,p=[1,1,1],m=Du(a.shape,i,l,p,u,f,c),g=new zg(m,"max",!1);return t.runWebGLProgram(g,[a],a.dtype)}const B7={kernelName:dS,backendName:"webgl",kernelFunc:L7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M7{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,a=e.dilationHeight,i=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=i-1-e.padInfo.top,c=l-1-e.padInfo.left,f=i*l-1;this.userCode=`
      const ivec2 pads = ivec2(${u}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${f} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${l} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class U7{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,m=c-1-e.padInfo.front,g=f-1-e.padInfo.top,x=p-1-e.padInfo.left,v=c*f*p-1;this.userCode=`
      const ivec3 pads = ivec3(${m}, ${g}, ${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${v} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${f} * ${p} +
                  wR * ${p} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,input:i}=e,l=i,{filterSize:u,strides:c,pad:f,dimRoundingMode:p}=r,m=[1,1,1],g=Du(l.shape,u,c,m,f,p),x=new zg(g,"max",!0),v=t.runWebGLProgram(x,[l],l.dtype),w=new U7(g),S=t.runWebGLProgram(w,[a,v],l.dtype);return t.disposeIntermediateTensorInfo(v),S}const z7={kernelName:$R,backendName:"webgl",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7(n){const{inputs:e,backend:t,attrs:r}=n,{dy:a,input:i,output:l}=e,u=i;Fu([i,l],"maxPoolGrad");const{filterSize:c,strides:f,pad:p,dimRoundingMode:m}=r,g=Ii(u.shape,c,f,1,p,m),x=!0,v=new Tu(g,"max",x),w=t.runWebGLProgram(v,[u],u.dtype),S=new M7(g),T=t.runWebGLProgram(S,[a,w],u.dtype);return t.disposeIntermediateTensorInfo(w),T}const G7={kernelName:ER,backendName:"webgl",kernelFunc:V7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(n,e,t,r){let a=new Tu(t,"max",!1);const i=r.runWebGLProgram(a,[n],"float32");a=new Tu(t,"max",!0,!0,e);const l=r.runWebGLProgram(a,[n],"float32");return[i,l]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={kernelName:fS,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:a,strides:i,pad:l,includeBatchInIndex:u}=e,c=t;A(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const f=[1,1];A(Ln(i,f),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const p=Ii(r.shape,a,i,f,l),[m,g]=H7(r,u,p,c);return[m,g]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(n,e,t,r){const a=pe(e),l=pe(n.shape)/a,u=be({inputs:{x:n},attrs:{shape:[l,a]},backend:r}),c=zi(u,"float32","mean",r),f=be({inputs:{x:c},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7={kernelName:hS,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:a,axis:i}=e,l=t,u=r.shape.length,c=Ft(i,r.shape);let f=c;const p=Cr(f,u),m=p!=null,g=l.shouldExecuteOnCPU([r]),x=[];let v=r;if(m){if(g){const R=l.texData.get(v.dataId).values,I=new Array(u);for(let K=0;K<I.length;K++)I[K]=r.shape[p[K]];const V=Mg(R,r.shape,r.dtype,p,I);v=l.makeTensorInfo(I,r.dtype);const j=l.texData.get(v.dataId);j.values=V}else v=cf(r,p,l);x.push(v),f=Sr(f.length,u)}qr("sum",f,u);const[w,S]=ma(v.shape,f);let T=w;a&&(T=Zn(w,c));const $=j7(v,S,T,l);for(const D of x)l.disposeIntermediateTensorInfo(D);return $}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,keepDims:l}=r,u=a.shape.length,c=Ft(i,a.shape);let f=c;const p=Cr(f,u);let m=a;p!=null&&(m=rn({inputs:{x:a},backend:t,attrs:{perm:p}}),f=Sr(f.length,a.shape.length)),qr("min",f,u);const[g,x]=ma(m.shape,f),v=pe(x),w=be({inputs:{x:m},backend:t,attrs:{shape:[-1,v]}}),S=zi(w,w.dtype,"min",t);let T;if(l){const $=Zn(g,c);T=be({inputs:{x:S},backend:t,attrs:{shape:$}})}else T=be({inputs:{x:S},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),p!=null&&t.disposeIntermediateTensorInfo(m),T}const K7={kernelName:pS,backendName:"webgl",kernelFunc:X7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y7=Ug+`
  return min(a, b);
`,Q7=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pi+`
  return result;
`,Z7=Ht({opSnippet:Y7,packedOpSnippet:Q7,cpuKernelImpl:BV}),J7={kernelName:mS,backendName:"webgl",kernelFunc:Z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e5{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((p,m)=>p[0]+e[m]+p[1]);const a=e.length,i=tt(a),l=t.map(p=>p[0]).join(","),u=t.map((p,m)=>p[0]+e[m]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),f=r==="reflect"?0:1;if(a===1){this.userCode=`
        int start = ${l};
        int end = ${u};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${f};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${f};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${l});
      ${i} end = ${i}(${u});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${a}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${f};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${f};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t5{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((v,w)=>v[0]+e[w]+v[1]);const a=e.length,i=tt(a),l=t.map(v=>v[0]).join(","),u=t.map((v,w)=>v[0]+e[w]).join(","),c=tn("rc",a),f=tn("source",a),p=`${c[a-1]} < ${this.outputShape[a-1]}`,m=a===1?"source":`vec2(${f.slice(-2).join()})`,g=r==="reflect"?0:1;let x="";if(a===1){const v=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${g};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${g};
        }
        source -= start;
      `;x=`
        ${i} rc = outputLoc;
        ${v}
        result[0] = getChannel(getX(${f.join()}), ${m});
        ${c[a-1]} += 1;
        if(${p}) {
          ${v}
          result[1] = getChannel(getX(${f.join()}), ${m});
        }
      `}else{const v=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${g}) +
                gte * ((end - 1) * 2 - source + ${g});
        source -= start;
      `;x=`
        ${i} rc = outputLoc;
        ${v}
        result[0] = getChannel(getX(${f.join()}), ${m});
        ${c[a-1]} += 1;
        if(${p}) {
          ${v}
          result[1] = getChannel(getX(${f.join()}), ${m});
        }
        rc = outputLoc;
        ${c[a-2]} += 1;
        if(${c[a-2]} < ${this.outputShape[a-2]}) {
          ${v}
          result[2] = getChannel(getX(${f.join()}), ${m});
          ${c[a-1]} += 1;
          if(${p}) {
            ${v}
            result[3] = getChannel(getX(${f.join()}), ${m});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${l});
      const ${i} end = ${i}(${u});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:a,mode:i}=t,l=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new t5(r.shape,a,i):new e5(r.shape,a,i);return e.runWebGLProgram(l,[r],r.dtype)},r5={kernelName:gS,backendName:"webgl",kernelFunc:n5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5=`if (b == 0.0) return NAN;
  return mod(a, b);`,s5=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Pi+`
  return result;
`,i5=Ht({opSnippet:a5,packedOpSnippet:s5}),o5={kernelName:yS,backendName:"webgl",kernelFunc:i5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l5{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u5=`
if (a == b) {
  return 1.0;
};
return a / b;`,c5=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,VN=Ht({opSnippet:u5,packedOpSnippet:c5,checkOutOfBounds:!0}),d5={kernelName:RC,backendName:"webgl",kernelFunc:VN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rv="return a - b;",GN=Ht({opSnippet:rv,packedOpSnippet:rv,supportsComplex:!0,cpuKernelImpl:aG}),f5={kernelName:bw,backendName:"webgl",kernelFunc:GN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HN(n){const{inputs:e,backend:t,attrs:r}=n,{logits:a}=e,{dim:i}=r,l=Ft([i],a.shape),u=zN({inputs:{x:a},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),c=Zn(u.shape,l),f=be({inputs:{x:u},backend:t,attrs:{shape:c}}),p=GN({inputs:{a,b:f},backend:t}),m=MN({inputs:{x:p},backend:t}),g=df({inputs:{x:m},backend:t,attrs:{axis:l,keepDims:!1}}),x=be({inputs:{x:g},backend:t,attrs:{shape:c}}),v=VN({inputs:{a:m,b:x},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(x),v}const h5={kernelName:ow,backendName:"webgl",kernelFunc:HN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p5(n){const{inputs:e,backend:t,attrs:r}=n,{logits:a}=e,{numSamples:i,seed:l,normalized:u}=r,c=u?a:HN({inputs:{logits:a},backend:t,attrs:{dim:a.shape.length-1}}),f=c.shape[0],p=c.shape[1],m=new l5(f,p,i),g=[[l]],x=t.runWebGLProgram(m,[c],"int32",g);return u||t.disposeIntermediateTensorInfo(c),x}const m5={kernelName:xS,backendName:"webgl",kernelFunc:p5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g5=wr+`
  return -x;
`,y5=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function x5(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId),[l,u]=UV(i.values,r.shape,r.dtype);return t.makeTensorInfo(u,r.dtype,l)}let a;return Z().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new vs(r.shape,y5):a=new da(r.shape,g5),t.runWebGLProgram(a,[r],r.dtype)}const b5={kernelName:vS,backendName:"webgl",kernelFunc:x5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v5=jT;function C5(n){Gr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:a,scores:i}=e,{maxOutputSize:l,iouThreshold:u,scoreThreshold:c}=r,f=t.readSync(a.dataId),p=t.readSync(i.dataId),{selectedIndices:m}=v5(f,p,l,u,c);return t.makeTensorInfo([m.length],"int32",new Int32Array(m))}const S5={kernelName:SS,backendName:"webgl",kernelFunc:C5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5=qT;function T5(n){Gr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:a,scores:i}=e,{maxOutputSize:l,iouThreshold:u,scoreThreshold:c,padToMaxOutputSize:f}=r,p=t.readSync(a.dataId),m=t.readSync(i.dataId),{selectedIndices:g,validOutputs:x}=w5(p,m,l,u,c,f);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([],"int32",new Int32Array([x]))]}const N5={kernelName:wS,backendName:"webgl",kernelFunc:T5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5=XT;function $5(n){Gr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:a,scores:i}=e,{maxOutputSize:l,iouThreshold:u,scoreThreshold:c,softNmsSigma:f}=r,p=t.readSync(a.dataId),m=t.readSync(i.dataId),g=l,x=u,v=c,w=f,{selectedIndices:S,selectedScores:T}=E5(p,m,g,x,v,w);return[t.makeTensorInfo([S.length],"int32",new Int32Array(S)),t.makeTensorInfo([T.length],"float32",new Float32Array(T))]}const D5={kernelName:TS,backendName:"webgl",kernelFunc:$5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R5{constructor(e,t,r,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${a}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _5=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:a}=e,{dtype:i,depth:l,onValue:u,offValue:c}=r,f=pe(a.shape),p=new R5(f,l,u,c),m=be({inputs:{x:a},backend:t,attrs:{shape:[f]}}),g=t.runWebGLProgram(p,[m],i);t.disposeIntermediateTensorInfo(m);const x=[...a.shape,l],v=be({inputs:{x:g},backend:t,attrs:{shape:x}});return t.disposeIntermediateTensorInfo(g),v},O5={kernelName:ES,backendName:"webgl",kernelFunc:_5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ud(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const a=Iu({inputs:{input:r},backend:t}),i=Ud({inputs:{x:a},backend:t}),l=ff({inputs:{input:r},backend:t}),u=Ud({inputs:{x:l},backend:t}),c=Fs({inputs:{real:i,imag:u},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(u),c}else return Lu({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const k5={kernelName:$w,backendName:"webgl",kernelFunc:Ud};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const a=Iu({inputs:{input:r},backend:t}),i=WN({inputs:{x:a},backend:t}),l=ff({inputs:{input:r},backend:t}),u=Ud({inputs:{x:l},backend:t}),c=Fs({inputs:{real:i,imag:u},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(u),c}else return Lu({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const F5={kernelName:NS,backendName:"webgl",kernelFunc:WN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A5(n){const{inputs:e,backend:t,attrs:r}=n,{axis:a}=r;if(e.length===1)return Wm({inputs:{input:e[0]},backend:t,attrs:{dim:a}});const i=e[0].shape,l=e[0].dtype;e.forEach(p=>{Kn(i,p.shape,"All tensors passed to stack must have matching shapes"),A(l===p.dtype,()=>"All tensors passed to stack must have matching dtypes")});const u=[],c=e.map(p=>{const m=Wm({inputs:{input:p},backend:t,attrs:{dim:a}});return u.push(m),m}),f=_N({inputs:c,backend:t,attrs:{axis:a}});return u.forEach(p=>t.disposeIntermediateTensorInfo(p)),f}const I5={kernelName:$S,backendName:"webgl",kernelFunc:A5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L5{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((f,p)=>f[0]+e[p]+f[1]);const a=e.length,i=tt(a),l=t.map(f=>f[0]).join(","),u=t.map((f,p)=>f[0]+e[p]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode=`
        int start = ${l};
        int end = ${u};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${l});
      ${i} end = ${i}(${u});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B5{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((w,S)=>w[0]+e[S]+w[1]);const a=e.length,i=tt(a),l=t.map(w=>w[0]).join(","),u=t.map((w,S)=>w[0]+e[S]).join(","),c=tn("rc",a),f=tn("source",a),p=`${c[a-1]} < ${this.outputShape[a-1]}`,m=a===1?"source":`vec2(${f.slice(-2).join()})`,g=[`${i} rc = outputLoc;`,`${c[a-1]} += 1;
       if(${p}) {
      `,a===1?"":`}
       rc = outputLoc;
       ${c[a-2]} += 1;
       if(${c[a-2]} < ${this.outputShape[a-2]}) {`,a===1?"":`  ${c[a-1]} += 1;
         if(${p}) {`],x=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let v="";for(let w=0,S=a===1?2:4;w<S;w++)v+=`
        ${g[w]}
        if (${x}) {
          result[${w}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${w}] = getChannel(getX(${f.join()}), ${m});
        }
      `;v+=a===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${l});
      const ${i} end = ${i}(${u});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jN=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{paddings:i,constantValue:l}=r;if(pe(a.shape)===0){const f=i.map((p,m)=>p[0]+a.shape[m]+p[1]);return Lu({backend:t,attrs:{shape:f,value:l,dtype:a.dtype}})}const u=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new B5(a.shape,i,l):new L5(a.shape,i,l),c=[[l]];return t.runWebGLProgram(u,[a],a.dtype,c)},M5={kernelName:DS,backendName:"webgl",kernelFunc:jN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,P5=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Pi+`
  return result;
`,z5=Ht({opSnippet:U5,packedOpSnippet:P5}),V5={kernelName:RS,backendName:"webgl",kernelFunc:z5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{axis:i,keepDims:l}=r,u=a.shape.length,c=[],f=Ft(i,a.shape);let p=f;const m=Cr(p,u);let g=a;m!=null&&(g=rn({inputs:{x:a},backend:t,attrs:{perm:m}}),p=Sr(p.length,u),c.push(g)),qr("prod",p,u);let x;if(t.shouldExecuteOnCPU([g])){const v=t.texData.get(g.dataId).values,{outVals:w,outShape:S,outDtype:T}=zV(g.shape,g.dtype,v,p);x=t.makeTensorInfo(S,T,w)}else{const[v,w]=ma(g.shape,p),S=pe(w),T=be({inputs:{x:g},backend:t,attrs:{shape:[-1,S]}}),$=ig(a.dtype),D=zi(T,$,"prod",t);x=be({inputs:{x:D},backend:t,attrs:{shape:v}}),c.push(T),c.push(D)}if(l){c.push(x);const v=Zn(x.shape,f);x=be({inputs:{x},backend:t,attrs:{shape:v}})}return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),x}const H5={kernelName:OS,backendName:"webgl",kernelFunc:G5};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:a,paramsDenseValues:i,indices:l}=e,{outputRaggedRank:u}=r,c=a.map(T=>t.readSync(T.dataId)),f=a.map(T=>T.shape),p=t.readSync(i.dataId),m=t.readSync(l.dataId),[g,x,v]=VV(c,f,p,i.shape,i.dtype,m,l.shape,u),w=g.map(T=>t.makeTensorInfo([T.length],"int32",T)),S=t.makeTensorInfo(v,i.dtype,x);return w.concat([S])}const j5={kernelName:kS,backendName:"webgl",kernelFunc:W5};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q5(n){const{inputs:e,backend:t}=n,{starts:r,limits:a,deltas:i}=e,l=t.readSync(r.dataId),u=t.readSync(a.dataId),c=t.readSync(i.dataId),[f,p]=GV(l,r.shape,r.dtype,u,a.shape,c,i.shape),m=t.makeTensorInfo([f.length],"int32",f),g=t.makeTensorInfo([p.length],r.dtype,p);return[m,g]}const X5={kernelName:FS,backendName:"webgl",kernelFunc:q5};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5(n){const{inputs:e,backend:t,attrs:r}=n,{shape:a,values:i,defaultValue:l,rowPartitionTensors:u}=e,{rowPartitionTypes:c}=r,f=t.readSync(a.dataId),p=t.readSync(i.dataId),m=t.readSync(l.dataId),g=u.map(S=>t.readSync(S.dataId)),x=u.map(S=>S.shape),[v,w]=HV(f,a.shape,p,i.shape,i.dtype,m,l.shape,g,x,c);return t.makeTensorInfo(v,i.dtype,w)}const Y5={kernelName:AS,backendName:"webgl",kernelFunc:K5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qN=n=>{const{backend:e,attrs:t}=n,{start:r,stop:a,step:i,dtype:l}=t,u=WV(r,a,i,l);return e.makeTensorInfo([u.length],l,u)},Q5={kernelName:IS,backendName:"webgl",kernelFunc:qN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z5="return 1.0 / x;",J5=Ge({opSnippet:Z5}),e8={kernelName:BS,backendName:"webgl",kernelFunc:J5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8=wr+`
  return (x < 0.0) ? 0.0 : x;
`,n8=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,r8=Ge({opSnippet:t8,packedOpSnippet:n8}),a8={kernelName:MS,backendName:"webgl",kernelFunc:r8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8=wr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,i8=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,o8=Ge({opSnippet:s8,packedOpSnippet:i8}),l8={kernelName:VS,backendName:"webgl",kernelFunc:o8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u8{constructor(e,t,r,a,i){this.variableNames=["A"],this.outputShape=[];const[l,u,c,f]=e;this.outputShape=[l,t,r,f];const p=[a&&t>1?u-1:u,a&&r>1?c-1:c],m=[a&&t>1?t-1:t,a&&r>1?r-1:r];let g;i?g="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${p[0]/m[0]},
          ${p[1]/m[1]});
      const vec2 inputShapeRC = vec2(${u}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c8{constructor(e,t,r,a,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[l,u,c,f]=e;this.outputShape=[l,t,r,f];const p=[a&&t>1?u-1:u,a&&r>1?c-1:c],m=[a&&t>1?t-1:t,a&&r>1?r-1:r];let g;i?g="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${p[0]/m[0]},
          ${p[1]/m[1]},
          ${p[1]/m[1]});
      const vec3 inputShapeRC = vec3(${u}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${f-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(n){const{inputs:e,backend:t,attrs:r}=n,{images:a}=e,{alignCorners:i,halfPixelCenters:l,size:u}=r,[c,f]=u,p=Z().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new c8(a.shape,c,f,i,l):new u8(a.shape,c,f,i,l);return t.runWebGLProgram(p,[a],"float32")}const f8={kernelName:zS,backendName:"webgl",kernelFunc:d8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h8{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,i]=t,[,l,u]=e,c=[r&&l>1?a-1:a,r&&u>1?i-1:i],f=[r&&l>1?l-1:l,r&&u>1?u-1:u],p=c[0]/f[0],m=c[1]/f[1],g=1/p,x=1/m,v=Math.ceil(g)*2+2,w=Math.ceil(x)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${p});
        const float widthScale = float(${m});

        const float invHeightScale = float(${g});
        const float invWidthScale = float(${x});

        const int winHeight = int(${v});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${l}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${u}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${a-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(n){const{inputs:e,backend:t,attrs:r}=n,{images:a,dy:i}=e,{alignCorners:l}=r,u=new h8(i.shape,a.shape,l);return t.runWebGLProgram(u,[i],i.dtype)}const m8={kernelName:RR,backendName:"webgl",kernelFunc:p8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g8{constructor(e,t,r,a,i){this.variableNames=["A"],this.outputShape=[];const[l,u,c,f]=e;this.outputShape=[l,t,r,f];const p=[a&&t>1?u-1:u,a&&r>1?c-1:c],m=[a&&t>1?t-1:t,a&&r>1?r-1:r],g=a?"0.5":"0.0";let x;i?x="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":x="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${p[0]/m[0]},
          ${p[1]/m[1]});
      const vec2 inputShapeRC = vec2(${u}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${x};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${g})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y8{constructor(e,t,r,a,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[l,u,c,f]=e;this.outputShape=[l,t,r,f];const p=[a&&t>1?u-1:u,a&&r>1?c-1:c],m=[a&&t>1?t-1:t,a&&r>1?r-1:r],g=a?"0.5":"0.0";let x;i?x="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":x="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${p[0]/m[0]},
          ${p[1]/m[1]},
          ${p[1]/m[1]});
      const vec3 inputShapeRC = vec3(${u}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${x};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${g})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${f-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(n){const{inputs:e,backend:t,attrs:r}=n,{images:a}=e,{alignCorners:i,halfPixelCenters:l,size:u}=r,[c,f]=u,p=Z().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new y8(a.shape,c,f,i,l):new g8(a.shape,c,f,i,l);return t.runWebGLProgram(p,[a],a.dtype)}const b8={kernelName:PS,backendName:"webgl",kernelFunc:x8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v8{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,i]=t,[,l,u]=e,c=[r&&l>1?a-1:a,r&&u>1?i-1:i],f=[r&&l>1?l-1:l,r&&u>1?u-1:u],p=c[0]/f[0],m=c[1]/f[1],g=1/p,x=1/m,v=Math.ceil(g)*2+2,w=Math.ceil(x)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${p});
        const float widthScale = float(${m});

        const float invHeightScale = float(${g});
        const float invWidthScale = float(${x});

        const int winHeight = int(${v});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${l}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${u}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${f[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${f[1]}));

            int sourceNearestRow = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(n){const{inputs:e,backend:t,attrs:r}=n,{images:a,dy:i}=e,{alignCorners:l}=r,u=new v8(i.shape,a.shape,l);return t.runWebGLProgram(u,[i],i.dtype)}const S8={kernelName:DR,backendName:"webgl",kernelFunc:C8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w8{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const a=u=>t.indexOf(u)!==-1&&e[u]!==1?`${e[u]} - coords[${u}] - 1`:`coords[${u}]`,i=e.map((u,c)=>a(c)).join(","),l=tt(r);this.userCode=`
      void main() {
        ${l} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T8{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const a=tn("rc",r),i=`${a[r-1]} + 1 < ${this.outputShape[r-1]}`,l=`${a[r-2]} + 1 < ${this.outputShape[r-2]}`,u=tt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${u} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(a.slice())};
          if(${i}){
            result.g = ${f(a.slice())};
          }
          if(${l}) {
            result.b = ${p(a.slice())};
            if(${i}) {
              result.a = ${m(a.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(v){return g(v)}function f(v){return v[r-1]="("+v[r-1]+" + 1)",g(v)}function p(v){return v[r-2]="("+v[r-2]+" + 1)",g(v)}function m(v){return v[r-1]="("+v[r-1]+" + 1)",v[r-2]="("+v[r-2]+" + 1)",g(v)}function g(v){const w=e.map(($,D)=>x(D,v)),S=w.join(","),T=w.slice(-2).join(",");return`getChannel(getX(${S}), vec2(${T}))`}function x(v,w){return t.indexOf(v)!==-1&&e[v]!==1?`${e[v]} - ${w[v]} - 1`:`${w[v]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N8(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{dims:i}=r,l=a.shape.length,u=Ft(i,a.shape);if(l===0)return In({inputs:{x:a},backend:t});const c=Z().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new T8(a.shape,u):new w8(a.shape,u);return t.runWebGLProgram(c,[a],a.dtype)}const E8={kernelName:GS,backendName:"webgl",kernelFunc:N8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $8{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],a=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8={kernelName:Rw,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:a,fillValue:i,center:l}=e,u=t,c=new $8(r.shape,i),[f,p]=v2(l,r.shape[1],r.shape[2]),m=[[f,p,Math.sin(a),Math.cos(a)]];return u.runWebGLProgram(c,[r],r.dtype,m)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,_8=Ge({opSnippet:R8}),O8={kernelName:HS,backendName:"webgl",kernelFunc:_8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8="return inversesqrt(x);",F8=Ge({opSnippet:k8,cpuKernelImpl:jV}),A8={kernelName:WS,backendName:"webgl",kernelFunc:F8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vg{constructor(e,t,r,a,i,l,u=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=l;const f=tt(i.length),p=tt(l.length);let m="";r===1?m="i":r===2&&(m="i, j");const g=`getIndices(${m})`;let x="";a===1?x="i":a===2&&(x="i, coords[1]");const v=`getUpdates(${x})`;let w="";c&&(w="coords[0], coords[1]");const S=`getDefaultValue(${w})`,T=t>1?"strides[j]":"strides";this.userCode=`
        ${f} strides = ${f}(${i});

        void main() {
          ${p} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${g});
              flattenedIndex += index * ${T};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${v};
              found = true;
            }
          }
          setOutput(mix(${S}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I8{constructor(e,t,r,a,i,l,u=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=l;const f=tt(i.length),p=tt(l.length);let m="";r===1?m="i":r===2&&(m="i, j");const g=`getIndices(${m})`;let x="";a===1?x="i":a===2&&(x="i, coords[1]");const v=`getUpdates(${x})`;let w="";c&&(w="coords[0], coords[1]");const S=`getDefaultValue(${w})`,T=t>1?"strides[j]":"strides",$=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${f} strides = ${f}(${i});

        void main() {
          ${p} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${g});
              flattenedIndex += index.xz * ${T};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${$};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${v};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${S}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(n){const{inputs:e,backend:t,attrs:r}=n,{indices:a,updates:i}=e,{shape:l}=r,{sliceRank:u,numUpdates:c,sliceSize:f,strides:p,outputSize:m}=tf(i,a,l),g=[m/f,f];if(m===0)return t.makeTensorInfo(l,a.dtype);const x=be({inputs:{x:a},backend:t,attrs:{shape:[c,u]}}),v=be({inputs:{x:i},backend:t,attrs:{shape:[c,f]}}),w=t.makeTensorInfo([],"float32",new Float32Array([0]));let S;Z().getBool("WEBGL_PACK")?S=new I8(c,u,x.shape.length,v.shape.length,p,g):S=new Vg(c,u,x.shape.length,v.shape.length,p,g);const T=t.runWebGLProgram(S,[v,x,w],v.dtype),$=be({inputs:{x:T},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(w),$}const B8={kernelName:jS,backendName:"webgl",kernelFunc:L8};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M8{constructor(e,t,r,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",l=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,u=Z().getNumber("WEBGL_VERSION")===2?i:l,c=a==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${u}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${c} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:a,values:i}=e,{side:l}=r,u=new M8(a.shape[0],a.shape[1],i.shape[1],l),c=[[a.shape[1]]];return t.runWebGLProgram(u,[a,i],"int32",c)}const P8={kernelName:XS,backendName:"webgl",kernelFunc:U8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z8{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let a,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",a="resRC";else{const u=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=[];for(let p=0;p<t.length;p++)f.push(`${u[p]}`),p<e&&c.push(`${u[p]}`);a=c.join(),i=f.join()}const l=tt(r);this.userCode=`
      void main() {
        ${l} resRC = getOutputCoords();
        float cVal = getC(${a});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(n){const{inputs:e,backend:t}=n,{condition:r,t:a,e:i}=e,l=new z8(r.shape.length,a.shape,a.shape.length);return t.runWebGLProgram(l,[r,a,i],pa(a.dtype,i.dtype))}const G8={kernelName:KS,backendName:"webgl",kernelFunc:V8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H8=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${w2};
  float scale = ${T2};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,W8=Ge({opSnippet:H8}),j8={kernelName:YS,backendName:"webgl",kernelFunc:W8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q8=el+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,X8=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,K8=Ge({opSnippet:q8,packedOpSnippet:X8,cpuKernelImpl:XV}),Y8={kernelName:tw,backendName:"webgl",kernelFunc:K8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q8=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Z8=Ge({opSnippet:Q8}),J8={kernelName:ew,backendName:"webgl",kernelFunc:Z8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq=el+`
  return sin(x);
`,tq=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Pi}
  return result;
`,nq=Ge({opSnippet:eq,packedOpSnippet:tq}),rq={kernelName:ZS,backendName:"webgl",kernelFunc:nq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,sq=Ge({opSnippet:aq}),iq={kernelName:JS,backendName:"webgl",kernelFunc:sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,lq=Ge({opSnippet:oq}),uq={kernelName:nw,backendName:"webgl",kernelFunc:lq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cq=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{blockShape:i,paddings:l}=r;A(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const u=i.reduce((T,$)=>T*$),c=[[0,0]];c.push(...l);for(let T=1+i.length;T<a.shape.length;++T)c.push([0,0]);const f=[],p=jN({inputs:{x:a},backend:t,attrs:{paddings:c,constantValue:0}}),m=Rg(p.shape,i,u,!1),g=_g(m.length,i.length,!1),x=Og(p.shape,i,u,!1),v=be({inputs:{x:p},backend:t,attrs:{shape:m}}),w=rn({inputs:{x:v},backend:t,attrs:{perm:g}}),S=be({inputs:{x:w},backend:t,attrs:{shape:x}});return f.push(p),f.push(v),f.push(w),f.forEach(T=>t.disposeIntermediateTensorInfo(T)),S},dq={kernelName:sw,backendName:"webgl",kernelFunc:cq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fq(n){const{inputs:e,backend:t}=n,{indices:r,values:a,denseShape:i,defaultValue:l}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(l.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${l.shape}`);const u=t.readSync(r.dataId),c=t.readSync(a.dataId),f=t.readSync(i.dataId),p=t.readSync(l.dataId)[0],[m,g,x,v,w]=YV(u,r.shape,r.dtype,c,a.dtype,f,p);return[t.makeTensorInfo(g,r.dtype,m),t.makeTensorInfo([g[0]],a.dtype,x),t.makeTensorInfo([v.length],"bool",new Uint8Array(v.map(S=>Number(S)))),t.makeTensorInfo([w.length],r.dtype,new Int32Array(w))]}const hq={kernelName:lw,backendName:"webgl",kernelFunc:fq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:a,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const l=Array.from(t.readSync(a.dataId)),u=t.readSync(r.dataId),c=Array.from(t.readSync(i.dataId)),[f,p,m]=QV(u,r.shape,r.dtype,l,c);return[t.makeTensorInfo(p,r.dtype,f),t.makeTensorInfo([m.length],i.dtype,new Int32Array(m))]}const mq={kernelName:uw,backendName:"webgl",kernelFunc:pq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(n){const{inputs:e,backend:t}=n,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const l=t.readSync(r.dataId),u=t.readSync(a.dataId),c=t.readSync(i.dataId),[f,p]=yN(l,r.shape,r.dtype,u,c,!0);return t.makeTensorInfo(p,r.dtype,f)}const yq={kernelName:cw,backendName:"webgl",kernelFunc:gq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(n){const{inputs:e,backend:t}=n,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const l=t.readSync(r.dataId),u=t.readSync(a.dataId),c=t.readSync(i.dataId),[f,p]=yN(l,r.shape,r.dtype,u,c);return t.makeTensorInfo(p,r.dtype,f)}const bq={kernelName:dw,backendName:"webgl",kernelFunc:xq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:a,sparseValues:i,defaultValue:l}=e,{outputShape:u}=r,{sliceRank:c,numUpdates:f,sliceSize:p,strides:m,outputSize:g}=tf(i,a,u),x=!1;if(i.dtype==="string"){const T=t.bufferSync(a),$=t.bufferSync(i),D=Mo(t.readSync(l.dataId)[0]),R=qV(T,$,u,g,p,f,c,m,D,x);return t.makeTensorInfo(u,R.dtype,R.values)}const v=new Vg(f,c,a.shape.length,i.shape.length,m,[g,1],x),w=t.runWebGLProgram(v,[i,a,l],i.dtype),S=be({inputs:{x:w},backend:t,attrs:{shape:u}});return t.disposeIntermediateTensorInfo(w),S}const Cq={kernelName:fw,backendName:"webgl",kernelFunc:vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{numOrSizeSplits:i,axis:l}=r,u=Ft(l,a.shape)[0],c=L2(a,i,u),f=a.shape.length,p=new Array(f).fill(0),m=a.shape.slice();return c.map(g=>{const x=[...m];x[u]=g;const v=tl({inputs:{x:a},backend:t,attrs:{begin:p,size:x}});return p[u]+=g,v})}const wq={kernelName:iw,backendName:"webgl",kernelFunc:Sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const av="return sqrt(x);",Tq=Ge({opSnippet:av,packedOpSnippet:av,cpuKernelImpl:ZV}),Nq={kernelName:rw,backendName:"webgl",kernelFunc:Tq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eq="return x * x;",$q=Ge({opSnippet:Eq}),Dq={kernelName:_R,backendName:"webgl",kernelFunc:$q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sv="return (a - b) * (a - b);",Rq=Ht({opSnippet:sv,packedOpSnippet:sv}),_q={kernelName:hw,backendName:"webgl",kernelFunc:Rq};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(a.dataId),l=zo(i),u=JV(l,"string",r);return t.makeTensorInfo(a.shape,"string",u)}const kq={kernelName:pw,backendName:"webgl",kernelFunc:Oq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq({inputs:n,attrs:e,backend:t}){const{x:r}=n,a=wr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new da(r.shape,a);return t.runWebGLProgram(i,[r],r.dtype)}const Aq={kernelName:Dw,backendName:"webgl",kernelFunc:Fq};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iq{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const a=r.length,i=tt(r.length),l=tt(r.length);let u="";if(a===1)u="coords * strides + begin";else{let c=0;u=r.map((f,p)=>(c++,r.length===1?`coords * strides[${p}] + begin[${p}]`:`coords[${c-1}] * strides[${p}] + begin[${p}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${l} coords = getOutputCoords();
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{begin:i,end:l,strides:u,beginMask:c,endMask:f,ellipsisMask:p,newAxisMask:m,shrinkAxisMask:g}=r,{finalShapeSparse:x,finalShape:v,isIdentity:w,sliceDim0:S,isSimpleSlice:T,begin:$,end:D,strides:R}=p2(a.shape,i,l,u,c,f,p,m,g);let I;if(w)I=be({inputs:{x:a},backend:t,attrs:{shape:v}});else if(S||T){A(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const j=a2($,D,R),K=tl({inputs:{x:a},backend:t,attrs:{begin:$,size:j}});I=be({inputs:{x:K},backend:t,attrs:{shape:v}}),t.disposeIntermediateTensorInfo(K)}else if(t.shouldExecuteOnCPU([a])){const K=t.readSync(a.dataId),B=mt(a.shape,a.dtype,K),U=eG(x,B,R,$);I=t.makeTensorInfo(v,a.dtype,U.values)}else{const K=new Iq($,R,x);I=t.runWebGLProgram(K,[a],a.dtype)}const V=be({inputs:{x:I},backend:t,attrs:{shape:v}});return t.disposeIntermediateTensorInfo(I),V}const Bq={kernelName:mw,backendName:"webgl",kernelFunc:Lq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(n){const{inputs:e,backend:t,attrs:r}=n,{separator:a,nGramWidths:i,leftPad:l,rightPad:u,padWidth:c,preserveShortSequences:f}=r,{data:p,dataSplits:m}=e,g=t.readSync(p.dataId),x=t.readSync(m.dataId),[v,w]=tG(g,x,a,i,l,u,c,f);return[t.makeTensorInfo([v.length],"string",v),t.makeTensorInfo(m.shape,"int32",w)]}const Uq={kernelName:gw,backendName:"webgl",kernelFunc:Mq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:a}=r,{input:i,delimiter:l}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(l.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${l.shape}`);const u=t.readSync(i.dataId),c=t.readSync(l.dataId)[0],[f,p,m]=nG(u,c,a),g=p.length;return[t.makeTensorInfo([g,2],"int32",f),t.makeTensorInfo([g],"string",p),t.makeTensorInfo([2],"int32",new Int32Array(m))]}const zq={kernelName:yw,backendName:"webgl",kernelFunc:Pq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:a}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const l=t.readSync(i.dataId),u=rG(l,a);return t.makeTensorInfo(i.shape,"int32",u)}const Gq={kernelName:xw,backendName:"webgl",kernelFunc:Vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hq="return tan(x);",Wq=Ge({opSnippet:Hq}),jq={kernelName:vw,backendName:"webgl",kernelFunc:Wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qq=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Xq=Ge({opSnippet:qq}),Kq={kernelName:Cw,backendName:"webgl",kernelFunc:Xq};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(n){const{inputs:e,backend:t,attrs:r}=n,{tensor:a,indices:i,updates:l}=e,{sliceRank:u,numUpdates:c,sliceSize:f,strides:p,outputSize:m}=tf(l,i,a.shape),g=[m/f,f];if(m===0)return t.makeTensorInfo(a.shape,i.dtype);const x=be({inputs:{x:i},backend:t,attrs:{shape:[c,u]}}),v=be({inputs:{x:l},backend:t,attrs:{shape:[c,f]}}),w=be({inputs:{x:a},backend:t,attrs:{shape:g}}),S=new Vg(c,u,x.shape.length,v.shape.length,p,g,!1,!0),T=t.runWebGLProgram(S,[v,x,w],w.dtype),$=be({inputs:{x:T},backend:t,attrs:{shape:a.shape}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(T),$}const Qq={kernelName:qS,backendName:"webgl",kernelFunc:Yq};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zq{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let l=0;l<r.length;l++)r[l]=e[l]*t[l];this.outputShape=r,this.rank=r.length;const a=tt(this.rank),i=Jq(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function Jq(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<n.length;a++)r.push(`imod(${t[a]}, ${n[a]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XN(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{reps:i}=r;if(a.dtype==="string"||a.shape.length>5){const c=t.readSync(a.dataId),f=a.dtype==="string"?c.map(g=>Mo(g)):c,p=mt(a.shape,a.dtype,f),m=sG(p,i);return t.makeTensorInfo(m.shape,m.dtype,m.values)}const l=new Zq(a.shape,i);return t.runWebGLProgram(l,[a],a.dtype)}const eX={kernelName:sg,backendName:"webgl",kernelFunc:XN};class tX{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class nX{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function iv(n){let e=1;for(;e<n;)e*=2;return e}function rX(n){const{inputs:e,backend:t,attrs:r}=n,{x:a}=e,{k:i,sorted:l}=r,u=Z().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=Z().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),f=a.shape,p=f[f.length-1];if(t.shouldExecuteOnCPU([a])||p<u||i>c){const U=t.readSync(a.dataId),[k,ee]=iG(U,f,a.dtype,i,l);return[t.makeTensorInfo(k.shape,k.dtype,k.values),t.makeTensorInfo(ee.shape,ee.dtype,ee.values)]}if(i===0)return f[f.length-1]=0,[t.makeTensorInfo(f,a.dtype,[]),t.makeTensorInfo(f,"int32",[])];if(p===1)return[a,Lu({attrs:{shape:f,dtype:"int32",value:0},backend:t})];const m=t.texData.get(a.dataId),g=m!==null&&m.isPacked,x=g?t.unpackTensor(a):a,w=pe(f)/p,S=be({inputs:{x},attrs:{shape:[w,p]},backend:t});g&&ii(t,x);const T=iv(i),$=iv(p);let D=null;const R=()=>D===null?[S,S]:[S,D],I=(U,k,ee)=>{const he=R(),fe=new tX(ee),ae=[[p],[D===null?1:0],[Number.NEGATIVE_INFINITY],[U],[k]],de=D;D=t.runWebGLProgram(fe,he,"int32",ae),ii(t,de)};for(let U=1;U<T;U*=2){const k=U*2;for(let ee=U;ee>=1;ee/=2)I(k,ee,[w,$])}for(let U=$;U>T;U/=2){const k=R(),ee=new nX([w,U/2]),fe=[[p],[D===null?1:0],[T]],me=D;D=t.runWebGLProgram(ee,k,"int32",fe),ii(t,me);const ae=T/2,de=ae*2;for(let le=ae;le>=1;le/=2)I(de,le,D.shape)}let V=D;D=tl({inputs:{x:D},backend:t,attrs:{begin:0,size:[w,i]}}),ii(t,V);let j=PN({inputs:{x:S,indices:D},backend:t,attrs:{axis:1,batchDims:1}});ii(t,S);const K=f.slice(0,-1);K.push(i),V=D,D=be({inputs:{x:D},attrs:{shape:K},backend:t}),ii(t,V);const B=j;return j=be({inputs:{x:j},attrs:{shape:K},backend:t}),ii(t,B),[j,D]}const aX={kernelName:Sw,backendName:"webgl",kernelFunc:rX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sX{constructor(e,t,r,a,i,l){this.variableNames=["Image","Transforms"],this.outputShape=l;const u=r==="nearest"?1:2;let c;switch(a){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${c} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${u} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(n){const{inputs:e,backend:t,attrs:r}=n,{image:a,transforms:i}=e,{interpolation:l,fillMode:u,fillValue:c,outputShape:f}=r,[p,m,g,x]=a.shape,[v,w]=f??[m,g],S=[p,v,w,x],T=new sX(m,g,l,u,c,S);return t.runWebGLProgram(T,[a,i],"float32")}const oX={kernelName:ww,backendName:"webgl",kernelFunc:iX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(n){const{inputs:e,attrs:t,backend:r}=n,{axis:a}=t,{x:i}=e;Fu(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const l=r.readSync(i.dataId),{outputValues:u,outputShape:c,indices:f}=oG(l,a,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([f.length],"int32",f)]}const uX={kernelName:Tw,backendName:"webgl",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(n){const{inputs:e,backend:t,attrs:r}=n,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const l=a,u=l.shape.length,c=a.shape[i],f=new Array(u-1);let p=0;for(let w=0;w<u;w++)w!==i&&(f[p++]=l.shape[w]);const m=[],g=new Array(u).fill(0),x=l.shape.slice();x[i]=1;const v=new Array(c);for(let w=0;w<v.length;w++){g[i]=w;const S=tl({inputs:{x:l},backend:t,attrs:{begin:g,size:x}}),T=be({inputs:{x:S},backend:t,attrs:{shape:f}});v[w]=T,m.push(S)}return m.forEach(w=>t.disposeIntermediateTensorInfo(w)),v}const dX={kernelName:Nw,backendName:"webgl",kernelFunc:cX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fX{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,a=e.batchSize,i=e.inSize,l=e.numSegments,u=l*Math.ceil(i/r);this.outputShape=[a,u];const c="0.0",f="sumValue",p=Math.floor(r/4)*4,m=r%4,g=`
        sumValue += dot(values, segFilter);
    `;let x="";i%r>0&&(x=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let v="";i%r>0&&(v=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${x}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${v}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${l})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${l})));

        float sumValue = 0.0;

        for (int i = 0; i < ${p}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${g}
        }

        int inIdx = inOffset + ${p};
        if (${m===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${g}
        } else if (${m===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${g}
        } else if (${m===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${g}
        }
        setOutput(${f});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(n){const{inputs:e,backend:t,attrs:r}=n,{x:a,segmentIds:i}=e,{numSegments:l}=r,u=a.shape.length,c=[];let f=0;const p=Cr([f],u);let m=a;p!=null&&(m=rn({inputs:{x:a},backend:t,attrs:{perm:p}}),c.push(m),f=Sr(1,u)[0]);const g=K2(m.shape,f,l),x=pe([m.shape[f]]),v=be({inputs:{x:m},backend:t,attrs:{shape:[-1,x]}});c.push(v);const w=ig(a.dtype),S=(R,I,V,j,K)=>{const B=R.shape[0],U=R.shape[1],k=X2(U,K),ee={windowSize:k,inSize:U,batchSize:B,numSegments:K},he=new fX(ee,I),fe=t.compileAndRun(he,[R,V],j);if(c.push(fe),fe.shape[1]===K)return fe;const me=qN({backend:t,attrs:{start:0,stop:K,step:1,dtype:"float32"}}),ae=XN({inputs:{x:me},backend:t,attrs:{reps:[U/k]}});return c.push(me),c.push(ae),S(fe,I,ae,j,K)},T=S(v,"unsortedSegmentSum",i,w,l),$=be({inputs:{x:T},backend:t,attrs:{shape:g}});let D=$;if(p!=null){c.push($);const R=hg(p);D=rn({inputs:{x:D},backend:t,attrs:{perm:R}})}return c.forEach(R=>t.disposeIntermediateTensorInfo(R)),D}const pX={kernelName:Ew,backendName:"webgl",kernelFunc:hX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX=[ZG,e6,r6,i6,l6,d6,h6,m6,b6,C6,T6,$6,_6,A6,B6,U6,z6,W6,q6,K6,J6,iH,lH,fH,pH,vH,SH,EH,IG,RH,AH,MH,HH,qH,KH,QH,JH,rW,iW,uW,dW,hW,mW,xW,vW,TW,EW,RW,kW,AW,MW,VW,jW,KW,ZW,JW,tj,rj,sj,oj,uj,hj,gj,bj,Cj,Tj,$j,Oj,Ij,AG,Bj,kH,Pj,Gj,jj,BG,Yj,e7,n7,i7,u7,h7,g7,v7,T7,$7,R7,F7,I7,B7,z7,G7,W7,q7,K7,J7,r5,o5,m5,PG,b5,S5,N5,D5,gH,O5,F5,I5,M5,V5,UG,H5,j5,X5,Y5,Q5,yH,d5,e8,a8,l8,VG,f8,m8,b8,S8,E8,D8,O8,A8,B8,P8,G8,j8,Y8,J8,rq,iq,aH,h5,uq,dq,hq,mq,yq,bq,Cq,wq,Nq,Dq,_q,kq,Aq,Bq,Uq,zq,Gq,f5,KG,jq,Kq,Qq,eX,aX,oX,YG,uX,dX,pX,k5];for(const n of mX)FR(n);var bd={exports:{}},gX=bd.exports,ov;function yX(){return ov||(ov=1,function(n,e){(function(t,r){n.exports=r()})(typeof self<"u"?self:gX,function(){return function(t){var r={};function a(i){if(r[i])return r[i].exports;var l=r[i]={i,l:!1,exports:{}};return t[i].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=t,a.c=r,a.d=function(i,l,u){a.o(i,l)||Object.defineProperty(i,l,{enumerable:!0,get:u})},a.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},a.t=function(i,l){if(1&l&&(i=a(i)),8&l||4&l&&typeof i=="object"&&i&&i.__esModule)return i;var u=Object.create(null);if(a.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:i}),2&l&&typeof i!="string")for(var c in i)a.d(u,c,(function(f){return i[f]}).bind(null,c));return u},a.n=function(i){var l=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(l,"a",l),l},a.o=function(i,l){return Object.prototype.hasOwnProperty.call(i,l)},a.p="",a(a.s=0)}([function(t,r,a){a.r(r);var i={};function l(Q){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F})(Q)}a.r(i),a.d(i,"VictoryGesture",function(){return he}),a.d(i,"ThumbsUpGesture",function(){return le});var u={Thumb:0,Index:1,Middle:2,Ring:3,Pinky:4,all:[0,1,2,3,4],nameMapping:{0:"Thumb",1:"Index",2:"Middle",3:"Ring",4:"Pinky"},pointsMapping:{0:[[0,1],[1,2],[2,3],[3,4]],1:[[0,5],[5,6],[6,7],[7,8]],2:[[0,9],[9,10],[10,11],[11,12]],3:[[0,13],[13,14],[14,15],[15,16]],4:[[0,17],[17,18],[18,19],[19,20]]},getName:function(Q){return l(this.nameMapping[Q])!==void 0&&this.nameMapping[Q]},getPoints:function(Q){return l(this.pointsMapping[Q])!==void 0&&this.pointsMapping[Q]}},c={NoCurl:0,HalfCurl:1,FullCurl:2,nameMapping:{0:"No Curl",1:"Half Curl",2:"Full Curl"},getName:function(Q){return l(this.nameMapping[Q])!==void 0&&this.nameMapping[Q]}},f={VerticalUp:0,VerticalDown:1,HorizontalLeft:2,HorizontalRight:3,DiagonalUpRight:4,DiagonalUpLeft:5,DiagonalDownRight:6,DiagonalDownLeft:7,nameMapping:{0:"Vertical Up",1:"Vertical Down",2:"Horizontal Left",3:"Horizontal Right",4:"Diagonal Up Right",5:"Diagonal Up Left",6:"Diagonal Down Right",7:"Diagonal Down Left"},getName:function(Q){return l(this.nameMapping[Q])!==void 0&&this.nameMapping[Q]}};function p(Q,F){var P=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(!P){if(Array.isArray(Q)||(P=function(ge,Se){if(ge){if(typeof ge=="string")return m(ge,Se);var Ne=Object.prototype.toString.call(ge).slice(8,-1);if(Ne==="Object"&&ge.constructor&&(Ne=ge.constructor.name),Ne==="Map"||Ne==="Set")return Array.from(ge);if(Ne==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ne))return m(ge,Se)}}(Q))||F){P&&(Q=P);var G=0,te=function(){};return{s:te,n:function(){return G>=Q.length?{done:!0}:{done:!1,value:Q[G++]}},e:function(ge){throw ge},f:te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,xe=!0,ye=!1;return{s:function(){P=P.call(Q)},n:function(){var ge=P.next();return xe=ge.done,ge},e:function(ge){ye=!0,re=ge},f:function(){try{xe||P.return==null||P.return()}finally{if(ye)throw re}}}}function m(Q,F){(F==null||F>Q.length)&&(F=Q.length);for(var P=0,G=new Array(F);P<F;P++)G[P]=Q[P];return G}function g(Q,F){var P=Object.keys(Q);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(Q);F&&(G=G.filter(function(te){return Object.getOwnPropertyDescriptor(Q,te).enumerable})),P.push.apply(P,G)}return P}function x(Q){for(var F=1;F<arguments.length;F++){var P=arguments[F]!=null?arguments[F]:{};F%2?g(Object(P),!0).forEach(function(G){v(Q,G,P[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(P)):g(Object(P)).forEach(function(G){Object.defineProperty(Q,G,Object.getOwnPropertyDescriptor(P,G))})}return Q}function v(Q,F,P){return F in Q?Object.defineProperty(Q,F,{value:P,enumerable:!0,configurable:!0,writable:!0}):Q[F]=P,Q}function w(Q,F){for(var P=0;P<F.length;P++){var G=F[P];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(Q,G.key,G)}}var S=function(){function Q(G){(function(te,re){if(!(te instanceof re))throw new TypeError("Cannot call a class as a function")})(this,Q),this.options=x(x({},{HALF_CURL_START_LIMIT:60,NO_CURL_START_LIMIT:130,DISTANCE_VOTE_POWER:1.1,SINGLE_ANGLE_VOTE_POWER:.9,TOTAL_ANGLE_VOTE_POWER:1.6}),G)}var F,P;return F=Q,(P=[{key:"estimate",value:function(G){var te,re=[],xe=[],ye=p(u.all);try{for(ye.s();!(te=ye.n()).done;){var ge,Se=te.value,Ne=u.getPoints(Se),De=[],Le=[],qe=p(Ne);try{for(qe.s();!(ge=qe.n()).done;){var Ze=ge.value,Je=G[Ze[0]],ke=G[Ze[1]],nt=this.getSlopes(Je,ke),bt=nt[0],At=nt[1];De.push(bt),Le.push(At)}}catch(rr){qe.e(rr)}finally{qe.f()}re.push(De),xe.push(Le)}}catch(rr){ye.e(rr)}finally{ye.f()}var Mn,Tn=[],hn=[],Kt=p(u.all);try{for(Kt.s();!(Mn=Kt.n()).done;){var pn=Mn.value,vt=pn==u.Thumb?1:0,Un=u.getPoints(pn),Fe=G[Un[vt][0]],Nn=G[Un[vt+1][1]],nr=G[Un[3][1]],Is=this.estimateFingerCurl(Fe,Nn,nr),Ls=this.calculateFingerDirection(Fe,Nn,nr,re[pn].slice(vt));Tn[pn]=Is,hn[pn]=Ls}}catch(rr){Kt.e(rr)}finally{Kt.f()}return{curls:Tn,directions:hn}}},{key:"getSlopes",value:function(G,te){var re=this.calculateSlope(G[0],G[1],te[0],te[1]);return G.length==2?re:[re,this.calculateSlope(G[1],G[2],te[1],te[2])]}},{key:"angleOrientationAt",value:function(G){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,re=0,xe=0,ye=0;return G>=75&&G<=105?re=1*te:G>=25&&G<=155?xe=1*te:ye=1*te,[re,xe,ye]}},{key:"estimateFingerCurl",value:function(G,te,re){var xe=G[0]-te[0],ye=G[0]-re[0],ge=te[0]-re[0],Se=G[1]-te[1],Ne=G[1]-re[1],De=te[1]-re[1],Le=G[2]-te[2],qe=G[2]-re[2],Ze=te[2]-re[2],Je=Math.sqrt(xe*xe+Se*Se+Le*Le),ke=Math.sqrt(ye*ye+Ne*Ne+qe*qe),nt=Math.sqrt(ge*ge+De*De+Ze*Ze),bt=(nt*nt+Je*Je-ke*ke)/(2*nt*Je);bt>1?bt=1:bt<-1&&(bt=-1);var At=Math.acos(bt);return(At=57.2958*At%180)>this.options.NO_CURL_START_LIMIT?c.NoCurl:At>this.options.HALF_CURL_START_LIMIT?c.HalfCurl:c.FullCurl}},{key:"estimateHorizontalDirection",value:function(G,te,re,xe){return xe==Math.abs(G)?G>0?f.HorizontalLeft:f.HorizontalRight:xe==Math.abs(te)?te>0?f.HorizontalLeft:f.HorizontalRight:re>0?f.HorizontalLeft:f.HorizontalRight}},{key:"estimateVerticalDirection",value:function(G,te,re,xe){return xe==Math.abs(G)?G<0?f.VerticalDown:f.VerticalUp:xe==Math.abs(te)?te<0?f.VerticalDown:f.VerticalUp:re<0?f.VerticalDown:f.VerticalUp}},{key:"estimateDiagonalDirection",value:function(G,te,re,xe,ye,ge,Se,Ne){var De=this.estimateVerticalDirection(G,te,re,xe),Le=this.estimateHorizontalDirection(ye,ge,Se,Ne);return De==f.VerticalUp?Le==f.HorizontalLeft?f.DiagonalUpLeft:f.DiagonalUpRight:Le==f.HorizontalLeft?f.DiagonalDownLeft:f.DiagonalDownRight}},{key:"calculateFingerDirection",value:function(G,te,re,xe){var ye=G[0]-te[0],ge=G[0]-re[0],Se=te[0]-re[0],Ne=G[1]-te[1],De=G[1]-re[1],Le=te[1]-re[1],qe=Math.max(Math.abs(ye),Math.abs(ge),Math.abs(Se)),Ze=Math.max(Math.abs(Ne),Math.abs(De),Math.abs(Le)),Je=0,ke=0,nt=0,bt=Ze/(qe+1e-5);bt>1.5?Je+=this.options.DISTANCE_VOTE_POWER:bt>.66?ke+=this.options.DISTANCE_VOTE_POWER:nt+=this.options.DISTANCE_VOTE_POWER;var At=Math.sqrt(ye*ye+Ne*Ne),Mn=Math.sqrt(ge*ge+De*De),Tn=Math.sqrt(Se*Se+Le*Le),hn=Math.max(At,Mn,Tn),Kt=G[0],pn=G[1],vt=re[0],Un=re[1];hn==At?(vt=re[0],Un=re[1]):hn==Tn&&(Kt=te[0],pn=te[1]);var Fe=[Kt,pn],Nn=[vt,Un],nr=this.getSlopes(Fe,Nn),Is=this.angleOrientationAt(nr,this.options.TOTAL_ANGLE_VOTE_POWER);Je+=Is[0],ke+=Is[1],nt+=Is[2];var Ls,rr=p(xe);try{for(rr.s();!(Ls=rr.n()).done;){var vf=Ls.value,ga=this.angleOrientationAt(vf,this.options.SINGLE_ANGLE_VOTE_POWER);Je+=ga[0],ke+=ga[1],nt+=ga[2]}}catch(mn){rr.e(mn)}finally{rr.f()}return Je==Math.max(Je,ke,nt)?this.estimateVerticalDirection(De,Ne,Le,Ze):nt==Math.max(ke,nt)?this.estimateHorizontalDirection(ge,ye,Se,qe):this.estimateDiagonalDirection(De,Ne,Le,Ze,ge,ye,Se,qe)}},{key:"calculateSlope",value:function(G,te,re,xe){var ye=(te-xe)/(G-re),ge=180*Math.atan(ye)/Math.PI;return ge<=0?ge=-ge:ge>0&&(ge=180-ge),ge}}])&&w(F.prototype,P),Q}();function T(Q,F){var P=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(!P){if(Array.isArray(Q)||(P=function(ge,Se){if(ge){if(typeof ge=="string")return $(ge,Se);var Ne=Object.prototype.toString.call(ge).slice(8,-1);if(Ne==="Object"&&ge.constructor&&(Ne=ge.constructor.name),Ne==="Map"||Ne==="Set")return Array.from(ge);if(Ne==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ne))return $(ge,Se)}}(Q))||F){P&&(Q=P);var G=0,te=function(){};return{s:te,n:function(){return G>=Q.length?{done:!0}:{done:!1,value:Q[G++]}},e:function(ge){throw ge},f:te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,xe=!0,ye=!1;return{s:function(){P=P.call(Q)},n:function(){var ge=P.next();return xe=ge.done,ge},e:function(ge){ye=!0,re=ge},f:function(){try{xe||P.return==null||P.return()}finally{if(ye)throw re}}}}function $(Q,F){(F==null||F>Q.length)&&(F=Q.length);for(var P=0,G=new Array(F);P<F;P++)G[P]=Q[P];return G}function D(Q,F){if(!(Q instanceof F))throw new TypeError("Cannot call a class as a function")}function R(Q,F){for(var P=0;P<F.length;P++){var G=F[P];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(Q,G.key,G)}}var I=function(){function Q(G){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};D(this,Q),this.estimator=new S(te),this.gestures=G}var F,P;return F=Q,(P=[{key:"estimate",value:function(G,te){var re,xe=[],ye=this.estimator.estimate(G),ge=[],Se=T(u.all);try{for(Se.s();!(re=Se.n()).done;){var Ne=re.value;ge.push([u.getName(Ne),c.getName(ye.curls[Ne]),f.getName(ye.directions[Ne])])}}catch(Je){Se.e(Je)}finally{Se.f()}var De,Le=T(this.gestures);try{for(Le.s();!(De=Le.n()).done;){var qe=De.value,Ze=qe.matchAgainst(ye.curls,ye.directions);Ze>=te&&xe.push({name:qe.name,score:Ze})}}catch(Je){Le.e(Je)}finally{Le.f()}return{poseData:ge,gestures:xe}}}])&&R(F.prototype,P),Q}();function V(Q,F){return function(P){if(Array.isArray(P))return P}(Q)||function(P,G){var te=P==null?null:typeof Symbol<"u"&&P[Symbol.iterator]||P["@@iterator"];if(te!=null){var re,xe,ye=[],ge=!0,Se=!1;try{for(te=te.call(P);!(ge=(re=te.next()).done)&&(ye.push(re.value),!G||ye.length!==G);ge=!0);}catch(Ne){Se=!0,xe=Ne}finally{try{ge||te.return==null||te.return()}finally{if(Se)throw xe}}return ye}}(Q,F)||K(Q,F)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function j(Q,F){var P=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(!P){if(Array.isArray(Q)||(P=K(Q))||F){P&&(Q=P);var G=0,te=function(){};return{s:te,n:function(){return G>=Q.length?{done:!0}:{done:!1,value:Q[G++]}},e:function(ge){throw ge},f:te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,xe=!0,ye=!1;return{s:function(){P=P.call(Q)},n:function(){var ge=P.next();return xe=ge.done,ge},e:function(ge){ye=!0,re=ge},f:function(){try{xe||P.return==null||P.return()}finally{if(ye)throw re}}}}function K(Q,F){if(Q){if(typeof Q=="string")return B(Q,F);var P=Object.prototype.toString.call(Q).slice(8,-1);return P==="Object"&&Q.constructor&&(P=Q.constructor.name),P==="Map"||P==="Set"?Array.from(Q):P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P)?B(Q,F):void 0}}function B(Q,F){(F==null||F>Q.length)&&(F=Q.length);for(var P=0,G=new Array(F);P<F;P++)G[P]=Q[P];return G}function U(Q,F){for(var P=0;P<F.length;P++){var G=F[P];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(Q,G.key,G)}}var k=function(){function Q(G){(function(te,re){if(!(te instanceof re))throw new TypeError("Cannot call a class as a function")})(this,Q),this.name=G,this.curls={},this.directions={}}var F,P;return F=Q,(P=[{key:"addCurl",value:function(G,te){var re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.curls[G]===void 0&&(this.curls[G]=[]),this.curls[G].push([te,re])}},{key:"addDirection",value:function(G,te){var re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.directions[G]===void 0&&(this.directions[G]=[]),this.directions[G].push([te,re])}},{key:"matchAgainst",value:function(G,te){var re=0,xe=0;for(var ye in G){var ge=G[ye],Se=this.curls[ye];if(Se!==void 0){xe++;var Ne,De=!1,Le=0,qe=j(Se);try{for(qe.s();!(Ne=qe.n()).done;){var Ze=V(Ne.value,2),Je=Ze[0],ke=Ze[1];if(ge==Je){re+=ke,Le=Math.max(Le,ke),De=!0;break}}}catch(Fe){qe.e(Fe)}finally{qe.f()}De||(re-=Le)}}for(var nt in te){var bt=te[nt],At=this.directions[nt];if(At!==void 0){xe++;var Mn,Tn=!1,hn=0,Kt=j(At);try{for(Kt.s();!(Mn=Kt.n()).done;){var pn=V(Mn.value,2),vt=pn[0],Un=pn[1];if(bt==vt){re+=Un,hn=Math.max(hn,Un),Tn=!0;break}}}catch(Fe){Kt.e(Fe)}finally{Kt.f()}Tn||(re-=hn)}}return re/xe*10}}])&&U(F.prototype,P),Q}(),ee=new k("victory");ee.addDirection(u.Thumb,f.VerticalUp,1),ee.addDirection(u.Thumb,f.DiagonalUpLeft,1),ee.addDirection(u.Thumb,f.DiagonalUpRight,1),ee.addCurl(u.Index,c.NoCurl,1),ee.addDirection(u.Index,f.VerticalUp,1),ee.addDirection(u.Index,f.DiagonalUpLeft,1),ee.addDirection(u.Index,f.DiagonalUpRight,1),ee.addDirection(u.Index,f.HorizontalLeft,1),ee.addDirection(u.Index,f.HorizontalRight,1),ee.addCurl(u.Middle,c.NoCurl,1),ee.addDirection(u.Middle,f.VerticalUp,1),ee.addDirection(u.Middle,f.DiagonalUpLeft,1),ee.addDirection(u.Middle,f.DiagonalUpRight,1),ee.addDirection(u.Middle,f.HorizontalLeft,1),ee.addDirection(u.Middle,f.HorizontalRight,1),ee.addCurl(u.Ring,c.FullCurl,1),ee.addCurl(u.Ring,c.HalfCurl,.9),ee.addCurl(u.Pinky,c.FullCurl,1),ee.addCurl(u.Pinky,c.HalfCurl,.9);var he=ee,fe=new k("thumbs_up");fe.addCurl(u.Thumb,c.NoCurl,1),fe.addDirection(u.Thumb,f.VerticalUp,1),fe.addDirection(u.Thumb,f.DiagonalUpLeft,.9),fe.addDirection(u.Thumb,f.DiagonalUpRight,.9);for(var me=0,ae=[u.Index,u.Middle,u.Ring,u.Pinky];me<ae.length;me++){var de=ae[me];fe.addCurl(de,c.FullCurl,1),fe.addCurl(de,c.HalfCurl,.9)}fe.addDirection(u.Index,f.DiagonalUpLeft,1),fe.addDirection(u.Index,f.HorizontalLeft,1),fe.addDirection(u.Index,f.HorizontalRight,1),fe.addDirection(u.Index,f.DiagonalUpRight,1);var le=fe;r.default={GestureEstimator:I,GestureDescription:k,Finger:u,FingerCurl:c,FingerDirection:f,Gestures:i}}]).default})}(bd)),bd.exports}var b=yX(),Gp={exports:{}},Ae={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv;function xX(){if(lv)return Ae;lv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(F){return F===null||typeof F!="object"?null:(F=m&&F[m]||F["@@iterator"],typeof F=="function"?F:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function S(F,P,G){this.props=F,this.context=P,this.refs=w,this.updater=G||x}S.prototype.isReactComponent={},S.prototype.setState=function(F,P){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,P,"setState")},S.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function T(){}T.prototype=S.prototype;function $(F,P,G){this.props=F,this.context=P,this.refs=w,this.updater=G||x}var D=$.prototype=new T;D.constructor=$,v(D,S.prototype),D.isPureReactComponent=!0;var R=Array.isArray,I={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function j(F,P,G,te,re,xe){return G=xe.ref,{$$typeof:n,type:F,key:P,ref:G!==void 0?G:null,props:xe}}function K(F,P){return j(F.type,P,void 0,void 0,void 0,F.props)}function B(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function U(F){var P={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(G){return P[G]})}var k=/\/+/g;function ee(F,P){return typeof F=="object"&&F!==null&&F.key!=null?U(""+F.key):P.toString(36)}function he(){}function fe(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(he,he):(F.status="pending",F.then(function(P){F.status==="pending"&&(F.status="fulfilled",F.value=P)},function(P){F.status==="pending"&&(F.status="rejected",F.reason=P)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function me(F,P,G,te,re){var xe=typeof F;(xe==="undefined"||xe==="boolean")&&(F=null);var ye=!1;if(F===null)ye=!0;else switch(xe){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(F.$$typeof){case n:case e:ye=!0;break;case p:return ye=F._init,me(ye(F._payload),P,G,te,re)}}if(ye)return re=re(F),ye=te===""?"."+ee(F,0):te,R(re)?(G="",ye!=null&&(G=ye.replace(k,"$&/")+"/"),me(re,P,G,"",function(Ne){return Ne})):re!=null&&(B(re)&&(re=K(re,G+(re.key==null||F&&F.key===re.key?"":(""+re.key).replace(k,"$&/")+"/")+ye)),P.push(re)),1;ye=0;var ge=te===""?".":te+":";if(R(F))for(var Se=0;Se<F.length;Se++)te=F[Se],xe=ge+ee(te,Se),ye+=me(te,P,G,xe,re);else if(Se=g(F),typeof Se=="function")for(F=Se.call(F),Se=0;!(te=F.next()).done;)te=te.value,xe=ge+ee(te,Se++),ye+=me(te,P,G,xe,re);else if(xe==="object"){if(typeof F.then=="function")return me(fe(F),P,G,te,re);throw P=String(F),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ye}function ae(F,P,G){if(F==null)return F;var te=[],re=0;return me(F,te,"","",function(xe){return P.call(G,xe,re++)}),te}function de(F){if(F._status===-1){var P=F._result;P=P(),P.then(function(G){(F._status===0||F._status===-1)&&(F._status=1,F._result=G)},function(G){(F._status===0||F._status===-1)&&(F._status=2,F._result=G)}),F._status===-1&&(F._status=0,F._result=P)}if(F._status===1)return F._result.default;throw F._result}var le=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function Q(){}return Ae.Children={map:ae,forEach:function(F,P,G){ae(F,function(){P.apply(this,arguments)},G)},count:function(F){var P=0;return ae(F,function(){P++}),P},toArray:function(F){return ae(F,function(P){return P})||[]},only:function(F){if(!B(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Ae.Component=S,Ae.Fragment=t,Ae.Profiler=a,Ae.PureComponent=$,Ae.StrictMode=r,Ae.Suspense=c,Ae.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Ae.act=function(){throw Error("act(...) is not supported in production builds of React.")},Ae.cache=function(F){return function(){return F.apply(null,arguments)}},Ae.cloneElement=function(F,P,G){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var te=v({},F.props),re=F.key,xe=void 0;if(P!=null)for(ye in P.ref!==void 0&&(xe=void 0),P.key!==void 0&&(re=""+P.key),P)!V.call(P,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&P.ref===void 0||(te[ye]=P[ye]);var ye=arguments.length-2;if(ye===1)te.children=G;else if(1<ye){for(var ge=Array(ye),Se=0;Se<ye;Se++)ge[Se]=arguments[Se+2];te.children=ge}return j(F.type,re,void 0,void 0,xe,te)},Ae.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:i,_context:F},F},Ae.createElement=function(F,P,G){var te,re={},xe=null;if(P!=null)for(te in P.key!==void 0&&(xe=""+P.key),P)V.call(P,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(re[te]=P[te]);var ye=arguments.length-2;if(ye===1)re.children=G;else if(1<ye){for(var ge=Array(ye),Se=0;Se<ye;Se++)ge[Se]=arguments[Se+2];re.children=ge}if(F&&F.defaultProps)for(te in ye=F.defaultProps,ye)re[te]===void 0&&(re[te]=ye[te]);return j(F,xe,void 0,void 0,null,re)},Ae.createRef=function(){return{current:null}},Ae.forwardRef=function(F){return{$$typeof:u,render:F}},Ae.isValidElement=B,Ae.lazy=function(F){return{$$typeof:p,_payload:{_status:-1,_result:F},_init:de}},Ae.memo=function(F,P){return{$$typeof:f,type:F,compare:P===void 0?null:P}},Ae.startTransition=function(F){var P=I.T,G={};I.T=G;try{var te=F(),re=I.S;re!==null&&re(G,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(Q,le)}catch(xe){le(xe)}finally{I.T=P}},Ae.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Ae.use=function(F){return I.H.use(F)},Ae.useActionState=function(F,P,G){return I.H.useActionState(F,P,G)},Ae.useCallback=function(F,P){return I.H.useCallback(F,P)},Ae.useContext=function(F){return I.H.useContext(F)},Ae.useDebugValue=function(){},Ae.useDeferredValue=function(F,P){return I.H.useDeferredValue(F,P)},Ae.useEffect=function(F,P){return I.H.useEffect(F,P)},Ae.useId=function(){return I.H.useId()},Ae.useImperativeHandle=function(F,P,G){return I.H.useImperativeHandle(F,P,G)},Ae.useInsertionEffect=function(F,P){return I.H.useInsertionEffect(F,P)},Ae.useLayoutEffect=function(F,P){return I.H.useLayoutEffect(F,P)},Ae.useMemo=function(F,P){return I.H.useMemo(F,P)},Ae.useOptimistic=function(F,P){return I.H.useOptimistic(F,P)},Ae.useReducer=function(F,P,G){return I.H.useReducer(F,P,G)},Ae.useRef=function(F){return I.H.useRef(F)},Ae.useState=function(F){return I.H.useState(F)},Ae.useSyncExternalStore=function(F,P,G){return I.H.useSyncExternalStore(F,P,G)},Ae.useTransition=function(){return I.H.useTransition()},Ae.version="19.0.0",Ae}var uv;function hf(){return uv||(uv=1,Gp.exports=xX()),Gp.exports}var X=hf();const bn=Ai(X);var vd={exports:{}},bX=vd.exports,cv;function vX(){return cv||(cv=1,function(n,e){(function(r,a){n.exports=a(hf())})(bX,function(t){return function(r){var a={};function i(l){if(a[l])return a[l].exports;var u=a[l]={i:l,l:!1,exports:{}};return r[l].call(u.exports,u,u.exports,i),u.l=!0,u.exports}return i.m=r,i.c=a,i.d=function(l,u,c){i.o(l,u)||Object.defineProperty(l,u,{enumerable:!0,get:c})},i.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},i.t=function(l,u){if(u&1&&(l=i(l)),u&8||u&4&&typeof l=="object"&&l&&l.__esModule)return l;var c=Object.create(null);if(i.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:l}),u&2&&typeof l!="string")for(var f in l)i.d(c,f,(function(p){return l[p]}).bind(null,f));return c},i.n=function(l){var u=l&&l.__esModule?function(){return l.default}:function(){return l};return i.d(u,"a",u),u},i.o=function(l,u){return Object.prototype.hasOwnProperty.call(l,u)},i.p="",i(i.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,a,i){i.r(a);var l=i("react"),u=function(){var g=function(x,v){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,S){w.__proto__=S}||function(w,S){for(var T in S)S.hasOwnProperty(T)&&(w[T]=S[T])},g(x,v)};return function(x,v){g(x,v);function w(){this.constructor=x}x.prototype=v===null?Object.create(v):(w.prototype=v.prototype,new w)}}(),c=function(){return c=Object.assign||function(g){for(var x,v=1,w=arguments.length;v<w;v++){x=arguments[v];for(var S in x)Object.prototype.hasOwnProperty.call(x,S)&&(g[S]=x[S])}return g},c.apply(this,arguments)},f=function(g,x){var v={};for(var w in g)Object.prototype.hasOwnProperty.call(g,w)&&x.indexOf(w)<0&&(v[w]=g[w]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,w=Object.getOwnPropertySymbols(g);S<w.length;S++)x.indexOf(w[S])<0&&Object.prototype.propertyIsEnumerable.call(g,w[S])&&(v[w[S]]=g[w[S]]);return v};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(x){var v=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return v?new Promise(function(w,S){v.call(navigator,x,w,S)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function p(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var m=function(g){u(x,g);function x(v){var w=g.call(this,v)||this;return w.canvas=null,w.ctx=null,w.requestUserMediaId=0,w.unmounted=!1,w.state={hasUserMedia:!1},w}return x.prototype.componentDidMount=function(){var v=this,w=v.state,S=v.props;if(this.unmounted=!1,!p()){S.onUserMediaError("getUserMedia not supported");return}w.hasUserMedia||this.requestUserMedia(),S.children&&typeof S.children!="function"&&console.warn("children must be a function")},x.prototype.componentDidUpdate=function(v){var w=this.props;if(!p()){w.onUserMediaError("getUserMedia not supported");return}var S=JSON.stringify(v.audioConstraints)!==JSON.stringify(w.audioConstraints),T=JSON.stringify(v.videoConstraints)!==JSON.stringify(w.videoConstraints),$=v.minScreenshotWidth!==w.minScreenshotWidth,D=v.minScreenshotHeight!==w.minScreenshotHeight;(T||$||D)&&(this.canvas=null,this.ctx=null),(S||T)&&(this.stopAndCleanup(),this.requestUserMedia())},x.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},x.stopMediaStream=function(v){v&&(v.getVideoTracks&&v.getAudioTracks?(v.getVideoTracks().map(function(w){v.removeTrack(w),w.stop()}),v.getAudioTracks().map(function(w){v.removeTrack(w),w.stop()})):v.stop())},x.prototype.stopAndCleanup=function(){var v=this.state;v.hasUserMedia&&(x.stopMediaStream(this.stream),v.src&&window.URL.revokeObjectURL(v.src))},x.prototype.getScreenshot=function(v){var w=this,S=w.state,T=w.props;if(!S.hasUserMedia)return null;var $=this.getCanvas(v);return $&&$.toDataURL(T.screenshotFormat,T.screenshotQuality)},x.prototype.getCanvas=function(v){var w=this,S=w.state,T=w.props;if(!this.video||!S.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var $=this.video.videoWidth,D=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var R=$/D;$=T.minScreenshotWidth||this.video.clientWidth,D=$/R,T.minScreenshotHeight&&D<T.minScreenshotHeight&&(D=T.minScreenshotHeight,$=D*R)}this.canvas=document.createElement("canvas"),this.canvas.width=(v==null?void 0:v.width)||$,this.canvas.height=(v==null?void 0:v.height)||D,this.ctx=this.canvas.getContext("2d")}var I=this,V=I.ctx,j=I.canvas;return V&&j&&(j.width=(v==null?void 0:v.width)||j.width,j.height=(v==null?void 0:v.height)||j.height,T.mirrored&&(V.translate(j.width,0),V.scale(-1,1)),V.imageSmoothingEnabled=T.imageSmoothing,V.drawImage(this.video,0,0,(v==null?void 0:v.width)||j.width,(v==null?void 0:v.height)||j.height),T.mirrored&&(V.scale(-1,1),V.translate(-j.width,0))),j},x.prototype.requestUserMedia=function(){var v=this,w=this.props,S=function(D,R){var I={video:typeof R<"u"?R:!0};w.audio&&(I.audio=typeof D<"u"?D:!0),v.requestUserMediaId++;var V=v.requestUserMediaId;navigator.mediaDevices.getUserMedia(I).then(function(j){v.unmounted||V!==v.requestUserMediaId?x.stopMediaStream(j):v.handleUserMedia(null,j)}).catch(function(j){v.handleUserMedia(j)})};if("mediaDevices"in navigator)S(w.audioConstraints,w.videoConstraints);else{var T=function(D){return{optional:[{sourceId:D}]}},$=function(D){var R=D.deviceId;return typeof R=="string"?R:Array.isArray(R)&&R.length>0?R[0]:typeof R=="object"&&R.ideal?R.ideal:null};MediaStreamTrack.getSources(function(D){var R=null,I=null;D.forEach(function(K){K.kind==="audio"?R=K.id:K.kind==="video"&&(I=K.id)});var V=$(w.audioConstraints);V&&(R=V);var j=$(w.videoConstraints);j&&(I=j),S(T(R),T(I))})}},x.prototype.handleUserMedia=function(v,w){var S=this.props;if(v||!w){this.setState({hasUserMedia:!1}),S.onUserMediaError(v);return}this.stream=w;try{this.video&&(this.video.srcObject=w),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(w)})}S.onUserMedia(w)},x.prototype.render=function(){var v=this,w=this,S=w.state,T=w.props,$=T.audio;T.forceScreenshotSourceSize;var D=T.disablePictureInPicture;T.onUserMedia,T.onUserMediaError,T.screenshotFormat,T.screenshotQuality,T.minScreenshotWidth,T.minScreenshotHeight,T.audioConstraints,T.videoConstraints,T.imageSmoothing;var R=T.mirrored,I=T.style,V=I===void 0?{}:I,j=T.children,K=f(T,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),B=R?c(c({},V),{transform:(V.transform||"")+" scaleX(-1)"}):V,U={getScreenshot:this.getScreenshot.bind(this)};return l.createElement(l.Fragment,null,l.createElement("video",c({autoPlay:!0,disablePictureInPicture:D,src:S.src,muted:!$,playsInline:!0,ref:function(k){v.video=k},style:B},K)),j&&j(U))},x.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},x}(l.Component);a.default=m},react:function(r,a){r.exports=t}}).default})}(vd)),vd.exports}var CX=vX();const SX=Ai(CX);var Hp={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var dv;function wX(){return dv||(dv=1,function(n){(function(){var e={}.hasOwnProperty;function t(){for(var i="",l=0;l<arguments.length;l++){var u=arguments[l];u&&(i=a(i,r(u)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var l="";for(var u in i)e.call(i,u)&&i[u]&&(l=a(l,u));return l}function a(i,l){return l?i?i+" "+l:i+l:i}n.exports?(t.default=t,n.exports=t):window.classNames=t})()}(Hp)),Hp.exports}var TX=wX();const Ye=Ai(TX);function jm(){return jm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},jm.apply(null,arguments)}function KN(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function fv(n){return"default"+n.charAt(0).toUpperCase()+n.substr(1)}function NX(n){var e=EX(n,"string");return typeof e=="symbol"?e:String(e)}function EX(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function $X(n,e,t){var r=X.useRef(n!==void 0),a=X.useState(e),i=a[0],l=a[1],u=n!==void 0,c=r.current;return r.current=u,!u&&c&&i!==e&&l(e),[u?n:i,X.useCallback(function(f){for(var p=arguments.length,m=new Array(p>1?p-1:0),g=1;g<p;g++)m[g-1]=arguments[g];t&&t.apply(void 0,[f].concat(m)),l(f)},[t])]}function DX(n,e){return Object.keys(e).reduce(function(t,r){var a,i=t,l=i[fv(r)],u=i[r],c=KN(i,[fv(r),r].map(NX)),f=e[r],p=$X(u,l,n[f]),m=p[0],g=p[1];return jm({},c,(a={},a[r]=m,a[f]=g,a))},n)}function qm(n,e){return qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},qm(n,e)}function RX(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,qm(n,e)}const YN=["xxl","xl","lg","md","sm","xs"],QN="xs",Bu=X.createContext({prefixes:{},breakpoints:YN,minBreakpoint:QN}),{Consumer:G9,Provider:H9}=Bu;function dt(n,e){const{prefixes:t}=X.useContext(Bu);return n||t[e]||e}function Gg(){const{breakpoints:n}=X.useContext(Bu);return n}function Hg(){const{minBreakpoint:n}=X.useContext(Bu);return n}function _X(){const{dir:n}=X.useContext(Bu);return n==="rtl"}function pf(n){return n&&n.ownerDocument||document}function OX(n){var e=pf(n);return e&&e.defaultView||window}function kX(n,e){return OX(n).getComputedStyle(n,e)}var FX=/([A-Z])/g;function AX(n){return n.replace(FX,"-$1").toLowerCase()}var IX=/^ms-/;function sd(n){return AX(n).replace(IX,"-ms-")}var LX=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function BX(n){return!!(n&&LX.test(n))}function vi(n,e){var t="",r="";if(typeof e=="string")return n.style.getPropertyValue(sd(e))||kX(n).getPropertyValue(sd(e));Object.keys(e).forEach(function(a){var i=e[a];!i&&i!==0?n.style.removeProperty(sd(a)):BX(a)?r+=a+"("+i+") ":t+=sd(a)+": "+i+";"}),r&&(t+="transform: "+r+";"),n.style.cssText+=";"+t}var Wp={exports:{}},jp,hv;function MX(){if(hv)return jp;hv=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return jp=n,jp}var qp,pv;function UX(){if(pv)return qp;pv=1;var n=MX();function e(){}function t(){}return t.resetWarningCache=e,qp=function(){function r(l,u,c,f,p,m){if(m!==n){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:e};return i.PropTypes=i,i},qp}var mv;function PX(){return mv||(mv=1,Wp.exports=UX()()),Wp.exports}var zX=PX();const Fn=Ai(zX);var Xp={exports:{}},Zt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gv;function VX(){if(gv)return Zt;gv=1;var n=hf();function e(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:c,containerInfo:f,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Zt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Zt.createPortal=function(c,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(c,f,null,p)},Zt.flushSync=function(c){var f=l.T,p=r.p;try{if(l.T=null,r.p=2,c)return c()}finally{l.T=f,r.p=p,r.d.f()}},Zt.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(c,f))},Zt.prefetchDNS=function(c){typeof c=="string"&&r.d.D(c)},Zt.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var p=f.as,m=u(p,f.crossOrigin),g=typeof f.integrity=="string"?f.integrity:void 0,x=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?r.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:g,fetchPriority:x}):p==="script"&&r.d.X(c,{crossOrigin:m,integrity:g,fetchPriority:x,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Zt.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);r.d.M(c,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(c)},Zt.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,m=u(p,f.crossOrigin);r.d.L(c,p,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Zt.preloadModule=function(c,f){if(typeof c=="string")if(f){var p=u(f.as,f.crossOrigin);r.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(c)},Zt.requestFormReset=function(c){r.d.r(c)},Zt.unstable_batchedUpdates=function(c,f){return c(f)},Zt.useFormState=function(c,f,p){return l.H.useFormState(c,f,p)},Zt.useFormStatus=function(){return l.H.useHostTransitionStatus()},Zt.version="19.0.0",Zt}var yv;function ZN(){if(yv)return Xp.exports;yv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Xp.exports=VX(),Xp.exports}var GX=ZN();const Oo=Ai(GX),xv={disabled:!1},JN=bn.createContext(null);var HX=function(e){return e.scrollTop},uu="unmounted",li="exited",ys="entering",pi="entered",Xm="exiting",Wa=function(n){RX(e,n);function e(r,a){var i;i=n.call(this,r,a)||this;var l=a,u=l&&!l.isMounting?r.enter:r.appear,c;return i.appearStatus=null,r.in?u?(c=li,i.appearStatus=ys):c=pi:r.unmountOnExit||r.mountOnEnter?c=uu:c=li,i.state={status:c},i.nextCallback=null,i}e.getDerivedStateFromProps=function(a,i){var l=a.in;return l&&i.status===uu?{status:li}:null};var t=e.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(a){var i=null;if(a!==this.props){var l=this.state.status;this.props.in?l!==ys&&l!==pi&&(i=ys):(l===ys||l===pi)&&(i=Xm)}this.updateStatus(!1,i)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var a=this.props.timeout,i,l,u;return i=l=u=a,a!=null&&typeof a!="number"&&(i=a.exit,l=a.enter,u=a.appear!==void 0?a.appear:l),{exit:i,enter:l,appear:u}},t.updateStatus=function(a,i){if(a===void 0&&(a=!1),i!==null)if(this.cancelNextCallback(),i===ys){if(this.props.unmountOnExit||this.props.mountOnEnter){var l=this.props.nodeRef?this.props.nodeRef.current:Oo.findDOMNode(this);l&&HX(l)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===li&&this.setState({status:uu})},t.performEnter=function(a){var i=this,l=this.props.enter,u=this.context?this.context.isMounting:a,c=this.props.nodeRef?[u]:[Oo.findDOMNode(this),u],f=c[0],p=c[1],m=this.getTimeouts(),g=u?m.appear:m.enter;if(!a&&!l||xv.disabled){this.safeSetState({status:pi},function(){i.props.onEntered(f)});return}this.props.onEnter(f,p),this.safeSetState({status:ys},function(){i.props.onEntering(f,p),i.onTransitionEnd(g,function(){i.safeSetState({status:pi},function(){i.props.onEntered(f,p)})})})},t.performExit=function(){var a=this,i=this.props.exit,l=this.getTimeouts(),u=this.props.nodeRef?void 0:Oo.findDOMNode(this);if(!i||xv.disabled){this.safeSetState({status:li},function(){a.props.onExited(u)});return}this.props.onExit(u),this.safeSetState({status:Xm},function(){a.props.onExiting(u),a.onTransitionEnd(l.exit,function(){a.safeSetState({status:li},function(){a.props.onExited(u)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(a,i){i=this.setNextCallback(i),this.setState(a,i)},t.setNextCallback=function(a){var i=this,l=!0;return this.nextCallback=function(u){l&&(l=!1,i.nextCallback=null,a(u))},this.nextCallback.cancel=function(){l=!1},this.nextCallback},t.onTransitionEnd=function(a,i){this.setNextCallback(i);var l=this.props.nodeRef?this.props.nodeRef.current:Oo.findDOMNode(this),u=a==null&&!this.props.addEndListener;if(!l||u){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[l,this.nextCallback],f=c[0],p=c[1];this.props.addEndListener(f,p)}a!=null&&setTimeout(this.nextCallback,a)},t.render=function(){var a=this.state.status;if(a===uu)return null;var i=this.props,l=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var u=KN(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return bn.createElement(JN.Provider,{value:null},typeof l=="function"?l(a,u):bn.cloneElement(bn.Children.only(l),u))},e}(bn.Component);Wa.contextType=JN;Wa.propTypes={};function Eo(){}Wa.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Eo,onEntering:Eo,onEntered:Eo,onExit:Eo,onExiting:Eo,onExited:Eo};Wa.UNMOUNTED=uu;Wa.EXITED=li;Wa.ENTERING=ys;Wa.ENTERED=pi;Wa.EXITING=Xm;function WX(n){return n.code==="Escape"||n.keyCode===27}function jX(){const n=X.version.split(".");return{major:+n[0],minor:+n[1],patch:+n[2]}}function mf(n){if(!n||typeof n=="function")return null;const{major:e}=jX();return e>=19?n.props.ref:n.ref}const nl=!!(typeof window<"u"&&window.document&&window.document.createElement);var Km=!1,Ym=!1;try{var Kp={get passive(){return Km=!0},get once(){return Ym=Km=!0}};nl&&(window.addEventListener("test",Kp,Kp),window.removeEventListener("test",Kp,!0))}catch{}function eE(n,e,t,r){if(r&&typeof r!="boolean"&&!Ym){var a=r.once,i=r.capture,l=t;!Ym&&a&&(l=t.__once||function u(c){this.removeEventListener(e,u,i),t.call(this,c)},t.__once=l),n.addEventListener(e,l,Km?r:i)}n.addEventListener(e,t,r)}function Qm(n,e,t,r){var a=r&&typeof r!="boolean"?r.capture:r;n.removeEventListener(e,t,a),t.__once&&n.removeEventListener(e,t.__once,a)}function Pd(n,e,t,r){return eE(n,e,t,r),function(){Qm(n,e,t,r)}}function qX(n,e,t,r){if(r===void 0&&(r=!0),n){var a=document.createEvent("HTMLEvents");a.initEvent(e,t,r),n.dispatchEvent(a)}}function XX(n){var e=vi(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function KX(n,e,t){t===void 0&&(t=5);var r=!1,a=setTimeout(function(){r||qX(n,"transitionend",!0)},e+t),i=Pd(n,"transitionend",function(){r=!0},{once:!0});return function(){clearTimeout(a),i()}}function tE(n,e,t,r){t==null&&(t=XX(n)||0);var a=KX(n,t,r),i=Pd(n,"transitionend",e);return function(){a(),i()}}function bv(n,e){const t=vi(n,e)||"",r=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*r}function YX(n,e){const t=bv(n,"transitionDuration"),r=bv(n,"transitionDelay"),a=tE(n,i=>{i.target===n&&(a(),e(i))},t+r)}function QX(n){n.offsetHeight}const vv=n=>!n||typeof n=="function"?n:e=>{n.current=e};function ZX(n,e){const t=vv(n),r=vv(e);return a=>{t&&t(a),r&&r(a)}}function nE(n,e){return X.useMemo(()=>ZX(n,e),[n,e])}function JX(n){return n&&"setState"in n?Oo.findDOMNode(n):n??null}const eK=bn.forwardRef(({onEnter:n,onEntering:e,onEntered:t,onExit:r,onExiting:a,onExited:i,addEndListener:l,children:u,childRef:c,...f},p)=>{const m=X.useRef(null),g=nE(m,c),x=V=>{g(JX(V))},v=V=>j=>{V&&m.current&&V(m.current,j)},w=X.useCallback(v(n),[n]),S=X.useCallback(v(e),[e]),T=X.useCallback(v(t),[t]),$=X.useCallback(v(r),[r]),D=X.useCallback(v(a),[a]),R=X.useCallback(v(i),[i]),I=X.useCallback(v(l),[l]);return q.jsx(Wa,{ref:p,...f,onEnter:w,onEntered:T,onEntering:S,onExit:$,onExited:R,onExiting:D,addEndListener:I,nodeRef:m,children:typeof u=="function"?(V,j)=>u(V,{...j,ref:x}):bn.cloneElement(u,{ref:x})})});function tK(n){const e=X.useRef(n);return X.useEffect(()=>{e.current=n},[n]),e}function zd(n){const e=tK(n);return X.useCallback(function(...t){return e.current&&e.current(...t)},[e])}const nK=n=>X.forwardRef((e,t)=>q.jsx("div",{...e,ref:t,className:Ye(e.className,n)}));function rK(n){const e=X.useRef(n);return X.useEffect(()=>{e.current=n},[n]),e}function xs(n){const e=rK(n);return X.useCallback(function(...t){return e.current&&e.current(...t)},[e])}function aK(){const n=X.useRef(!0),e=X.useRef(()=>n.current);return X.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),e.current}function sK(n){const e=X.useRef(null);return X.useEffect(()=>{e.current=n}),e.current}const iK=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",oK=typeof document<"u",Cv=oK||iK?X.useLayoutEffect:X.useEffect,lK=["as","disabled"];function uK(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function cK(n){return!n||n.trim()==="#"}function rE({tagName:n,disabled:e,href:t,target:r,rel:a,role:i,onClick:l,tabIndex:u=0,type:c}){n||(t!=null||r!=null||a!=null?n="a":n="button");const f={tagName:n};if(n==="button")return[{type:c||"button",disabled:e},f];const p=g=>{if((e||n==="a"&&cK(t))&&g.preventDefault(),e){g.stopPropagation();return}l==null||l(g)},m=g=>{g.key===" "&&(g.preventDefault(),p(g))};return n==="a"&&(t||(t="#"),e&&(t=void 0)),[{role:i??"button",disabled:void 0,tabIndex:e?void 0:u,href:t,target:n==="a"?r:void 0,"aria-disabled":e||void 0,rel:n==="a"?a:void 0,onClick:p,onKeyDown:m},f]}const aE=X.forwardRef((n,e)=>{let{as:t,disabled:r}=n,a=uK(n,lK);const[i,{tagName:l}]=rE(Object.assign({tagName:t,disabled:r},a));return q.jsx(l,Object.assign({},a,i,{ref:e}))});aE.displayName="Button";const dK={[ys]:"show",[pi]:"show"},Wg=X.forwardRef(({className:n,children:e,transitionClasses:t={},onEnter:r,...a},i)=>{const l={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...a},u=X.useCallback((c,f)=>{QX(c),r==null||r(c,f)},[r]);return q.jsx(eK,{ref:i,addEndListener:YX,...l,onEnter:u,childRef:mf(e),children:(c,f)=>X.cloneElement(e,{...f,className:Ye("fade",n,e.props.className,dK[c],t[c])})})});Wg.displayName="Fade";const fK={"aria-label":Fn.string,onClick:Fn.func,variant:Fn.oneOf(["white"])},jg=X.forwardRef(({className:n,variant:e,"aria-label":t="Close",...r},a)=>q.jsx("button",{ref:a,type:"button",className:Ye("btn-close",e&&`btn-close-${e}`,n),"aria-label":t,...r}));jg.displayName="CloseButton";jg.propTypes=fK;const ht=X.forwardRef(({as:n,bsPrefix:e,variant:t="primary",size:r,active:a=!1,disabled:i=!1,className:l,...u},c)=>{const f=dt(e,"btn"),[p,{tagName:m}]=rE({tagName:n,disabled:i,...u}),g=m;return q.jsx(g,{...p,...u,ref:c,disabled:i,className:Ye(l,f,a&&"active",t&&`${f}-${t}`,r&&`${f}-${r}`,u.href&&i&&"disabled")})});ht.displayName="Button";function hK(n){const e=X.useRef(n);return e.current=n,e}function pK(n){const e=hK(n);X.useEffect(()=>()=>e.current(),[])}function mK(n,e){return X.Children.toArray(n).some(t=>X.isValidElement(t)&&t.type===e)}function gK({as:n,bsPrefix:e,className:t,...r}){e=dt(e,"col");const a=Gg(),i=Hg(),l=[],u=[];return a.forEach(c=>{const f=r[c];delete r[c];let p,m,g;typeof f=="object"&&f!=null?{span:p,offset:m,order:g}=f:p=f;const x=c!==i?`-${c}`:"";p&&l.push(p===!0?`${e}${x}`:`${e}${x}-${p}`),g!=null&&u.push(`order${x}-${g}`),m!=null&&u.push(`offset${x}-${m}`)}),[{...r,className:Ye(t,...l,...u)},{as:n,bsPrefix:e,spans:l}]}const qg=X.forwardRef((n,e)=>{const[{className:t,...r},{as:a="div",bsPrefix:i,spans:l}]=gK(n);return q.jsx(a,{...r,ref:e,className:Ye(t,!l.length&&i)})});qg.displayName="Col";const Xg=X.forwardRef(({bsPrefix:n,fluid:e=!1,as:t="div",className:r,...a},i)=>{const l=dt(n,"container"),u=typeof e=="string"?`-${e}`:"-fluid";return q.jsx(t,{ref:i,...a,className:Ye(r,e?`${l}${u}`:l)})});Xg.displayName="Container";var yK=Function.prototype.bind.call(Function.prototype.call,[].slice);function ui(n,e){return yK(n.querySelectorAll(e))}function xK(){const[,n]=X.useReducer(e=>e+1,0);return n}function Sv(n,e){if(n.contains)return n.contains(e);if(n.compareDocumentPosition)return n===e||!!(n.compareDocumentPosition(e)&16)}const Zm=X.createContext(null),Kg=(n,e=null)=>n!=null?String(n):e||null,Yg=X.createContext(null);Yg.displayName="NavContext";const bK="data-rr-ui-",vK="rrUi";function gf(n){return`${bK}${n}`}function CK(n){return`${vK}${n}`}const sE=X.createContext(nl?window:void 0);sE.Provider;function Qg(){return X.useContext(sE)}Fn.string,Fn.bool,Fn.bool,Fn.bool,Fn.bool;const Zg=X.forwardRef(({bsPrefix:n,className:e,fluid:t=!1,rounded:r=!1,roundedCircle:a=!1,thumbnail:i=!1,...l},u)=>(n=dt(n,"img"),q.jsx("img",{ref:u,...l,className:Ye(e,t&&`${n}-fluid`,r&&"rounded",a&&"rounded-circle",i&&`${n}-thumbnail`)})));Zg.displayName="Image";const SK={type:Fn.string,tooltip:Fn.bool,as:Fn.elementType},yf=X.forwardRef(({as:n="div",className:e,type:t="valid",tooltip:r=!1,...a},i)=>q.jsx(n,{...a,ref:i,className:Ye(e,`${t}-${r?"tooltip":"feedback"}`)}));yf.displayName="Feedback";yf.propTypes=SK;const za=X.createContext({}),Jg=X.forwardRef(({id:n,bsPrefix:e,className:t,type:r="checkbox",isValid:a=!1,isInvalid:i=!1,as:l="input",...u},c)=>{const{controlId:f}=X.useContext(za);return e=dt(e,"form-check-input"),q.jsx(l,{...u,ref:c,type:r,id:n||f,className:Ye(t,e,a&&"is-valid",i&&"is-invalid")})});Jg.displayName="FormCheckInput";const Vd=X.forwardRef(({bsPrefix:n,className:e,htmlFor:t,...r},a)=>{const{controlId:i}=X.useContext(za);return n=dt(n,"form-check-label"),q.jsx("label",{...r,ref:a,htmlFor:t||i,className:Ye(e,n)})});Vd.displayName="FormCheckLabel";const iE=X.forwardRef(({id:n,bsPrefix:e,bsSwitchPrefix:t,inline:r=!1,reverse:a=!1,disabled:i=!1,isValid:l=!1,isInvalid:u=!1,feedbackTooltip:c=!1,feedback:f,feedbackType:p,className:m,style:g,title:x="",type:v="checkbox",label:w,children:S,as:T="input",...$},D)=>{e=dt(e,"form-check"),t=dt(t,"form-switch");const{controlId:R}=X.useContext(za),I=X.useMemo(()=>({controlId:n||R}),[R,n]),V=!S&&w!=null&&w!==!1||mK(S,Vd),j=q.jsx(Jg,{...$,type:v==="switch"?"checkbox":v,ref:D,isValid:l,isInvalid:u,disabled:i,as:T});return q.jsx(za.Provider,{value:I,children:q.jsx("div",{style:g,className:Ye(m,V&&e,r&&`${e}-inline`,a&&`${e}-reverse`,v==="switch"&&t),children:S||q.jsxs(q.Fragment,{children:[j,V&&q.jsx(Vd,{title:x,children:w}),f&&q.jsx(yf,{type:p,tooltip:c,children:f})]})})})});iE.displayName="FormCheck";const Gd=Object.assign(iE,{Input:Jg,Label:Vd}),oE=X.forwardRef(({bsPrefix:n,type:e,size:t,htmlSize:r,id:a,className:i,isValid:l=!1,isInvalid:u=!1,plaintext:c,readOnly:f,as:p="input",...m},g)=>{const{controlId:x}=X.useContext(za);return n=dt(n,"form-control"),q.jsx(p,{...m,type:e,size:r,ref:g,readOnly:f,id:a||x,className:Ye(i,c?`${n}-plaintext`:n,t&&`${n}-${t}`,e==="color"&&`${n}-color`,l&&"is-valid",u&&"is-invalid")})});oE.displayName="FormControl";const wK=Object.assign(oE,{Feedback:yf}),lE=X.forwardRef(({className:n,bsPrefix:e,as:t="div",...r},a)=>(e=dt(e,"form-floating"),q.jsx(t,{ref:a,className:Ye(n,e),...r})));lE.displayName="FormFloating";const ey=X.forwardRef(({controlId:n,as:e="div",...t},r)=>{const a=X.useMemo(()=>({controlId:n}),[n]);return q.jsx(za.Provider,{value:a,children:q.jsx(e,{...t,ref:r})})});ey.displayName="FormGroup";const uE=X.forwardRef(({as:n="label",bsPrefix:e,column:t=!1,visuallyHidden:r=!1,className:a,htmlFor:i,...l},u)=>{const{controlId:c}=X.useContext(za);e=dt(e,"form-label");let f="col-form-label";typeof t=="string"&&(f=`${f} ${f}-${t}`);const p=Ye(a,e,r&&"visually-hidden",t&&f);return i=i||c,t?q.jsx(qg,{ref:u,as:"label",className:p,htmlFor:i,...l}):q.jsx(n,{ref:u,className:p,htmlFor:i,...l})});uE.displayName="FormLabel";const cE=X.forwardRef(({bsPrefix:n,className:e,id:t,...r},a)=>{const{controlId:i}=X.useContext(za);return n=dt(n,"form-range"),q.jsx("input",{...r,type:"range",ref:a,className:Ye(e,n),id:t||i})});cE.displayName="FormRange";const dE=X.forwardRef(({bsPrefix:n,size:e,htmlSize:t,className:r,isValid:a=!1,isInvalid:i=!1,id:l,...u},c)=>{const{controlId:f}=X.useContext(za);return n=dt(n,"form-select"),q.jsx("select",{...u,size:t,ref:c,className:Ye(r,n,e&&`${n}-${e}`,a&&"is-valid",i&&"is-invalid"),id:l||f})});dE.displayName="FormSelect";const fE=X.forwardRef(({bsPrefix:n,className:e,as:t="small",muted:r,...a},i)=>(n=dt(n,"form-text"),q.jsx(t,{...a,ref:i,className:Ye(e,n,r&&"text-muted")})));fE.displayName="FormText";const hE=X.forwardRef((n,e)=>q.jsx(Gd,{...n,ref:e,type:"switch"}));hE.displayName="Switch";const TK=Object.assign(hE,{Input:Gd.Input,Label:Gd.Label}),pE=X.forwardRef(({bsPrefix:n,className:e,children:t,controlId:r,label:a,...i},l)=>(n=dt(n,"form-floating"),q.jsxs(ey,{ref:l,className:Ye(e,n),controlId:r,...i,children:[t,q.jsx("label",{htmlFor:r,children:a})]})));pE.displayName="FloatingLabel";const NK={_ref:Fn.any,validated:Fn.bool,as:Fn.elementType},ty=X.forwardRef(({className:n,validated:e,as:t="form",...r},a)=>q.jsx(t,{...r,ref:a,className:Ye(n,e&&"was-validated")}));ty.displayName="Form";ty.propTypes=NK;const nu=Object.assign(ty,{Group:ey,Control:wK,Floating:lE,Check:Gd,Switch:TK,Label:uE,Text:fE,Range:cE,Select:dE,FloatingLabel:pE}),wv=n=>!n||typeof n=="function"?n:e=>{n.current=e};function EK(n,e){const t=wv(n),r=wv(e);return a=>{t&&t(a),r&&r(a)}}function xf(n,e){return X.useMemo(()=>EK(n,e),[n,e])}const mE=X.createContext(null),$K=["as","active","eventKey"];function DK(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function gE({key:n,onClick:e,active:t,id:r,role:a,disabled:i}){const l=X.useContext(Zm),u=X.useContext(Yg),c=X.useContext(mE);let f=t;const p={role:a};if(u){!a&&u.role==="tablist"&&(p.role="tab");const m=u.getControllerId(n??null),g=u.getControlledId(n??null);p[gf("event-key")]=n,p.id=m||r,f=t==null&&n!=null?u.activeKey===n:t,(f||!(c!=null&&c.unmountOnExit)&&!(c!=null&&c.mountOnEnter))&&(p["aria-controls"]=g)}return p.role==="tab"&&(p["aria-selected"]=f,f||(p.tabIndex=-1),i&&(p.tabIndex=-1,p["aria-disabled"]=!0)),p.onClick=xs(m=>{i||(e==null||e(m),n!=null&&l&&!m.isPropagationStopped()&&l(n,m))}),[p,{isActive:f}]}const yE=X.forwardRef((n,e)=>{let{as:t=aE,active:r,eventKey:a}=n,i=DK(n,$K);const[l,u]=gE(Object.assign({key:Kg(a,i.href),active:r},i));return l[gf("active")]=u.isActive,q.jsx(t,Object.assign({},i,l,{ref:e}))});yE.displayName="NavItem";const RK=["as","onSelect","activeKey","role","onKeyDown"];function _K(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}const Tv=()=>{},Nv=gf("event-key"),xE=X.forwardRef((n,e)=>{let{as:t="div",onSelect:r,activeKey:a,role:i,onKeyDown:l}=n,u=_K(n,RK);const c=xK(),f=X.useRef(!1),p=X.useContext(Zm),m=X.useContext(mE);let g,x;m&&(i=i||"tablist",a=m.activeKey,g=m.getControlledId,x=m.getControllerId);const v=X.useRef(null),w=D=>{const R=v.current;if(!R)return null;const I=ui(R,`[${Nv}]:not([aria-disabled=true])`),V=R.querySelector("[aria-selected=true]");if(!V||V!==document.activeElement)return null;const j=I.indexOf(V);if(j===-1)return null;let K=j+D;return K>=I.length&&(K=0),K<0&&(K=I.length-1),I[K]},S=(D,R)=>{D!=null&&(r==null||r(D,R),p==null||p(D,R))},T=D=>{if(l==null||l(D),!m)return;let R;switch(D.key){case"ArrowLeft":case"ArrowUp":R=w(-1);break;case"ArrowRight":case"ArrowDown":R=w(1);break;default:return}R&&(D.preventDefault(),S(R.dataset[CK("EventKey")]||null,D),f.current=!0,c())};X.useEffect(()=>{if(v.current&&f.current){const D=v.current.querySelector(`[${Nv}][aria-selected=true]`);D==null||D.focus()}f.current=!1});const $=xf(e,v);return q.jsx(Zm.Provider,{value:S,children:q.jsx(Yg.Provider,{value:{role:i,activeKey:Kg(a),getControlledId:g||Tv,getControllerId:x||Tv},children:q.jsx(t,Object.assign({},u,{onKeyDown:T,ref:$,role:i}))})})});xE.displayName="Nav";const OK=Object.assign(xE,{Item:yE}),bE=X.forwardRef(({bsPrefix:n,active:e,disabled:t,eventKey:r,className:a,variant:i,action:l,as:u,...c},f)=>{n=dt(n,"list-group-item");const[p,m]=gE({key:Kg(r,c.href),active:e,...c}),g=zd(v=>{if(t){v.preventDefault(),v.stopPropagation();return}p.onClick(v)});t&&c.tabIndex===void 0&&(c.tabIndex=-1,c["aria-disabled"]=!0);const x=u||(l?c.href?"a":"button":"div");return q.jsx(x,{ref:f,...c,...p,onClick:g,className:Ye(a,n,m.isActive&&"active",t&&"disabled",i&&`${n}-${i}`,l&&`${n}-action`)})});bE.displayName="ListGroupItem";const vE=X.forwardRef((n,e)=>{const{className:t,bsPrefix:r,variant:a,horizontal:i,numbered:l,as:u="div",...c}=DX(n,{activeKey:"onSelect"}),f=dt(r,"list-group");let p;return i&&(p=i===!0?"horizontal":`horizontal-${i}`),q.jsx(OK,{ref:e,...c,as:u,className:Ye(t,f,a&&`${f}-${a}`,p&&`${f}-${p}`,l&&`${f}-numbered`)})});vE.displayName="ListGroup";const ru=Object.assign(vE,{Item:bE});var id;function Ev(n){if((!id&&id!==0||n)&&nl){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),id=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return id}function kK(){return X.useState(null)}function Yp(n){n===void 0&&(n=pf());try{var e=n.activeElement;return!e||!e.nodeName?null:e}catch{return n.body}}function FK(n){const e=X.useRef(n);return e.current=n,e}function AK(n){const e=FK(n);X.useEffect(()=>()=>e.current(),[])}function IK(n=document){const e=n.defaultView;return Math.abs(e.innerWidth-n.documentElement.clientWidth)}const $v=gf("modal-open");class ny{constructor({ownerDocument:e,handleContainerOverflow:t=!0,isRTL:r=!1}={}){this.handleContainerOverflow=t,this.isRTL=r,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return IK(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},r=this.isRTL?"paddingLeft":"paddingRight",a=this.getElement();e.style={overflow:a.style.overflow,[r]:a.style[r]},e.scrollBarWidth&&(t[r]=`${parseInt(vi(a,r)||"0",10)+e.scrollBarWidth}px`),a.setAttribute($v,""),vi(a,t)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute($v),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return t!==-1||(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),t!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t}remove(e){const t=this.modals.indexOf(e);t!==-1&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const Qp=(n,e)=>nl?n==null?(e||pf()).body:(typeof n=="function"&&(n=n()),n&&"current"in n&&(n=n.current),n&&("nodeType"in n||n.getBoundingClientRect)?n:null):null;function LK(n,e){const t=Qg(),[r,a]=X.useState(()=>Qp(n,t==null?void 0:t.document));if(!r){const i=Qp(n);i&&a(i)}return X.useEffect(()=>{},[e,r]),X.useEffect(()=>{const i=Qp(n);i!==r&&a(i)},[n,r]),r}function BK({children:n,in:e,onExited:t,mountOnEnter:r,unmountOnExit:a}){const i=X.useRef(null),l=X.useRef(e),u=xs(t);X.useEffect(()=>{e?l.current=!0:u(i.current)},[e,u]);const c=xf(i,mf(n)),f=X.cloneElement(n,{ref:c});return e?f:a||!l.current&&r?null:f}const MK=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function UK(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function PK(n){let{onEnter:e,onEntering:t,onEntered:r,onExit:a,onExiting:i,onExited:l,addEndListener:u,children:c}=n,f=UK(n,MK);const p=X.useRef(null),m=xf(p,mf(c)),g=R=>I=>{R&&p.current&&R(p.current,I)},x=X.useCallback(g(e),[e]),v=X.useCallback(g(t),[t]),w=X.useCallback(g(r),[r]),S=X.useCallback(g(a),[a]),T=X.useCallback(g(i),[i]),$=X.useCallback(g(l),[l]),D=X.useCallback(g(u),[u]);return Object.assign({},f,{nodeRef:p},e&&{onEnter:x},t&&{onEntering:v},r&&{onEntered:w},a&&{onExit:S},i&&{onExiting:T},l&&{onExited:$},u&&{addEndListener:D},{children:typeof c=="function"?(R,I)=>c(R,Object.assign({},I,{ref:m})):X.cloneElement(c,{ref:m})})}const zK=["component"];function VK(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}const GK=X.forwardRef((n,e)=>{let{component:t}=n,r=VK(n,zK);const a=PK(r);return q.jsx(t,Object.assign({ref:e},a))});function HK({in:n,onTransition:e}){const t=X.useRef(null),r=X.useRef(!0),a=xs(e);return Cv(()=>{if(!t.current)return;let i=!1;return a({in:n,element:t.current,initial:r.current,isStale:()=>i}),()=>{i=!0}},[n,a]),Cv(()=>(r.current=!1,()=>{r.current=!0}),[]),t}function WK({children:n,in:e,onExited:t,onEntered:r,transition:a}){const[i,l]=X.useState(!e);e&&i&&l(!1);const u=HK({in:!!e,onTransition:f=>{const p=()=>{f.isStale()||(f.in?r==null||r(f.element,f.initial):(l(!0),t==null||t(f.element)))};Promise.resolve(a(f)).then(p,m=>{throw f.in||l(!0),m})}}),c=xf(u,mf(n));return i&&!e?null:X.cloneElement(n,{ref:c})}function Dv(n,e,t){return n?q.jsx(GK,Object.assign({},t,{component:n})):e?q.jsx(WK,Object.assign({},t,{transition:e})):q.jsx(BK,Object.assign({},t))}const jK=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function qK(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}let Zp;function XK(n){return Zp||(Zp=new ny({ownerDocument:n==null?void 0:n.document})),Zp}function KK(n){const e=Qg(),t=n||XK(e),r=X.useRef({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>t.add(r.current),remove:()=>t.remove(r.current),isTopModal:()=>t.isTopModal(r.current),setDialogRef:X.useCallback(a=>{r.current.dialog=a},[]),setBackdropRef:X.useCallback(a=>{r.current.backdrop=a},[])})}const CE=X.forwardRef((n,e)=>{let{show:t=!1,role:r="dialog",className:a,style:i,children:l,backdrop:u=!0,keyboard:c=!0,onBackdropClick:f,onEscapeKeyDown:p,transition:m,runTransition:g,backdropTransition:x,runBackdropTransition:v,autoFocus:w=!0,enforceFocus:S=!0,restoreFocus:T=!0,restoreFocusOptions:$,renderDialog:D,renderBackdrop:R=ke=>q.jsx("div",Object.assign({},ke)),manager:I,container:V,onShow:j,onHide:K=()=>{},onExit:B,onExited:U,onExiting:k,onEnter:ee,onEntering:he,onEntered:fe}=n,me=qK(n,jK);const ae=Qg(),de=LK(V),le=KK(I),Q=aK(),F=sK(t),[P,G]=X.useState(!t),te=X.useRef(null);X.useImperativeHandle(e,()=>le,[le]),nl&&!F&&t&&(te.current=Yp(ae==null?void 0:ae.document)),t&&P&&G(!1);const re=xs(()=>{if(le.add(),De.current=Pd(document,"keydown",Se),Ne.current=Pd(document,"focus",()=>setTimeout(ye),!0),j&&j(),w){var ke,nt;const bt=Yp((ke=(nt=le.dialog)==null?void 0:nt.ownerDocument)!=null?ke:ae==null?void 0:ae.document);le.dialog&&bt&&!Sv(le.dialog,bt)&&(te.current=bt,le.dialog.focus())}}),xe=xs(()=>{if(le.remove(),De.current==null||De.current(),Ne.current==null||Ne.current(),T){var ke;(ke=te.current)==null||ke.focus==null||ke.focus($),te.current=null}});X.useEffect(()=>{!t||!de||re()},[t,de,re]),X.useEffect(()=>{P&&xe()},[P,xe]),AK(()=>{xe()});const ye=xs(()=>{if(!S||!Q()||!le.isTopModal())return;const ke=Yp(ae==null?void 0:ae.document);le.dialog&&ke&&!Sv(le.dialog,ke)&&le.dialog.focus()}),ge=xs(ke=>{ke.target===ke.currentTarget&&(f==null||f(ke),u===!0&&K())}),Se=xs(ke=>{c&&WX(ke)&&le.isTopModal()&&(p==null||p(ke),ke.defaultPrevented||K())}),Ne=X.useRef(),De=X.useRef(),Le=(...ke)=>{G(!0),U==null||U(...ke)};if(!de)return null;const qe=Object.assign({role:r,ref:le.setDialogRef,"aria-modal":r==="dialog"?!0:void 0},me,{style:i,className:a,tabIndex:-1});let Ze=D?D(qe):q.jsx("div",Object.assign({},qe,{children:X.cloneElement(l,{role:"document"})}));Ze=Dv(m,g,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!t,onExit:B,onExiting:k,onExited:Le,onEnter:ee,onEntering:he,onEntered:fe,children:Ze});let Je=null;return u&&(Je=R({ref:le.setBackdropRef,onClick:ge}),Je=Dv(x,v,{in:!!t,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Je})),q.jsx(q.Fragment,{children:Oo.createPortal(q.jsxs(q.Fragment,{children:[Je,Ze]}),de)})});CE.displayName="Modal";const YK=Object.assign(CE,{Manager:ny});function QK(n,e){return n.classList?n.classList.contains(e):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+e+" ")!==-1}function ZK(n,e){n.classList?n.classList.add(e):QK(n,e)||(typeof n.className=="string"?n.className=n.className+" "+e:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+e))}function Rv(n,e){return n.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function JK(n,e){n.classList?n.classList.remove(e):typeof n.className=="string"?n.className=Rv(n.className,e):n.setAttribute("class",Rv(n.className&&n.className.baseVal||"",e))}const $o={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class e9 extends ny{adjustAndStore(e,t,r){const a=t.style[e];t.dataset[e]=a,vi(t,{[e]:`${parseFloat(vi(t,e))+r}px`})}restore(e,t){const r=t.dataset[e];r!==void 0&&(delete t.dataset[e],vi(t,{[e]:r}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();if(ZK(t,"modal-open"),!e.scrollBarWidth)return;const r=this.isRTL?"paddingLeft":"paddingRight",a=this.isRTL?"marginLeft":"marginRight";ui(t,$o.FIXED_CONTENT).forEach(i=>this.adjustAndStore(r,i,e.scrollBarWidth)),ui(t,$o.STICKY_CONTENT).forEach(i=>this.adjustAndStore(a,i,-e.scrollBarWidth)),ui(t,$o.NAVBAR_TOGGLER).forEach(i=>this.adjustAndStore(a,i,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();JK(t,"modal-open");const r=this.isRTL?"paddingLeft":"paddingRight",a=this.isRTL?"marginLeft":"marginRight";ui(t,$o.FIXED_CONTENT).forEach(i=>this.restore(r,i)),ui(t,$o.STICKY_CONTENT).forEach(i=>this.restore(a,i)),ui(t,$o.NAVBAR_TOGGLER).forEach(i=>this.restore(a,i))}}let Jp;function t9(n){return Jp||(Jp=new e9(n)),Jp}const SE=X.forwardRef(({className:n,bsPrefix:e,as:t="div",...r},a)=>(e=dt(e,"modal-body"),q.jsx(t,{ref:a,className:Ye(n,e),...r})));SE.displayName="ModalBody";const wE=X.createContext({onHide(){}}),ry=X.forwardRef(({bsPrefix:n,className:e,contentClassName:t,centered:r,size:a,fullscreen:i,children:l,scrollable:u,...c},f)=>{n=dt(n,"modal");const p=`${n}-dialog`,m=typeof i=="string"?`${n}-fullscreen-${i}`:`${n}-fullscreen`;return q.jsx("div",{...c,ref:f,className:Ye(p,e,a&&`${n}-${a}`,r&&`${p}-centered`,u&&`${p}-scrollable`,i&&m),children:q.jsx("div",{className:Ye(`${n}-content`,t),children:l})})});ry.displayName="ModalDialog";const TE=X.forwardRef(({className:n,bsPrefix:e,as:t="div",...r},a)=>(e=dt(e,"modal-footer"),q.jsx(t,{ref:a,className:Ye(n,e),...r})));TE.displayName="ModalFooter";const n9=X.forwardRef(({closeLabel:n="Close",closeVariant:e,closeButton:t=!1,onHide:r,children:a,...i},l)=>{const u=X.useContext(wE),c=zd(()=>{u==null||u.onHide(),r==null||r()});return q.jsxs("div",{ref:l,...i,children:[a,t&&q.jsx(jg,{"aria-label":n,variant:e,onClick:c})]})}),NE=X.forwardRef(({bsPrefix:n,className:e,closeLabel:t="Close",closeButton:r=!1,...a},i)=>(n=dt(n,"modal-header"),q.jsx(n9,{ref:i,...a,className:Ye(e,n),closeLabel:t,closeButton:r})));NE.displayName="ModalHeader";const r9=nK("h4"),EE=X.forwardRef(({className:n,bsPrefix:e,as:t=r9,...r},a)=>(e=dt(e,"modal-title"),q.jsx(t,{ref:a,className:Ye(n,e),...r})));EE.displayName="ModalTitle";function a9(n){return q.jsx(Wg,{...n,timeout:null})}function s9(n){return q.jsx(Wg,{...n,timeout:null})}const $E=X.forwardRef(({bsPrefix:n,className:e,style:t,dialogClassName:r,contentClassName:a,children:i,dialogAs:l=ry,"data-bs-theme":u,"aria-labelledby":c,"aria-describedby":f,"aria-label":p,show:m=!1,animation:g=!0,backdrop:x=!0,keyboard:v=!0,onEscapeKeyDown:w,onShow:S,onHide:T,container:$,autoFocus:D=!0,enforceFocus:R=!0,restoreFocus:I=!0,restoreFocusOptions:V,onEntered:j,onExit:K,onExiting:B,onEnter:U,onEntering:k,onExited:ee,backdropClassName:he,manager:fe,...me},ae)=>{const[de,le]=X.useState({}),[Q,F]=X.useState(!1),P=X.useRef(!1),G=X.useRef(!1),te=X.useRef(null),[re,xe]=kK(),ye=nE(ae,xe),ge=zd(T),Se=_X();n=dt(n,"modal");const Ne=X.useMemo(()=>({onHide:ge}),[ge]);function De(){return fe||t9({isRTL:Se})}function Le(Fe){if(!nl)return;const Nn=De().getScrollbarWidth()>0,nr=Fe.scrollHeight>pf(Fe).documentElement.clientHeight;le({paddingRight:Nn&&!nr?Ev():void 0,paddingLeft:!Nn&&nr?Ev():void 0})}const qe=zd(()=>{re&&Le(re.dialog)});pK(()=>{Qm(window,"resize",qe),te.current==null||te.current()});const Ze=()=>{P.current=!0},Je=Fe=>{P.current&&re&&Fe.target===re.dialog&&(G.current=!0),P.current=!1},ke=()=>{F(!0),te.current=tE(re.dialog,()=>{F(!1)})},nt=Fe=>{Fe.target===Fe.currentTarget&&ke()},bt=Fe=>{if(x==="static"){nt(Fe);return}if(G.current||Fe.target!==Fe.currentTarget){G.current=!1;return}T==null||T()},At=Fe=>{v?w==null||w(Fe):(Fe.preventDefault(),x==="static"&&ke())},Mn=(Fe,Nn)=>{Fe&&Le(Fe),U==null||U(Fe,Nn)},Tn=Fe=>{te.current==null||te.current(),K==null||K(Fe)},hn=(Fe,Nn)=>{k==null||k(Fe,Nn),eE(window,"resize",qe)},Kt=Fe=>{Fe&&(Fe.style.display=""),ee==null||ee(Fe),Qm(window,"resize",qe)},pn=X.useCallback(Fe=>q.jsx("div",{...Fe,className:Ye(`${n}-backdrop`,he,!g&&"show")}),[g,he,n]),vt={...t,...de};vt.display="block";const Un=Fe=>q.jsx("div",{role:"dialog",...Fe,style:vt,className:Ye(e,n,Q&&`${n}-static`,!g&&"show"),onClick:x?bt:void 0,onMouseUp:Je,"data-bs-theme":u,"aria-label":p,"aria-labelledby":c,"aria-describedby":f,children:q.jsx(l,{...me,onMouseDown:Ze,className:r,contentClassName:a,children:i})});return q.jsx(wE.Provider,{value:Ne,children:q.jsx(YK,{show:m,ref:ye,backdrop:x,container:$,keyboard:!0,autoFocus:D,enforceFocus:R,restoreFocus:I,restoreFocusOptions:V,onEscapeKeyDown:At,onShow:S,onHide:T,onEnter:Mn,onEntering:hn,onEntered:j,onExit:Tn,onExiting:B,onExited:Kt,manager:De(),transition:g?a9:void 0,backdropTransition:g?s9:void 0,renderBackdrop:pn,renderDialog:Un})})});$E.displayName="Modal";const ct=Object.assign($E,{Body:SE,Header:NE,Title:EE,Footer:TE,Dialog:ry,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),DE=X.forwardRef(({bsPrefix:n,className:e,as:t="div",...r},a)=>{const i=dt(n,"row"),l=Gg(),u=Hg(),c=`${i}-cols`,f=[];return l.forEach(p=>{const m=r[p];delete r[p];let g;m!=null&&typeof m=="object"?{cols:g}=m:g=m;const x=p!==u?`-${p}`:"";g!=null&&f.push(`${c}${x}-${g}`)}),q.jsx(t,{ref:a,...r,className:Ye(e,i,...f)})});DE.displayName="Row";function i9(n,e=YN,t=QN){const r=[];return Object.entries(n).forEach(([a,i])=>{i!=null&&(typeof i=="object"?e.forEach(l=>{const u=i[l];if(u!=null){const c=l!==t?`-${l}`:"";r.push(`${a}${c}-${u}`)}}):r.push(`${a}-${i}`))}),r}const RE=X.forwardRef(({as:n="div",bsPrefix:e,className:t,direction:r,gap:a,...i},l)=>{e=dt(e,r==="horizontal"?"hstack":"vstack");const u=Gg(),c=Hg();return q.jsx(n,{...i,ref:l,className:Ye(t,e,...i9({gap:a},u,c))})});RE.displayName="Stack";const _E=bn.createContext();function As(){return X.useContext(_E)}const o9=({children:n})=>{const[e,t]=X.useState(1),[r,a]=X.useState(1),[i,l]=X.useState(""),[u,c]=X.useState(!1),[f,p]=X.useState("letters"),[m,g]=X.useState(!1),x=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZ"),v=Array.from("123456789");return X.useEffect(()=>{document.body.setAttribute("data-bs-theme",m?"dark":"light")},[m]),q.jsxs(_E.Provider,{value:{letters:x,numbers:v,numLetters:e,speed:r,currentLetter:i,gameStart:u,characterType:f,darkMode:m,setNumLetters:t,setSpeed:a,setCurrentLetter:l,setGameStart:c,setCharacterType:p,setDarkMode:g},children:[" ",n," "]})},Tr=new b.GestureDescription("A");Tr.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Tr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.6);Tr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.6);Tr.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);Tr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Tr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Tr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Tr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Tr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Tr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Tr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Nr=new b.GestureDescription("B");Nr.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);Nr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);Nr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Nr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Nr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Nr.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Nr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Nr.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);Nr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Nr.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);Nr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const sn=new b.GestureDescription("C");sn.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);sn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.6);sn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.6);sn.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);sn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.6);sn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.6);sn.addCurl(b.Finger.Middle,b.FingerCurl.HalfCurl,1);sn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpRight,.6);sn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpLeft,.6);sn.addCurl(b.Finger.Ring,b.FingerCurl.HalfCurl,1);sn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpRight,.6);sn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpLeft,.6);sn.addCurl(b.Finger.Pinky,b.FingerCurl.HalfCurl,1);sn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpRight,.6);sn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.6);const Xr=new b.GestureDescription("D");Xr.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);Xr.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);Xr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Xr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Xr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Xr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalDown,.7);Xr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Xr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalDown,.7);Xr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Xr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalDown,.7);const Er=new b.GestureDescription("E");Er.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,.7);Er.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalLeft,.5);Er.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalRight,.5);Er.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,.7);Er.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Er.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,.7);Er.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Er.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,.7);Er.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Er.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,.7);Er.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Kr=new b.GestureDescription("F");Kr.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);Kr.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);Kr.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);Kr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Kr.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Kr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Kr.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);Kr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Kr.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);Kr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const on=new b.GestureDescription("G");on.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);on.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalRight,.7);on.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalLeft,.7);on.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);on.addDirection(b.Finger.Index,b.FingerDirection.HorizontalRight,.7);on.addDirection(b.Finger.Index,b.FingerDirection.HorizontalLeft,.7);on.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);on.addDirection(b.Finger.Middle,b.FingerDirection.HorizontalRight,.7);on.addDirection(b.Finger.Middle,b.FingerDirection.HorizontalLeft,.7);on.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);on.addDirection(b.Finger.Ring,b.FingerDirection.HorizontalRight,.7);on.addDirection(b.Finger.Ring,b.FingerDirection.HorizontalLeft,.7);on.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);on.addDirection(b.Finger.Pinky,b.FingerDirection.HorizontalRight,.7);on.addDirection(b.Finger.Pinky,b.FingerDirection.HorizontalLeft,.7);const ln=new b.GestureDescription("H");ln.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);ln.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalRight,.7);ln.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalLeft,.7);ln.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);ln.addDirection(b.Finger.Index,b.FingerDirection.HorizontalRight,.7);ln.addDirection(b.Finger.Index,b.FingerDirection.HorizontalLeft,.7);ln.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);ln.addDirection(b.Finger.Middle,b.FingerDirection.HorizontalRight,.7);ln.addDirection(b.Finger.Middle,b.FingerDirection.HorizontalLeft,.7);ln.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);ln.addDirection(b.Finger.Ring,b.FingerDirection.HorizontalRight,.7);ln.addDirection(b.Finger.Ring,b.FingerDirection.HorizontalLeft,.7);ln.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);ln.addDirection(b.Finger.Pinky,b.FingerDirection.HorizontalRight,.7);ln.addDirection(b.Finger.Pinky,b.FingerDirection.HorizontalLeft,.7);const $r=new b.GestureDescription("I");$r.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);$r.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);$r.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);$r.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);$r.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);$r.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);$r.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);$r.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);$r.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);$r.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);$r.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const un=new b.GestureDescription("J");un.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);un.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);un.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);un.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);un.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.7);un.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.7);un.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);un.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpRight,.7);un.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpLeft,.7);un.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);un.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpRight,.7);un.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpLeft,.7);un.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);un.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpRight,.7);un.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const Dr=new b.GestureDescription("K");Dr.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Dr.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);Dr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Dr.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.7);Dr.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.7);Dr.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Dr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Dr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Dr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Dr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Dr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Rr=new b.GestureDescription("L");Rr.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Rr.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalLeft,.7);Rr.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalRight,.7);Rr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Rr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Rr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Rr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Rr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Rr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Rr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Rr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const _r=new b.GestureDescription("M");_r.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);_r.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalLeft,.7);_r.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalRight,.7);_r.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);_r.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);_r.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);_r.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);_r.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);_r.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);_r.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);_r.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Or=new b.GestureDescription("N");Or.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);Or.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);Or.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Or.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);Or.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Or.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Or.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Or.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Or.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Or.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Or.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const cn=new b.GestureDescription("O");cn.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);cn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);cn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);cn.addCurl(b.Finger.Index,b.FingerCurl.HalfCurl,1);cn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.7);cn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.7);cn.addCurl(b.Finger.Middle,b.FingerCurl.HalfCurl,1);cn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpRight,.7);cn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpLeft,.7);cn.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);cn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpRight,.7);cn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpLeft,.7);cn.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);cn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpRight,.7);cn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const dn=new b.GestureDescription("P");dn.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);dn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalDownLeft,.7);dn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalDownRight,.7);dn.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);dn.addDirection(b.Finger.Index,b.FingerDirection.HorizontalRight,.7);dn.addDirection(b.Finger.Index,b.FingerDirection.HorizontalLeft,.7);dn.addCurl(b.Finger.Middle,b.FingerCurl.HalfCurl,1);dn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalDownRight,.7);dn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalDownLeft,.7);dn.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);dn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalDownRight,.7);dn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalDownLeft,.7);dn.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);dn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownRight,.7);dn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownLeft,.7);const Bn=new b.GestureDescription("Q");Bn.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Bn.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);Bn.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Bn.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Bn.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Bn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalDownRight,.7);Bn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalDownLeft,.7);Bn.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Bn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalDownRight,.7);Bn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalDownLeft,.7);Bn.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Bn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownRight,.7);Bn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownLeft,.7);const Jn=new b.GestureDescription("R");Jn.addCurl(b.Finger.Thumb,b.FingerCurl.FullCurl,1);Jn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);Jn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Jn.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Jn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.7);Jn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.7);Jn.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Jn.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Jn.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Jn.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Jn.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Jn.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const kr=new b.GestureDescription("S");kr.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);kr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.75);kr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.75);kr.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);kr.addDirection(b.Finger.Index,b.FingerDirection.VerticalDown,.7);kr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);kr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalDown,.7);kr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);kr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalDown,.7);kr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);kr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalDown,.7);const Yr=new b.GestureDescription("T");Yr.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Yr.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);Yr.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);Yr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Yr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Yr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Yr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Yr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Yr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Yr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const er=new b.GestureDescription("U");er.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);er.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);er.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);er.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);er.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);er.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);er.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);er.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);er.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);er.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);er.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownLeft,.7);er.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownRight,.7);const wn=new b.GestureDescription("V");wn.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);wn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);wn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);wn.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);wn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.7);wn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.7);wn.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);wn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpLeft,.7);wn.addDirection(b.Finger.Middle,b.FingerDirection.DiagonalUpRight,.7);wn.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);wn.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);wn.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);wn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownLeft,.7);wn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownRight,.7);const fn=new b.GestureDescription("W");fn.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);fn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);fn.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);fn.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);fn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpRight,.7);fn.addDirection(b.Finger.Index,b.FingerDirection.DiagonalUpLeft,.7);fn.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);fn.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);fn.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);fn.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);fn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpLeft,.7);fn.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalUpRight,.7);fn.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);fn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownLeft,.7);fn.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalDownRight,.7);const Fr=new b.GestureDescription("X");Fr.addCurl(b.Finger.Thumb,b.FingerCurl.FullCurl,1);Fr.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalLeft,.7);Fr.addDirection(b.Finger.Thumb,b.FingerDirection.HorizontalRight,.7);Fr.addCurl(b.Finger.Index,b.FingerCurl.HalfCurl,1);Fr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Fr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Fr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Fr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Fr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Fr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Fr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const tr=new b.GestureDescription("Y");tr.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);tr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);tr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);tr.addCurl(b.Finger.Index,b.FingerCurl.FullCurl,1);tr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);tr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);tr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);tr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);tr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);tr.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);tr.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);tr.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpRight,.7);const Ar=new b.GestureDescription("Z");Ar.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,.8);Ar.addDirection(b.Finger.Index,b.FingerDirection.HorizontalLeft,.7);Ar.addDirection(b.Finger.Index,b.FingerDirection.HorizontalRight,.7);Ar.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Ar.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Ar.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,1);Ar.addDirection(b.Finger.Middle,b.FingerDirection.VerticalDown,.7);Ar.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Ar.addDirection(b.Finger.Ring,b.FingerDirection.VerticalDown,.7);Ar.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Ar.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalDown,.7);const Qr=new b.GestureDescription("One");Qr.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,.7);Qr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Qr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Qr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Qr.addCurl(b.Finger.Middle,b.FingerCurl.FullCurl,.7);Qr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Qr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,.7);Qr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Qr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,.7);Qr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Zr=new b.GestureDescription("Two");Zr.addCurl(b.Finger.Thumb,b.FingerCurl.HalfCurl,1);Zr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Zr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Zr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Zr.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Zr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Zr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Zr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Zr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Zr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Jr=new b.GestureDescription("Three");Jr.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Jr.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Jr.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Jr.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Jr.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Jr.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Jr.addCurl(b.Finger.Ring,b.FingerCurl.FullCurl,1);Jr.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Jr.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);Jr.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const Ir=new b.GestureDescription("Four");Ir.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);Ir.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpLeft,.7);Ir.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);Ir.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);Ir.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);Ir.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);Ir.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);Ir.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);Ir.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);Ir.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);Ir.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const ea=new b.GestureDescription("Five");ea.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);ea.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);ea.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);ea.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);ea.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);ea.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);ea.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);ea.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);ea.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);ea.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const ta=new b.GestureDescription("Six");ta.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);ta.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);ta.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);ta.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);ta.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);ta.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);ta.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);ta.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);ta.addCurl(b.Finger.Pinky,b.FingerCurl.FullCurl,1);ta.addDirection(b.Finger.Pinky,b.FingerDirection.VerticalUp,.7);const na=new b.GestureDescription("Seven");na.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);na.addDirection(b.Finger.Thumb,b.FingerDirection.DiagonalUpRight,.7);na.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);na.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);na.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);na.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);na.addCurl(b.Finger.Ring,b.FingerCurl.HalfCurl,1);na.addDirection(b.Finger.Ring,b.FingerDirection.DiagonalDownLeft,.7);na.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);na.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const ra=new b.GestureDescription("Eight");ra.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);ra.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);ra.addCurl(b.Finger.Index,b.FingerCurl.NoCurl,1);ra.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);ra.addCurl(b.Finger.Middle,b.FingerCurl.HalfCurl,1);ra.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);ra.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);ra.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);ra.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);ra.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const aa=new b.GestureDescription("Nine");aa.addCurl(b.Finger.Thumb,b.FingerCurl.NoCurl,1);aa.addDirection(b.Finger.Thumb,b.FingerDirection.VerticalUp,.7);aa.addCurl(b.Finger.Index,b.FingerCurl.HalfCurl,1);aa.addDirection(b.Finger.Index,b.FingerDirection.VerticalUp,.7);aa.addCurl(b.Finger.Middle,b.FingerCurl.NoCurl,1);aa.addDirection(b.Finger.Middle,b.FingerDirection.VerticalUp,.7);aa.addCurl(b.Finger.Ring,b.FingerCurl.NoCurl,1);aa.addDirection(b.Finger.Ring,b.FingerDirection.VerticalUp,.7);aa.addCurl(b.Finger.Pinky,b.FingerCurl.NoCurl,1);aa.addDirection(b.Finger.Pinky,b.FingerDirection.DiagonalUpLeft,.7);const l9={aSign:Tr,bSign:Nr,cSign:sn,dSign:Xr,eSign:Er,fSign:Kr,gSign:on,hSign:ln,iSign:$r,jSign:un,kSign:Dr,lSign:Rr,mSign:_r,nSign:Or,oSign:cn,pSign:dn,qSign:Bn,rSign:Jn,sSign:kr,tSign:Yr,uSign:er,vSign:wn,wSign:fn,xSign:Fr,ySign:tr,zSign:Ar,oneSign:Qr,twoSign:Zr,threeSign:Jr,fourSign:Ir,fiveSign:ea,sixSign:ta,sevenSign:na,eightSign:ra,nineSign:aa};function u9(){const n=X.useRef(null),{currentLetter:e,setCurrentLetter:t}=As(),[r]=X.useState({width:640,height:480}),[a,i]=X.useState(!0);X.useEffect(()=>{(async()=>{const f=await vU(),p=new b.GestureEstimator(Object.values(l9));l(f,p)})()},[]);const l=X.useCallback(async(c,f)=>{const p=async()=>{if(n.current&&n.current.video.readyState===4){const m=n.current.video,g=await c.estimateHands(m);if(g.length>0){const x=await f.estimate(g[0].landmarks,8);if(x.gestures&&x.gestures.length>0){const v=x.gestures.reduce((w,S)=>w.score>S.score?w:S);v.name=="One"?t("1"):v.name=="Two"?t("2"):v.name=="Three"?t("3"):v.name=="Four"?t("4"):v.name=="Five"?t("5"):v.name=="Six"?t("6"):v.name=="Seven"?t("7"):v.name=="Eight"?t("8"):v.name=="Nine"?t("9"):t(v.name)}}}requestAnimationFrame(p)};p()},[]),u=X.useCallback(()=>{i(c=>!c)},[]);return q.jsx(q.Fragment,{children:q.jsxs("div",{style:{position:"absolute",left:"0",top:"0",width:"100vw",height:"100vh"},children:[q.jsx("div",{style:{position:"absolute",left:"50%",top:"3%",transform:"translateX(-50%)",width:"auto",fontSize:"72px",fontWeight:"bold",color:"BlueViolet",textShadow:"2px 2px 4px rgba(0,0,0,0.5)"},children:e}),q.jsx(SX,{style:{position:"absolute",bottom:0,left:0,margin:"auto",display:"flex",justifyContent:"center",width:`${r.width}px`,height:`${r.height}px`,visibility:a?"visible":"hidden"},id:"webcam",ref:n}),q.jsx(ht,{style:{position:"absolute",bottom:"20px",right:"20px"},onClick:u,variant:a?"danger":"success",children:a?"Hide Camera":"Show Camera"})]})})}function c9({show:n,handleClose:e}){return q.jsxs(ct,{show:n,onHide:e,centered:!0,children:[q.jsx(ct.Header,{closeButton:!0,children:q.jsx(ct.Title,{children:"Important Information"})}),q.jsx(ct.Body,{children:q.jsxs(ru,{variant:"flush",children:[q.jsxs(ru.Item,{children:[q.jsx("strong",{children:" Hardware Acceleration is recommended"}),q.jsx("p",{className:"small mb-0",children:"This will improve webcam and gesture detection performance"})]}),q.jsxs(ru.Item,{children:[q.jsx("strong",{children:" Camera Access"}),q.jsx("p",{className:"small mb-0",children:"Browser permission for camera access is required"})]}),q.jsxs(ru.Item,{children:[q.jsx("strong",{children:" Good Lighting"}),q.jsx("p",{className:"small mb-0",children:"Ensure your hands are well lit for better detection"})]}),q.jsxs(ru.Item,{children:[q.jsx("strong",{children:" Hand Position"}),q.jsx("p",{className:"small mb-0",children:"Keep your hand within frame and about 1-2 feet from your camera"})]})]})}),q.jsx(ct.Footer,{children:q.jsx(ht,{variant:"secondary",onClick:e,children:"Close"})})]})}var OE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},_v=bn.createContext&&bn.createContext(OE),d9=["attr","size","title"];function f9(n,e){if(n==null)return{};var t=h9(n,e),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(a=0;a<i.length;a++)r=i[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function h9(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function Hd(){return Hd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Hd.apply(this,arguments)}function Ov(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Wd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ov(Object(t),!0).forEach(function(r){p9(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ov(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function p9(n,e,t){return e=m9(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m9(n){var e=g9(n,"string");return typeof e=="symbol"?e:e+""}function g9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kE(n){return n&&n.map((e,t)=>bn.createElement(e.tag,Wd({key:t},e.attr),kE(e.child)))}function bf(n){return e=>bn.createElement(y9,Hd({attr:Wd({},n.attr)},e),kE(n.child))}function y9(n){var e=t=>{var{attr:r,size:a,title:i}=n,l=f9(n,d9),u=a||t.size||"1em",c;return t.className&&(c=t.className),n.className&&(c=(c?c+" ":"")+n.className),bn.createElement("svg",Hd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:c,style:Wd(Wd({color:n.color||t.color},t.style),n.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&bn.createElement("title",null,i),n.children)};return _v!==void 0?bn.createElement(_v.Consumer,null,t=>e(t)):e(OE)}function x9(n){return bf({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z"},child:[]}]})(n)}function b9(n){return bf({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5z"},child:[]}]})(n)}function v9(n){return bf({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"},child:[]}]})(n)}function C9(n){return bf({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"},child:[]}]})(n)}function S9({show:n,handleClose:e}){const[t,r]=X.useState(!1),{letters:a,numbers:i}=As(),l=()=>{r(!t)},u=t?i:a;return q.jsxs(ct,{show:n,onHide:e,size:"xl",fullscreen:!0,children:[q.jsx(ct.Header,{closeButton:!0,children:q.jsx(ct.Title,{children:t?"Number Signs Gallery":"Letter Signs Gallery"})}),q.jsxs(ct.Body,{className:"position-relative",children:[t?q.jsx(ht,{variant:"link",onClick:l,className:"position-absolute",style:{left:"20px",top:"50%",fontSize:"2rem"},children:q.jsx(x9,{})}):q.jsx(ht,{variant:"link",onClick:l,className:"position-absolute",style:{right:"20px",top:"50%",fontSize:"2rem"},children:q.jsx(b9,{})}),q.jsx(Xg,{children:[...Array(Math.ceil(u.length/6))].map((c,f)=>q.jsx(DE,{className:"mb-3",children:u.slice(f*6,(f+1)*6).map(p=>q.jsxs(qg,{xs:2,className:"border p-3 text-center",children:[q.jsx("div",{className:"mb-2 h4",children:p}),q.jsx(Zg,{src:`./blob/master/src/assets/${p}.png`,alt:`Sign for ${p}`,fluid:!0,style:{maxHeight:"150px",objectFit:"contain"}})]},p))},f))})]}),q.jsx(ct.Footer,{children:q.jsx(ht,{variant:"secondary",onClick:e,children:"Close"})})]})}function w9({show:n,handleClose:e}){const[t,r]=X.useState("A"),[a,i]=X.useState(0),[l,u]=X.useState(!1),{currentLetter:c,letters:f,numbers:p,characterType:m,setCharacterType:g}=As(),x=()=>{switch(m){case"numbers":return p;case"both":return[...f,...p];default:return f}},v=(S,T)=>{if(l){const D=Math.floor(Math.random()*S.length);return S[D]}const $=(T+1)%S.length;return S[$]},w=()=>{const S=x(),T=S.indexOf(t),$=v(S,T);r($),i(0)};return X.useEffect(()=>{let S;return n&&c===t?S=setInterval(()=>{i(T=>{if(T>=3){const $=x(),D=$.indexOf(t),R=v($,D);return r(R),0}return T+1})},1e3):i(0),()=>clearInterval(S)},[c,t,n,m,l]),q.jsxs(ct,{show:n,onHide:e,centered:!0,children:[q.jsx(ct.Header,{closeButton:!0,children:q.jsx(ct.Title,{children:"Practice Mode"})}),q.jsxs(ct.Body,{className:"text-center",children:[q.jsxs("div",{className:"mb-4 d-flex justify-content-center gap-2",children:[q.jsx(ht,{variant:m==="letters"?"primary":"outline-primary",onClick:()=>g("letters"),children:"Letters"}),q.jsx(ht,{variant:m==="numbers"?"primary":"outline-primary",onClick:()=>g("numbers"),children:"Numbers"}),q.jsx(ht,{variant:m==="both"?"primary":"outline-primary",onClick:()=>g("both"),children:"Both"}),q.jsx(ht,{variant:l?"success":"outline-success",onClick:()=>u(!l),children:"Random"})]}),q.jsxs("h2",{className:"mb-4",children:["Current Character: ",t]}),q.jsx(Zg,{src:`./blob/master/src/assets/${t}.png`,alt:`Sign for ${t}`,fluid:!0,style:{maxHeight:"300px",objectFit:"contain"}}),c===t&&q.jsxs("div",{className:"mt-3",children:["Holding for: ",a," seconds"]})]}),q.jsxs(ct.Footer,{children:[q.jsx(ht,{variant:"secondary",onClick:e,children:"Close"}),q.jsx(ht,{variant:"warning",onClick:w,children:"Skip Character"})]})]})}function T9({show:n,handleClose:e,letterCount:t,missedCount:r,totalLetterCount:a}){const{setGameStart:i}=As(),l=()=>{i(!1),e(),setTimeout(()=>{i(!0)},0)},u=()=>{i(!1),e()};return q.jsxs(ct,{show:n,onHide:e,centered:!0,children:[q.jsx(ct.Header,{closeButton:!0,children:q.jsx(ct.Title,{children:"Game Results"})}),q.jsx(ct.Body,{children:q.jsxs("div",{className:"text-center mb-4",children:[q.jsx("h5",{children:"Final Score:"}),q.jsxs("p",{className:"mb-2",children:["Hit: ",t]}),q.jsxs("p",{className:"mb-2",children:["Missed: ",r]}),q.jsxs("p",{className:"mb-2",children:["Total: ",a]}),q.jsxs("p",{className:"mb-2",children:["Accuracy: ",(t/a*100).toFixed(1),"%"]})]})}),q.jsxs(ct.Footer,{children:[q.jsx(ht,{variant:"primary",onClick:l,children:"Restart"}),q.jsx(ht,{variant:"secondary",onClick:u,children:"Back to Menu"})]})]})}const Cd=[10.136,-1.375,10.385,9.115,-1.375,8.585,9.067,-1.067,5.894,10.151,-.659,3.434,10.807,1.886,.469,10.761,2.872,-1.281,9.62,2.872,-3.283,6.976,2.766,-4.759,6.046,1.073,-6.664,7.347,-1.823,-9.069,7.226,-1.823,-10.5,5.835,-1.823,-12.039,3.653,-.205,-13.877,-.302,1.597,-14.88,-2.893,2.297,-13.892,-4.538,4.586,-12.141,-6.129,5.965,-8.978,-6.012,4.408,-6.712,-5.214,2.821,-4.453,-2.342,2.203,-3.079,-.008,1.893,-1.658,-.248,2.885,.074,-2.217,4.242,2.216,-3.453,3.062,4.792,-3.736,1.405,7.843,-3.4,1.192,9.246,-1.885,1.527,10.306,.011,2.11,10.491,.426,2.276,11.613,.096,.032,16.223,2.346,.389,19.912,5.702,1.733,20.615,7.972,1.733,19.303,9.867,.09,16.893,11.226,-1.375,14.279,11.289,-1.375,11.926,10.136,-1.375,10.385],FE=[],N9=Cd.length;for(let n=0;n<N9;n+=3)FE.push(new _n.Vector3(Cd[n],Cd[n+1],Cd[n+2]));const E9=new _n.CatmullRomCurve3(FE);function $9(){const n=X.useRef(null),e=X.useRef([]),t=X.useRef(),r=X.useRef(),[a,i]=X.useState(0),[l,u]=X.useState(0),[c,f]=X.useState(0),{currentLetter:p,setCurrentLetter:m,numLetters:g,speed:x,characterType:v}=As(),[w,S]=X.useState(!1),T=()=>S(!1),$=X.useRef(0);return X.useEffect(()=>{e.current.length>0&&p===e.current[0].name&&r.current.position.distanceTo(e.current[0].position)<3&&(t.current.remove(e.current[0]),e.current.splice(0,1),m(""),i(D=>D+1))},[p,m]),X.useEffect(()=>{const D=window.innerWidth,R=window.innerHeight,I=new _n.WebGLRenderer({antialias:!0});I.setSize(D,R),I.toneMapping=_n.ACESFilmicToneMapping,I.outputColorSpace=_n.SRGBColorSpace,n.current.appendChild(I.domElement),r.current=new _n.PerspectiveCamera(75,D/R,.1,1e3),r.current.position.z=5,t.current=new _n.Scene,t.current.fog=new _n.FogExp2(0,.3);const V=new YD(r.current,I.domElement);V.enableDamping=!0,V.dampingFactor=.03;const j=new _n.TubeGeometry(E9,222,.6,16,!0),K=new _n.MeshBasicMaterial({color:16777215,side:_n.DoubleSide}),B=new _n.Mesh(j,K);t.current.add(B),new ZD().load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",function(fe){const ae=new _n.MeshBasicMaterial({color:65535});for(let de=0;de<g;de++){let le;v==="letters"?le=String.fromCharCode(65+Math.floor(Math.random()*26)):v==="numbers"?le=String(Math.floor(Math.random()*9)+1):le=Math.random()>.5?String.fromCharCode(65+Math.floor(Math.random()*26)):String(Math.floor(Math.random()*9)+1);const Q=new QD(le,{font:fe,size:.075,height:.01,curveSegments:12,bevelEnabled:!1}),F=new _n.Mesh(Q,ae),P=(de/g+Math.random()*.02)%1,G=j.parameters.path.getPointAt(P);F.position.copy(G),F.name=le,e.current.push(F),t.current.add(F)}$.current=e.current.length});function k(fe){const me=fe*.1,ae=1e4/x,de=me%ae/ae,le=j.parameters.path.getPointAt(de);r.current.position.copy(le);const Q=j.parameters.path.getPointAt((de+.03)%1);r.current.lookAt(Q)}let ee=!0;function he(fe=0){ee&&(requestAnimationFrame(he),e.current.sort((me,ae)=>r.current.position.distanceTo(me.position)-r.current.position.distanceTo(ae.position)),e.current.forEach((me,ae)=>{r.current.position.distanceTo(me.position)<.4?(e.current.splice(ae,1),t.current.remove(me),f(de=>de+1)):me.lookAt(r.current.position)}),e.current.length===0&&$.current>0&&(S(!0),ee=!1),k(fe),I.render(t.current,r.current),V.update())}return he(),()=>{ee=!1,n.current&&(n.current.removeChild(I.domElement),I.dispose(),I.forceContextLoss())}},[]),X.useEffect(()=>{u($.current)},[$.current]),q.jsxs(q.Fragment,{children:[q.jsxs("div",{style:{position:"absolute",top:"1vh",left:"1vw",color:"BlueViolet",zIndex:10},children:["Hit: ",a," / Missed: ",c," / Total: ",l]}),q.jsx("div",{ref:n}),q.jsx(T9,{show:w,handleClose:T,letterCount:a,missedCount:c,totalLetterCount:l})]})}function D9({show:n,handleClose:e}){const{numLetters:t,speed:r,setNumLetters:a,setSpeed:i,gameStart:l,setGameStart:u,characterType:c,setCharacterType:f}=As(),p=x=>{a(x.target.value)},m=x=>{i(x.target.value)},g=()=>{u(!0),e()};return q.jsxs(q.Fragment,{children:[q.jsxs(ct,{show:n,onHide:e,children:[q.jsx(ct.Header,{closeButton:!0,children:q.jsx(ct.Title,{children:"Adjust Settings"})}),q.jsxs(ct.Body,{children:[q.jsx(nu.Label,{className:"mb-3",children:"Choose Characters:"}),q.jsxs("div",{className:"d-flex gap-2 mb-4",children:[q.jsx(ht,{variant:c==="letters"?"primary":"outline-primary",onClick:()=>f("letters"),children:"Letters"}),q.jsx(ht,{variant:c==="numbers"?"primary":"outline-primary",onClick:()=>f("numbers"),children:"Numbers"}),q.jsx(ht,{variant:c==="both"?"primary":"outline-primary",onClick:()=>f("both"),children:"Both"})]}),q.jsxs(nu.Label,{children:["Number of Characters: ",t]}),q.jsx(nu.Range,{min:"1",max:"100",value:t,onChange:p}),q.jsxs(nu.Label,{children:["Speed: ",r]}),q.jsx(nu.Range,{min:"1",max:"10",step:"0.1",value:r,onChange:m})]}),q.jsxs(ct.Footer,{children:[q.jsx(ht,{variant:"secondary",onClick:e,children:"Close"}),q.jsx(ht,{variant:"primary",onClick:g,children:"Start"})]})]}),l&&q.jsx($9,{})]})}const R9={zIndex:1,bottom:"33vh",width:"auto",minWidth:"25vw"},_9={position:"fixed",left:"20px",top:"25%",transform:"translateY(-50%)",writingMode:"vertical-rl",textOrientation:"mixed",fontSize:"4rem",fontWeight:"bold",opacity:"0.7",userSelect:"none"};function O9(){const[n,e]=X.useState(!1),[t,r]=X.useState(!1),[a,i]=X.useState(!1),[l,u]=X.useState(!1),{gameStart:c,darkMode:f}=As(),p=()=>e(!0),m=()=>e(!1),g=()=>r(!0),x=()=>r(!1),v=()=>i(!0),w=()=>i(!1),S=()=>u(!0),T=()=>u(!1);return q.jsxs(q.Fragment,{children:[!c&&q.jsxs(q.Fragment,{children:[q.jsx("div",{style:_9,className:`text-${f?"light":"dark"}`,children:"ASTunneL"}),q.jsx(Xg,{className:"position-fixed end-0 p-3",style:R9,children:q.jsxs(RE,{gap:2,children:[q.jsx(ht,{variant:"primary",onClick:p,className:"py-1",size:"lg",children:"Start"}),q.jsx(ht,{variant:"info",onClick:v,className:"py-1",size:"lg",children:"Practice Mode"}),q.jsx(ht,{variant:"secondary",onClick:g,className:"py-1",size:"lg",children:"Open Gallery"}),q.jsx(ht,{variant:f?"light":"dark",onClick:S,className:"py-1",size:"lg",children:"Important Info"})]})})]}),q.jsx(D9,{show:n,handleClose:m}),q.jsx(S9,{show:t,handleClose:x}),q.jsx(w9,{show:a,handleClose:w}),q.jsx(c9,{show:l,handleClose:T})]})}function k9(){const{darkMode:n,setDarkMode:e,gameStart:t}=As();return t?null:q.jsx(ht,{variant:n?"light":"dark",onClick:()=>e(r=>!r),style:{position:"fixed",top:"20px",right:"20px",zIndex:1,borderRadius:"50%",width:"46px",height:"46px",padding:"0",display:"flex",alignItems:"center",justifyContent:"center"},children:n?q.jsx(C9,{size:20}):q.jsx(v9,{size:20})})}function F9(){return q.jsxs(q.Fragment,{children:[q.jsx(k9,{}),q.jsx(O9,{}),q.jsx(u9,{})]})}var em={exports:{}},au={},tm={exports:{}},nm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function A9(){return kv||(kv=1,function(n){function e(ae,de){var le=ae.length;ae.push(de);e:for(;0<le;){var Q=le-1>>>1,F=ae[Q];if(0<a(F,de))ae[Q]=de,ae[le]=F,le=Q;else break e}}function t(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var de=ae[0],le=ae.pop();if(le!==de){ae[0]=le;e:for(var Q=0,F=ae.length,P=F>>>1;Q<P;){var G=2*(Q+1)-1,te=ae[G],re=G+1,xe=ae[re];if(0>a(te,le))re<F&&0>a(xe,te)?(ae[Q]=xe,ae[re]=le,Q=re):(ae[Q]=te,ae[G]=le,Q=G);else if(re<F&&0>a(xe,le))ae[Q]=xe,ae[re]=le,Q=re;else break e}}return de}function a(ae,de){var le=ae.sortIndex-de.sortIndex;return le!==0?le:ae.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var c=[],f=[],p=1,m=null,g=3,x=!1,v=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function D(ae){for(var de=t(f);de!==null;){if(de.callback===null)r(f);else if(de.startTime<=ae)r(f),de.sortIndex=de.expirationTime,e(c,de);else break;de=t(f)}}function R(ae){if(w=!1,D(ae),!v)if(t(c)!==null)v=!0,fe();else{var de=t(f);de!==null&&me(R,de.startTime-ae)}}var I=!1,V=-1,j=5,K=-1;function B(){return!(n.unstable_now()-K<j)}function U(){if(I){var ae=n.unstable_now();K=ae;var de=!0;try{e:{v=!1,w&&(w=!1,T(V),V=-1),x=!0;var le=g;try{t:{for(D(ae),m=t(c);m!==null&&!(m.expirationTime>ae&&B());){var Q=m.callback;if(typeof Q=="function"){m.callback=null,g=m.priorityLevel;var F=Q(m.expirationTime<=ae);if(ae=n.unstable_now(),typeof F=="function"){m.callback=F,D(ae),de=!0;break t}m===t(c)&&r(c),D(ae)}else r(c);m=t(c)}if(m!==null)de=!0;else{var P=t(f);P!==null&&me(R,P.startTime-ae),de=!1}}break e}finally{m=null,g=le,x=!1}de=void 0}}finally{de?k():I=!1}}}var k;if(typeof $=="function")k=function(){$(U)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,he=ee.port2;ee.port1.onmessage=U,k=function(){he.postMessage(null)}}else k=function(){S(U,0)};function fe(){I||(I=!0,k())}function me(ae,de){V=S(function(){ae(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ae){ae.callback=null},n.unstable_continueExecution=function(){v||x||(v=!0,fe())},n.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<ae?Math.floor(1e3/ae):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(ae){switch(g){case 1:case 2:case 3:var de=3;break;default:de=g}var le=g;g=de;try{return ae()}finally{g=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ae,de){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var le=g;g=ae;try{return de()}finally{g=le}},n.unstable_scheduleCallback=function(ae,de,le){var Q=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Q+le:Q):le=Q,ae){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=le+F,ae={id:p++,callback:de,priorityLevel:ae,startTime:le,expirationTime:F,sortIndex:-1},le>Q?(ae.sortIndex=le,e(f,ae),t(c)===null&&ae===t(f)&&(w?(T(V),V=-1):w=!0,me(R,le-Q))):(ae.sortIndex=F,e(c,ae),v||x||(v=!0,fe())),ae},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(ae){var de=g;return function(){var le=g;g=de;try{return ae.apply(this,arguments)}finally{g=le}}}}(nm)),nm}var Fv;function I9(){return Fv||(Fv=1,tm.exports=A9()),tm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Av;function L9(){if(Av)return au;Av=1;var n=I9(),e=hf(),t=ZN();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}var i=Symbol.for("react.element"),l=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),g=Symbol.for("react.consumer"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),D=Symbol.for("react.offscreen"),R=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function V(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function K(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case c:return"Fragment";case u:return"Portal";case p:return"Profiler";case f:return"StrictMode";case w:return"Suspense";case S:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case x:return(s.displayName||"Context")+".Provider";case g:return(s._context.displayName||"Context")+".Consumer";case v:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return o=s.displayName||null,o!==null?o:K(s.type)||"Memo";case $:o=s._payload,s=s._init;try{return K(s(o))}catch{}}return null}var B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=Object.assign,k,ee;function he(s){if(k===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);k=o&&o[1]||"",ee=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+k+s+ee}var fe=!1;function me(s,o){if(!s||fe)return"";fe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(se){var ne=se}Reflect.construct(s,[],ce)}else{try{ce.call()}catch(se){ne=se}s.call(ce.prototype)}}else{try{throw Error()}catch(se){ne=se}(ce=s())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(se){if(se&&ne&&typeof se.stack=="string")return[se.stack,ne.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=h.DetermineComponentFrameRoot(),E=C[0],O=C[1];if(E&&O){var L=E.split(`
`),W=O.split(`
`);for(y=h=0;h<L.length&&!L[h].includes("DetermineComponentFrameRoot");)h++;for(;y<W.length&&!W[y].includes("DetermineComponentFrameRoot");)y++;if(h===L.length||y===W.length)for(h=L.length-1,y=W.length-1;1<=h&&0<=y&&L[h]!==W[y];)y--;for(;1<=h&&0<=y;h--,y--)if(L[h]!==W[y]){if(h!==1||y!==1)do if(h--,y--,0>y||L[h]!==W[y]){var ie=`
`+L[h].replace(" at new "," at ");return s.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",s.displayName)),ie}while(1<=h&&0<=y);break}}}finally{fe=!1,Error.prepareStackTrace=d}return(d=s?s.displayName||s.name:"")?he(d):""}function ae(s){switch(s.tag){case 26:case 27:case 5:return he(s.type);case 16:return he("Lazy");case 13:return he("Suspense");case 19:return he("SuspenseList");case 0:case 15:return s=me(s.type,!1),s;case 11:return s=me(s.type.render,!1),s;case 1:return s=me(s.type,!0),s;default:return""}}function de(s){try{var o="";do o+=ae(s),s=s.return;while(s);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function le(s){var o=s,d=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(d=o.return),s=o.return;while(s)}return o.tag===3?d:null}function Q(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function F(s){if(le(s)!==s)throw Error(r(188))}function P(s){var o=s.alternate;if(!o){if(o=le(s),o===null)throw Error(r(188));return o!==s?null:s}for(var d=s,h=o;;){var y=d.return;if(y===null)break;var C=y.alternate;if(C===null){if(h=y.return,h!==null){d=h;continue}break}if(y.child===C.child){for(C=y.child;C;){if(C===d)return F(y),s;if(C===h)return F(y),o;C=C.sibling}throw Error(r(188))}if(d.return!==h.return)d=y,h=C;else{for(var E=!1,O=y.child;O;){if(O===d){E=!0,d=y,h=C;break}if(O===h){E=!0,h=y,d=C;break}O=O.sibling}if(!E){for(O=C.child;O;){if(O===d){E=!0,d=C,h=y;break}if(O===h){E=!0,h=C,d=y;break}O=O.sibling}if(!E)throw Error(r(189))}}if(d.alternate!==h)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?s:o}function G(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=G(s),o!==null)return o;s=s.sibling}return null}var te=Array.isArray,re=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe={pending:!1,data:null,method:null,action:null},ye=[],ge=-1;function Se(s){return{current:s}}function Ne(s){0>ge||(s.current=ye[ge],ye[ge]=null,ge--)}function De(s,o){ge++,ye[ge]=s.current,s.current=o}var Le=Se(null),qe=Se(null),Ze=Se(null),Je=Se(null);function ke(s,o){switch(De(Ze,o),De(qe,s),De(Le,null),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)&&(o=o.namespaceURI)?f1(o):0;break;default:if(s=s===8?o.parentNode:o,o=s.tagName,s=s.namespaceURI)s=f1(s),o=h1(s,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Ne(Le),De(Le,o)}function nt(){Ne(Le),Ne(qe),Ne(Ze)}function bt(s){s.memoizedState!==null&&De(Je,s);var o=Le.current,d=h1(o,s.type);o!==d&&(De(qe,s),De(Le,d))}function At(s){qe.current===s&&(Ne(Le),Ne(qe)),Je.current===s&&(Ne(Je),ql._currentValue=xe)}var Mn=Object.prototype.hasOwnProperty,Tn=n.unstable_scheduleCallback,hn=n.unstable_cancelCallback,Kt=n.unstable_shouldYield,pn=n.unstable_requestPaint,vt=n.unstable_now,Un=n.unstable_getCurrentPriorityLevel,Fe=n.unstable_ImmediatePriority,Nn=n.unstable_UserBlockingPriority,nr=n.unstable_NormalPriority,Is=n.unstable_LowPriority,Ls=n.unstable_IdlePriority,rr=n.log,vf=n.unstable_setDisableYieldValue,ga=null,mn=null;function AE(s){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(ga,s,void 0,(s.current.flags&128)===128)}catch{}}function ja(s){if(typeof rr=="function"&&vf(s),mn&&typeof mn.setStrictMode=="function")try{mn.setStrictMode(ga,s)}catch{}}var Pn=Math.clz32?Math.clz32:BE,IE=Math.log,LE=Math.LN2;function BE(s){return s>>>=0,s===0?32:31-(IE(s)/LE|0)|0}var Mu=128,Uu=4194304;function Bs(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Pu(s,o){var d=s.pendingLanes;if(d===0)return 0;var h=0,y=s.suspendedLanes,C=s.pingedLanes,E=s.warmLanes;s=s.finishedLanes!==0;var O=d&134217727;return O!==0?(d=O&~y,d!==0?h=Bs(d):(C&=O,C!==0?h=Bs(C):s||(E=O&~E,E!==0&&(h=Bs(E))))):(O=d&~y,O!==0?h=Bs(O):C!==0?h=Bs(C):s||(E=d&~E,E!==0&&(h=Bs(E)))),h===0?0:o!==0&&o!==h&&(o&y)===0&&(y=h&-h,E=o&-o,y>=E||y===32&&(E&4194176)!==0)?o:h}function rl(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function ME(s,o){switch(s){case 1:case 2:case 4:case 8:return o+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ay(){var s=Mu;return Mu<<=1,(Mu&4194176)===0&&(Mu=128),s}function sy(){var s=Uu;return Uu<<=1,(Uu&62914560)===0&&(Uu=4194304),s}function Cf(s){for(var o=[],d=0;31>d;d++)o.push(s);return o}function al(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function UE(s,o,d,h,y,C){var E=s.pendingLanes;s.pendingLanes=d,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=d,s.entangledLanes&=d,s.errorRecoveryDisabledLanes&=d,s.shellSuspendCounter=0;var O=s.entanglements,L=s.expirationTimes,W=s.hiddenUpdates;for(d=E&~d;0<d;){var ie=31-Pn(d),ce=1<<ie;O[ie]=0,L[ie]=-1;var ne=W[ie];if(ne!==null)for(W[ie]=null,ie=0;ie<ne.length;ie++){var se=ne[ie];se!==null&&(se.lane&=-536870913)}d&=~ce}h!==0&&iy(s,h,0),C!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=C&~(E&~o))}function iy(s,o,d){s.pendingLanes|=o,s.suspendedLanes&=~o;var h=31-Pn(o);s.entangledLanes|=o,s.entanglements[h]=s.entanglements[h]|1073741824|d&4194218}function oy(s,o){var d=s.entangledLanes|=o;for(s=s.entanglements;d;){var h=31-Pn(d),y=1<<h;y&o|s[h]&o&&(s[h]|=o),d&=~y}}function ly(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function uy(){var s=re.p;return s!==0?s:(s=window.event,s===void 0?32:O1(s.type))}function PE(s,o){var d=re.p;try{return re.p=s,o()}finally{re.p=d}}var qa=Math.random().toString(36).slice(2),Yt="__reactFiber$"+qa,En="__reactProps$"+qa,Vi="__reactContainer$"+qa,Sf="__reactEvents$"+qa,zE="__reactListeners$"+qa,VE="__reactHandles$"+qa,cy="__reactResources$"+qa,sl="__reactMarker$"+qa;function wf(s){delete s[Yt],delete s[En],delete s[Sf],delete s[zE],delete s[VE]}function Ms(s){var o=s[Yt];if(o)return o;for(var d=s.parentNode;d;){if(o=d[Vi]||d[Yt]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(s=g1(s);s!==null;){if(d=s[Yt])return d;s=g1(s)}return o}s=d,d=s.parentNode}return null}function Gi(s){if(s=s[Yt]||s[Vi]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function il(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function Hi(s){var o=s[cy];return o||(o=s[cy]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function It(s){s[sl]=!0}var dy=new Set,fy={};function Us(s,o){Wi(s,o),Wi(s+"Capture",o)}function Wi(s,o){for(fy[s]=o,s=0;s<o.length;s++)dy.add(o[s])}var ya=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),GE=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hy={},py={};function HE(s){return Mn.call(py,s)?!0:Mn.call(hy,s)?!1:GE.test(s)?py[s]=!0:(hy[s]=!0,!1)}function zu(s,o,d){if(HE(o))if(d===null)s.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+d)}}function Vu(s,o,d){if(d===null)s.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+d)}}function xa(s,o,d,h){if(h===null)s.removeAttribute(d);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(d);return}s.setAttributeNS(o,d,""+h)}}function ar(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function my(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function WE(s){var o=my(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),h=""+s[o];if(!s.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,C=d.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(E){h=""+E,C.call(this,E)}}),Object.defineProperty(s,o,{enumerable:d.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Gu(s){s._valueTracker||(s._valueTracker=WE(s))}function gy(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var d=o.getValue(),h="";return s&&(h=my(s)?s.checked?"true":"false":s.value),s=h,s!==d?(o.setValue(s),!0):!1}function Hu(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var jE=/[\n"\\]/g;function sr(s){return s.replace(jE,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Tf(s,o,d,h,y,C,E,O){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),o!=null?E==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+ar(o)):s.value!==""+ar(o)&&(s.value=""+ar(o)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),o!=null?Nf(s,E,ar(o)):d!=null?Nf(s,E,ar(d)):h!=null&&s.removeAttribute("value"),y==null&&C!=null&&(s.defaultChecked=!!C),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?s.name=""+ar(O):s.removeAttribute("name")}function yy(s,o,d,h,y,C,E,O){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(s.type=C),o!=null||d!=null){if(!(C!=="submit"&&C!=="reset"||o!=null))return;d=d!=null?""+ar(d):"",o=o!=null?""+ar(o):d,O||o===s.value||(s.value=o),s.defaultValue=o}h=h??y,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=O?s.checked:!!h,s.defaultChecked=!!h,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E)}function Nf(s,o,d){o==="number"&&Hu(s.ownerDocument)===s||s.defaultValue===""+d||(s.defaultValue=""+d)}function ji(s,o,d,h){if(s=s.options,o){o={};for(var y=0;y<d.length;y++)o["$"+d[y]]=!0;for(d=0;d<s.length;d++)y=o.hasOwnProperty("$"+s[d].value),s[d].selected!==y&&(s[d].selected=y),y&&h&&(s[d].defaultSelected=!0)}else{for(d=""+ar(d),o=null,y=0;y<s.length;y++){if(s[y].value===d){s[y].selected=!0,h&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function xy(s,o,d){if(o!=null&&(o=""+ar(o),o!==s.value&&(s.value=o),d==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=d!=null?""+ar(d):""}function by(s,o,d,h){if(o==null){if(h!=null){if(d!=null)throw Error(r(92));if(te(h)){if(1<h.length)throw Error(r(93));h=h[0]}d=h}d==null&&(d=""),o=d}d=ar(o),s.defaultValue=d,h=s.textContent,h===d&&h!==""&&h!==null&&(s.value=h)}function qi(s,o){if(o){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=o;return}}s.textContent=o}var qE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vy(s,o,d){var h=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?h?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":h?s.setProperty(o,d):typeof d!="number"||d===0||qE.has(o)?o==="float"?s.cssFloat=d:s[o]=(""+d).trim():s[o]=d+"px"}function Cy(s,o,d){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,d!=null){for(var h in d)!d.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var y in o)h=o[y],o.hasOwnProperty(y)&&d[y]!==h&&vy(s,y,h)}else for(var C in o)o.hasOwnProperty(C)&&vy(s,C,o[C])}function Ef(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),KE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wu(s){return KE.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var $f=null;function Df(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xi=null,Ki=null;function Sy(s){var o=Gi(s);if(o&&(s=o.stateNode)){var d=s[En]||null;e:switch(s=o.stateNode,o.type){case"input":if(Tf(s,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+sr(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var h=d[o];if(h!==s&&h.form===s.form){var y=h[En]||null;if(!y)throw Error(r(90));Tf(h,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<d.length;o++)h=d[o],h.form===s.form&&gy(h)}break e;case"textarea":xy(s,d.value,d.defaultValue);break e;case"select":o=d.value,o!=null&&ji(s,!!d.multiple,o,!1)}}}var Rf=!1;function wy(s,o,d){if(Rf)return s(o,d);Rf=!0;try{var h=s(o);return h}finally{if(Rf=!1,(Xi!==null||Ki!==null)&&(Dc(),Xi&&(o=Xi,s=Ki,Ki=Xi=null,Sy(o),s)))for(o=0;o<s.length;o++)Sy(s[o])}}function ol(s,o){var d=s.stateNode;if(d===null)return null;var h=d[En]||null;if(h===null)return null;d=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(r(231,o,typeof d));return d}var _f=!1;if(ya)try{var ll={};Object.defineProperty(ll,"passive",{get:function(){_f=!0}}),window.addEventListener("test",ll,ll),window.removeEventListener("test",ll,ll)}catch{_f=!1}var Xa=null,Of=null,ju=null;function Ty(){if(ju)return ju;var s,o=Of,d=o.length,h,y="value"in Xa?Xa.value:Xa.textContent,C=y.length;for(s=0;s<d&&o[s]===y[s];s++);var E=d-s;for(h=1;h<=E&&o[d-h]===y[C-h];h++);return ju=y.slice(s,1<h?1-h:void 0)}function qu(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Xu(){return!0}function Ny(){return!1}function $n(s){function o(d,h,y,C,E){this._reactName=d,this._targetInst=y,this.type=h,this.nativeEvent=C,this.target=E,this.currentTarget=null;for(var O in s)s.hasOwnProperty(O)&&(d=s[O],this[O]=d?d(C):C[O]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Xu:Ny,this.isPropagationStopped=Ny,this}return U(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Xu)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Xu)},persist:function(){},isPersistent:Xu}),o}var Ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ku=$n(Ps),ul=U({},Ps,{view:0,detail:0}),YE=$n(ul),kf,Ff,cl,Yu=U({},ul,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:If,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==cl&&(cl&&s.type==="mousemove"?(kf=s.screenX-cl.screenX,Ff=s.screenY-cl.screenY):Ff=kf=0,cl=s),kf)},movementY:function(s){return"movementY"in s?s.movementY:Ff}}),Ey=$n(Yu),QE=U({},Yu,{dataTransfer:0}),ZE=$n(QE),JE=U({},ul,{relatedTarget:0}),Af=$n(JE),e$=U({},Ps,{animationName:0,elapsedTime:0,pseudoElement:0}),t$=$n(e$),n$=U({},Ps,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),r$=$n(n$),a$=U({},Ps,{data:0}),$y=$n(a$),s$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l$(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=o$[s])?!!o[s]:!1}function If(){return l$}var u$=U({},ul,{key:function(s){if(s.key){var o=s$[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=qu(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?i$[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:If,charCode:function(s){return s.type==="keypress"?qu(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?qu(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),c$=$n(u$),d$=U({},Yu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dy=$n(d$),f$=U({},ul,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:If}),h$=$n(f$),p$=U({},Ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),m$=$n(p$),g$=U({},Yu,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),y$=$n(g$),x$=U({},Ps,{newState:0,oldState:0}),b$=$n(x$),v$=[9,13,27,32],Lf=ya&&"CompositionEvent"in window,dl=null;ya&&"documentMode"in document&&(dl=document.documentMode);var C$=ya&&"TextEvent"in window&&!dl,Ry=ya&&(!Lf||dl&&8<dl&&11>=dl),_y=" ",Oy=!1;function ky(s,o){switch(s){case"keyup":return v$.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fy(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Yi=!1;function S$(s,o){switch(s){case"compositionend":return Fy(o);case"keypress":return o.which!==32?null:(Oy=!0,_y);case"textInput":return s=o.data,s===_y&&Oy?null:s;default:return null}}function w$(s,o){if(Yi)return s==="compositionend"||!Lf&&ky(s,o)?(s=Ty(),ju=Of=Xa=null,Yi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ry&&o.locale!=="ko"?null:o.data;default:return null}}var T$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ay(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!T$[s.type]:o==="textarea"}function Iy(s,o,d,h){Xi?Ki?Ki.push(h):Ki=[h]:Xi=h,o=Fc(o,"onChange"),0<o.length&&(d=new Ku("onChange","change",null,d,h),s.push({event:d,listeners:o}))}var fl=null,hl=null;function N$(s){o1(s,0)}function Qu(s){var o=il(s);if(gy(o))return s}function Ly(s,o){if(s==="change")return o}var By=!1;if(ya){var Bf;if(ya){var Mf="oninput"in document;if(!Mf){var My=document.createElement("div");My.setAttribute("oninput","return;"),Mf=typeof My.oninput=="function"}Bf=Mf}else Bf=!1;By=Bf&&(!document.documentMode||9<document.documentMode)}function Uy(){fl&&(fl.detachEvent("onpropertychange",Py),hl=fl=null)}function Py(s){if(s.propertyName==="value"&&Qu(hl)){var o=[];Iy(o,hl,s,Df(s)),wy(N$,o)}}function E$(s,o,d){s==="focusin"?(Uy(),fl=o,hl=d,fl.attachEvent("onpropertychange",Py)):s==="focusout"&&Uy()}function $$(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Qu(hl)}function D$(s,o){if(s==="click")return Qu(o)}function R$(s,o){if(s==="input"||s==="change")return Qu(o)}function _$(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var zn=typeof Object.is=="function"?Object.is:_$;function pl(s,o){if(zn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var d=Object.keys(s),h=Object.keys(o);if(d.length!==h.length)return!1;for(h=0;h<d.length;h++){var y=d[h];if(!Mn.call(o,y)||!zn(s[y],o[y]))return!1}return!0}function zy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Vy(s,o){var d=zy(s);s=0;for(var h;d;){if(d.nodeType===3){if(h=s+d.textContent.length,s<=o&&h>=o)return{node:d,offset:o-s};s=h}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=zy(d)}}function Gy(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Gy(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Hy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Hu(s.document);o instanceof s.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)s=o.contentWindow;else break;o=Hu(s.document)}return o}function Uf(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function O$(s,o){var d=Hy(o);o=s.focusedElem;var h=s.selectionRange;if(d!==o&&o&&o.ownerDocument&&Gy(o.ownerDocument.documentElement,o)){if(h!==null&&Uf(o)){if(s=h.start,d=h.end,d===void 0&&(d=s),"selectionStart"in o)o.selectionStart=s,o.selectionEnd=Math.min(d,o.value.length);else if(d=(s=o.ownerDocument||document)&&s.defaultView||window,d.getSelection){d=d.getSelection();var y=o.textContent.length,C=Math.min(h.start,y);h=h.end===void 0?C:Math.min(h.end,y),!d.extend&&C>h&&(y=h,h=C,C=y),y=Vy(o,C);var E=Vy(o,h);y&&E&&(d.rangeCount!==1||d.anchorNode!==y.node||d.anchorOffset!==y.offset||d.focusNode!==E.node||d.focusOffset!==E.offset)&&(s=s.createRange(),s.setStart(y.node,y.offset),d.removeAllRanges(),C>h?(d.addRange(s),d.extend(E.node,E.offset)):(s.setEnd(E.node,E.offset),d.addRange(s)))}}for(s=[],d=o;d=d.parentNode;)d.nodeType===1&&s.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<s.length;o++)d=s[o],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var k$=ya&&"documentMode"in document&&11>=document.documentMode,Qi=null,Pf=null,ml=null,zf=!1;function Wy(s,o,d){var h=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;zf||Qi==null||Qi!==Hu(h)||(h=Qi,"selectionStart"in h&&Uf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ml&&pl(ml,h)||(ml=h,h=Fc(Pf,"onSelect"),0<h.length&&(o=new Ku("onSelect","select",null,o,d),s.push({event:o,listeners:h}),o.target=Qi)))}function zs(s,o){var d={};return d[s.toLowerCase()]=o.toLowerCase(),d["Webkit"+s]="webkit"+o,d["Moz"+s]="moz"+o,d}var Zi={animationend:zs("Animation","AnimationEnd"),animationiteration:zs("Animation","AnimationIteration"),animationstart:zs("Animation","AnimationStart"),transitionrun:zs("Transition","TransitionRun"),transitionstart:zs("Transition","TransitionStart"),transitioncancel:zs("Transition","TransitionCancel"),transitionend:zs("Transition","TransitionEnd")},Vf={},jy={};ya&&(jy=document.createElement("div").style,"AnimationEvent"in window||(delete Zi.animationend.animation,delete Zi.animationiteration.animation,delete Zi.animationstart.animation),"TransitionEvent"in window||delete Zi.transitionend.transition);function Vs(s){if(Vf[s])return Vf[s];if(!Zi[s])return s;var o=Zi[s],d;for(d in o)if(o.hasOwnProperty(d)&&d in jy)return Vf[s]=o[d];return s}var qy=Vs("animationend"),Xy=Vs("animationiteration"),Ky=Vs("animationstart"),F$=Vs("transitionrun"),A$=Vs("transitionstart"),I$=Vs("transitioncancel"),Yy=Vs("transitionend"),Qy=new Map,Zy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Lr(s,o){Qy.set(s,o),Us(o,[s])}var ir=[],Ji=0,Gf=0;function Zu(){for(var s=Ji,o=Gf=Ji=0;o<s;){var d=ir[o];ir[o++]=null;var h=ir[o];ir[o++]=null;var y=ir[o];ir[o++]=null;var C=ir[o];if(ir[o++]=null,h!==null&&y!==null){var E=h.pending;E===null?y.next=y:(y.next=E.next,E.next=y),h.pending=y}C!==0&&Jy(d,y,C)}}function Ju(s,o,d,h){ir[Ji++]=s,ir[Ji++]=o,ir[Ji++]=d,ir[Ji++]=h,Gf|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Hf(s,o,d,h){return Ju(s,o,d,h),ec(s)}function Ka(s,o){return Ju(s,null,null,o),ec(s)}function Jy(s,o,d){s.lanes|=d;var h=s.alternate;h!==null&&(h.lanes|=d);for(var y=!1,C=s.return;C!==null;)C.childLanes|=d,h=C.alternate,h!==null&&(h.childLanes|=d),C.tag===22&&(s=C.stateNode,s===null||s._visibility&1||(y=!0)),s=C,C=C.return;y&&o!==null&&s.tag===3&&(C=s.stateNode,y=31-Pn(d),C=C.hiddenUpdates,s=C[y],s===null?C[y]=[o]:s.push(o),o.lane=d|536870912)}function ec(s){if(50<Pl)throw Pl=0,Yh=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var eo={},e0=new WeakMap;function or(s,o){if(typeof s=="object"&&s!==null){var d=e0.get(s);return d!==void 0?d:(o={value:s,source:o,stack:de(o)},e0.set(s,o),o)}return{value:s,source:o,stack:de(o)}}var to=[],no=0,tc=null,nc=0,lr=[],ur=0,Gs=null,ba=1,va="";function Hs(s,o){to[no++]=nc,to[no++]=tc,tc=s,nc=o}function t0(s,o,d){lr[ur++]=ba,lr[ur++]=va,lr[ur++]=Gs,Gs=s;var h=ba;s=va;var y=32-Pn(h)-1;h&=~(1<<y),d+=1;var C=32-Pn(o)+y;if(30<C){var E=y-y%5;C=(h&(1<<E)-1).toString(32),h>>=E,y-=E,ba=1<<32-Pn(o)+y|d<<y|h,va=C+s}else ba=1<<C|d<<y|h,va=s}function Wf(s){s.return!==null&&(Hs(s,1),t0(s,1,0))}function jf(s){for(;s===tc;)tc=to[--no],to[no]=null,nc=to[--no],to[no]=null;for(;s===Gs;)Gs=lr[--ur],lr[ur]=null,va=lr[--ur],lr[ur]=null,ba=lr[--ur],lr[ur]=null}var gn=null,Wt=null,Xe=!1,Br=null,sa=!1,qf=Error(r(519));function Ws(s){var o=Error(r(418,""));throw xl(or(o,s)),qf}function n0(s){var o=s.stateNode,d=s.type,h=s.memoizedProps;switch(o[Yt]=s,o[En]=h,d){case"dialog":Ve("cancel",o),Ve("close",o);break;case"iframe":case"object":case"embed":Ve("load",o);break;case"video":case"audio":for(d=0;d<Vl.length;d++)Ve(Vl[d],o);break;case"source":Ve("error",o);break;case"img":case"image":case"link":Ve("error",o),Ve("load",o);break;case"details":Ve("toggle",o);break;case"input":Ve("invalid",o),yy(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),Gu(o);break;case"select":Ve("invalid",o);break;case"textarea":Ve("invalid",o),by(o,h.value,h.defaultValue,h.children),Gu(o)}d=h.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||h.suppressHydrationWarning===!0||d1(o.textContent,d)?(h.popover!=null&&(Ve("beforetoggle",o),Ve("toggle",o)),h.onScroll!=null&&Ve("scroll",o),h.onScrollEnd!=null&&Ve("scrollend",o),h.onClick!=null&&(o.onclick=Ac),o=!0):o=!1,o||Ws(s)}function r0(s){for(gn=s.return;gn;)switch(gn.tag){case 3:case 27:sa=!0;return;case 5:case 13:sa=!1;return;default:gn=gn.return}}function gl(s){if(s!==gn)return!1;if(!Xe)return r0(s),Xe=!0,!1;var o=!1,d;if((d=s.tag!==3&&s.tag!==27)&&((d=s.tag===5)&&(d=s.type,d=!(d!=="form"&&d!=="button")||hp(s.type,s.memoizedProps)),d=!d),d&&(o=!0),o&&Wt&&Ws(s),r0(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(d=s.data,d==="/$"){if(o===0){Wt=Ur(s.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++;s=s.nextSibling}Wt=null}}else Wt=gn?Ur(s.stateNode.nextSibling):null;return!0}function yl(){Wt=gn=null,Xe=!1}function xl(s){Br===null?Br=[s]:Br.push(s)}var bl=Error(r(460)),a0=Error(r(474)),Xf={then:function(){}};function s0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function rc(){}function i0(s,o,d){switch(d=s[d],d===void 0?s.push(o):d!==o&&(o.then(rc,rc),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,s===bl?Error(r(483)):s;default:if(typeof o.status=="string")o.then(rc,rc);else{if(s=ot,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(h){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=h}},function(h){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,s===bl?Error(r(483)):s}throw vl=o,bl}}var vl=null;function o0(){if(vl===null)throw Error(r(459));var s=vl;return vl=null,s}var ro=null,Cl=0;function ac(s){var o=Cl;return Cl+=1,ro===null&&(ro=[]),i0(ro,s,o)}function Sl(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function sc(s,o){throw o.$$typeof===i?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function l0(s){var o=s._init;return o(s._payload)}function u0(s){function o(Y,H){if(s){var J=Y.deletions;J===null?(Y.deletions=[H],Y.flags|=16):J.push(H)}}function d(Y,H){if(!s)return null;for(;H!==null;)o(Y,H),H=H.sibling;return null}function h(Y){for(var H=new Map;Y!==null;)Y.key!==null?H.set(Y.key,Y):H.set(Y.index,Y),Y=Y.sibling;return H}function y(Y,H){return Y=os(Y,H),Y.index=0,Y.sibling=null,Y}function C(Y,H,J){return Y.index=J,s?(J=Y.alternate,J!==null?(J=J.index,J<H?(Y.flags|=33554434,H):J):(Y.flags|=33554434,H)):(Y.flags|=1048576,H)}function E(Y){return s&&Y.alternate===null&&(Y.flags|=33554434),Y}function O(Y,H,J,ue){return H===null||H.tag!==6?(H=Vh(J,Y.mode,ue),H.return=Y,H):(H=y(H,J),H.return=Y,H)}function L(Y,H,J,ue){var we=J.type;return we===c?ie(Y,H,J.props.children,ue,J.key):H!==null&&(H.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===$&&l0(we)===H.type)?(H=y(H,J.props),Sl(H,J),H.return=Y,H):(H=wc(J.type,J.key,J.props,null,Y.mode,ue),Sl(H,J),H.return=Y,H)}function W(Y,H,J,ue){return H===null||H.tag!==4||H.stateNode.containerInfo!==J.containerInfo||H.stateNode.implementation!==J.implementation?(H=Gh(J,Y.mode,ue),H.return=Y,H):(H=y(H,J.children||[]),H.return=Y,H)}function ie(Y,H,J,ue,we){return H===null||H.tag!==7?(H=ti(J,Y.mode,ue,we),H.return=Y,H):(H=y(H,J),H.return=Y,H)}function ce(Y,H,J){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Vh(""+H,Y.mode,J),H.return=Y,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case l:return J=wc(H.type,H.key,H.props,null,Y.mode,J),Sl(J,H),J.return=Y,J;case u:return H=Gh(H,Y.mode,J),H.return=Y,H;case $:var ue=H._init;return H=ue(H._payload),ce(Y,H,J)}if(te(H)||V(H))return H=ti(H,Y.mode,J,null),H.return=Y,H;if(typeof H.then=="function")return ce(Y,ac(H),J);if(H.$$typeof===x)return ce(Y,vc(Y,H),J);sc(Y,H)}return null}function ne(Y,H,J,ue){var we=H!==null?H.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return we!==null?null:O(Y,H,""+J,ue);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case l:return J.key===we?L(Y,H,J,ue):null;case u:return J.key===we?W(Y,H,J,ue):null;case $:return we=J._init,J=we(J._payload),ne(Y,H,J,ue)}if(te(J)||V(J))return we!==null?null:ie(Y,H,J,ue,null);if(typeof J.then=="function")return ne(Y,H,ac(J),ue);if(J.$$typeof===x)return ne(Y,H,vc(Y,J),ue);sc(Y,J)}return null}function se(Y,H,J,ue,we){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return Y=Y.get(J)||null,O(H,Y,""+ue,we);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case l:return Y=Y.get(ue.key===null?J:ue.key)||null,L(H,Y,ue,we);case u:return Y=Y.get(ue.key===null?J:ue.key)||null,W(H,Y,ue,we);case $:var Ue=ue._init;return ue=Ue(ue._payload),se(Y,H,J,ue,we)}if(te(ue)||V(ue))return Y=Y.get(J)||null,ie(H,Y,ue,we,null);if(typeof ue.then=="function")return se(Y,H,J,ac(ue),we);if(ue.$$typeof===x)return se(Y,H,J,vc(H,ue),we);sc(H,ue)}return null}function Ee(Y,H,J,ue){for(var we=null,Ue=null,$e=H,_e=H=0,Mt=null;$e!==null&&_e<J.length;_e++){$e.index>_e?(Mt=$e,$e=null):Mt=$e.sibling;var Ke=ne(Y,$e,J[_e],ue);if(Ke===null){$e===null&&($e=Mt);break}s&&$e&&Ke.alternate===null&&o(Y,$e),H=C(Ke,H,_e),Ue===null?we=Ke:Ue.sibling=Ke,Ue=Ke,$e=Mt}if(_e===J.length)return d(Y,$e),Xe&&Hs(Y,_e),we;if($e===null){for(;_e<J.length;_e++)$e=ce(Y,J[_e],ue),$e!==null&&(H=C($e,H,_e),Ue===null?we=$e:Ue.sibling=$e,Ue=$e);return Xe&&Hs(Y,_e),we}for($e=h($e);_e<J.length;_e++)Mt=se($e,Y,_e,J[_e],ue),Mt!==null&&(s&&Mt.alternate!==null&&$e.delete(Mt.key===null?_e:Mt.key),H=C(Mt,H,_e),Ue===null?we=Mt:Ue.sibling=Mt,Ue=Mt);return s&&$e.forEach(function(ps){return o(Y,ps)}),Xe&&Hs(Y,_e),we}function Oe(Y,H,J,ue){if(J==null)throw Error(r(151));for(var we=null,Ue=null,$e=H,_e=H=0,Mt=null,Ke=J.next();$e!==null&&!Ke.done;_e++,Ke=J.next()){$e.index>_e?(Mt=$e,$e=null):Mt=$e.sibling;var ps=ne(Y,$e,Ke.value,ue);if(ps===null){$e===null&&($e=Mt);break}s&&$e&&ps.alternate===null&&o(Y,$e),H=C(ps,H,_e),Ue===null?we=ps:Ue.sibling=ps,Ue=ps,$e=Mt}if(Ke.done)return d(Y,$e),Xe&&Hs(Y,_e),we;if($e===null){for(;!Ke.done;_e++,Ke=J.next())Ke=ce(Y,Ke.value,ue),Ke!==null&&(H=C(Ke,H,_e),Ue===null?we=Ke:Ue.sibling=Ke,Ue=Ke);return Xe&&Hs(Y,_e),we}for($e=h($e);!Ke.done;_e++,Ke=J.next())Ke=se($e,Y,_e,Ke.value,ue),Ke!==null&&(s&&Ke.alternate!==null&&$e.delete(Ke.key===null?_e:Ke.key),H=C(Ke,H,_e),Ue===null?we=Ke:Ue.sibling=Ke,Ue=Ke);return s&&$e.forEach(function(KD){return o(Y,KD)}),Xe&&Hs(Y,_e),we}function wt(Y,H,J,ue){if(typeof J=="object"&&J!==null&&J.type===c&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case l:e:{for(var we=J.key;H!==null;){if(H.key===we){if(we=J.type,we===c){if(H.tag===7){d(Y,H.sibling),ue=y(H,J.props.children),ue.return=Y,Y=ue;break e}}else if(H.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===$&&l0(we)===H.type){d(Y,H.sibling),ue=y(H,J.props),Sl(ue,J),ue.return=Y,Y=ue;break e}d(Y,H);break}else o(Y,H);H=H.sibling}J.type===c?(ue=ti(J.props.children,Y.mode,ue,J.key),ue.return=Y,Y=ue):(ue=wc(J.type,J.key,J.props,null,Y.mode,ue),Sl(ue,J),ue.return=Y,Y=ue)}return E(Y);case u:e:{for(we=J.key;H!==null;){if(H.key===we)if(H.tag===4&&H.stateNode.containerInfo===J.containerInfo&&H.stateNode.implementation===J.implementation){d(Y,H.sibling),ue=y(H,J.children||[]),ue.return=Y,Y=ue;break e}else{d(Y,H);break}else o(Y,H);H=H.sibling}ue=Gh(J,Y.mode,ue),ue.return=Y,Y=ue}return E(Y);case $:return we=J._init,J=we(J._payload),wt(Y,H,J,ue)}if(te(J))return Ee(Y,H,J,ue);if(V(J)){if(we=V(J),typeof we!="function")throw Error(r(150));return J=we.call(J),Oe(Y,H,J,ue)}if(typeof J.then=="function")return wt(Y,H,ac(J),ue);if(J.$$typeof===x)return wt(Y,H,vc(Y,J),ue);sc(Y,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,H!==null&&H.tag===6?(d(Y,H.sibling),ue=y(H,J),ue.return=Y,Y=ue):(d(Y,H),ue=Vh(J,Y.mode,ue),ue.return=Y,Y=ue),E(Y)):d(Y,H)}return function(Y,H,J,ue){try{Cl=0;var we=wt(Y,H,J,ue);return ro=null,we}catch($e){if($e===bl)throw $e;var Ue=hr(29,$e,null,Y.mode);return Ue.lanes=ue,Ue.return=Y,Ue}finally{}}}var js=u0(!0),c0=u0(!1),ao=Se(null),ic=Se(0);function d0(s,o){s=Oa,De(ic,s),De(ao,o),Oa=s|o.baseLanes}function Kf(){De(ic,Oa),De(ao,ao.current)}function Yf(){Oa=ic.current,Ne(ao),Ne(ic)}var cr=Se(null),ia=null;function Ya(s){var o=s.alternate;De(Rt,Rt.current&1),De(cr,s),ia===null&&(o===null||ao.current!==null||o.memoizedState!==null)&&(ia=s)}function f0(s){if(s.tag===22){if(De(Rt,Rt.current),De(cr,s),ia===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(ia=s)}}else Qa()}function Qa(){De(Rt,Rt.current),De(cr,cr.current)}function Ca(s){Ne(cr),ia===s&&(ia=null),Ne(Rt)}var Rt=Se(0);function oc(s){for(var o=s;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var L$=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(d,h){s.push(h)}};this.abort=function(){o.aborted=!0,s.forEach(function(d){return d()})}},B$=n.unstable_scheduleCallback,M$=n.unstable_NormalPriority,_t={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qf(){return{controller:new L$,data:new Map,refCount:0}}function wl(s){s.refCount--,s.refCount===0&&B$(M$,function(){s.controller.abort()})}var Tl=null,Zf=0,so=0,io=null;function U$(s,o){if(Tl===null){var d=Tl=[];Zf=0,so=ap(),io={status:"pending",value:void 0,then:function(h){d.push(h)}}}return Zf++,o.then(h0,h0),o}function h0(){if(--Zf===0&&Tl!==null){io!==null&&(io.status="fulfilled");var s=Tl;Tl=null,so=0,io=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function P$(s,o){var d=[],h={status:"pending",value:null,reason:null,then:function(y){d.push(y)}};return s.then(function(){h.status="fulfilled",h.value=o;for(var y=0;y<d.length;y++)(0,d[y])(o)},function(y){for(h.status="rejected",h.reason=y,y=0;y<d.length;y++)(0,d[y])(void 0)}),h}var p0=B.S;B.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&U$(s,o),p0!==null&&p0(s,o)};var qs=Se(null);function Jf(){var s=qs.current;return s!==null?s:ot.pooledCache}function lc(s,o){o===null?De(qs,qs.current):De(qs,o.pool)}function m0(){var s=Jf();return s===null?null:{parent:_t._currentValue,pool:s}}var Za=0,Be=null,rt=null,Et=null,uc=!1,oo=!1,Xs=!1,cc=0,Nl=0,lo=null,z$=0;function Nt(){throw Error(r(321))}function eh(s,o){if(o===null)return!1;for(var d=0;d<o.length&&d<s.length;d++)if(!zn(s[d],o[d]))return!1;return!0}function th(s,o,d,h,y,C){return Za=C,Be=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,B.H=s===null||s.memoizedState===null?Ks:Ja,Xs=!1,C=d(h,y),Xs=!1,oo&&(C=y0(o,d,h,y)),g0(s),C}function g0(s){B.H=oa;var o=rt!==null&&rt.next!==null;if(Za=0,Et=rt=Be=null,uc=!1,Nl=0,lo=null,o)throw Error(r(300));s===null||Lt||(s=s.dependencies,s!==null&&bc(s)&&(Lt=!0))}function y0(s,o,d,h){Be=s;var y=0;do{if(oo&&(lo=null),Nl=0,oo=!1,25<=y)throw Error(r(301));if(y+=1,Et=rt=null,s.updateQueue!=null){var C=s.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}B.H=Ys,C=o(d,h)}while(oo);return C}function V$(){var s=B.H,o=s.useState()[0];return o=typeof o.then=="function"?El(o):o,s=s.useState()[0],(rt!==null?rt.memoizedState:null)!==s&&(Be.flags|=1024),o}function nh(){var s=cc!==0;return cc=0,s}function rh(s,o,d){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~d}function ah(s){if(uc){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}uc=!1}Za=0,Et=rt=Be=null,oo=!1,Nl=cc=0,lo=null}function Dn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?Be.memoizedState=Et=s:Et=Et.next=s,Et}function $t(){if(rt===null){var s=Be.alternate;s=s!==null?s.memoizedState:null}else s=rt.next;var o=Et===null?Be.memoizedState:Et.next;if(o!==null)Et=o,rt=s;else{if(s===null)throw Be.alternate===null?Error(r(467)):Error(r(310));rt=s,s={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},Et===null?Be.memoizedState=Et=s:Et=Et.next=s}return Et}var dc;dc=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function El(s){var o=Nl;return Nl+=1,lo===null&&(lo=[]),s=i0(lo,s,o),o=Be,(Et===null?o.memoizedState:Et.next)===null&&(o=o.alternate,B.H=o===null||o.memoizedState===null?Ks:Ja),s}function fc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return El(s);if(s.$$typeof===x)return Qt(s)}throw Error(r(438,String(s)))}function sh(s){var o=null,d=Be.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var h=Be.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=dc(),Be.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(s),h=0;h<s;h++)d[h]=R;return o.index++,d}function Sa(s,o){return typeof o=="function"?o(s):o}function hc(s){var o=$t();return ih(o,rt,s)}function ih(s,o,d){var h=s.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=d;var y=s.baseQueue,C=h.pending;if(C!==null){if(y!==null){var E=y.next;y.next=C.next,C.next=E}o.baseQueue=y=C,h.pending=null}if(C=s.baseState,y===null)s.memoizedState=C;else{o=y.next;var O=E=null,L=null,W=o,ie=!1;do{var ce=W.lane&-536870913;if(ce!==W.lane?(He&ce)===ce:(Za&ce)===ce){var ne=W.revertLane;if(ne===0)L!==null&&(L=L.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),ce===so&&(ie=!0);else if((Za&ne)===ne){W=W.next,ne===so&&(ie=!0);continue}else ce={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},L===null?(O=L=ce,E=C):L=L.next=ce,Be.lanes|=ne,ls|=ne;ce=W.action,Xs&&d(C,ce),C=W.hasEagerState?W.eagerState:d(C,ce)}else ne={lane:ce,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},L===null?(O=L=ne,E=C):L=L.next=ne,Be.lanes|=ce,ls|=ce;W=W.next}while(W!==null&&W!==o);if(L===null?E=C:L.next=O,!zn(C,s.memoizedState)&&(Lt=!0,ie&&(d=io,d!==null)))throw d;s.memoizedState=C,s.baseState=E,s.baseQueue=L,h.lastRenderedState=C}return y===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function oh(s){var o=$t(),d=o.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=s;var h=d.dispatch,y=d.pending,C=o.memoizedState;if(y!==null){d.pending=null;var E=y=y.next;do C=s(C,E.action),E=E.next;while(E!==y);zn(C,o.memoizedState)||(Lt=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),d.lastRenderedState=C}return[C,h]}function x0(s,o,d){var h=Be,y=$t(),C=Xe;if(C){if(d===void 0)throw Error(r(407));d=d()}else d=o();var E=!zn((rt||y).memoizedState,d);if(E&&(y.memoizedState=d,Lt=!0),y=y.queue,ch(C0.bind(null,h,y,s),[s]),y.getSnapshot!==o||E||Et!==null&&Et.memoizedState.tag&1){if(h.flags|=2048,uo(9,v0.bind(null,h,y,d,o),{destroy:void 0},null),ot===null)throw Error(r(349));C||(Za&60)!==0||b0(h,o,d)}return d}function b0(s,o,d){s.flags|=16384,s={getSnapshot:o,value:d},o=Be.updateQueue,o===null?(o=dc(),Be.updateQueue=o,o.stores=[s]):(d=o.stores,d===null?o.stores=[s]:d.push(s))}function v0(s,o,d,h){o.value=d,o.getSnapshot=h,S0(o)&&w0(s)}function C0(s,o,d){return d(function(){S0(o)&&w0(s)})}function S0(s){var o=s.getSnapshot;s=s.value;try{var d=o();return!zn(s,d)}catch{return!0}}function w0(s){var o=Ka(s,2);o!==null&&yn(o,s,2)}function lh(s){var o=Dn();if(typeof s=="function"){var d=s;if(s=d(),Xs){ja(!0);try{d()}finally{ja(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:s},o}function T0(s,o,d,h){return s.baseState=d,ih(s,rt,typeof h=="function"?h:Sa)}function G$(s,o,d,h,y){if(gc(s))throw Error(r(485));if(s=o.action,s!==null){var C={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){C.listeners.push(E)}};B.T!==null?d(!0):C.isTransition=!1,h(C),d=o.pending,d===null?(C.next=o.pending=C,N0(o,C)):(C.next=d.next,o.pending=d.next=C)}}function N0(s,o){var d=o.action,h=o.payload,y=s.state;if(o.isTransition){var C=B.T,E={};B.T=E;try{var O=d(y,h),L=B.S;L!==null&&L(E,O),E0(s,o,O)}catch(W){uh(s,o,W)}finally{B.T=C}}else try{C=d(y,h),E0(s,o,C)}catch(W){uh(s,o,W)}}function E0(s,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(h){$0(s,o,h)},function(h){return uh(s,o,h)}):$0(s,o,d)}function $0(s,o,d){o.status="fulfilled",o.value=d,D0(o),s.state=d,o=s.pending,o!==null&&(d=o.next,d===o?s.pending=null:(d=d.next,o.next=d,N0(s,d)))}function uh(s,o,d){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=d,D0(o),o=o.next;while(o!==h)}s.action=null}function D0(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function R0(s,o){return o}function _0(s,o){if(Xe){var d=ot.formState;if(d!==null){e:{var h=Be;if(Xe){if(Wt){t:{for(var y=Wt,C=sa;y.nodeType!==8;){if(!C){y=null;break t}if(y=Ur(y.nextSibling),y===null){y=null;break t}}C=y.data,y=C==="F!"||C==="F"?y:null}if(y){Wt=Ur(y.nextSibling),h=y.data==="F!";break e}}Ws(h)}h=!1}h&&(o=d[0])}}return d=Dn(),d.memoizedState=d.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:R0,lastRenderedState:o},d.queue=h,d=X0.bind(null,Be,h),h.dispatch=d,h=lh(!1),C=mh.bind(null,Be,!1,h.queue),h=Dn(),y={state:o,dispatch:null,action:s,pending:null},h.queue=y,d=G$.bind(null,Be,y,C,d),y.dispatch=d,h.memoizedState=s,[o,d,!1]}function O0(s){var o=$t();return k0(o,rt,s)}function k0(s,o,d){o=ih(s,o,R0)[0],s=hc(Sa)[0],o=typeof o=="object"&&o!==null&&typeof o.then=="function"?El(o):o;var h=$t(),y=h.queue,C=y.dispatch;return d!==h.memoizedState&&(Be.flags|=2048,uo(9,H$.bind(null,y,d),{destroy:void 0},null)),[o,C,s]}function H$(s,o){s.action=o}function F0(s){var o=$t(),d=rt;if(d!==null)return k0(o,d,s);$t(),o=o.memoizedState,d=$t();var h=d.queue.dispatch;return d.memoizedState=s,[o,h,!1]}function uo(s,o,d,h){return s={tag:s,create:o,inst:d,deps:h,next:null},o=Be.updateQueue,o===null&&(o=dc(),Be.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=s.next=s:(h=d.next,d.next=s,s.next=h,o.lastEffect=s),s}function A0(){return $t().memoizedState}function pc(s,o,d,h){var y=Dn();Be.flags|=s,y.memoizedState=uo(1|o,d,{destroy:void 0},h===void 0?null:h)}function mc(s,o,d,h){var y=$t();h=h===void 0?null:h;var C=y.memoizedState.inst;rt!==null&&h!==null&&eh(h,rt.memoizedState.deps)?y.memoizedState=uo(o,d,C,h):(Be.flags|=s,y.memoizedState=uo(1|o,d,C,h))}function I0(s,o){pc(8390656,8,s,o)}function ch(s,o){mc(2048,8,s,o)}function L0(s,o){return mc(4,2,s,o)}function B0(s,o){return mc(4,4,s,o)}function M0(s,o){if(typeof o=="function"){s=s();var d=o(s);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function U0(s,o,d){d=d!=null?d.concat([s]):null,mc(4,4,M0.bind(null,o,s),d)}function dh(){}function P0(s,o){var d=$t();o=o===void 0?null:o;var h=d.memoizedState;return o!==null&&eh(o,h[1])?h[0]:(d.memoizedState=[s,o],s)}function z0(s,o){var d=$t();o=o===void 0?null:o;var h=d.memoizedState;if(o!==null&&eh(o,h[1]))return h[0];if(h=s(),Xs){ja(!0);try{s()}finally{ja(!1)}}return d.memoizedState=[h,o],h}function fh(s,o,d){return d===void 0||(Za&1073741824)!==0?s.memoizedState=o:(s.memoizedState=d,s=Gx(),Be.lanes|=s,ls|=s,d)}function V0(s,o,d,h){return zn(d,o)?d:ao.current!==null?(s=fh(s,d,h),zn(s,o)||(Lt=!0),s):(Za&42)===0?(Lt=!0,s.memoizedState=d):(s=Gx(),Be.lanes|=s,ls|=s,o)}function G0(s,o,d,h,y){var C=re.p;re.p=C!==0&&8>C?C:8;var E=B.T,O={};B.T=O,mh(s,!1,o,d);try{var L=y(),W=B.S;if(W!==null&&W(O,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var ie=P$(L,h);$l(s,o,ie,Wn(s))}else $l(s,o,h,Wn(s))}catch(ce){$l(s,o,{then:function(){},status:"rejected",reason:ce},Wn())}finally{re.p=C,B.T=E}}function W$(){}function hh(s,o,d,h){if(s.tag!==5)throw Error(r(476));var y=H0(s).queue;G0(s,y,o,xe,d===null?W$:function(){return W0(s),d(h)})}function H0(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:xe,baseState:xe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:xe},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:d},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function W0(s){var o=H0(s).next.queue;$l(s,o,{},Wn())}function ph(){return Qt(ql)}function j0(){return $t().memoizedState}function q0(){return $t().memoizedState}function j$(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var d=Wn();s=ns(d);var h=rs(o,s,d);h!==null&&(yn(h,o,d),_l(h,o,d)),o={cache:Qf()},s.payload=o;return}o=o.return}}function q$(s,o,d){var h=Wn();d={lane:h,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},gc(s)?K0(o,d):(d=Hf(s,o,d,h),d!==null&&(yn(d,s,h),Y0(d,o,h)))}function X0(s,o,d){var h=Wn();$l(s,o,d,h)}function $l(s,o,d,h){var y={lane:h,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(gc(s))K0(o,y);else{var C=s.alternate;if(s.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var E=o.lastRenderedState,O=C(E,d);if(y.hasEagerState=!0,y.eagerState=O,zn(O,E))return Ju(s,o,y,0),ot===null&&Zu(),!1}catch{}finally{}if(d=Hf(s,o,y,h),d!==null)return yn(d,s,h),Y0(d,o,h),!0}return!1}function mh(s,o,d,h){if(h={lane:2,revertLane:ap(),action:h,hasEagerState:!1,eagerState:null,next:null},gc(s)){if(o)throw Error(r(479))}else o=Hf(s,d,h,2),o!==null&&yn(o,s,2)}function gc(s){var o=s.alternate;return s===Be||o!==null&&o===Be}function K0(s,o){oo=uc=!0;var d=s.pending;d===null?o.next=o:(o.next=d.next,d.next=o),s.pending=o}function Y0(s,o,d){if((d&4194176)!==0){var h=o.lanes;h&=s.pendingLanes,d|=h,o.lanes=d,oy(s,d)}}var oa={readContext:Qt,use:fc,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt};oa.useCacheRefresh=Nt,oa.useMemoCache=Nt,oa.useHostTransitionStatus=Nt,oa.useFormState=Nt,oa.useActionState=Nt,oa.useOptimistic=Nt;var Ks={readContext:Qt,use:fc,useCallback:function(s,o){return Dn().memoizedState=[s,o===void 0?null:o],s},useContext:Qt,useEffect:I0,useImperativeHandle:function(s,o,d){d=d!=null?d.concat([s]):null,pc(4194308,4,M0.bind(null,o,s),d)},useLayoutEffect:function(s,o){return pc(4194308,4,s,o)},useInsertionEffect:function(s,o){pc(4,2,s,o)},useMemo:function(s,o){var d=Dn();o=o===void 0?null:o;var h=s();if(Xs){ja(!0);try{s()}finally{ja(!1)}}return d.memoizedState=[h,o],h},useReducer:function(s,o,d){var h=Dn();if(d!==void 0){var y=d(o);if(Xs){ja(!0);try{d(o)}finally{ja(!1)}}}else y=o;return h.memoizedState=h.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},h.queue=s,s=s.dispatch=q$.bind(null,Be,s),[h.memoizedState,s]},useRef:function(s){var o=Dn();return s={current:s},o.memoizedState=s},useState:function(s){s=lh(s);var o=s.queue,d=X0.bind(null,Be,o);return o.dispatch=d,[s.memoizedState,d]},useDebugValue:dh,useDeferredValue:function(s,o){var d=Dn();return fh(d,s,o)},useTransition:function(){var s=lh(!1);return s=G0.bind(null,Be,s.queue,!0,!1),Dn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,d){var h=Be,y=Dn();if(Xe){if(d===void 0)throw Error(r(407));d=d()}else{if(d=o(),ot===null)throw Error(r(349));(He&60)!==0||b0(h,o,d)}y.memoizedState=d;var C={value:d,getSnapshot:o};return y.queue=C,I0(C0.bind(null,h,C,s),[s]),h.flags|=2048,uo(9,v0.bind(null,h,C,d,o),{destroy:void 0},null),d},useId:function(){var s=Dn(),o=ot.identifierPrefix;if(Xe){var d=va,h=ba;d=(h&~(1<<32-Pn(h)-1)).toString(32)+d,o=":"+o+"R"+d,d=cc++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=z$++,o=":"+o+"r"+d.toString(32)+":";return s.memoizedState=o},useCacheRefresh:function(){return Dn().memoizedState=j$.bind(null,Be)}};Ks.useMemoCache=sh,Ks.useHostTransitionStatus=ph,Ks.useFormState=_0,Ks.useActionState=_0,Ks.useOptimistic=function(s){var o=Dn();o.memoizedState=o.baseState=s;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=mh.bind(null,Be,!0,d),d.dispatch=o,[s,o]};var Ja={readContext:Qt,use:fc,useCallback:P0,useContext:Qt,useEffect:ch,useImperativeHandle:U0,useInsertionEffect:L0,useLayoutEffect:B0,useMemo:z0,useReducer:hc,useRef:A0,useState:function(){return hc(Sa)},useDebugValue:dh,useDeferredValue:function(s,o){var d=$t();return V0(d,rt.memoizedState,s,o)},useTransition:function(){var s=hc(Sa)[0],o=$t().memoizedState;return[typeof s=="boolean"?s:El(s),o]},useSyncExternalStore:x0,useId:j0};Ja.useCacheRefresh=q0,Ja.useMemoCache=sh,Ja.useHostTransitionStatus=ph,Ja.useFormState=O0,Ja.useActionState=O0,Ja.useOptimistic=function(s,o){var d=$t();return T0(d,rt,s,o)};var Ys={readContext:Qt,use:fc,useCallback:P0,useContext:Qt,useEffect:ch,useImperativeHandle:U0,useInsertionEffect:L0,useLayoutEffect:B0,useMemo:z0,useReducer:oh,useRef:A0,useState:function(){return oh(Sa)},useDebugValue:dh,useDeferredValue:function(s,o){var d=$t();return rt===null?fh(d,s,o):V0(d,rt.memoizedState,s,o)},useTransition:function(){var s=oh(Sa)[0],o=$t().memoizedState;return[typeof s=="boolean"?s:El(s),o]},useSyncExternalStore:x0,useId:j0};Ys.useCacheRefresh=q0,Ys.useMemoCache=sh,Ys.useHostTransitionStatus=ph,Ys.useFormState=F0,Ys.useActionState=F0,Ys.useOptimistic=function(s,o){var d=$t();return rt!==null?T0(d,rt,s,o):(d.baseState=s,[s,d.queue.dispatch])};function gh(s,o,d,h){o=s.memoizedState,d=d(h,o),d=d==null?o:U({},o,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var yh={isMounted:function(s){return(s=s._reactInternals)?le(s)===s:!1},enqueueSetState:function(s,o,d){s=s._reactInternals;var h=Wn(),y=ns(h);y.payload=o,d!=null&&(y.callback=d),o=rs(s,y,h),o!==null&&(yn(o,s,h),_l(o,s,h))},enqueueReplaceState:function(s,o,d){s=s._reactInternals;var h=Wn(),y=ns(h);y.tag=1,y.payload=o,d!=null&&(y.callback=d),o=rs(s,y,h),o!==null&&(yn(o,s,h),_l(o,s,h))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var d=Wn(),h=ns(d);h.tag=2,o!=null&&(h.callback=o),o=rs(s,h,d),o!==null&&(yn(o,s,d),_l(o,s,d))}};function Q0(s,o,d,h,y,C,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,C,E):o.prototype&&o.prototype.isPureReactComponent?!pl(d,h)||!pl(y,C):!0}function Z0(s,o,d,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,h),o.state!==s&&yh.enqueueReplaceState(o,o.state,null)}function Qs(s,o){var d=o;if("ref"in o){d={};for(var h in o)h!=="ref"&&(d[h]=o[h])}if(s=s.defaultProps){d===o&&(d=U({},d));for(var y in s)d[y]===void 0&&(d[y]=s[y])}return d}var yc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function J0(s){yc(s)}function ex(s){console.error(s)}function tx(s){yc(s)}function xc(s,o){try{var d=s.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function nx(s,o,d){try{var h=s.onCaughtError;h(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function xh(s,o,d){return d=ns(d),d.tag=3,d.payload={element:null},d.callback=function(){xc(s,o)},d}function rx(s){return s=ns(s),s.tag=3,s}function ax(s,o,d,h){var y=d.type.getDerivedStateFromError;if(typeof y=="function"){var C=h.value;s.payload=function(){return y(C)},s.callback=function(){nx(o,d,h)}}var E=d.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){nx(o,d,h),typeof y!="function"&&(us===null?us=new Set([this]):us.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})})}function X$(s,o,d,h,y){if(d.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=d.alternate,o!==null&&Rl(o,d,y,!0),d=cr.current,d!==null){switch(d.tag){case 13:return ia===null?Jh():d.alternate===null&&St===0&&(St=3),d.flags&=-257,d.flags|=65536,d.lanes=y,h===Xf?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([h]):o.add(h),tp(s,h,y)),!1;case 22:return d.flags|=65536,h===Xf?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([h]):d.add(h)),tp(s,h,y)),!1}throw Error(r(435,d.tag))}return tp(s,h,y),Jh(),!1}if(Xe)return o=cr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,h!==qf&&(s=Error(r(422),{cause:h}),xl(or(s,d)))):(h!==qf&&(o=Error(r(423),{cause:h}),xl(or(o,d))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,h=or(h,d),y=xh(s.stateNode,h,y),Fh(s,y),St!==4&&(St=2)),!1;var C=Error(r(520),{cause:h});if(C=or(C,d),Ml===null?Ml=[C]:Ml.push(C),St!==4&&(St=2),o===null)return!0;h=or(h,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,s=y&-y,d.lanes|=s,s=xh(d.stateNode,h,s),Fh(d,s),!1;case 1:if(o=d.type,C=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(us===null||!us.has(C))))return d.flags|=65536,y&=-y,d.lanes|=y,y=rx(y),ax(y,s,d,h),Fh(d,y),!1}d=d.return}while(d!==null);return!1}var sx=Error(r(461)),Lt=!1;function jt(s,o,d,h){o.child=s===null?c0(o,null,d,h):js(o,s.child,d,h)}function ix(s,o,d,h,y){d=d.render;var C=o.ref;if("ref"in h){var E={};for(var O in h)O!=="ref"&&(E[O]=h[O])}else E=h;return Js(o),h=th(s,o,d,E,C,y),O=nh(),s!==null&&!Lt?(rh(s,o,y),wa(s,o,y)):(Xe&&O&&Wf(o),o.flags|=1,jt(s,o,h,y),o.child)}function ox(s,o,d,h,y){if(s===null){var C=d.type;return typeof C=="function"&&!zh(C)&&C.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=C,lx(s,o,C,h,y)):(s=wc(d.type,null,h,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(C=s.child,!$h(s,y)){var E=C.memoizedProps;if(d=d.compare,d=d!==null?d:pl,d(E,h)&&s.ref===o.ref)return wa(s,o,y)}return o.flags|=1,s=os(C,h),s.ref=o.ref,s.return=o,o.child=s}function lx(s,o,d,h,y){if(s!==null){var C=s.memoizedProps;if(pl(C,h)&&s.ref===o.ref)if(Lt=!1,o.pendingProps=h=C,$h(s,y))(s.flags&131072)!==0&&(Lt=!0);else return o.lanes=s.lanes,wa(s,o,y)}return bh(s,o,d,h,y)}function ux(s,o,d){var h=o.pendingProps,y=h.children,C=(o.stateNode._pendingVisibility&2)!==0,E=s!==null?s.memoizedState:null;if(Dl(s,o),h.mode==="hidden"||C){if((o.flags&128)!==0){if(h=E!==null?E.baseLanes|d:d,s!==null){for(y=o.child=s.child,C=0;y!==null;)C=C|y.lanes|y.childLanes,y=y.sibling;o.childLanes=C&~h}else o.childLanes=0,o.child=null;return cx(s,o,h,d)}if((d&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&lc(o,E!==null?E.cachePool:null),E!==null?d0(o,E):Kf(),f0(o);else return o.lanes=o.childLanes=536870912,cx(s,o,E!==null?E.baseLanes|d:d,d)}else E!==null?(lc(o,E.cachePool),d0(o,E),Qa(),o.memoizedState=null):(s!==null&&lc(o,null),Kf(),Qa());return jt(s,o,y,d),o.child}function cx(s,o,d,h){var y=Jf();return y=y===null?null:{parent:_t._currentValue,pool:y},o.memoizedState={baseLanes:d,cachePool:y},s!==null&&lc(o,null),Kf(),f0(o),s!==null&&Rl(s,o,h,!0),null}function Dl(s,o){var d=o.ref;if(d===null)s!==null&&s.ref!==null&&(o.flags|=2097664);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(s===null||s.ref!==d)&&(o.flags|=2097664)}}function bh(s,o,d,h,y){return Js(o),d=th(s,o,d,h,void 0,y),h=nh(),s!==null&&!Lt?(rh(s,o,y),wa(s,o,y)):(Xe&&h&&Wf(o),o.flags|=1,jt(s,o,d,y),o.child)}function dx(s,o,d,h,y,C){return Js(o),o.updateQueue=null,d=y0(o,h,d,y),g0(s),h=nh(),s!==null&&!Lt?(rh(s,o,C),wa(s,o,C)):(Xe&&h&&Wf(o),o.flags|=1,jt(s,o,d,C),o.child)}function fx(s,o,d,h,y){if(Js(o),o.stateNode===null){var C=eo,E=d.contextType;typeof E=="object"&&E!==null&&(C=Qt(E)),C=new d(h,C),o.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=yh,o.stateNode=C,C._reactInternals=o,C=o.stateNode,C.props=h,C.state=o.memoizedState,C.refs={},Oh(o),E=d.contextType,C.context=typeof E=="object"&&E!==null?Qt(E):eo,C.state=o.memoizedState,E=d.getDerivedStateFromProps,typeof E=="function"&&(gh(o,d,E,h),C.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(E=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),E!==C.state&&yh.enqueueReplaceState(C,C.state,null),kl(o,h,C,y),Ol(),C.state=o.memoizedState),typeof C.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(s===null){C=o.stateNode;var O=o.memoizedProps,L=Qs(d,O);C.props=L;var W=C.context,ie=d.contextType;E=eo,typeof ie=="object"&&ie!==null&&(E=Qt(ie));var ce=d.getDerivedStateFromProps;ie=typeof ce=="function"||typeof C.getSnapshotBeforeUpdate=="function",O=o.pendingProps!==O,ie||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(O||W!==E)&&Z0(o,C,h,E),ts=!1;var ne=o.memoizedState;C.state=ne,kl(o,h,C,y),Ol(),W=o.memoizedState,O||ne!==W||ts?(typeof ce=="function"&&(gh(o,d,ce,h),W=o.memoizedState),(L=ts||Q0(o,d,L,h,ne,W,E))?(ie||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(o.flags|=4194308)):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=W),C.props=h,C.state=W,C.context=E,h=L):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{C=o.stateNode,kh(s,o),E=o.memoizedProps,ie=Qs(d,E),C.props=ie,ce=o.pendingProps,ne=C.context,W=d.contextType,L=eo,typeof W=="object"&&W!==null&&(L=Qt(W)),O=d.getDerivedStateFromProps,(W=typeof O=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(E!==ce||ne!==L)&&Z0(o,C,h,L),ts=!1,ne=o.memoizedState,C.state=ne,kl(o,h,C,y),Ol();var se=o.memoizedState;E!==ce||ne!==se||ts||s!==null&&s.dependencies!==null&&bc(s.dependencies)?(typeof O=="function"&&(gh(o,d,O,h),se=o.memoizedState),(ie=ts||Q0(o,d,ie,h,ne,se,L)||s!==null&&s.dependencies!==null&&bc(s.dependencies))?(W||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(h,se,L),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(h,se,L)),typeof C.componentDidUpdate=="function"&&(o.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof C.componentDidUpdate!="function"||E===s.memoizedProps&&ne===s.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&ne===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=se),C.props=h,C.state=se,C.context=L,h=ie):(typeof C.componentDidUpdate!="function"||E===s.memoizedProps&&ne===s.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&ne===s.memoizedState||(o.flags|=1024),h=!1)}return C=h,Dl(s,o),h=(o.flags&128)!==0,C||h?(C=o.stateNode,d=h&&typeof d.getDerivedStateFromError!="function"?null:C.render(),o.flags|=1,s!==null&&h?(o.child=js(o,s.child,null,y),o.child=js(o,null,d,y)):jt(s,o,d,y),o.memoizedState=C.state,s=o.child):s=wa(s,o,y),s}function hx(s,o,d,h){return yl(),o.flags|=256,jt(s,o,d,h),o.child}var vh={dehydrated:null,treeContext:null,retryLane:0};function Ch(s){return{baseLanes:s,cachePool:m0()}}function Sh(s,o,d){return s=s!==null?s.childLanes&~d:0,o&&(s|=pr),s}function px(s,o,d){var h=o.pendingProps,y=!1,C=(o.flags&128)!==0,E;if((E=C)||(E=s!==null&&s.memoizedState===null?!1:(Rt.current&2)!==0),E&&(y=!0,o.flags&=-129),E=(o.flags&32)!==0,o.flags&=-33,s===null){if(Xe){if(y?Ya(o):Qa(),Xe){var O=Wt,L;if(L=O){e:{for(L=O,O=sa;L.nodeType!==8;){if(!O){O=null;break e}if(L=Ur(L.nextSibling),L===null){O=null;break e}}O=L}O!==null?(o.memoizedState={dehydrated:O,treeContext:Gs!==null?{id:ba,overflow:va}:null,retryLane:536870912},L=hr(18,null,null,0),L.stateNode=O,L.return=o,o.child=L,gn=o,Wt=null,L=!0):L=!1}L||Ws(o)}if(O=o.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return O.data==="$!"?o.lanes=16:o.lanes=536870912,null;Ca(o)}return O=h.children,h=h.fallback,y?(Qa(),y=o.mode,O=Th({mode:"hidden",children:O},y),h=ti(h,y,d,null),O.return=o,h.return=o,O.sibling=h,o.child=O,y=o.child,y.memoizedState=Ch(d),y.childLanes=Sh(s,E,d),o.memoizedState=vh,h):(Ya(o),wh(o,O))}if(L=s.memoizedState,L!==null&&(O=L.dehydrated,O!==null)){if(C)o.flags&256?(Ya(o),o.flags&=-257,o=Nh(s,o,d)):o.memoizedState!==null?(Qa(),o.child=s.child,o.flags|=128,o=null):(Qa(),y=h.fallback,O=o.mode,h=Th({mode:"visible",children:h.children},O),y=ti(y,O,d,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,js(o,s.child,null,d),h=o.child,h.memoizedState=Ch(d),h.childLanes=Sh(s,E,d),o.memoizedState=vh,o=y);else if(Ya(o),O.data==="$!"){if(E=O.nextSibling&&O.nextSibling.dataset,E)var W=E.dgst;E=W,h=Error(r(419)),h.stack="",h.digest=E,xl({value:h,source:null,stack:null}),o=Nh(s,o,d)}else if(Lt||Rl(s,o,d,!1),E=(d&s.childLanes)!==0,Lt||E){if(E=ot,E!==null){if(h=d&-d,(h&42)!==0)h=1;else switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=64;break;case 268435456:h=134217728;break;default:h=0}if(h=(h&(E.suspendedLanes|d))!==0?0:h,h!==0&&h!==L.retryLane)throw L.retryLane=h,Ka(s,h),yn(E,s,h),sx}O.data==="$?"||Jh(),o=Nh(s,o,d)}else O.data==="$?"?(o.flags|=128,o.child=s.child,o=uD.bind(null,s),O._reactRetry=o,o=null):(s=L.treeContext,Wt=Ur(O.nextSibling),gn=o,Xe=!0,Br=null,sa=!1,s!==null&&(lr[ur++]=ba,lr[ur++]=va,lr[ur++]=Gs,ba=s.id,va=s.overflow,Gs=o),o=wh(o,h.children),o.flags|=4096);return o}return y?(Qa(),y=h.fallback,O=o.mode,L=s.child,W=L.sibling,h=os(L,{mode:"hidden",children:h.children}),h.subtreeFlags=L.subtreeFlags&31457280,W!==null?y=os(W,y):(y=ti(y,O,d,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,O=s.child.memoizedState,O===null?O=Ch(d):(L=O.cachePool,L!==null?(W=_t._currentValue,L=L.parent!==W?{parent:W,pool:W}:L):L=m0(),O={baseLanes:O.baseLanes|d,cachePool:L}),y.memoizedState=O,y.childLanes=Sh(s,E,d),o.memoizedState=vh,h):(Ya(o),d=s.child,s=d.sibling,d=os(d,{mode:"visible",children:h.children}),d.return=o,d.sibling=null,s!==null&&(E=o.deletions,E===null?(o.deletions=[s],o.flags|=16):E.push(s)),o.child=d,o.memoizedState=null,d)}function wh(s,o){return o=Th({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Th(s,o){return Px(s,o,0,null)}function Nh(s,o,d){return js(o,s.child,null,d),s=wh(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function mx(s,o,d){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),Rh(s.return,o,d)}function Eh(s,o,d,h,y){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:d,tailMode:y}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=h,C.tail=d,C.tailMode=y)}function gx(s,o,d){var h=o.pendingProps,y=h.revealOrder,C=h.tail;if(jt(s,o,h.children,d),h=Rt.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&mx(s,d,o);else if(s.tag===19)mx(s,d,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}switch(De(Rt,h),y){case"forwards":for(d=o.child,y=null;d!==null;)s=d.alternate,s!==null&&oc(s)===null&&(y=d),d=d.sibling;d=y,d===null?(y=o.child,o.child=null):(y=d.sibling,d.sibling=null),Eh(o,!1,y,d,C);break;case"backwards":for(d=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&oc(s)===null){o.child=y;break}s=y.sibling,y.sibling=d,d=y,y=s}Eh(o,!0,d,null,C);break;case"together":Eh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function wa(s,o,d){if(s!==null&&(o.dependencies=s.dependencies),ls|=o.lanes,(d&o.childLanes)===0)if(s!==null){if(Rl(s,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,d=os(s,s.pendingProps),o.child=d,d.return=o;s.sibling!==null;)s=s.sibling,d=d.sibling=os(s,s.pendingProps),d.return=o;d.sibling=null}return o.child}function $h(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&bc(s)))}function K$(s,o,d){switch(o.tag){case 3:ke(o,o.stateNode.containerInfo),es(o,_t,s.memoizedState.cache),yl();break;case 27:case 5:bt(o);break;case 4:ke(o,o.stateNode.containerInfo);break;case 10:es(o,o.type,o.memoizedProps.value);break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(Ya(o),o.flags|=128,null):(d&o.child.childLanes)!==0?px(s,o,d):(Ya(o),s=wa(s,o,d),s!==null?s.sibling:null);Ya(o);break;case 19:var y=(s.flags&128)!==0;if(h=(d&o.childLanes)!==0,h||(Rl(s,o,d,!1),h=(d&o.childLanes)!==0),y){if(h)return gx(s,o,d);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),De(Rt,Rt.current),h)break;return null;case 22:case 23:return o.lanes=0,ux(s,o,d);case 24:es(o,_t,s.memoizedState.cache)}return wa(s,o,d)}function yx(s,o,d){if(s!==null)if(s.memoizedProps!==o.pendingProps)Lt=!0;else{if(!$h(s,d)&&(o.flags&128)===0)return Lt=!1,K$(s,o,d);Lt=(s.flags&131072)!==0}else Lt=!1,Xe&&(o.flags&1048576)!==0&&t0(o,nc,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var h=o.elementType,y=h._init;if(h=y(h._payload),o.type=h,typeof h=="function")zh(h)?(s=Qs(h,s),o.tag=1,o=fx(null,o,h,s,d)):(o.tag=0,o=bh(null,o,h,s,d));else{if(h!=null){if(y=h.$$typeof,y===v){o.tag=11,o=ix(null,o,h,s,d);break e}else if(y===T){o.tag=14,o=ox(null,o,h,s,d);break e}}throw o=K(h)||h,Error(r(306,o,""))}}return o;case 0:return bh(s,o,o.type,o.pendingProps,d);case 1:return h=o.type,y=Qs(h,o.pendingProps),fx(s,o,h,y,d);case 3:e:{if(ke(o,o.stateNode.containerInfo),s===null)throw Error(r(387));var C=o.pendingProps;y=o.memoizedState,h=y.element,kh(s,o),kl(o,C,null,d);var E=o.memoizedState;if(C=E.cache,es(o,_t,C),C!==y.cache&&_h(o,[_t],d,!0),Ol(),C=E.element,y.isDehydrated)if(y={element:C,isDehydrated:!1,cache:E.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=hx(s,o,C,d);break e}else if(C!==h){h=or(Error(r(424)),o),xl(h),o=hx(s,o,C,d);break e}else for(Wt=Ur(o.stateNode.containerInfo.firstChild),gn=o,Xe=!0,Br=null,sa=!0,d=c0(o,null,C,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(yl(),C===h){o=wa(s,o,d);break e}jt(s,o,C,d)}o=o.child}return o;case 26:return Dl(s,o),s===null?(d=v1(o.type,null,o.pendingProps,null))?o.memoizedState=d:Xe||(d=o.type,s=o.pendingProps,h=Ic(Ze.current).createElement(d),h[Yt]=o,h[En]=s,qt(h,d,s),It(h),o.stateNode=h):o.memoizedState=v1(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return bt(o),s===null&&Xe&&(h=o.stateNode=y1(o.type,o.pendingProps,Ze.current),gn=o,sa=!0,Wt=Ur(h.firstChild)),h=o.pendingProps.children,s!==null||Xe?jt(s,o,h,d):o.child=js(o,null,h,d),Dl(s,o),o.child;case 5:return s===null&&Xe&&((y=h=Wt)&&(h=ND(h,o.type,o.pendingProps,sa),h!==null?(o.stateNode=h,gn=o,Wt=Ur(h.firstChild),sa=!1,y=!0):y=!1),y||Ws(o)),bt(o),y=o.type,C=o.pendingProps,E=s!==null?s.memoizedProps:null,h=C.children,hp(y,C)?h=null:E!==null&&hp(y,E)&&(o.flags|=32),o.memoizedState!==null&&(y=th(s,o,V$,null,null,d),ql._currentValue=y),Dl(s,o),jt(s,o,h,d),o.child;case 6:return s===null&&Xe&&((s=d=Wt)&&(d=ED(d,o.pendingProps,sa),d!==null?(o.stateNode=d,gn=o,Wt=null,s=!0):s=!1),s||Ws(o)),null;case 13:return px(s,o,d);case 4:return ke(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=js(o,null,h,d):jt(s,o,h,d),o.child;case 11:return ix(s,o,o.type,o.pendingProps,d);case 7:return jt(s,o,o.pendingProps,d),o.child;case 8:return jt(s,o,o.pendingProps.children,d),o.child;case 12:return jt(s,o,o.pendingProps.children,d),o.child;case 10:return h=o.pendingProps,es(o,o.type,h.value),jt(s,o,h.children,d),o.child;case 9:return y=o.type._context,h=o.pendingProps.children,Js(o),y=Qt(y),h=h(y),o.flags|=1,jt(s,o,h,d),o.child;case 14:return ox(s,o,o.type,o.pendingProps,d);case 15:return lx(s,o,o.type,o.pendingProps,d);case 19:return gx(s,o,d);case 22:return ux(s,o,d);case 24:return Js(o),h=Qt(_t),s===null?(y=Jf(),y===null&&(y=ot,C=Qf(),y.pooledCache=C,C.refCount++,C!==null&&(y.pooledCacheLanes|=d),y=C),o.memoizedState={parent:h,cache:y},Oh(o),es(o,_t,y)):((s.lanes&d)!==0&&(kh(s,o),kl(o,null,null,d),Ol()),y=s.memoizedState,C=o.memoizedState,y.parent!==h?(y={parent:h,cache:h},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),es(o,_t,h)):(h=C.cache,es(o,_t,h),h!==y.cache&&_h(o,[_t],d,!0))),jt(s,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}var Dh=Se(null),Zs=null,Ta=null;function es(s,o,d){De(Dh,o._currentValue),o._currentValue=d}function Na(s){s._currentValue=Dh.current,Ne(Dh)}function Rh(s,o,d){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===d)break;s=s.return}}function _h(s,o,d,h){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var C=y.dependencies;if(C!==null){var E=y.child;C=C.firstContext;e:for(;C!==null;){var O=C;C=y;for(var L=0;L<o.length;L++)if(O.context===o[L]){C.lanes|=d,O=C.alternate,O!==null&&(O.lanes|=d),Rh(C.return,d,s),h||(E=null);break e}C=O.next}}else if(y.tag===18){if(E=y.return,E===null)throw Error(r(341));E.lanes|=d,C=E.alternate,C!==null&&(C.lanes|=d),Rh(E,d,s),E=null}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===s){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}}function Rl(s,o,d,h){s=null;for(var y=o,C=!1;y!==null;){if(!C){if((y.flags&524288)!==0)C=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var E=y.alternate;if(E===null)throw Error(r(387));if(E=E.memoizedProps,E!==null){var O=y.type;zn(y.pendingProps.value,E.value)||(s!==null?s.push(O):s=[O])}}else if(y===Je.current){if(E=y.alternate,E===null)throw Error(r(387));E.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(ql):s=[ql])}y=y.return}s!==null&&_h(o,s,d,h),o.flags|=262144}function bc(s){for(s=s.firstContext;s!==null;){if(!zn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Js(s){Zs=s,Ta=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qt(s){return xx(Zs,s)}function vc(s,o){return Zs===null&&Js(s),xx(s,o)}function xx(s,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},Ta===null){if(s===null)throw Error(r(308));Ta=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ta=Ta.next=o;return d}var ts=!1;function Oh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kh(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ns(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function rs(s,o,d){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(yt&2)!==0){var y=h.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),h.pending=o,o=ec(s),Jy(s,null,d),o}return Ju(s,h,o,d),ec(s)}function _l(s,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194176)!==0)){var h=o.lanes;h&=s.pendingLanes,d|=h,o.lanes=d,oy(s,d)}}function Fh(s,o){var d=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,d===h)){var y=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var E={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};C===null?y=C=E:C=C.next=E,d=d.next}while(d!==null);C===null?y=C=o:C=C.next=o}else y=C=o;d={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:C,shared:h.shared,callbacks:h.callbacks},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=o:s.next=o,d.lastBaseUpdate=o}var Ah=!1;function Ol(){if(Ah){var s=io;if(s!==null)throw s}}function kl(s,o,d,h){Ah=!1;var y=s.updateQueue;ts=!1;var C=y.firstBaseUpdate,E=y.lastBaseUpdate,O=y.shared.pending;if(O!==null){y.shared.pending=null;var L=O,W=L.next;L.next=null,E===null?C=W:E.next=W,E=L;var ie=s.alternate;ie!==null&&(ie=ie.updateQueue,O=ie.lastBaseUpdate,O!==E&&(O===null?ie.firstBaseUpdate=W:O.next=W,ie.lastBaseUpdate=L))}if(C!==null){var ce=y.baseState;E=0,ie=W=L=null,O=C;do{var ne=O.lane&-536870913,se=ne!==O.lane;if(se?(He&ne)===ne:(h&ne)===ne){ne!==0&&ne===so&&(Ah=!0),ie!==null&&(ie=ie.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ee=s,Oe=O;ne=o;var wt=d;switch(Oe.tag){case 1:if(Ee=Oe.payload,typeof Ee=="function"){ce=Ee.call(wt,ce,ne);break e}ce=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Oe.payload,ne=typeof Ee=="function"?Ee.call(wt,ce,ne):Ee,ne==null)break e;ce=U({},ce,ne);break e;case 2:ts=!0}}ne=O.callback,ne!==null&&(s.flags|=64,se&&(s.flags|=8192),se=y.callbacks,se===null?y.callbacks=[ne]:se.push(ne))}else se={lane:ne,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ie===null?(W=ie=se,L=ce):ie=ie.next=se,E|=ne;if(O=O.next,O===null){if(O=y.shared.pending,O===null)break;se=O,O=se.next,se.next=null,y.lastBaseUpdate=se,y.shared.pending=null}}while(!0);ie===null&&(L=ce),y.baseState=L,y.firstBaseUpdate=W,y.lastBaseUpdate=ie,C===null&&(y.shared.lanes=0),ls|=E,s.lanes=E,s.memoizedState=ce}}function bx(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function vx(s,o){var d=s.callbacks;if(d!==null)for(s.callbacks=null,s=0;s<d.length;s++)bx(d[s],o)}function Fl(s,o){try{var d=o.updateQueue,h=d!==null?d.lastEffect:null;if(h!==null){var y=h.next;d=y;do{if((d.tag&s)===s){h=void 0;var C=d.create,E=d.inst;h=C(),E.destroy=h}d=d.next}while(d!==y)}}catch(O){st(o,o.return,O)}}function as(s,o,d){try{var h=o.updateQueue,y=h!==null?h.lastEffect:null;if(y!==null){var C=y.next;h=C;do{if((h.tag&s)===s){var E=h.inst,O=E.destroy;if(O!==void 0){E.destroy=void 0,y=o;var L=d;try{O()}catch(W){st(y,L,W)}}}h=h.next}while(h!==C)}}catch(W){st(o,o.return,W)}}function Cx(s){var o=s.updateQueue;if(o!==null){var d=s.stateNode;try{vx(o,d)}catch(h){st(s,s.return,h)}}}function Sx(s,o,d){d.props=Qs(s.type,s.memoizedProps),d.state=s.memoizedState;try{d.componentWillUnmount()}catch(h){st(s,o,h)}}function ei(s,o){try{var d=s.ref;if(d!==null){var h=s.stateNode;switch(s.tag){case 26:case 27:case 5:var y=h;break;default:y=h}typeof d=="function"?s.refCleanup=d(y):d.current=y}}catch(C){st(s,o,C)}}function Vn(s,o){var d=s.ref,h=s.refCleanup;if(d!==null)if(typeof h=="function")try{h()}catch(y){st(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(y){st(s,o,y)}else d.current=null}function wx(s){var o=s.type,d=s.memoizedProps,h=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&h.focus();break e;case"img":d.src?h.src=d.src:d.srcSet&&(h.srcset=d.srcSet)}}catch(y){st(s,s.return,y)}}function Tx(s,o,d){try{var h=s.stateNode;vD(h,s.type,d,o),h[En]=o}catch(y){st(s,s.return,y)}}function Nx(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27||s.tag===4}function Ih(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Nx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==27&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lh(s,o,d){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(s,o):d.insertBefore(s,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(s,d)):(o=d,o.appendChild(s)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Ac));else if(h!==4&&h!==27&&(s=s.child,s!==null))for(Lh(s,o,d),s=s.sibling;s!==null;)Lh(s,o,d),s=s.sibling}function Cc(s,o,d){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?d.insertBefore(s,o):d.appendChild(s);else if(h!==4&&h!==27&&(s=s.child,s!==null))for(Cc(s,o,d),s=s.sibling;s!==null;)Cc(s,o,d),s=s.sibling}var Ea=!1,Ct=!1,Bh=!1,Ex=typeof WeakSet=="function"?WeakSet:Set,Bt=null,$x=!1;function Y$(s,o){if(s=s.containerInfo,dp=zc,s=Hy(s),Uf(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var h=d.getSelection&&d.getSelection();if(h&&h.rangeCount!==0){d=h.anchorNode;var y=h.anchorOffset,C=h.focusNode;h=h.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var E=0,O=-1,L=-1,W=0,ie=0,ce=s,ne=null;t:for(;;){for(var se;ce!==d||y!==0&&ce.nodeType!==3||(O=E+y),ce!==C||h!==0&&ce.nodeType!==3||(L=E+h),ce.nodeType===3&&(E+=ce.nodeValue.length),(se=ce.firstChild)!==null;)ne=ce,ce=se;for(;;){if(ce===s)break t;if(ne===d&&++W===y&&(O=E),ne===C&&++ie===h&&(L=E),(se=ce.nextSibling)!==null)break;ce=ne,ne=ce.parentNode}ce=se}d=O===-1||L===-1?null:{start:O,end:L}}else d=null}d=d||{start:0,end:0}}else d=null;for(fp={focusedElem:s,selectionRange:d},zc=!1,Bt=o;Bt!==null;)if(o=Bt,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Bt=s;else for(;Bt!==null;){switch(o=Bt,C=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&C!==null){s=void 0,d=o,y=C.memoizedProps,C=C.memoizedState,h=d.stateNode;try{var Ee=Qs(d.type,y,d.elementType===d.type);s=h.getSnapshotBeforeUpdate(Ee,C),h.__reactInternalSnapshotBeforeUpdate=s}catch(Oe){st(d,d.return,Oe)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,d=s.nodeType,d===9)gp(s);else if(d===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":gp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,Bt=s;break}Bt=o.return}return Ee=$x,$x=!1,Ee}function Dx(s,o,d){var h=d.flags;switch(d.tag){case 0:case 11:case 15:Da(s,d),h&4&&Fl(5,d);break;case 1:if(Da(s,d),h&4)if(s=d.stateNode,o===null)try{s.componentDidMount()}catch(O){st(d,d.return,O)}else{var y=Qs(d.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(O){st(d,d.return,O)}}h&64&&Cx(d),h&512&&ei(d,d.return);break;case 3:if(Da(s,d),h&64&&(h=d.updateQueue,h!==null)){if(s=null,d.child!==null)switch(d.child.tag){case 27:case 5:s=d.child.stateNode;break;case 1:s=d.child.stateNode}try{vx(h,s)}catch(O){st(d,d.return,O)}}break;case 26:Da(s,d),h&512&&ei(d,d.return);break;case 27:case 5:Da(s,d),o===null&&h&4&&wx(d),h&512&&ei(d,d.return);break;case 12:Da(s,d);break;case 13:Da(s,d),h&4&&Ox(s,d);break;case 22:if(y=d.memoizedState!==null||Ea,!y){o=o!==null&&o.memoizedState!==null||Ct;var C=Ea,E=Ct;Ea=y,(Ct=o)&&!E?ss(s,d,(d.subtreeFlags&8772)!==0):Da(s,d),Ea=C,Ct=E}h&512&&(d.memoizedProps.mode==="manual"?ei(d,d.return):Vn(d,d.return));break;default:Da(s,d)}}function Rx(s){var o=s.alternate;o!==null&&(s.alternate=null,Rx(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&wf(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Dt=null,Gn=!1;function $a(s,o,d){for(d=d.child;d!==null;)_x(s,o,d),d=d.sibling}function _x(s,o,d){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(ga,d)}catch{}switch(d.tag){case 26:Ct||Vn(d,o),$a(s,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ct||Vn(d,o);var h=Dt,y=Gn;for(Dt=d.stateNode,$a(s,o,d),d=d.stateNode,o=d.attributes;o.length;)d.removeAttributeNode(o[0]);wf(d),Dt=h,Gn=y;break;case 5:Ct||Vn(d,o);case 6:y=Dt;var C=Gn;if(Dt=null,$a(s,o,d),Dt=y,Gn=C,Dt!==null)if(Gn)try{s=Dt,h=d.stateNode,s.nodeType===8?s.parentNode.removeChild(h):s.removeChild(h)}catch(E){st(d,o,E)}else try{Dt.removeChild(d.stateNode)}catch(E){st(d,o,E)}break;case 18:Dt!==null&&(Gn?(o=Dt,d=d.stateNode,o.nodeType===8?mp(o.parentNode,d):o.nodeType===1&&mp(o,d),Ql(o)):mp(Dt,d.stateNode));break;case 4:h=Dt,y=Gn,Dt=d.stateNode.containerInfo,Gn=!0,$a(s,o,d),Dt=h,Gn=y;break;case 0:case 11:case 14:case 15:Ct||as(2,d,o),Ct||as(4,d,o),$a(s,o,d);break;case 1:Ct||(Vn(d,o),h=d.stateNode,typeof h.componentWillUnmount=="function"&&Sx(d,o,h)),$a(s,o,d);break;case 21:$a(s,o,d);break;case 22:Ct||Vn(d,o),Ct=(h=Ct)||d.memoizedState!==null,$a(s,o,d),Ct=h;break;default:$a(s,o,d)}}function Ox(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ql(s)}catch(d){st(o,o.return,d)}}function Q$(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Ex),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Ex),o;default:throw Error(r(435,s.tag))}}function Mh(s,o){var d=Q$(s);o.forEach(function(h){var y=cD.bind(null,s,h);d.has(h)||(d.add(h),h.then(y,y))})}function dr(s,o){var d=o.deletions;if(d!==null)for(var h=0;h<d.length;h++){var y=d[h],C=s,E=o,O=E;e:for(;O!==null;){switch(O.tag){case 27:case 5:Dt=O.stateNode,Gn=!1;break e;case 3:Dt=O.stateNode.containerInfo,Gn=!0;break e;case 4:Dt=O.stateNode.containerInfo,Gn=!0;break e}O=O.return}if(Dt===null)throw Error(r(160));_x(C,E,y),Dt=null,Gn=!1,C=y.alternate,C!==null&&(C.return=null),y.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)kx(o,s),o=o.sibling}var Mr=null;function kx(s,o){var d=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:dr(o,s),fr(s),h&4&&(as(3,s,s.return),Fl(3,s),as(5,s,s.return));break;case 1:dr(o,s),fr(s),h&512&&(Ct||d===null||Vn(d,d.return)),h&64&&Ea&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(d=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=d===null?h:d.concat(h))));break;case 26:var y=Mr;if(dr(o,s),fr(s),h&512&&(Ct||d===null||Vn(d,d.return)),h&4){var C=d!==null?d.memoizedState:null;if(h=s.memoizedState,d===null)if(h===null)if(s.stateNode===null){e:{h=s.type,d=s.memoizedProps,y=y.ownerDocument||y;t:switch(h){case"title":C=y.getElementsByTagName("title")[0],(!C||C[sl]||C[Yt]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=y.createElement(h),y.head.insertBefore(C,y.querySelector("head > title"))),qt(C,h,d),C[Yt]=s,It(C),h=C;break e;case"link":var E=w1("link","href",y).get(h+(d.href||""));if(E){for(var O=0;O<E.length;O++)if(C=E[O],C.getAttribute("href")===(d.href==null?null:d.href)&&C.getAttribute("rel")===(d.rel==null?null:d.rel)&&C.getAttribute("title")===(d.title==null?null:d.title)&&C.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){E.splice(O,1);break t}}C=y.createElement(h),qt(C,h,d),y.head.appendChild(C);break;case"meta":if(E=w1("meta","content",y).get(h+(d.content||""))){for(O=0;O<E.length;O++)if(C=E[O],C.getAttribute("content")===(d.content==null?null:""+d.content)&&C.getAttribute("name")===(d.name==null?null:d.name)&&C.getAttribute("property")===(d.property==null?null:d.property)&&C.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&C.getAttribute("charset")===(d.charSet==null?null:d.charSet)){E.splice(O,1);break t}}C=y.createElement(h),qt(C,h,d),y.head.appendChild(C);break;default:throw Error(r(468,h))}C[Yt]=s,It(C),h=C}s.stateNode=h}else T1(y,s.type,s.stateNode);else s.stateNode=S1(y,h,s.memoizedProps);else C!==h?(C===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):C.count--,h===null?T1(y,s.type,s.stateNode):S1(y,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Tx(s,s.memoizedProps,d.memoizedProps)}break;case 27:if(h&4&&s.alternate===null){y=s.stateNode,C=s.memoizedProps;try{for(var L=y.firstChild;L;){var W=L.nextSibling,ie=L.nodeName;L[sl]||ie==="HEAD"||ie==="BODY"||ie==="SCRIPT"||ie==="STYLE"||ie==="LINK"&&L.rel.toLowerCase()==="stylesheet"||y.removeChild(L),L=W}for(var ce=s.type,ne=y.attributes;ne.length;)y.removeAttributeNode(ne[0]);qt(y,ce,C),y[Yt]=s,y[En]=C}catch(Ee){st(s,s.return,Ee)}}case 5:if(dr(o,s),fr(s),h&512&&(Ct||d===null||Vn(d,d.return)),s.flags&32){y=s.stateNode;try{qi(y,"")}catch(Ee){st(s,s.return,Ee)}}h&4&&s.stateNode!=null&&(y=s.memoizedProps,Tx(s,y,d!==null?d.memoizedProps:y)),h&1024&&(Bh=!0);break;case 6:if(dr(o,s),fr(s),h&4){if(s.stateNode===null)throw Error(r(162));h=s.memoizedProps,d=s.stateNode;try{d.nodeValue=h}catch(Ee){st(s,s.return,Ee)}}break;case 3:if(Mc=null,y=Mr,Mr=Lc(o.containerInfo),dr(o,s),Mr=y,fr(s),h&4&&d!==null&&d.memoizedState.isDehydrated)try{Ql(o.containerInfo)}catch(Ee){st(s,s.return,Ee)}Bh&&(Bh=!1,Fx(s));break;case 4:h=Mr,Mr=Lc(s.stateNode.containerInfo),dr(o,s),fr(s),Mr=h;break;case 12:dr(o,s),fr(s);break;case 13:dr(o,s),fr(s),s.child.flags&8192&&s.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(qh=vt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Mh(s,h)));break;case 22:if(h&512&&(Ct||d===null||Vn(d,d.return)),L=s.memoizedState!==null,W=d!==null&&d.memoizedState!==null,ie=Ea,ce=Ct,Ea=ie||L,Ct=ce||W,dr(o,s),Ct=ce,Ea=ie,fr(s),o=s.stateNode,o._current=s,o._visibility&=-3,o._visibility|=o._pendingVisibility&2,h&8192&&(o._visibility=L?o._visibility&-2:o._visibility|1,L&&(o=Ea||Ct,d===null||W||o||co(s)),s.memoizedProps===null||s.memoizedProps.mode!=="manual"))e:for(d=null,o=s;;){if(o.tag===5||o.tag===26||o.tag===27){if(d===null){W=d=o;try{if(y=W.stateNode,L)C=y.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{E=W.stateNode,O=W.memoizedProps.style;var se=O!=null&&O.hasOwnProperty("display")?O.display:null;E.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Ee){st(W,W.return,Ee)}}}else if(o.tag===6){if(d===null){W=o;try{W.stateNode.nodeValue=L?"":W.memoizedProps}catch(Ee){st(W,W.return,Ee)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=s.updateQueue,h!==null&&(d=h.retryQueue,d!==null&&(h.retryQueue=null,Mh(s,d))));break;case 19:dr(o,s),fr(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Mh(s,h)));break;case 21:break;default:dr(o,s),fr(s)}}function fr(s){var o=s.flags;if(o&2){try{if(s.tag!==27){e:{for(var d=s.return;d!==null;){if(Nx(d)){var h=d;break e}d=d.return}throw Error(r(160))}switch(h.tag){case 27:var y=h.stateNode,C=Ih(s);Cc(s,C,y);break;case 5:var E=h.stateNode;h.flags&32&&(qi(E,""),h.flags&=-33);var O=Ih(s);Cc(s,O,E);break;case 3:case 4:var L=h.stateNode.containerInfo,W=Ih(s);Lh(s,W,L);break;default:throw Error(r(161))}}}catch(ie){st(s,s.return,ie)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Fx(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Fx(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Da(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Dx(s,o.alternate,o),o=o.sibling}function co(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:as(4,o,o.return),co(o);break;case 1:Vn(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&Sx(o,o.return,d),co(o);break;case 26:case 27:case 5:Vn(o,o.return),co(o);break;case 22:Vn(o,o.return),o.memoizedState===null&&co(o);break;default:co(o)}s=s.sibling}}function ss(s,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,y=s,C=o,E=C.flags;switch(C.tag){case 0:case 11:case 15:ss(y,C,d),Fl(4,C);break;case 1:if(ss(y,C,d),h=C,y=h.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(W){st(h,h.return,W)}if(h=C,y=h.updateQueue,y!==null){var O=h.stateNode;try{var L=y.shared.hiddenCallbacks;if(L!==null)for(y.shared.hiddenCallbacks=null,y=0;y<L.length;y++)bx(L[y],O)}catch(W){st(h,h.return,W)}}d&&E&64&&Cx(C),ei(C,C.return);break;case 26:case 27:case 5:ss(y,C,d),d&&h===null&&E&4&&wx(C),ei(C,C.return);break;case 12:ss(y,C,d);break;case 13:ss(y,C,d),d&&E&4&&Ox(y,C);break;case 22:C.memoizedState===null&&ss(y,C,d),ei(C,C.return);break;default:ss(y,C,d)}o=o.sibling}}function Uh(s,o){var d=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==d&&(s!=null&&s.refCount++,d!=null&&wl(d))}function Ph(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&wl(s))}function is(s,o,d,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Ax(s,o,d,h),o=o.sibling}function Ax(s,o,d,h){var y=o.flags;switch(o.tag){case 0:case 11:case 15:is(s,o,d,h),y&2048&&Fl(9,o);break;case 3:is(s,o,d,h),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&wl(s)));break;case 12:if(y&2048){is(s,o,d,h),s=o.stateNode;try{var C=o.memoizedProps,E=C.id,O=C.onPostCommit;typeof O=="function"&&O(E,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(L){st(o,o.return,L)}}else is(s,o,d,h);break;case 23:break;case 22:C=o.stateNode,o.memoizedState!==null?C._visibility&4?is(s,o,d,h):Al(s,o):C._visibility&4?is(s,o,d,h):(C._visibility|=4,fo(s,o,d,h,(o.subtreeFlags&10256)!==0)),y&2048&&Uh(o.alternate,o);break;case 24:is(s,o,d,h),y&2048&&Ph(o.alternate,o);break;default:is(s,o,d,h)}}function fo(s,o,d,h,y){for(y=y&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var C=s,E=o,O=d,L=h,W=E.flags;switch(E.tag){case 0:case 11:case 15:fo(C,E,O,L,y),Fl(8,E);break;case 23:break;case 22:var ie=E.stateNode;E.memoizedState!==null?ie._visibility&4?fo(C,E,O,L,y):Al(C,E):(ie._visibility|=4,fo(C,E,O,L,y)),y&&W&2048&&Uh(E.alternate,E);break;case 24:fo(C,E,O,L,y),y&&W&2048&&Ph(E.alternate,E);break;default:fo(C,E,O,L,y)}o=o.sibling}}function Al(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=s,h=o,y=h.flags;switch(h.tag){case 22:Al(d,h),y&2048&&Uh(h.alternate,h);break;case 24:Al(d,h),y&2048&&Ph(h.alternate,h);break;default:Al(d,h)}o=o.sibling}}var Il=8192;function ho(s){if(s.subtreeFlags&Il)for(s=s.child;s!==null;)Ix(s),s=s.sibling}function Ix(s){switch(s.tag){case 26:ho(s),s.flags&Il&&s.memoizedState!==null&&UD(Mr,s.memoizedState,s.memoizedProps);break;case 5:ho(s);break;case 3:case 4:var o=Mr;Mr=Lc(s.stateNode.containerInfo),ho(s),Mr=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=Il,Il=16777216,ho(s),Il=o):ho(s));break;default:ho(s)}}function Lx(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function Ll(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var h=o[d];Bt=h,Mx(h,s)}Lx(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Bx(s),s=s.sibling}function Bx(s){switch(s.tag){case 0:case 11:case 15:Ll(s),s.flags&2048&&as(9,s,s.return);break;case 3:Ll(s);break;case 12:Ll(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&4&&(s.return===null||s.return.tag!==13)?(o._visibility&=-5,Sc(s)):Ll(s);break;default:Ll(s)}}function Sc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var h=o[d];Bt=h,Mx(h,s)}Lx(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:as(8,o,o.return),Sc(o);break;case 22:d=o.stateNode,d._visibility&4&&(d._visibility&=-5,Sc(o));break;default:Sc(o)}s=s.sibling}}function Mx(s,o){for(;Bt!==null;){var d=Bt;switch(d.tag){case 0:case 11:case 15:as(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var h=d.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:wl(d.memoizedState.cache)}if(h=d.child,h!==null)h.return=d,Bt=h;else e:for(d=s;Bt!==null;){h=Bt;var y=h.sibling,C=h.return;if(Rx(h),h===d){Bt=null;break e}if(y!==null){y.return=C,Bt=y;break e}Bt=C}}}function Z$(s,o,d,h){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(s,o,d,h){return new Z$(s,o,d,h)}function zh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function os(s,o){var d=s.alternate;return d===null?(d=hr(s.tag,o,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=o,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&31457280,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,o=s.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d.refCleanup=s.refCleanup,d}function Ux(s,o){s.flags&=31457282;var d=s.alternate;return d===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=d.childLanes,s.lanes=d.lanes,s.child=d.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=d.memoizedProps,s.memoizedState=d.memoizedState,s.updateQueue=d.updateQueue,s.type=d.type,o=d.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function wc(s,o,d,h,y,C){var E=0;if(h=s,typeof s=="function")zh(s)&&(E=1);else if(typeof s=="string")E=BD(s,d,Le.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case c:return ti(d.children,y,C,o);case f:E=8,y|=24;break;case p:return s=hr(12,d,o,y|2),s.elementType=p,s.lanes=C,s;case w:return s=hr(13,d,o,y),s.elementType=w,s.lanes=C,s;case S:return s=hr(19,d,o,y),s.elementType=S,s.lanes=C,s;case D:return Px(d,y,C,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case m:case x:E=10;break e;case g:E=9;break e;case v:E=11;break e;case T:E=14;break e;case $:E=16,h=null;break e}E=29,d=Error(r(130,s===null?"null":typeof s,"")),h=null}return o=hr(E,d,o,y),o.elementType=s,o.type=h,o.lanes=C,o}function ti(s,o,d,h){return s=hr(7,s,h,o),s.lanes=d,s}function Px(s,o,d,h){s=hr(22,s,h,o),s.elementType=D,s.lanes=d;var y={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var C=y._current;if(C===null)throw Error(r(456));if((y._pendingVisibility&2)===0){var E=Ka(C,2);E!==null&&(y._pendingVisibility|=2,yn(E,C,2))}},attach:function(){var C=y._current;if(C===null)throw Error(r(456));if((y._pendingVisibility&2)!==0){var E=Ka(C,2);E!==null&&(y._pendingVisibility&=-3,yn(E,C,2))}}};return s.stateNode=y,s}function Vh(s,o,d){return s=hr(6,s,null,o),s.lanes=d,s}function Gh(s,o,d){return o=hr(4,s.children!==null?s.children:[],s.key,o),o.lanes=d,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function Ra(s){s.flags|=4}function zx(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!N1(o)){if(o=cr.current,o!==null&&((He&4194176)===He?ia!==null:(He&62914560)!==He&&(He&536870912)===0||o!==ia))throw vl=Xf,a0;s.flags|=8192}}function Tc(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?sy():536870912,s.lanes|=o,mo|=o)}function Bl(s,o){if(!Xe)switch(s.tailMode){case"hidden":o=s.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var h=null;d!==null;)d.alternate!==null&&(h=d),d=d.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function gt(s){var o=s.alternate!==null&&s.alternate.child===s.child,d=0,h=0;if(o)for(var y=s.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags&31457280,h|=y.flags&31457280,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)d|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=h,s.childLanes=d,o}function J$(s,o,d){var h=o.pendingProps;switch(jf(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(o),null;case 1:return gt(o),null;case 3:return d=o.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Na(_t),nt(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(s===null||s.child===null)&&(gl(o)?Ra(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Br!==null&&(Qh(Br),Br=null))),gt(o),null;case 26:return d=o.memoizedState,s===null?(Ra(o),d!==null?(gt(o),zx(o,d)):(gt(o),o.flags&=-16777217)):d?d!==s.memoizedState?(Ra(o),gt(o),zx(o,d)):(gt(o),o.flags&=-16777217):(s.memoizedProps!==h&&Ra(o),gt(o),o.flags&=-16777217),null;case 27:At(o),d=Ze.current;var y=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Ra(o);else{if(!h){if(o.stateNode===null)throw Error(r(166));return gt(o),null}s=Le.current,gl(o)?n0(o):(s=y1(y,h,d),o.stateNode=s,Ra(o))}return gt(o),null;case 5:if(At(o),d=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Ra(o);else{if(!h){if(o.stateNode===null)throw Error(r(166));return gt(o),null}if(s=Le.current,gl(o))n0(o);else{switch(y=Ic(Ze.current),s){case 1:s=y.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:s=y.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":s=y.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":s=y.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":s=y.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof h.is=="string"?y.createElement("select",{is:h.is}):y.createElement("select"),h.multiple?s.multiple=!0:h.size&&(s.size=h.size);break;default:s=typeof h.is=="string"?y.createElement(d,{is:h.is}):y.createElement(d)}}s[Yt]=o,s[En]=h;e:for(y=o.child;y!==null;){if(y.tag===5||y.tag===6)s.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===o)break e;for(;y.sibling===null;){if(y.return===null||y.return===o)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}o.stateNode=s;e:switch(qt(s,d,h),d){case"button":case"input":case"select":case"textarea":s=!!h.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ra(o)}}return gt(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==h&&Ra(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(r(166));if(s=Ze.current,gl(o)){if(s=o.stateNode,d=o.memoizedProps,h=null,y=gn,y!==null)switch(y.tag){case 27:case 5:h=y.memoizedProps}s[Yt]=o,s=!!(s.nodeValue===d||h!==null&&h.suppressHydrationWarning===!0||d1(s.nodeValue,d)),s||Ws(o)}else s=Ic(s).createTextNode(h),s[Yt]=o,o.stateNode=s}return gt(o),null;case 13:if(h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=gl(o),h!==null&&h.dehydrated!==null){if(s===null){if(!y)throw Error(r(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[Yt]=o}else yl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;gt(o),y=!1}else Br!==null&&(Qh(Br),Br=null),y=!0;if(!y)return o.flags&256?(Ca(o),o):(Ca(o),null)}if(Ca(o),(o.flags&128)!==0)return o.lanes=d,o;if(d=h!==null,s=s!==null&&s.memoizedState!==null,d){h=o.child,y=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(y=h.alternate.memoizedState.cachePool.pool);var C=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(C=h.memoizedState.cachePool.pool),C!==y&&(h.flags|=2048)}return d!==s&&d&&(o.child.flags|=8192),Tc(o,o.updateQueue),gt(o),null;case 4:return nt(),s===null&&lp(o.stateNode.containerInfo),gt(o),null;case 10:return Na(o.type),gt(o),null;case 19:if(Ne(Rt),y=o.memoizedState,y===null)return gt(o),null;if(h=(o.flags&128)!==0,C=y.rendering,C===null)if(h)Bl(y,!1);else{if(St!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(C=oc(s),C!==null){for(o.flags|=128,Bl(y,!1),s=C.updateQueue,o.updateQueue=s,Tc(o,s),o.subtreeFlags=0,s=d,d=o.child;d!==null;)Ux(d,s),d=d.sibling;return De(Rt,Rt.current&1|2),o.child}s=s.sibling}y.tail!==null&&vt()>Nc&&(o.flags|=128,h=!0,Bl(y,!1),o.lanes=4194304)}else{if(!h)if(s=oc(C),s!==null){if(o.flags|=128,h=!0,s=s.updateQueue,o.updateQueue=s,Tc(o,s),Bl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!C.alternate&&!Xe)return gt(o),null}else 2*vt()-y.renderingStartTime>Nc&&d!==536870912&&(o.flags|=128,h=!0,Bl(y,!1),o.lanes=4194304);y.isBackwards?(C.sibling=o.child,o.child=C):(s=y.last,s!==null?s.sibling=C:o.child=C,y.last=C)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=vt(),o.sibling=null,s=Rt.current,De(Rt,h?s&1|2:s&1),o):(gt(o),null);case 22:case 23:return Ca(o),Yf(),h=o.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(d&536870912)!==0&&(o.flags&128)===0&&(gt(o),o.subtreeFlags&6&&(o.flags|=8192)):gt(o),d=o.updateQueue,d!==null&&Tc(o,d.retryQueue),d=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==d&&(o.flags|=2048),s!==null&&Ne(qs),null;case 24:return d=null,s!==null&&(d=s.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),Na(_t),gt(o),null;case 25:return null}throw Error(r(156,o.tag))}function eD(s,o){switch(jf(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Na(_t),nt(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return At(o),null;case 13:if(Ca(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));yl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return Ne(Rt),null;case 4:return nt(),null;case 10:return Na(o.type),null;case 22:case 23:return Ca(o),Yf(),s!==null&&Ne(qs),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Na(_t),null;case 25:return null;default:return null}}function Vx(s,o){switch(jf(o),o.tag){case 3:Na(_t),nt();break;case 26:case 27:case 5:At(o);break;case 4:nt();break;case 13:Ca(o);break;case 19:Ne(Rt);break;case 10:Na(o.type);break;case 22:case 23:Ca(o),Yf(),s!==null&&Ne(qs);break;case 24:Na(_t)}}var tD={getCacheForType:function(s){var o=Qt(_t),d=o.data.get(s);return d===void 0&&(d=s(),o.data.set(s,d)),d}},nD=typeof WeakMap=="function"?WeakMap:Map,yt=0,ot=null,Pe=null,He=0,lt=0,Hn=null,_a=!1,po=!1,Hh=!1,Oa=0,St=0,ls=0,ni=0,Wh=0,pr=0,mo=0,Ml=null,la=null,jh=!1,qh=0,Nc=1/0,Ec=null,us=null,$c=!1,ri=null,Ul=0,Xh=0,Kh=null,Pl=0,Yh=null;function Wn(){if((yt&2)!==0&&He!==0)return He&-He;if(B.T!==null){var s=so;return s!==0?s:ap()}return uy()}function Gx(){pr===0&&(pr=(He&536870912)===0||Xe?ay():536870912);var s=cr.current;return s!==null&&(s.flags|=32),pr}function yn(s,o,d){(s===ot&&lt===2||s.cancelPendingCommit!==null)&&(go(s,0),ka(s,He,pr,!1)),al(s,d),((yt&2)===0||s!==ot)&&(s===ot&&((yt&2)===0&&(ni|=d),St===4&&ka(s,He,pr,!1)),ua(s))}function Hx(s,o,d){if((yt&6)!==0)throw Error(r(327));var h=!d&&(o&60)===0&&(o&s.expiredLanes)===0||rl(s,o),y=h?sD(s,o):ep(s,o,!0),C=h;do{if(y===0){po&&!h&&ka(s,o,0,!1);break}else if(y===6)ka(s,o,0,!_a);else{if(d=s.current.alternate,C&&!rD(d)){y=ep(s,o,!1),C=!1;continue}if(y===2){if(C=o,s.errorRecoveryDisabledLanes&C)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){o=E;e:{var O=s;y=Ml;var L=O.current.memoizedState.isDehydrated;if(L&&(go(O,E).flags|=256),E=ep(O,E,!1),E!==2){if(Hh&&!L){O.errorRecoveryDisabledLanes|=C,ni|=C,y=4;break e}C=la,la=y,C!==null&&Qh(C)}y=E}if(C=!1,y!==2)continue}}if(y===1){go(s,0),ka(s,o,0,!0);break}e:{switch(h=s,y){case 0:case 1:throw Error(r(345));case 4:if((o&4194176)===o){ka(h,o,pr,!_a);break e}break;case 2:la=null;break;case 3:case 5:break;default:throw Error(r(329))}if(h.finishedWork=d,h.finishedLanes=o,(o&62914560)===o&&(C=qh+300-vt(),10<C)){if(ka(h,o,pr,!_a),Pu(h,0)!==0)break e;h.timeoutHandle=p1(Wx.bind(null,h,d,la,Ec,jh,o,pr,ni,mo,_a,2,-0,0),C);break e}Wx(h,d,la,Ec,jh,o,pr,ni,mo,_a,0,-0,0)}}break}while(!0);ua(s)}function Qh(s){la===null?la=s:la.push.apply(la,s)}function Wx(s,o,d,h,y,C,E,O,L,W,ie,ce,ne){var se=o.subtreeFlags;if((se&8192||(se&16785408)===16785408)&&(jl={stylesheets:null,count:0,unsuspend:MD},Ix(o),o=PD(),o!==null)){s.cancelPendingCommit=o(Zx.bind(null,s,d,h,y,E,O,L,1,ce,ne)),ka(s,C,E,!W);return}Zx(s,d,h,y,E,O,L,ie,ce,ne)}function rD(s){for(var o=s;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var h=0;h<d.length;h++){var y=d[h],C=y.getSnapshot;y=y.value;try{if(!zn(C(),y))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ka(s,o,d,h){o&=~Wh,o&=~ni,s.suspendedLanes|=o,s.pingedLanes&=~o,h&&(s.warmLanes|=o),h=s.expirationTimes;for(var y=o;0<y;){var C=31-Pn(y),E=1<<C;h[C]=-1,y&=~E}d!==0&&iy(s,d,o)}function Dc(){return(yt&6)===0?(zl(0),!1):!0}function Zh(){if(Pe!==null){if(lt===0)var s=Pe.return;else s=Pe,Ta=Zs=null,ah(s),ro=null,Cl=0,s=Pe;for(;s!==null;)Vx(s.alternate,s),s=s.return;Pe=null}}function go(s,o){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;d!==-1&&(s.timeoutHandle=-1,SD(d)),d=s.cancelPendingCommit,d!==null&&(s.cancelPendingCommit=null,d()),Zh(),ot=s,Pe=d=os(s.current,null),He=o,lt=0,Hn=null,_a=!1,po=rl(s,o),Hh=!1,mo=pr=Wh=ni=ls=St=0,la=Ml=null,jh=!1,(o&8)!==0&&(o|=o&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=o;0<h;){var y=31-Pn(h),C=1<<y;o|=s[y],h&=~C}return Oa=o,Zu(),d}function jx(s,o){Be=null,B.H=oa,o===bl?(o=o0(),lt=3):o===a0?(o=o0(),lt=4):lt=o===sx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Hn=o,Pe===null&&(St=1,xc(s,or(o,s.current)))}function qx(){var s=B.H;return B.H=oa,s===null?oa:s}function Xx(){var s=B.A;return B.A=tD,s}function Jh(){St=4,_a||(He&4194176)!==He&&cr.current!==null||(po=!0),(ls&134217727)===0&&(ni&134217727)===0||ot===null||ka(ot,He,pr,!1)}function ep(s,o,d){var h=yt;yt|=2;var y=qx(),C=Xx();(ot!==s||He!==o)&&(Ec=null,go(s,o)),o=!1;var E=St;e:do try{if(lt!==0&&Pe!==null){var O=Pe,L=Hn;switch(lt){case 8:Zh(),E=6;break e;case 3:case 2:case 6:cr.current===null&&(o=!0);var W=lt;if(lt=0,Hn=null,yo(s,O,L,W),d&&po){E=0;break e}break;default:W=lt,lt=0,Hn=null,yo(s,O,L,W)}}aD(),E=St;break}catch(ie){jx(s,ie)}while(!0);return o&&s.shellSuspendCounter++,Ta=Zs=null,yt=h,B.H=y,B.A=C,Pe===null&&(ot=null,He=0,Zu()),E}function aD(){for(;Pe!==null;)Kx(Pe)}function sD(s,o){var d=yt;yt|=2;var h=qx(),y=Xx();ot!==s||He!==o?(Ec=null,Nc=vt()+500,go(s,o)):po=rl(s,o);e:do try{if(lt!==0&&Pe!==null){o=Pe;var C=Hn;t:switch(lt){case 1:lt=0,Hn=null,yo(s,o,C,1);break;case 2:if(s0(C)){lt=0,Hn=null,Yx(o);break}o=function(){lt===2&&ot===s&&(lt=7),ua(s)},C.then(o,o);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:s0(C)?(lt=0,Hn=null,Yx(o)):(lt=0,Hn=null,yo(s,o,C,7));break;case 5:var E=null;switch(Pe.tag){case 26:E=Pe.memoizedState;case 5:case 27:var O=Pe;if(!E||N1(E)){lt=0,Hn=null;var L=O.sibling;if(L!==null)Pe=L;else{var W=O.return;W!==null?(Pe=W,Rc(W)):Pe=null}break t}}lt=0,Hn=null,yo(s,o,C,5);break;case 6:lt=0,Hn=null,yo(s,o,C,6);break;case 8:Zh(),St=6;break e;default:throw Error(r(462))}}iD();break}catch(ie){jx(s,ie)}while(!0);return Ta=Zs=null,B.H=h,B.A=y,yt=d,Pe!==null?0:(ot=null,He=0,Zu(),St)}function iD(){for(;Pe!==null&&!Kt();)Kx(Pe)}function Kx(s){var o=yx(s.alternate,s,Oa);s.memoizedProps=s.pendingProps,o===null?Rc(s):Pe=o}function Yx(s){var o=s,d=o.alternate;switch(o.tag){case 15:case 0:o=dx(d,o,o.pendingProps,o.type,void 0,He);break;case 11:o=dx(d,o,o.pendingProps,o.type.render,o.ref,He);break;case 5:ah(o);default:Vx(d,o),o=Pe=Ux(o,Oa),o=yx(d,o,Oa)}s.memoizedProps=s.pendingProps,o===null?Rc(s):Pe=o}function yo(s,o,d,h){Ta=Zs=null,ah(o),ro=null,Cl=0;var y=o.return;try{if(X$(s,y,o,d,He)){St=1,xc(s,or(d,s.current)),Pe=null;return}}catch(C){if(y!==null)throw Pe=y,C;St=1,xc(s,or(d,s.current)),Pe=null;return}o.flags&32768?(Xe||h===1?s=!0:po||(He&536870912)!==0?s=!1:(_a=s=!0,(h===2||h===3||h===6)&&(h=cr.current,h!==null&&h.tag===13&&(h.flags|=16384))),Qx(o,s)):Rc(o)}function Rc(s){var o=s;do{if((o.flags&32768)!==0){Qx(o,_a);return}s=o.return;var d=J$(o.alternate,o,Oa);if(d!==null){Pe=d;return}if(o=o.sibling,o!==null){Pe=o;return}Pe=o=s}while(o!==null);St===0&&(St=5)}function Qx(s,o){do{var d=eD(s.alternate,s);if(d!==null){d.flags&=32767,Pe=d;return}if(d=s.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(s=s.sibling,s!==null)){Pe=s;return}Pe=s=d}while(s!==null);St=6,Pe=null}function Zx(s,o,d,h,y,C,E,O,L,W){var ie=B.T,ce=re.p;try{re.p=2,B.T=null,oD(s,o,d,h,ce,y,C,E,O,L,W)}finally{B.T=ie,re.p=ce}}function oD(s,o,d,h,y,C,E,O){do xo();while(ri!==null);if((yt&6)!==0)throw Error(r(327));var L=s.finishedWork;if(h=s.finishedLanes,L===null)return null;if(s.finishedWork=null,s.finishedLanes=0,L===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0,s.cancelPendingCommit=null;var W=L.lanes|L.childLanes;if(W|=Gf,UE(s,h,W,C,E,O),s===ot&&(Pe=ot=null,He=0),(L.subtreeFlags&10256)===0&&(L.flags&10256)===0||$c||($c=!0,Xh=W,Kh=d,dD(nr,function(){return xo(),null})),d=(L.flags&15990)!==0,(L.subtreeFlags&15990)!==0||d?(d=B.T,B.T=null,C=re.p,re.p=2,E=yt,yt|=4,Y$(s,L),kx(L,s),O$(fp,s.containerInfo),zc=!!dp,fp=dp=null,s.current=L,Dx(s,L.alternate,L),pn(),yt=E,re.p=C,B.T=d):s.current=L,$c?($c=!1,ri=s,Ul=h):Jx(s,W),W=s.pendingLanes,W===0&&(us=null),AE(L.stateNode),ua(s),o!==null)for(y=s.onRecoverableError,L=0;L<o.length;L++)W=o[L],y(W.value,{componentStack:W.stack});return(Ul&3)!==0&&xo(),W=s.pendingLanes,(h&4194218)!==0&&(W&42)!==0?s===Yh?Pl++:(Pl=0,Yh=s):Pl=0,zl(0),null}function Jx(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,wl(o)))}function xo(){if(ri!==null){var s=ri,o=Xh;Xh=0;var d=ly(Ul),h=B.T,y=re.p;try{if(re.p=32>d?32:d,B.T=null,ri===null)var C=!1;else{d=Kh,Kh=null;var E=ri,O=Ul;if(ri=null,Ul=0,(yt&6)!==0)throw Error(r(331));var L=yt;if(yt|=4,Bx(E.current),Ax(E,E.current,O,d),yt=L,zl(0,!1),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(ga,E)}catch{}C=!0}return C}finally{re.p=y,B.T=h,Jx(s,o)}}return!1}function e1(s,o,d){o=or(d,o),o=xh(s.stateNode,o,2),s=rs(s,o,2),s!==null&&(al(s,2),ua(s))}function st(s,o,d){if(s.tag===3)e1(s,s,d);else for(;o!==null;){if(o.tag===3){e1(o,s,d);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(us===null||!us.has(h))){s=or(d,s),d=rx(2),h=rs(o,d,2),h!==null&&(ax(d,h,o,s),al(h,2),ua(h));break}}o=o.return}}function tp(s,o,d){var h=s.pingCache;if(h===null){h=s.pingCache=new nD;var y=new Set;h.set(o,y)}else y=h.get(o),y===void 0&&(y=new Set,h.set(o,y));y.has(d)||(Hh=!0,y.add(d),s=lD.bind(null,s,o,d),o.then(s,s))}function lD(s,o,d){var h=s.pingCache;h!==null&&h.delete(o),s.pingedLanes|=s.suspendedLanes&d,s.warmLanes&=~d,ot===s&&(He&d)===d&&(St===4||St===3&&(He&62914560)===He&&300>vt()-qh?(yt&2)===0&&go(s,0):Wh|=d,mo===He&&(mo=0)),ua(s)}function t1(s,o){o===0&&(o=sy()),s=Ka(s,o),s!==null&&(al(s,o),ua(s))}function uD(s){var o=s.memoizedState,d=0;o!==null&&(d=o.retryLane),t1(s,d)}function cD(s,o){var d=0;switch(s.tag){case 13:var h=s.stateNode,y=s.memoizedState;y!==null&&(d=y.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(r(314))}h!==null&&h.delete(o),t1(s,d)}function dD(s,o){return Tn(s,o)}var _c=null,bo=null,np=!1,Oc=!1,rp=!1,ai=0;function ua(s){s!==bo&&s.next===null&&(bo===null?_c=bo=s:bo=bo.next=s),Oc=!0,np||(np=!0,hD(fD))}function zl(s,o){if(!rp&&Oc){rp=!0;do for(var d=!1,h=_c;h!==null;){if(s!==0){var y=h.pendingLanes;if(y===0)var C=0;else{var E=h.suspendedLanes,O=h.pingedLanes;C=(1<<31-Pn(42|s)+1)-1,C&=y&~(E&~O),C=C&201326677?C&201326677|1:C?C|2:0}C!==0&&(d=!0,a1(h,C))}else C=He,C=Pu(h,h===ot?C:0),(C&3)===0||rl(h,C)||(d=!0,a1(h,C));h=h.next}while(d);rp=!1}}function fD(){Oc=np=!1;var s=0;ai!==0&&(CD()&&(s=ai),ai=0);for(var o=vt(),d=null,h=_c;h!==null;){var y=h.next,C=n1(h,o);C===0?(h.next=null,d===null?_c=y:d.next=y,y===null&&(bo=d)):(d=h,(s!==0||(C&3)!==0)&&(Oc=!0)),h=y}zl(s)}function n1(s,o){for(var d=s.suspendedLanes,h=s.pingedLanes,y=s.expirationTimes,C=s.pendingLanes&-62914561;0<C;){var E=31-Pn(C),O=1<<E,L=y[E];L===-1?((O&d)===0||(O&h)!==0)&&(y[E]=ME(O,o)):L<=o&&(s.expiredLanes|=O),C&=~O}if(o=ot,d=He,d=Pu(s,s===o?d:0),h=s.callbackNode,d===0||s===o&&lt===2||s.cancelPendingCommit!==null)return h!==null&&h!==null&&hn(h),s.callbackNode=null,s.callbackPriority=0;if((d&3)===0||rl(s,d)){if(o=d&-d,o===s.callbackPriority)return o;switch(h!==null&&hn(h),ly(d)){case 2:case 8:d=Nn;break;case 32:d=nr;break;case 268435456:d=Ls;break;default:d=nr}return h=r1.bind(null,s),d=Tn(d,h),s.callbackPriority=o,s.callbackNode=d,o}return h!==null&&h!==null&&hn(h),s.callbackPriority=2,s.callbackNode=null,2}function r1(s,o){var d=s.callbackNode;if(xo()&&s.callbackNode!==d)return null;var h=He;return h=Pu(s,s===ot?h:0),h===0?null:(Hx(s,h,o),n1(s,vt()),s.callbackNode!=null&&s.callbackNode===d?r1.bind(null,s):null)}function a1(s,o){if(xo())return null;Hx(s,o,!0)}function hD(s){wD(function(){(yt&6)!==0?Tn(Fe,s):s()})}function ap(){return ai===0&&(ai=ay()),ai}function s1(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Wu(""+s)}function i1(s,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,s.id&&d.setAttribute("form",s.id),o.parentNode.insertBefore(d,o),s=new FormData(s),d.parentNode.removeChild(d),s}function pD(s,o,d,h,y){if(o==="submit"&&d&&d.stateNode===y){var C=s1((y[En]||null).action),E=h.submitter;E&&(o=(o=E[En]||null)?s1(o.formAction):E.getAttribute("formAction"),o!==null&&(C=o,E=null));var O=new Ku("action","action",null,h,y);s.push({event:O,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ai!==0){var L=E?i1(y,E):new FormData(y);hh(d,{pending:!0,data:L,method:y.method,action:C},null,L)}}else typeof C=="function"&&(O.preventDefault(),L=E?i1(y,E):new FormData(y),hh(d,{pending:!0,data:L,method:y.method,action:C},C,L))},currentTarget:y}]})}}for(var sp=0;sp<Zy.length;sp++){var ip=Zy[sp],mD=ip.toLowerCase(),gD=ip[0].toUpperCase()+ip.slice(1);Lr(mD,"on"+gD)}Lr(qy,"onAnimationEnd"),Lr(Xy,"onAnimationIteration"),Lr(Ky,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(F$,"onTransitionRun"),Lr(A$,"onTransitionStart"),Lr(I$,"onTransitionCancel"),Lr(Yy,"onTransitionEnd"),Wi("onMouseEnter",["mouseout","mouseover"]),Wi("onMouseLeave",["mouseout","mouseover"]),Wi("onPointerEnter",["pointerout","pointerover"]),Wi("onPointerLeave",["pointerout","pointerover"]),Us("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Us("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Us("onBeforeInput",["compositionend","keypress","textInput","paste"]),Us("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Us("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Us("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function o1(s,o){o=(o&4)!==0;for(var d=0;d<s.length;d++){var h=s[d],y=h.event;h=h.listeners;e:{var C=void 0;if(o)for(var E=h.length-1;0<=E;E--){var O=h[E],L=O.instance,W=O.currentTarget;if(O=O.listener,L!==C&&y.isPropagationStopped())break e;C=O,y.currentTarget=W;try{C(y)}catch(ie){yc(ie)}y.currentTarget=null,C=L}else for(E=0;E<h.length;E++){if(O=h[E],L=O.instance,W=O.currentTarget,O=O.listener,L!==C&&y.isPropagationStopped())break e;C=O,y.currentTarget=W;try{C(y)}catch(ie){yc(ie)}y.currentTarget=null,C=L}}}}function Ve(s,o){var d=o[Sf];d===void 0&&(d=o[Sf]=new Set);var h=s+"__bubble";d.has(h)||(l1(o,s,2,!1),d.add(h))}function op(s,o,d){var h=0;o&&(h|=4),l1(d,s,h,o)}var kc="_reactListening"+Math.random().toString(36).slice(2);function lp(s){if(!s[kc]){s[kc]=!0,dy.forEach(function(d){d!=="selectionchange"&&(yD.has(d)||op(d,!1,s),op(d,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[kc]||(o[kc]=!0,op("selectionchange",!1,o))}}function l1(s,o,d,h){switch(O1(o)){case 2:var y=GD;break;case 8:y=HD;break;default:y=Cp}d=y.bind(null,o,d,s),y=void 0,!_f||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),h?y!==void 0?s.addEventListener(o,d,{capture:!0,passive:y}):s.addEventListener(o,d,!0):y!==void 0?s.addEventListener(o,d,{passive:y}):s.addEventListener(o,d,!1)}function up(s,o,d,h,y){var C=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var O=h.stateNode.containerInfo;if(O===y||O.nodeType===8&&O.parentNode===y)break;if(E===4)for(E=h.return;E!==null;){var L=E.tag;if((L===3||L===4)&&(L=E.stateNode.containerInfo,L===y||L.nodeType===8&&L.parentNode===y))return;E=E.return}for(;O!==null;){if(E=Ms(O),E===null)return;if(L=E.tag,L===5||L===6||L===26||L===27){h=C=E;continue e}O=O.parentNode}}h=h.return}wy(function(){var W=C,ie=Df(d),ce=[];e:{var ne=Qy.get(s);if(ne!==void 0){var se=Ku,Ee=s;switch(s){case"keypress":if(qu(d)===0)break e;case"keydown":case"keyup":se=c$;break;case"focusin":Ee="focus",se=Af;break;case"focusout":Ee="blur",se=Af;break;case"beforeblur":case"afterblur":se=Af;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=Ey;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=ZE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=h$;break;case qy:case Xy:case Ky:se=t$;break;case Yy:se=m$;break;case"scroll":case"scrollend":se=YE;break;case"wheel":se=y$;break;case"copy":case"cut":case"paste":se=r$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Dy;break;case"toggle":case"beforetoggle":se=b$}var Oe=(o&4)!==0,wt=!Oe&&(s==="scroll"||s==="scrollend"),Y=Oe?ne!==null?ne+"Capture":null:ne;Oe=[];for(var H=W,J;H!==null;){var ue=H;if(J=ue.stateNode,ue=ue.tag,ue!==5&&ue!==26&&ue!==27||J===null||Y===null||(ue=ol(H,Y),ue!=null&&Oe.push(Gl(H,ue,J))),wt)break;H=H.return}0<Oe.length&&(ne=new se(ne,Ee,null,d,ie),ce.push({event:ne,listeners:Oe}))}}if((o&7)===0){e:{if(ne=s==="mouseover"||s==="pointerover",se=s==="mouseout"||s==="pointerout",ne&&d!==$f&&(Ee=d.relatedTarget||d.fromElement)&&(Ms(Ee)||Ee[Vi]))break e;if((se||ne)&&(ne=ie.window===ie?ie:(ne=ie.ownerDocument)?ne.defaultView||ne.parentWindow:window,se?(Ee=d.relatedTarget||d.toElement,se=W,Ee=Ee?Ms(Ee):null,Ee!==null&&(wt=le(Ee),Oe=Ee.tag,Ee!==wt||Oe!==5&&Oe!==27&&Oe!==6)&&(Ee=null)):(se=null,Ee=W),se!==Ee)){if(Oe=Ey,ue="onMouseLeave",Y="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(Oe=Dy,ue="onPointerLeave",Y="onPointerEnter",H="pointer"),wt=se==null?ne:il(se),J=Ee==null?ne:il(Ee),ne=new Oe(ue,H+"leave",se,d,ie),ne.target=wt,ne.relatedTarget=J,ue=null,Ms(ie)===W&&(Oe=new Oe(Y,H+"enter",Ee,d,ie),Oe.target=J,Oe.relatedTarget=wt,ue=Oe),wt=ue,se&&Ee)t:{for(Oe=se,Y=Ee,H=0,J=Oe;J;J=vo(J))H++;for(J=0,ue=Y;ue;ue=vo(ue))J++;for(;0<H-J;)Oe=vo(Oe),H--;for(;0<J-H;)Y=vo(Y),J--;for(;H--;){if(Oe===Y||Y!==null&&Oe===Y.alternate)break t;Oe=vo(Oe),Y=vo(Y)}Oe=null}else Oe=null;se!==null&&u1(ce,ne,se,Oe,!1),Ee!==null&&wt!==null&&u1(ce,wt,Ee,Oe,!0)}}e:{if(ne=W?il(W):window,se=ne.nodeName&&ne.nodeName.toLowerCase(),se==="select"||se==="input"&&ne.type==="file")var we=Ly;else if(Ay(ne))if(By)we=R$;else{we=$$;var Ue=E$}else se=ne.nodeName,!se||se.toLowerCase()!=="input"||ne.type!=="checkbox"&&ne.type!=="radio"?W&&Ef(W.elementType)&&(we=Ly):we=D$;if(we&&(we=we(s,W))){Iy(ce,we,d,ie);break e}Ue&&Ue(s,ne,W),s==="focusout"&&W&&ne.type==="number"&&W.memoizedProps.value!=null&&Nf(ne,"number",ne.value)}switch(Ue=W?il(W):window,s){case"focusin":(Ay(Ue)||Ue.contentEditable==="true")&&(Qi=Ue,Pf=W,ml=null);break;case"focusout":ml=Pf=Qi=null;break;case"mousedown":zf=!0;break;case"contextmenu":case"mouseup":case"dragend":zf=!1,Wy(ce,d,ie);break;case"selectionchange":if(k$)break;case"keydown":case"keyup":Wy(ce,d,ie)}var $e;if(Lf)e:{switch(s){case"compositionstart":var _e="onCompositionStart";break e;case"compositionend":_e="onCompositionEnd";break e;case"compositionupdate":_e="onCompositionUpdate";break e}_e=void 0}else Yi?ky(s,d)&&(_e="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(_e="onCompositionStart");_e&&(Ry&&d.locale!=="ko"&&(Yi||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&Yi&&($e=Ty()):(Xa=ie,Of="value"in Xa?Xa.value:Xa.textContent,Yi=!0)),Ue=Fc(W,_e),0<Ue.length&&(_e=new $y(_e,s,null,d,ie),ce.push({event:_e,listeners:Ue}),$e?_e.data=$e:($e=Fy(d),$e!==null&&(_e.data=$e)))),($e=C$?S$(s,d):w$(s,d))&&(_e=Fc(W,"onBeforeInput"),0<_e.length&&(Ue=new $y("onBeforeInput","beforeinput",null,d,ie),ce.push({event:Ue,listeners:_e}),Ue.data=$e)),pD(ce,s,W,d,ie)}o1(ce,o)})}function Gl(s,o,d){return{instance:s,listener:o,currentTarget:d}}function Fc(s,o){for(var d=o+"Capture",h=[];s!==null;){var y=s,C=y.stateNode;y=y.tag,y!==5&&y!==26&&y!==27||C===null||(y=ol(s,d),y!=null&&h.unshift(Gl(s,y,C)),y=ol(s,o),y!=null&&h.push(Gl(s,y,C))),s=s.return}return h}function vo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function u1(s,o,d,h,y){for(var C=o._reactName,E=[];d!==null&&d!==h;){var O=d,L=O.alternate,W=O.stateNode;if(O=O.tag,L!==null&&L===h)break;O!==5&&O!==26&&O!==27||W===null||(L=W,y?(W=ol(d,C),W!=null&&E.unshift(Gl(d,W,L))):y||(W=ol(d,C),W!=null&&E.push(Gl(d,W,L)))),d=d.return}E.length!==0&&s.push({event:o,listeners:E})}var xD=/\r\n?/g,bD=/\u0000|\uFFFD/g;function c1(s){return(typeof s=="string"?s:""+s).replace(xD,`
`).replace(bD,"")}function d1(s,o){return o=c1(o),c1(s)===o}function Ac(){}function at(s,o,d,h,y,C){switch(d){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||qi(s,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&qi(s,""+h);break;case"className":Vu(s,"class",h);break;case"tabIndex":Vu(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Vu(s,d,h);break;case"style":Cy(s,h,C);break;case"data":if(o!=="object"){Vu(s,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||d!=="href")){s.removeAttribute(d);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(d);break}h=Wu(""+h),s.setAttribute(d,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(d==="formAction"?(o!=="input"&&at(s,o,"name",y.name,y,null),at(s,o,"formEncType",y.formEncType,y,null),at(s,o,"formMethod",y.formMethod,y,null),at(s,o,"formTarget",y.formTarget,y,null)):(at(s,o,"encType",y.encType,y,null),at(s,o,"method",y.method,y,null),at(s,o,"target",y.target,y,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(d);break}h=Wu(""+h),s.setAttribute(d,h);break;case"onClick":h!=null&&(s.onclick=Ac);break;case"onScroll":h!=null&&Ve("scroll",s);break;case"onScrollEnd":h!=null&&Ve("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(d=h.__html,d!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=d}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}d=Wu(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(d,""+h):s.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(d,""):s.removeAttribute(d);break;case"capture":case"download":h===!0?s.setAttribute(d,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(d,h):s.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(d,h):s.removeAttribute(d);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(d):s.setAttribute(d,h);break;case"popover":Ve("beforetoggle",s),Ve("toggle",s),zu(s,"popover",h);break;case"xlinkActuate":xa(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":xa(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":xa(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":xa(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":xa(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":xa(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":xa(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":xa(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":xa(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":zu(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=XE.get(d)||d,zu(s,d,h))}}function cp(s,o,d,h,y,C){switch(d){case"style":Cy(s,h,C);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(d=h.__html,d!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=d}}break;case"children":typeof h=="string"?qi(s,h):(typeof h=="number"||typeof h=="bigint")&&qi(s,""+h);break;case"onScroll":h!=null&&Ve("scroll",s);break;case"onScrollEnd":h!=null&&Ve("scrollend",s);break;case"onClick":h!=null&&(s.onclick=Ac);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fy.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(y=d.endsWith("Capture"),o=d.slice(2,y?d.length-7:void 0),C=s[En]||null,C=C!=null?C[d]:null,typeof C=="function"&&s.removeEventListener(o,C,y),typeof h=="function")){typeof C!="function"&&C!==null&&(d in s?s[d]=null:s.hasAttribute(d)&&s.removeAttribute(d)),s.addEventListener(o,h,y);break e}d in s?s[d]=h:h===!0?s.setAttribute(d,""):zu(s,d,h)}}}function qt(s,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",s),Ve("load",s);var h=!1,y=!1,C;for(C in d)if(d.hasOwnProperty(C)){var E=d[C];if(E!=null)switch(C){case"src":h=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:at(s,o,C,E,d,null)}}y&&at(s,o,"srcSet",d.srcSet,d,null),h&&at(s,o,"src",d.src,d,null);return;case"input":Ve("invalid",s);var O=C=E=y=null,L=null,W=null;for(h in d)if(d.hasOwnProperty(h)){var ie=d[h];if(ie!=null)switch(h){case"name":y=ie;break;case"type":E=ie;break;case"checked":L=ie;break;case"defaultChecked":W=ie;break;case"value":C=ie;break;case"defaultValue":O=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(r(137,o));break;default:at(s,o,h,ie,d,null)}}yy(s,C,O,L,W,E,y,!1),Gu(s);return;case"select":Ve("invalid",s),h=E=C=null;for(y in d)if(d.hasOwnProperty(y)&&(O=d[y],O!=null))switch(y){case"value":C=O;break;case"defaultValue":E=O;break;case"multiple":h=O;default:at(s,o,y,O,d,null)}o=C,d=E,s.multiple=!!h,o!=null?ji(s,!!h,o,!1):d!=null&&ji(s,!!h,d,!0);return;case"textarea":Ve("invalid",s),C=y=h=null;for(E in d)if(d.hasOwnProperty(E)&&(O=d[E],O!=null))switch(E){case"value":h=O;break;case"defaultValue":y=O;break;case"children":C=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:at(s,o,E,O,d,null)}by(s,h,y,C),Gu(s);return;case"option":for(L in d)if(d.hasOwnProperty(L)&&(h=d[L],h!=null))switch(L){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:at(s,o,L,h,d,null)}return;case"dialog":Ve("cancel",s),Ve("close",s);break;case"iframe":case"object":Ve("load",s);break;case"video":case"audio":for(h=0;h<Vl.length;h++)Ve(Vl[h],s);break;case"image":Ve("error",s),Ve("load",s);break;case"details":Ve("toggle",s);break;case"embed":case"source":case"link":Ve("error",s),Ve("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in d)if(d.hasOwnProperty(W)&&(h=d[W],h!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:at(s,o,W,h,d,null)}return;default:if(Ef(o)){for(ie in d)d.hasOwnProperty(ie)&&(h=d[ie],h!==void 0&&cp(s,o,ie,h,d,void 0));return}}for(O in d)d.hasOwnProperty(O)&&(h=d[O],h!=null&&at(s,o,O,h,d,null))}function vD(s,o,d,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,C=null,E=null,O=null,L=null,W=null,ie=null;for(se in d){var ce=d[se];if(d.hasOwnProperty(se)&&ce!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":L=ce;default:h.hasOwnProperty(se)||at(s,o,se,null,h,ce)}}for(var ne in h){var se=h[ne];if(ce=d[ne],h.hasOwnProperty(ne)&&(se!=null||ce!=null))switch(ne){case"type":C=se;break;case"name":y=se;break;case"checked":W=se;break;case"defaultChecked":ie=se;break;case"value":E=se;break;case"defaultValue":O=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,o));break;default:se!==ce&&at(s,o,ne,se,h,ce)}}Tf(s,E,O,L,W,ie,C,y);return;case"select":se=E=O=ne=null;for(C in d)if(L=d[C],d.hasOwnProperty(C)&&L!=null)switch(C){case"value":break;case"multiple":se=L;default:h.hasOwnProperty(C)||at(s,o,C,null,h,L)}for(y in h)if(C=h[y],L=d[y],h.hasOwnProperty(y)&&(C!=null||L!=null))switch(y){case"value":ne=C;break;case"defaultValue":O=C;break;case"multiple":E=C;default:C!==L&&at(s,o,y,C,h,L)}o=O,d=E,h=se,ne!=null?ji(s,!!d,ne,!1):!!h!=!!d&&(o!=null?ji(s,!!d,o,!0):ji(s,!!d,d?[]:"",!1));return;case"textarea":se=ne=null;for(O in d)if(y=d[O],d.hasOwnProperty(O)&&y!=null&&!h.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:at(s,o,O,null,h,y)}for(E in h)if(y=h[E],C=d[E],h.hasOwnProperty(E)&&(y!=null||C!=null))switch(E){case"value":ne=y;break;case"defaultValue":se=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==C&&at(s,o,E,y,h,C)}xy(s,ne,se);return;case"option":for(var Ee in d)if(ne=d[Ee],d.hasOwnProperty(Ee)&&ne!=null&&!h.hasOwnProperty(Ee))switch(Ee){case"selected":s.selected=!1;break;default:at(s,o,Ee,null,h,ne)}for(L in h)if(ne=h[L],se=d[L],h.hasOwnProperty(L)&&ne!==se&&(ne!=null||se!=null))switch(L){case"selected":s.selected=ne&&typeof ne!="function"&&typeof ne!="symbol";break;default:at(s,o,L,ne,h,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Oe in d)ne=d[Oe],d.hasOwnProperty(Oe)&&ne!=null&&!h.hasOwnProperty(Oe)&&at(s,o,Oe,null,h,ne);for(W in h)if(ne=h[W],se=d[W],h.hasOwnProperty(W)&&ne!==se&&(ne!=null||se!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(r(137,o));break;default:at(s,o,W,ne,h,se)}return;default:if(Ef(o)){for(var wt in d)ne=d[wt],d.hasOwnProperty(wt)&&ne!==void 0&&!h.hasOwnProperty(wt)&&cp(s,o,wt,void 0,h,ne);for(ie in h)ne=h[ie],se=d[ie],!h.hasOwnProperty(ie)||ne===se||ne===void 0&&se===void 0||cp(s,o,ie,ne,h,se);return}}for(var Y in d)ne=d[Y],d.hasOwnProperty(Y)&&ne!=null&&!h.hasOwnProperty(Y)&&at(s,o,Y,null,h,ne);for(ce in h)ne=h[ce],se=d[ce],!h.hasOwnProperty(ce)||ne===se||ne==null&&se==null||at(s,o,ce,ne,h,se)}var dp=null,fp=null;function Ic(s){return s.nodeType===9?s:s.ownerDocument}function f1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function h1(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function hp(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var pp=null;function CD(){var s=window.event;return s&&s.type==="popstate"?s===pp?!1:(pp=s,!0):(pp=null,!1)}var p1=typeof setTimeout=="function"?setTimeout:void 0,SD=typeof clearTimeout=="function"?clearTimeout:void 0,m1=typeof Promise=="function"?Promise:void 0,wD=typeof queueMicrotask=="function"?queueMicrotask:typeof m1<"u"?function(s){return m1.resolve(null).then(s).catch(TD)}:p1;function TD(s){setTimeout(function(){throw s})}function mp(s,o){var d=o,h=0;do{var y=d.nextSibling;if(s.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(h===0){s.removeChild(y),Ql(o);return}h--}else d!=="$"&&d!=="$?"&&d!=="$!"||h++;d=y}while(d);Ql(o)}function gp(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":gp(d),wf(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}s.removeChild(d)}}function ND(s,o,d,h){for(;s.nodeType===1;){var y=d;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[sl])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(C=s.getAttribute("rel"),C==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(C!==y.rel||s.getAttribute("href")!==(y.href==null?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(C=s.getAttribute("src"),(C!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&C&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var C=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===C)return s}else return s;if(s=Ur(s.nextSibling),s===null)break}return null}function ED(s,o,d){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!d||(s=Ur(s.nextSibling),s===null))return null;return s}function Ur(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}function g1(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return s;o--}else d==="/$"&&o++}s=s.previousSibling}return null}function y1(s,o,d){switch(o=Ic(d),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}var mr=new Map,x1=new Set;function Lc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.ownerDocument}var Fa=re.d;re.d={f:$D,r:DD,D:RD,C:_D,L:OD,m:kD,X:AD,S:FD,M:ID};function $D(){var s=Fa.f(),o=Dc();return s||o}function DD(s){var o=Gi(s);o!==null&&o.tag===5&&o.type==="form"?W0(o):Fa.r(s)}var Co=typeof document>"u"?null:document;function b1(s,o,d){var h=Co;if(h&&typeof o=="string"&&o){var y=sr(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof d=="string"&&(y+='[crossorigin="'+d+'"]'),x1.has(y)||(x1.add(y),s={rel:s,crossOrigin:d,href:o},h.querySelector(y)===null&&(o=h.createElement("link"),qt(o,"link",s),It(o),h.head.appendChild(o)))}}function RD(s){Fa.D(s),b1("dns-prefetch",s,null)}function _D(s,o){Fa.C(s,o),b1("preconnect",s,o)}function OD(s,o,d){Fa.L(s,o,d);var h=Co;if(h&&s&&o){var y='link[rel="preload"][as="'+sr(o)+'"]';o==="image"&&d&&d.imageSrcSet?(y+='[imagesrcset="'+sr(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(y+='[imagesizes="'+sr(d.imageSizes)+'"]')):y+='[href="'+sr(s)+'"]';var C=y;switch(o){case"style":C=So(s);break;case"script":C=wo(s)}mr.has(C)||(s=U({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:s,as:o},d),mr.set(C,s),h.querySelector(y)!==null||o==="style"&&h.querySelector(Hl(C))||o==="script"&&h.querySelector(Wl(C))||(o=h.createElement("link"),qt(o,"link",s),It(o),h.head.appendChild(o)))}}function kD(s,o){Fa.m(s,o);var d=Co;if(d&&s){var h=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+sr(h)+'"][href="'+sr(s)+'"]',C=y;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=wo(s)}if(!mr.has(C)&&(s=U({rel:"modulepreload",href:s},o),mr.set(C,s),d.querySelector(y)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Wl(C)))return}h=d.createElement("link"),qt(h,"link",s),It(h),d.head.appendChild(h)}}}function FD(s,o,d){Fa.S(s,o,d);var h=Co;if(h&&s){var y=Hi(h).hoistableStyles,C=So(s);o=o||"default";var E=y.get(C);if(!E){var O={loading:0,preload:null};if(E=h.querySelector(Hl(C)))O.loading=5;else{s=U({rel:"stylesheet",href:s,"data-precedence":o},d),(d=mr.get(C))&&yp(s,d);var L=E=h.createElement("link");It(L),qt(L,"link",s),L._p=new Promise(function(W,ie){L.onload=W,L.onerror=ie}),L.addEventListener("load",function(){O.loading|=1}),L.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Bc(E,o,h)}E={type:"stylesheet",instance:E,count:1,state:O},y.set(C,E)}}}function AD(s,o){Fa.X(s,o);var d=Co;if(d&&s){var h=Hi(d).hoistableScripts,y=wo(s),C=h.get(y);C||(C=d.querySelector(Wl(y)),C||(s=U({src:s,async:!0},o),(o=mr.get(y))&&xp(s,o),C=d.createElement("script"),It(C),qt(C,"link",s),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},h.set(y,C))}}function ID(s,o){Fa.M(s,o);var d=Co;if(d&&s){var h=Hi(d).hoistableScripts,y=wo(s),C=h.get(y);C||(C=d.querySelector(Wl(y)),C||(s=U({src:s,async:!0,type:"module"},o),(o=mr.get(y))&&xp(s,o),C=d.createElement("script"),It(C),qt(C,"link",s),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},h.set(y,C))}}function v1(s,o,d,h){var y=(y=Ze.current)?Lc(y):null;if(!y)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=So(d.href),d=Hi(y).hoistableStyles,h=d.get(o),h||(h={type:"style",instance:null,count:0,state:null},d.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){s=So(d.href);var C=Hi(y).hoistableStyles,E=C.get(s);if(E||(y=y.ownerDocument||y,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(s,E),(C=y.querySelector(Hl(s)))&&!C._p&&(E.instance=C,E.state.loading=5),mr.has(s)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},mr.set(s,d),C||LD(y,s,d,E.state))),o&&h===null)throw Error(r(528,""));return E}if(o&&h!==null)throw Error(r(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=wo(d),d=Hi(y).hoistableScripts,h=d.get(o),h||(h={type:"script",instance:null,count:0,state:null},d.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function So(s){return'href="'+sr(s)+'"'}function Hl(s){return'link[rel="stylesheet"]['+s+"]"}function C1(s){return U({},s,{"data-precedence":s.precedence,precedence:null})}function LD(s,o,d,h){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=s.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),qt(o,"link",d),It(o),s.head.appendChild(o))}function wo(s){return'[src="'+sr(s)+'"]'}function Wl(s){return"script[async]"+s}function S1(s,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var h=s.querySelector('style[data-href~="'+sr(d.href)+'"]');if(h)return o.instance=h,It(h),h;var y=U({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),It(h),qt(h,"style",y),Bc(h,d.precedence,s),o.instance=h;case"stylesheet":y=So(d.href);var C=s.querySelector(Hl(y));if(C)return o.state.loading|=4,o.instance=C,It(C),C;h=C1(d),(y=mr.get(y))&&yp(h,y),C=(s.ownerDocument||s).createElement("link"),It(C);var E=C;return E._p=new Promise(function(O,L){E.onload=O,E.onerror=L}),qt(C,"link",h),o.state.loading|=4,Bc(C,d.precedence,s),o.instance=C;case"script":return C=wo(d.src),(y=s.querySelector(Wl(C)))?(o.instance=y,It(y),y):(h=d,(y=mr.get(C))&&(h=U({},d),xp(h,y)),s=s.ownerDocument||s,y=s.createElement("script"),It(y),qt(y,"link",h),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,Bc(h,d.precedence,s));return o.instance}function Bc(s,o,d){for(var h=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=h.length?h[h.length-1]:null,C=y,E=0;E<h.length;E++){var O=h[E];if(O.dataset.precedence===o)C=O;else if(C!==y)break}C?C.parentNode.insertBefore(s,C.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(s,o.firstChild))}function yp(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function xp(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Mc=null;function w1(s,o,d){if(Mc===null){var h=new Map,y=Mc=new Map;y.set(d,h)}else y=Mc,h=y.get(d),h||(h=new Map,y.set(d,h));if(h.has(s))return h;for(h.set(s,null),d=d.getElementsByTagName(s),y=0;y<d.length;y++){var C=d[y];if(!(C[sl]||C[Yt]||s==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var E=C.getAttribute(o)||"";E=s+E;var O=h.get(E);O?O.push(C):h.set(E,[C])}}return h}function T1(s,o,d){s=s.ownerDocument||s,s.head.insertBefore(d,o==="title"?s.querySelector("head > title"):null)}function BD(s,o,d){if(d===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function N1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var jl=null;function MD(){}function UD(s,o,d){if(jl===null)throw Error(r(475));var h=jl;if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var y=So(d.href),C=s.querySelector(Hl(y));if(C){s=C._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(h.count++,h=Uc.bind(h),s.then(h,h)),o.state.loading|=4,o.instance=C,It(C);return}C=s.ownerDocument||s,d=C1(d),(y=mr.get(y))&&yp(d,y),C=C.createElement("link"),It(C);var E=C;E._p=new Promise(function(O,L){E.onload=O,E.onerror=L}),qt(C,"link",d),o.instance=C}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(h.count++,o=Uc.bind(h),s.addEventListener("load",o),s.addEventListener("error",o))}}function PD(){if(jl===null)throw Error(r(475));var s=jl;return s.stylesheets&&s.count===0&&bp(s,s.stylesheets),0<s.count?function(o){var d=setTimeout(function(){if(s.stylesheets&&bp(s,s.stylesheets),s.unsuspend){var h=s.unsuspend;s.unsuspend=null,h()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(d)}}:null}function Uc(){if(this.count--,this.count===0){if(this.stylesheets)bp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Pc=null;function bp(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Pc=new Map,o.forEach(zD,s),Pc=null,Uc.call(s))}function zD(s,o){if(!(o.state.loading&4)){var d=Pc.get(s);if(d)var h=d.get(null);else{d=new Map,Pc.set(s,d);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<y.length;C++){var E=y[C];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(d.set(E.dataset.precedence,E),h=E)}h&&d.set(null,h)}y=o.instance,E=y.getAttribute("data-precedence"),C=d.get(E)||h,C===h&&d.set(null,y),d.set(E,y),this.count++,h=Uc.bind(this),y.addEventListener("load",h),y.addEventListener("error",h),C?C.parentNode.insertBefore(y,C.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var ql={$$typeof:x,Provider:null,Consumer:null,_currentValue:xe,_currentValue2:xe,_threadCount:0};function VD(s,o,d,h,y,C,E,O){this.tag=1,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cf(0),this.hiddenUpdates=Cf(null),this.identifierPrefix=h,this.onUncaughtError=y,this.onCaughtError=C,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function E1(s,o,d,h,y,C,E,O,L,W,ie,ce){return s=new VD(s,o,d,E,O,L,W,ce),o=1,C===!0&&(o|=24),C=hr(3,null,null,o),s.current=C,C.stateNode=s,o=Qf(),o.refCount++,s.pooledCache=o,o.refCount++,C.memoizedState={element:h,isDehydrated:d,cache:o},Oh(C),s}function $1(s){return s?(s=eo,s):eo}function D1(s,o,d,h,y,C){y=$1(y),h.context===null?h.context=y:h.pendingContext=y,h=ns(o),h.payload={element:d},C=C===void 0?null:C,C!==null&&(h.callback=C),d=rs(s,h,o),d!==null&&(yn(d,s,o),_l(d,s,o))}function R1(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<o?d:o}}function vp(s,o){R1(s,o),(s=s.alternate)&&R1(s,o)}function _1(s){if(s.tag===13){var o=Ka(s,67108864);o!==null&&yn(o,s,67108864),vp(s,67108864)}}var zc=!0;function GD(s,o,d,h){var y=B.T;B.T=null;var C=re.p;try{re.p=2,Cp(s,o,d,h)}finally{re.p=C,B.T=y}}function HD(s,o,d,h){var y=B.T;B.T=null;var C=re.p;try{re.p=8,Cp(s,o,d,h)}finally{re.p=C,B.T=y}}function Cp(s,o,d,h){if(zc){var y=Sp(h);if(y===null)up(s,o,h,Vc,d),k1(s,h);else if(jD(y,s,o,d,h))h.stopPropagation();else if(k1(s,h),o&4&&-1<WD.indexOf(s)){for(;y!==null;){var C=Gi(y);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var E=Bs(C.pendingLanes);if(E!==0){var O=C;for(O.pendingLanes|=2,O.entangledLanes|=2;E;){var L=1<<31-Pn(E);O.entanglements[1]|=L,E&=~L}ua(C),(yt&6)===0&&(Nc=vt()+500,zl(0))}}break;case 13:O=Ka(C,2),O!==null&&yn(O,C,2),Dc(),vp(C,2)}if(C=Sp(h),C===null&&up(s,o,h,Vc,d),C===y)break;y=C}y!==null&&h.stopPropagation()}else up(s,o,h,null,d)}}function Sp(s){return s=Df(s),wp(s)}var Vc=null;function wp(s){if(Vc=null,s=Ms(s),s!==null){var o=le(s);if(o===null)s=null;else{var d=o.tag;if(d===13){if(s=Q(o),s!==null)return s;s=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Vc=s,null}function O1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Un()){case Fe:return 2;case Nn:return 8;case nr:case Is:return 32;case Ls:return 268435456;default:return 32}default:return 32}}var Tp=!1,cs=null,ds=null,fs=null,Xl=new Map,Kl=new Map,hs=[],WD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function k1(s,o){switch(s){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":fs=null;break;case"pointerover":case"pointerout":Xl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kl.delete(o.pointerId)}}function Yl(s,o,d,h,y,C){return s===null||s.nativeEvent!==C?(s={blockedOn:o,domEventName:d,eventSystemFlags:h,nativeEvent:C,targetContainers:[y]},o!==null&&(o=Gi(o),o!==null&&_1(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function jD(s,o,d,h,y){switch(o){case"focusin":return cs=Yl(cs,s,o,d,h,y),!0;case"dragenter":return ds=Yl(ds,s,o,d,h,y),!0;case"mouseover":return fs=Yl(fs,s,o,d,h,y),!0;case"pointerover":var C=y.pointerId;return Xl.set(C,Yl(Xl.get(C)||null,s,o,d,h,y)),!0;case"gotpointercapture":return C=y.pointerId,Kl.set(C,Yl(Kl.get(C)||null,s,o,d,h,y)),!0}return!1}function F1(s){var o=Ms(s.target);if(o!==null){var d=le(o);if(d!==null){if(o=d.tag,o===13){if(o=Q(d),o!==null){s.blockedOn=o,PE(s.priority,function(){if(d.tag===13){var h=Wn(),y=Ka(d,h);y!==null&&yn(y,d,h),vp(d,h)}});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gc(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var d=Sp(s.nativeEvent);if(d===null){d=s.nativeEvent;var h=new d.constructor(d.type,d);$f=h,d.target.dispatchEvent(h),$f=null}else return o=Gi(d),o!==null&&_1(o),s.blockedOn=d,!1;o.shift()}return!0}function A1(s,o,d){Gc(s)&&d.delete(o)}function qD(){Tp=!1,cs!==null&&Gc(cs)&&(cs=null),ds!==null&&Gc(ds)&&(ds=null),fs!==null&&Gc(fs)&&(fs=null),Xl.forEach(A1),Kl.forEach(A1)}function Hc(s,o){s.blockedOn===o&&(s.blockedOn=null,Tp||(Tp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,qD)))}var Wc=null;function I1(s){Wc!==s&&(Wc=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Wc===s&&(Wc=null);for(var o=0;o<s.length;o+=3){var d=s[o],h=s[o+1],y=s[o+2];if(typeof h!="function"){if(wp(h||d)===null)continue;break}var C=Gi(d);C!==null&&(s.splice(o,3),o-=3,hh(C,{pending:!0,data:y,method:d.method,action:h},h,y))}}))}function Ql(s){function o(L){return Hc(L,s)}cs!==null&&Hc(cs,s),ds!==null&&Hc(ds,s),fs!==null&&Hc(fs,s),Xl.forEach(o),Kl.forEach(o);for(var d=0;d<hs.length;d++){var h=hs[d];h.blockedOn===s&&(h.blockedOn=null)}for(;0<hs.length&&(d=hs[0],d.blockedOn===null);)F1(d),d.blockedOn===null&&hs.shift();if(d=(s.ownerDocument||s).$$reactFormReplay,d!=null)for(h=0;h<d.length;h+=3){var y=d[h],C=d[h+1],E=y[En]||null;if(typeof C=="function")E||I1(d);else if(E){var O=null;if(C&&C.hasAttribute("formAction")){if(y=C,E=C[En]||null)O=E.formAction;else if(wp(y)!==null)continue}else O=E.action;typeof O=="function"?d[h+1]=O:(d.splice(h,3),h-=3),I1(d)}}}function Np(s){this._internalRoot=s}jc.prototype.render=Np.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var d=o.current,h=Wn();D1(d,h,s,o,null,null)},jc.prototype.unmount=Np.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;s.tag===0&&xo(),D1(s.current,2,null,s,null,null),Dc(),o[Vi]=null}};function jc(s){this._internalRoot=s}jc.prototype.unstable_scheduleHydration=function(s){if(s){var o=uy();s={blockedOn:null,target:s,priority:o};for(var d=0;d<hs.length&&o!==0&&o<hs[d].priority;d++);hs.splice(d,0,s),d===0&&F1(s)}};var L1=e.version;if(L1!=="19.0.0")throw Error(r(527,L1,"19.0.0"));re.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=P(o),s=s!==null?G(s):null,s=s===null?null:s.stateNode,s};var XD={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:B,findFiberByHostInstance:Ms,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qc.isDisabled&&qc.supportsFiber)try{ga=qc.inject(XD),mn=qc}catch{}}return au.createRoot=function(s,o){if(!a(s))throw Error(r(299));var d=!1,h="",y=J0,C=ex,E=tx,O=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(C=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(O=o.unstable_transitionCallbacks)),o=E1(s,1,!1,null,null,d,h,y,C,E,O,null),s[Vi]=o.current,lp(s.nodeType===8?s.parentNode:s),new Np(o)},au.hydrateRoot=function(s,o,d){if(!a(s))throw Error(r(299));var h=!1,y="",C=J0,E=ex,O=tx,L=null,W=null;return d!=null&&(d.unstable_strictMode===!0&&(h=!0),d.identifierPrefix!==void 0&&(y=d.identifierPrefix),d.onUncaughtError!==void 0&&(C=d.onUncaughtError),d.onCaughtError!==void 0&&(E=d.onCaughtError),d.onRecoverableError!==void 0&&(O=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(L=d.unstable_transitionCallbacks),d.formState!==void 0&&(W=d.formState)),o=E1(s,1,!0,o,d??null,h,y,C,E,O,L,W),o.context=$1(null),d=o.current,h=Wn(),y=ns(h),y.callback=null,rs(d,y,h),o.current.lanes=h,al(o,h),ua(o),s[Vi]=o.current,lp(s),new jc(o)},au.version="19.0.0",au}var Iv;function B9(){if(Iv)return em.exports;Iv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),em.exports=L9(),em.exports}var M9=B9();const U9=Ai(M9);U9.createRoot(document.getElementById("root")).render(q.jsx(o9,{children:q.jsx(F9,{})}));
